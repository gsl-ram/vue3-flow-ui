import{a0 as sp,a1 as op,a2 as hp,a3 as lp,a4 as dp,a5 as fp,a6 as pp,F as Vl,a7 as cp,a8 as up,a9 as gp,aa as vp,ab as mp,ac as yp,ad as Sp,ae as wp,af as Ip,ag as xp,ah as Cp,ai as Pp,aj as Tp,ak as Ap,al as bp,am as Ep,an as Dp,ao as Lp,l as eo,ap as Mp,i as zp,j as kp,c as io,a as pe,aq as Rp,D as Hp,ar as Bp,as as Op,at as Wp,au as Np,b as Gl,e as Zl,P as Xp,av as Yp,d as $l,aw as Up,ax as Fp,ay as Vp,az as Gp,aA as Zp,aB as $p,aC as qp,aD as Qp,aE as Jp,aF as _p,G as Kp,E as jp,Q as tc,aG as ec,aH as ic,aI as rc,q as nc,aJ as ac,aK as sc,aL as oc,aM as hc,aN as lc,aO as dc,aP as fc,aQ as pc,aR as cc,L as uc,J as gc,aS as vc,aT as mc,aU as yc,N as Sc,aV as wc,aW as Ic,aX as xc,m as Cc,aY as Pc,aZ as Tc,X as Ac,n as bc,a_ as Ec,x as Dc,a$ as Lc,k as Mc,b0 as zc,H as kc,I as Rc,b1 as Hc,b2 as Bc,b3 as Oc,C as ql,b4 as Wc,b5 as Nc,R as Xc,b6 as Yc,B as Uc,b7 as Fc,b8 as Vc,o as ro,b9 as Gc,ba as Zc,S as $c,bb as qc,bc as Qc,bd as Jc,M as _c,U as Kc,g as bn,be as jc,bf as tu,r as Ql,h as eu,V as iu,bg as ru,s as nu,bh as au,bi as su,bj as ou,bk as hu,bl as lu,bm as du,bn as fu,K as pu,bo as cu,bp as uu,bq as gu,t as ya,br as vu,bs as mu,bt as yu,p as Su,O as wu,T as Iu,bu as xu,bv as Cu,u as Jl,W as Pu,bw as Tu,bx as Au,by as bu,bz as Eu,bA as Du,bB as Lu,bC as Mu,A as zu,bD as ku,bE as Ru,bF as Hu,bG as Bu,bH as Ou,v as _l,$ as Wu,y as Nu,bI as Xu,bJ as Yu,z as Uu,Z as Fu,bK as Vu,bL as Gu,bM as Zu,f as $u,bN as qu,w as Kl,bO as Qu,bP as Ju,bQ as _u,bR as Ku,bS as w,bT as j,bU as Ii,bV as Re,bW as Lt,bX as os,bY as V,bZ as Yi,b_ as Ve,b$ as vt,c0 as J,c1 as We,c2 as he,c3 as ur,c4 as X,c5 as ot,c6 as Po,c7 as Vr,c8 as Bt,c9 as fr,ca as jr,cb as ba,cc as sn,cd as Kr,ce as re,cf as Rr,cg as tn,ch as ju,ci as xr,cj as jl,ck as td,cl as no,cm as Ts,cn as tg,co as eg,cp as ig,cq as rg,cr as ng,cs as As,ct as Ni,cu as ag,cv as Ea,cw as sg,cx as og,cy as hg,_ as lg}from"./index-OeQLC6yW.js";const dg=()=>{},fg=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:sp,BaseTransitionPropsValidators:op,Comment:hp,DeprecationTypes:lp,EffectScope:dp,ErrorCodes:fp,ErrorTypeStrings:pp,Fragment:Vl,KeepAlive:cp,ReactiveEffect:up,Static:gp,Suspense:vp,Teleport:mp,Text:yp,TrackOpTypes:Sp,Transition:wp,TransitionGroup:Ip,TriggerOpTypes:xp,VueElement:Cp,assertNumber:Pp,callWithAsyncErrorHandling:Tp,callWithErrorHandling:Ap,camelize:bp,capitalize:Ep,cloneVNode:Dp,compatUtils:Lp,compile:dg,computed:eo,createApp:Mp,createBlock:zp,createCommentVNode:kp,createElementBlock:io,createElementVNode:pe,createHydrationRenderer:Rp,createPropsRestProxy:Hp,createRenderer:Bp,createSSRApp:Op,createSlots:Wp,createStaticVNode:Np,createTextVNode:Gl,createVNode:Zl,customRef:Xp,defineAsyncComponent:Yp,defineComponent:$l,defineCustomElement:Up,defineEmits:Fp,defineExpose:Vp,defineModel:Gp,defineOptions:Zp,defineProps:$p,defineSSRCustomElement:qp,defineSlots:Qp,devtools:Jp,effect:_p,effectScope:Kp,getCurrentInstance:jp,getCurrentScope:tc,getCurrentWatcher:ec,getTransitionRawChildren:ic,guardReactiveProps:rc,h:nc,handleError:ac,hasInjectionContext:sc,hydrate:oc,hydrateOnIdle:hc,hydrateOnInteraction:lc,hydrateOnMediaQuery:dc,hydrateOnVisible:fc,initCustomFormatter:pc,initDirectivesForSSR:cc,inject:uc,isMemoSame:gc,isProxy:vc,isReactive:mc,isReadonly:yc,isRef:Sc,isRuntimeOnly:wc,isShallow:Ic,isVNode:xc,markRaw:Cc,mergeDefaults:Pc,mergeModels:Tc,mergeProps:Ac,nextTick:bc,nodeOps:Ec,normalizeClass:Dc,normalizeProps:Lc,normalizeStyle:Mc,onActivated:zc,onBeforeMount:kc,onBeforeUnmount:Rc,onBeforeUpdate:Hc,onDeactivated:Bc,onErrorCaptured:Oc,onMounted:ql,onRenderTracked:Wc,onRenderTriggered:Nc,onScopeDispose:Xc,onServerPrefetch:Yc,onUnmounted:Uc,onUpdated:Fc,onWatcherCleanup:Vc,openBlock:ro,patchProp:Gc,popScopeId:Zc,provide:$c,proxyRefs:qc,pushScopeId:Qc,queuePostFlushCb:Jc,reactive:_c,readonly:Kc,ref:bn,registerRuntimeCompiler:jc,render:tu,renderList:Ql,renderSlot:eu,resolveComponent:iu,resolveDirective:ru,resolveDynamicComponent:nu,resolveFilter:au,resolveTransitionHooks:su,setBlockTracking:ou,setDevtoolsHook:hu,setTransitionHooks:lu,shallowReactive:du,shallowReadonly:fu,shallowRef:pu,ssrContextKey:cu,ssrUtils:uu,stop:gu,toDisplayString:ya,toHandlerKey:vu,toHandlers:mu,toRaw:yu,toRef:Su,toRefs:wu,toValue:Iu,transformVNodeArgs:xu,triggerRef:Cu,unref:Jl,useAttrs:Pu,useCssModule:Tu,useCssVars:Au,useHost:bu,useId:Eu,useModel:Du,useSSRContext:Lu,useShadowRoot:Mu,useSlots:zu,useTemplateRef:ku,useTransitionState:Ru,vModelCheckbox:Hu,vModelDynamic:Bu,vModelRadio:Ou,vModelSelect:_l,vModelText:Wu,vShow:Nu,version:Xu,warn:Yu,watch:Uu,watchEffect:Fu,watchPostEffect:Vu,watchSyncEffect:Gu,withAsyncContext:Zu,withCtx:$u,withDefaults:qu,withDirectives:Kl,withKeys:Qu,withMemo:Ju,withModifiers:_u,withScopeId:Ku},Symbol.toStringTag,{value:"Module"}));var U=(function(){function n(e,t){this.width=e,this.height=t}return n.prototype.isEmpty=function(){return this.height===0&&this.width===0},n.prototype.clone=function(){return new n(this.width,this.height)},n})(),pg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),wh=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},b=(function(n){pg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.equals=function(t,i){return t===i?!0:!t||!i?!1:!t||!i||t.x===i.x&&t.y===i.y},e.isEmptyPoint=function(t){return!(t.x&&t.y)},e.transform=function(t,i,r){var a={x:0,y:0};return a.x=Math.round((t.x+r*Math.cos(i*Math.PI/180))*100)/100,a.y=Math.round((t.y+r*Math.sin(i*Math.PI/180))*100)/100,a},e.findLength=function(t,i){var r=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2));return r},e.findAngle=function(t,i){var r=Math.atan2(i.y-t.y,i.x-t.x);return r=180*r/Math.PI,r%=360,r<0&&(r+=360),r},e.distancePoints=function(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},e.getLengthFromListOfPoints=function(t){for(var i=0,r=0;r<t.length-1;r++)i+=this.distancePoints(t[parseInt(r.toString(),10)],t[r+1]);return i},e.adjustPoint=function(t,i,r,a){var s=r?{x:t.x,y:t.y}:{x:i.x,y:i.y},o;return t.x===i.x?t.y<i.y&&r||t.y>i.y&&!r?s.y+=a:s.y-=a:t.y===i.y?t.x<i.x&&r||t.x>i.x&&!r?s.x+=a:s.x-=a:r?(o=this.findAngle(t,i),s=this.transform(t,o,a)):(o=this.findAngle(i,t),s=this.transform(i,o,a)),s},e.direction=function(t,i){return Math.abs(i.x-t.x)>Math.abs(i.y-t.y)?t.x<i.x?"Right":"Left":t.y<i.y?"Bottom":"Top"},e.prototype.getClassName=function(){return"Point"},wh([w(0)],e.prototype,"x",void 0),wh([w(0)],e.prototype,"y",void 0),e})(j);function Hr(n){var e=[],t,i=cg(n);if(i.length>0)for(var r=0;r<i.length;r++){var a=i[parseInt(r.toString(),10)],s="";switch(s=a[0],s.toLowerCase()){case"m":for(t=1;t<a.length;t++)e.push({command:s,x:a[parseInt(t.toString(),10)],y:a[t+1]}),t=t+1,s==="m"?s="l":s==="M"&&(s="L");break;case"l":case"t":for(t=1;t<a.length;t++)e.push({command:s,x:a[parseInt(t.toString(),10)],y:a[t+1]}),t=t+1;break;case"h":for(t=1;t<a.length;t++)e.push({command:s,x:a[parseInt(t.toString(),10)]});break;case"v":for(t=1;t<a.length;t++)e.push({command:s,y:a[parseInt(t.toString(),10)]});break;case"z":e.push({command:s});break;case"c":for(t=1;t<a.length;t++)e.push({command:s,x1:a[parseInt(t.toString(),10)],y1:a[t+1],x2:a[t+2],y2:a[t+3],x:a[t+4],y:a[t+5]}),t=t+5;break;case"s":for(t=1;t<a.length;t++)e.push({command:s,x2:a[parseInt(t.toString(),10)],y2:a[t+1],x:a[t+2],y:a[t+3]}),t=t+3;break;case"q":for(t=1;t<a.length;t++)e.push({command:s,x1:a[parseInt(t.toString(),10)],y1:a[t+1],x:a[t+2],y:a[t+3]}),t=t+3;break;case"a":for(t=1;t<a.length;t++)e.push({command:s,r1:a[parseInt(t.toString(),10)],r2:a[t+1],angle:a[t+2],largeArc:a[t+3],sweep:a[t+4],x:a[t+5],y:a[t+6]}),t=t+6;break}}return e}function cg(n){var e=/([a-z]+)|([+-]?(?:\d+\.?\d*|\.\d+))/gi,t=[],i=[],r={};e.lastIndex=0;var a=!1;for(r=e.exec(n);r;)r[1]==="e"?a=!0:r[1]?(r[1].toLowerCase()==="zm"?(t.length&&i.push(t),i.push(["Z"]),t=[r[1].substring(1,2)]):(t.length&&i.push(t),t=[r[1]]),a=!1):(t.length||(t=[]),a||t.push(Number(r[2])),a=!1),r=e.exec(n);return t.length&&i.push(t),i}function ug(n,e,t){var i=0,r=0,a="",s=[{x:i+n,y:r},{x:i+t-n,y:r},{x:i+t,y:r+n},{x:i+t,y:r+e-n},{x:i+t-n,y:r+e},{x:i+n,y:r+e},{x:i,y:r+e-n},{x:i,y:r+n}],o=[{x:i+t,y:r},{x:i+t,y:r+e},{x:i,y:r+e},{x:i,y:r}],h=0,l,d;a="M"+s[0].x+" "+s[0].y;var f;for(f=0;f<s.length;f=f+2)l=s[f+1],a+="L"+l.x+" "+l.y,d=s[f+2]||s[0],a+="Q"+o[parseInt(h.toString(),10)].x+" "+o[parseInt(h.toString(),10)].y+" "+d.x+" "+d.y,h++;return a}function To(n){var e="",t;e="M"+n[0].x+" "+n[0].y;var i;for(i=1;i<n.length;i++)t=n[parseInt(i.toString(),10)],e+="L"+t.x+" "+t.y;return e+="Z",e}function ao(n){var e;for(e=0;e<n.length;e++)n[parseInt(e.toString(),10)].x=Math.round(n[parseInt(e.toString(),10)].x),n[parseInt(e.toString(),10)].y=Math.round(n[parseInt(e.toString(),10)].y);var t="",i;t="M"+n[0].x+" "+n[0].y;var r;for(r=1;r<n.length;r++)i=n[parseInt(r.toString(),10)],t+="L"+i.x+" "+i.y;return t}function ed(n){var e,t,i,r,a,s,o,h,l,d,f=[];for(o=0,h=0,d=0,l=n.length;d<l;++d){var p=n[d],c=p,u="";u=c.command,"y1"in c&&(r=c.y1),"y2"in c&&(s=c.y2),"x1"in c&&(i=c.x1),"x2"in c&&(a=c.x2),"x"in c&&(o=c.x),"y"in c&&(h=c.y);var g=f[f.length-1];switch(u){case"M":f.push({command:"M",x:o,y:h});break;case"L":f.push({command:"L",x0:e,y0:t,x:o,y:h});break;case"H":f.push({command:"L",x0:e,y0:t,x:o,y:t});break;case"V":f.push({command:"L",x0:e,y0:t,x:e,y:h});break;case"C":f.push({command:"C",x0:e,y0:t,x1:i,y1:r,x2:a,y2:s,x:o,y:h});break;case"S":if(g){var v=void 0;g.command==="C"||g.command==="S"?v={x:g.x2,y:g.y2}:v={x:e,y:t};var m={x:2*e-v.x,y:2*t-v.y};f.push({command:"C",x0:e,y0:t,x1:m.x,y1:m.y,x2:a,y2:s,x:o,y:h})}break;case"Q":f.push({command:"Q",x0:e,y0:t,x1:i,y1:r,x:o,y:h});break;case"T":if(g){var v=void 0;g.command==="Q"?v={x:g.x1,y:g.y1}:v={x:e,y:t};var m={x:2*e-v.x,y:2*t-v.y};f.push({command:"Q",x0:e,y0:t,x1:m.x,y1:m.y,x:o,y:h})}break;case"A":var y=c;y.command="A",f.push(y);break;case"Z":case"z":f.push({command:"Z"}),o=e,h=t;break}e=o,t=h}return f}function Da(n,e,t,i,r,a,s,o){var h,l,d,f,p,c,u,g,v;for(p=0,c=0,g=0,u=n.length;g<u;++g){var m=n[g],y=m,S=y.command;"x"in y&&(p=y.x),"y"in y&&(c=y.y),"y1"in y&&(l=y.y1),"y2"in y&&(f=y.y2),"x1"in y&&(h=y.x1),"x2"in y&&(d=y.x2),i?(p!==void 0&&(p=$r(p,e,r,s)),c!==void 0&&(c=$r(c,t,a,o)),h!==void 0&&(h=$r(h,e,r,s)),l!==void 0&&(l=$r(l,t,a,o)),d!==void 0&&(d=$r(d,e,r,s)),f!==void 0&&(f=$r(f,t,a,o))):(p!==void 0&&(p=Number((p+e).toFixed(2))),c!==void 0&&(c=Number((c+t).toFixed(2))),h!==void 0&&(h=Number((h+e).toFixed(2))),l!==void 0&&(l=Number((l+t).toFixed(2))),d!==void 0&&(d=Number((d+e).toFixed(2))),f!==void 0&&(f=Number((f+t).toFixed(2))));var x={x:p,y:c,x1:h,y1:l,x2:d,y2:f,r1:y.r1,r2:y.r2};v=gg(y,S,x,i,e,t),v&&(n[g]=v)}var I=id(n);return I}function gg(n,e,t,i,r,a){switch(e){case"M":n.x=t.x,n.y=t.y;break;case"L":n.x=t.x,n.y=t.y;break;case"H":n.x=t.x;break;case"V":n.y=t.y;break;case"C":n.x=t.x,n.y=t.y,n.x1=t.x1,n.y1=t.y1,n.x2=t.x2,n.y2=t.y2;break;case"S":n.x=t.x,n.y=t.y,n.x2=t.x2,n.y2=t.y2;break;case"Q":n.x=t.x,n.y=t.y,n.x1=t.x1,n.y1=t.y1;break;case"T":n.x=t.x,n.y=t.y;break;case"A":var s=t.r1,o=t.r2;i&&(t.r1=s=s*r,t.r2=o=o*a),n.x=t.x,n.y=t.y,n.r1=t.r1,n.r2=t.r2;break;case"z":case"Z":n={command:"Z"};break}return n}function $r(n,e,t,i){return n!==t?i!==t?n=n*e-(Number(t)*e-Number(t))+(i-Number(t)):n=Number(n)*e-(Number(t)*e-Number(t)):i!==t&&(n=i),Number(n.toFixed(2))}function La(n){var e,t,i,r,a,s,o,h,l,d;for(o=0,h=0,d=0,l=n.length;d<l;++d){var f=n[parseInt(d.toString(),10)],p=f,c=p.command;if(/[MLHVCSQTA]/.test(c))"x"in p&&(p.x=o=p.x),"y"in p&&(p.y=h=p.y);else{"x1"in p&&(p.x1=i=o+p.x1),"x2"in p&&(p.x2=a=o+p.x2),"y1"in p&&(p.y1=r=h+p.y1),"y2"in p&&(p.y2=s=h+p.y2),"x"in p&&(p.x=o+=p.x),"y"in p&&(p.y=h+=p.y);var u=void 0;switch(c){case"m":case"M":u={command:"M",x:o,y:h};break;case"l":case"L":u={command:"L",x:o,y:h};break;case"h":case"H":u={command:"H",x:o};break;case"v":case"V":u={command:"V",y:h};break;case"c":case"C":u={command:"C",x:o,y:h,x1:i,y1:r,x2:a,y2:s};break;case"s":case"S":u={command:"S",x:o,y:h,x2:a,y2:s};break;case"q":case"Q":u={command:"Q",x:o,y:h,x1:i,y1:r};break;case"t":case"T":u={command:"T",x:o,y:h};break;case"a":case"A":u={command:"A",x:o,y:h},u.r1=p.r1,u.r2=p.r2,u.angle=p.angle,u.largeArc=p.largeArc,u.sweep=p.sweep;break;case"z":case"Z":u={command:"Z"},o=e,h=t,u=n[parseInt(d.toString(),10)];break}u&&(n[parseInt(d.toString(),10)]=u)}(c==="M"||c==="m")&&(e=o,t=h)}return n}function id(n){var e="",t;for(t=0;t<n.length;t++)t===0?e+=Ih(n[parseInt(t.toString(),10)]):e+=" "+Ih(n[parseInt(t.toString(),10)]);return e}function Ih(n){var e="";switch(n.command){case"Z":case"z":e=n.command;break;case"M":case"m":case"L":case"l":e=n.command+" "+n.x+" "+n.y;break;case"C":case"c":e=n.command+" "+n.x1+" "+n.y1+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;break;case"Q":case"q":e=n.command+" "+n.x1+" "+n.y1+" "+n.x+" "+n.y;break;case"A":case"a":var t=n.command,i=n.angle,r=n.largeArc?"1":"0",a=n.sweep?"1":"0";e=t+" "+n.r1+" "+n.r2+" "+i+" "+r+" "+a+" "+n.x+" "+n.y;break;case"H":case"h":e=n.command+" "+n.x;break;case"V":case"v":e=n.command+" "+n.y;break;case"S":case"s":e=n.command+" "+n.x2+" "+n.y2+" "+n.x+" "+n.y;break;case"T":case"t":e=n.command+" "+n.x+" "+n.y}return e}var it=(function(){function n(e,t,i,r){this.x=Number.MAX_VALUE,this.y=Number.MAX_VALUE,this.width=0,this.height=0,e===void 0||t===void 0?(e=t=Number.MAX_VALUE,i=r=0):(i===void 0&&(i=0),r===void 0&&(r=0)),this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(n.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topLeft",{get:function(){return{x:this.left,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topRight",{get:function(){return{x:this.right,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomLeft",{get:function(){return{x:this.left,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomRight",{get:function(){return{x:this.right,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"middleLeft",{get:function(){return{x:this.left,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"middleRight",{get:function(){return{x:this.right,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"topCenter",{get:function(){return{x:this.x+this.width/2,y:this.top}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bottomCenter",{get:function(){return{x:this.x+this.width/2,y:this.bottom}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"center",{get:function(){return{x:this.x+this.width/2,y:this.y+this.height/2}},enumerable:!0,configurable:!0}),n.prototype.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},n.prototype.uniteRect=function(e){var t=Math.max(isNaN(this.right)||this.x===Number.MAX_VALUE?e.right:this.right,e.right),i=Math.max(isNaN(this.bottom)||this.y===Number.MAX_VALUE?e.bottom:this.bottom,e.bottom);return this.x=Math.min(this.left,e.left),this.y=Math.min(this.top,e.top),this.width=t-this.x,this.height=i-this.y,this},n.prototype.unitePoint=function(e){if(this.x===Number.MAX_VALUE){this.x=e.x,this.y=e.y;return}var t=Math.min(this.left,e.x),i=Math.min(this.top,e.y),r=Math.max(this.right,e.x),a=Math.max(this.bottom,e.y);this.x=t,this.y=i,this.width=r-this.x,this.height=a-this.y},n.prototype.Inflate=function(e){return this.x-=e,this.y-=e,this.width+=e*2,this.height+=e*2,this},n.prototype.intersects=function(e){return!(this.right<e.left||this.left>e.right||this.top>e.bottom||this.bottom<e.top)},n.prototype.containsRect=function(e){return this.left<=e.left&&this.right>=e.right&&this.top<=e.top&&this.bottom>=e.bottom},n.prototype.containsPoint=function(e,t){return t===void 0&&(t=0),this.left-t<=e.x&&this.right+t>=e.x&&this.top-t<=e.y&&this.bottom+t>=e.y},n.toBounds=function(e){for(var t=new n,i=0,r=e;i<r.length;i++){var a=r[i];t.unitePoint(a)}return t},n.empty=new n(Number.MAX_VALUE,Number.MIN_VALUE,0,0),n})(),Jt;(function(n){n[n.Identity=0]="Identity",n[n.Translation=1]="Translation",n[n.Scaling=2]="Scaling",n[n.Unknown=4]="Unknown"})(Jt||(Jt={}));var vg=(function(){function n(e,t,i,r,a,s,o){this.m11=e,this.m12=t,this.m21=i,this.m22=r,this.offsetX=a,this.offsetY=s,this.type=o}return n})();function xt(){return new vg(1,0,0,1,0,0,Jt.Identity)}function st(n,e){var t=wg(n,e.x,e.y);return{x:Math.round(t.x*100)/100,y:Math.round(t.y*100)/100}}function mg(n,e){for(var t=[],i=0,r=e;i<r.length;i++){var a=r[i];t.push(st(n,a))}return t}function Rt(n,e,t,i){e%=360,Ao(n,Sg(e*.017453292519943295,t||0,i||0))}function Or(n,e,t,i,r){i===void 0&&(i=0),r===void 0&&(r=0),Ao(n,yg(e,t,i,r))}function xh(n,e,t){n.offsetX+=e,n.offsetY+=t,n.type|=Jt.Translation}function yg(n,e,t,i){var r=xt();return r.type=t||i?Jt.Scaling|Jt.Translation:Jt.Scaling,bo(r,n,0,0,e,t-n*t,i-e*i),r}function Sg(n,e,t){var i=xt(),r=Math.sin(n),a=Math.cos(n),s=e*(1-a)+t*r,o=t*(1-a)-e*r;return i.type=Jt.Unknown,bo(i,a,r,-r,a,s,o),i}function wg(n,e,t){if(n.type===(Jt.Translation|Jt.Scaling))e*=n.m11,e+=n.offsetX,t*=n.m22,t+=n.offsetY;else{var i=t*n.m21+n.offsetX,r=e*n.m12+n.offsetY;e*=n.m11,e+=i,t*=n.m22,t+=r}return{x:e,y:t}}function Ao(n,e){var t=n.type,i=e.type;if(t===Jt.Identity){Ch(n,e),n.type=e.type;return}if(t!==Jt.Translation){var r=t<<4|i;switch(r){case 50:n.m11*=e.m11,n.m22*=e.m22,n.offsetX*=e.m11,n.offsetY*=e.m22;return;case 51:n.m11*=e.m11,n.m22*=e.m22,n.offsetX=e.m11*n.offsetX+e.offsetX,n.offsetY=e.m22*n.offsetY+e.offsetY;return;case 52:break;default:switch(r){case 66:case 67:case 68:break;default:return}break}var a=xt(),s=n.m11*e.m11+n.m12*e.m21,o=n.m11*e.m12+n.m12*e.m22,h=n.m21*e.m11+n.m22*e.m21,l=n.m21*e.m12+n.m22*e.m22,d=n.offsetX*e.m11+n.offsetY*e.m21+e.offsetX,f=n.offsetX*e.m12+n.offsetY*e.m22+e.offsetY;bo(a,s,o,h,l,d,f),a.m21||a.m12?a.type=Jt.Unknown:((a.m11&&a.m11!==1||a.m22&&a.m22!==1)&&(a.type=Jt.Scaling),(a.offsetX||a.offsetY)&&(a.type|=Jt.Translation),(a.type&(Jt.Translation|Jt.Scaling))===Jt.Identity&&(a.type=Jt.Identity),a.type=Jt.Scaling|Jt.Translation),Ch(n,a),n.type=a.type;return}var p=n.offsetX,c=n.offsetY;if(n.offsetX=p*e.m11+c*e.m21+e.offsetX,n.offsetY=p*e.m12+c*e.m22+e.offsetY,i===Jt.Unknown){n.type=Jt.Unknown;return}n.type=Jt.Translation|Jt.Scaling}function bo(n,e,t,i,r,a,s){n.m11=e,n.m12=t,n.m21=i,n.m22=r,n.offsetX=a,n.offsetY=s}function Ch(n,e){n.m11=e.m11,n.m12=e.m12,n.m21=e.m21,n.m22=e.m22,n.offsetX=e.offsetX,n.offsetY=e.offsetY,n.type=e.type}function K(){for(var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",e="",t,i=0;i<5;i++){if(typeof window<"u"&&"crypto"in window&&"getRandomValues"in crypto){var r=new Uint32Array(1),a=window.msCrypto||window.crypto;t=a.getRandomValues(r)[0]%(n.length-1)}if(i===0&&t<10){i--;continue}e+=n.substring(t,t+1)}return e}function Eo(n){if(n)try{return typeof n!="function"&&document.querySelectorAll(n).length?Re(document.querySelector(n).innerHTML.trim()):Re(n)}catch{return Re(n)}}function se(n){var e=new it,t=n.offsetY-n.actualSize.height*n.pivot.y,i=n.offsetY+n.actualSize.height*(1-n.pivot.y),r=n.offsetX-n.actualSize.width*n.pivot.x,a=n.offsetX+n.actualSize.width*(1-n.pivot.x),s={x:r,y:t},o={x:a,y:t},h={x:r,y:i},l={x:a,y:i};return e=it.toBounds([s,o,h,l]),e}function ze(n){var e=new it,t=se(n),i=t.middleLeft,r=t.topCenter,a=t.bottomCenter,s=t.middleRight,o=t.topLeft,h=t.topRight,l=t.bottomLeft,d=t.bottomRight;if(n.corners={topLeft:o,topCenter:r,topRight:h,middleLeft:i,middleRight:s,bottomLeft:l,bottomCenter:a,bottomRight:d},n.rotateAngle!==0||n.parentTransform!==0){var f=xt();Rt(f,n.rotateAngle+n.parentTransform,n.offsetX,n.offsetY),n.corners.topLeft=o=st(f,o),n.corners.topCenter=r=st(f,r),n.corners.topRight=h=st(f,h),n.corners.middleLeft=i=st(f,i),n.corners.middleRight=s=st(f,s),n.corners.bottomLeft=l=st(f,l),n.corners.bottomCenter=a=st(f,a),n.corners.bottomRight=d=st(f,d)}return e=it.toBounds([o,h,l,d]),n.corners.left=e.left,n.corners.right=e.right,n.corners.top=e.top,n.corners.bottom=e.bottom,n.corners.center=e.center,n.corners.width=e.width,n.corners.height=e.height,e}function E(n,e,t,i){var r={},a="properties",s="propName";if(n){t=n[""+s];var o=n[""+a]||n,h=[];h=h.concat(Object.keys(o));var l=[];if(h.push("version"),t){var d=_t(e);d?l=d(t):l=[],h=h.concat(l)}var f=Ig(t);h=h.concat(f);for(var p=0,c=h;p<c.length;p++){var u=c[p];if(u!=="historyManager")if(u!=="wrapper"){var g=!!(n[""+u]&&n.hasOwnProperty("observers"));g||(n[""+u]instanceof Array?r[""+u]=xg(f.indexOf(u)===-1&&n[""+a]?n[""+a][""+u]:n[""+u],e,u):!(n[""+u]instanceof Array)&&n[""+u]instanceof HTMLElement?r[""+u]=n[""+u].cloneNode(!0).innerHTML:!(n[""+u]instanceof Array)&&n[""+u]instanceof Object?r[""+u]=E(f.indexOf(u)===-1&&n[""+a]?n[""+a][""+u]:n[""+u],void 0,void 0):r[""+u]=n[""+u])}else n[""+u]&&(r[""+u]={actualSize:{width:n[""+u].actualSize.width,height:n[""+u].actualSize.height},offsetX:n[""+u].offsetX,offsetY:n[""+u].offsetY})}}return r}function Ig(n){switch(n){case"nodes":case"children":return["inEdges","outEdges","parentId","processId","nodeId","umlIndex","isPhase","isLane"];case"connectors":return["parentId"];case"annotation":return["nodeId"];case"annotations":return["nodeId"];case"shape":return["hasHeader"];case"layers":return["objectZIndex"]}return[]}function xg(n,e,t,i){var r;if(n){r=[];for(var a=0;a<n.length;a++)n[parseInt(a.toString(),10)]instanceof Array?r.push(n[parseInt(a.toString(),10)]):n[parseInt(a.toString(),10)]instanceof Object?r.push(E(n[parseInt(a.toString(),10)],e,t)):r.push(n[parseInt(a.toString(),10)])}return r}function Ma(n,e){var t="properties";if(n){e||(e={properties:{}});for(var i=0,r=Object.keys(n);i<r.length;i++){var a=r[i];if(n[""+a]instanceof Array){var s=so(n[""+a],e[""+t][""+a]);(!e[""+t][""+a]||!e[""+t][""+a].length)&&(e[""+a]=s)}else if(!(n[""+a]instanceof Array)&&n[""+a]instanceof HTMLElement)e[""+a]=n[""+a].cloneNode(!0).innerHtml;else if(!(n[""+a]instanceof Array)&&n[""+a]instanceof Object){var o=Ma(n[""+a],e[""+t][""+a]);o[""+t]&&!Object.keys(o[""+t]).length&&delete o[""+t],e[""+a]=o}else e[""+a]=e[""+t][""+a]!==void 0?e[""+a]:n[""+a]}}return e}function so(n,e){var t=[],i=!1;e||(e=[]),e.length||(i=!0);for(var r=0;r<n.length;r++)if(n[parseInt(r.toString(),10)]instanceof Array)so(n[parseInt(r.toString(),10)],e[parseInt(r.toString(),10)]),i&&t.push(so);else if(n[parseInt(r.toString(),10)]instanceof Object){var a=Ma(n[parseInt(r.toString(),10)],e[parseInt(r.toString(),10)]);i&&t.push(a)}else t.push(n[parseInt(r.toString(),10)]);return t}function rd(n){var e="";switch(n){case"Center":e="center";break;case"Left":e="left";break;case"Right":e="right";break;case"Justify":e="justify";break}return e}function hs(n){var e="";switch(n){case"Wrap":e="breakall";break;case"NoWrap":e="keepall";break;case"WrapWithOverflow":e="normal";break;case"LineThrough":e="line-through";break}return e}var aa=null;function gr(n,e){if(!aa){var t=document.createElement("canvas");aa=t.getContext("2d")}aa.font=(e.bold?"bold":"normal")+" "+e.fontSize+"px "+e.fontFamily;var i=aa.measureText(n);return i.width}function Cg(n,e){var t=0;return t=(n+e)/2,t}function nd(n,e){var t=0,i=0,r=0,a=0,s="";i=n.length;var o=0;do a>0&&(t=r),r=Math.floor(Cg(t,i)),s+=n.substr(t,r),a=gr(s,e);while(a<=e.width);for(s=s.substr(0,t),o=t;o<i;o++)if(s+=n[parseInt(o.toString(),10)],a=gr(s,e),a>=e.width){n=n.substr(0,s.length-1);break}return e.textOverflow==="Ellipsis"?(n=n.substr(0,n.length-3),n+="..."):n=n.substr(0,n.length),n}function Do(n,e){if(e==="NoWrap"&&n==="PreserveAll")return"pre";var t="";switch(n){case"CollapseAll":t="nowrap";break;case"CollapseSpace":t="pre-line";break;case"PreserveAll":t="pre-wrap";break}return t}function oo(n,e){var t=xt();Rt(t,e,0,0);var i=st(t,{x:0,y:0}),r=st(t,{x:n.width,y:0}),a=st(t,{x:0,y:n.height}),s=st(t,{x:n.width,y:n.height}),o=Math.min(i.x,r.x,a.x,s.x),h=Math.min(i.y,r.y,a.y,s.y),l=Math.max(i.x,r.x,a.x,s.x),d=Math.max(i.y,r.y,a.y,s.y);return new U(l-o,d-h)}function ye(n,e,t,i){if(n!==0){var r=xt();return Rt(r,n,e,t),st(r,i)}return i}function ad(n,e){var t=n.x+e.desiredSize.width*e.pivot.x,i=n.y+e.desiredSize.height*e.pivot.y;return{x:t,y:i}}function _t(n){return n!==void 0&&typeof n=="string"&&(n=Ii(n,window)),n}var ki=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),ht=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},sd=function(n){if(n)switch(n.type){case"Linear":return bs;case"Radial":return Ag;default:return bs}return bs},Pg=(function(){function n(e,t,i,r){this.left=e,this.right=t,this.top=i,this.bottom=r}return n})(),Ie=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w(0)],e.prototype,"left",void 0),ht([w(0)],e.prototype,"right",void 0),ht([w(0)],e.prototype,"top",void 0),ht([w(0)],e.prototype,"bottom",void 0),e})(j),Tg=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w(45)],e.prototype,"angle",void 0),ht([w(5)],e.prototype,"distance",void 0),ht([w(.7)],e.prototype,"opacity",void 0),ht([w("lightgrey")],e.prototype,"color",void 0),e})(j),od=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Stop"},ht([w("")],e.prototype,"color",void 0),ht([w(0)],e.prototype,"offset",void 0),ht([w(1)],e.prototype,"opacity",void 0),e})(j),Lo=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([Lt([],od)],e.prototype,"stops",void 0),ht([w("None")],e.prototype,"type",void 0),ht([w("")],e.prototype,"id",void 0),e})(j);(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w(0)],e.prototype,"x1",void 0),ht([w(0)],e.prototype,"x2",void 0),ht([w(0)],e.prototype,"y1",void 0),ht([w(0)],e.prototype,"y2",void 0),ht([w(0)],e.prototype,"cx",void 0),ht([w(0)],e.prototype,"cy",void 0),ht([w(0)],e.prototype,"fx",void 0),ht([w(0)],e.prototype,"fy",void 0),ht([w(50)],e.prototype,"r",void 0),e})(Lo);var bs=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w(0)],e.prototype,"x1",void 0),ht([w(0)],e.prototype,"x2",void 0),ht([w(0)],e.prototype,"y1",void 0),ht([w(0)],e.prototype,"y2",void 0),e})(Lo),Ag=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w(0)],e.prototype,"cx",void 0),ht([w(0)],e.prototype,"cy",void 0),ht([w(0)],e.prototype,"fx",void 0),ht([w(0)],e.prototype,"fy",void 0),ht([w(50)],e.prototype,"r",void 0),e})(Lo),Qi=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w("white")],e.prototype,"fill",void 0),ht([w("black")],e.prototype,"strokeColor",void 0),ht([w("")],e.prototype,"strokeDashArray",void 0),ht([w(1)],e.prototype,"strokeWidth",void 0),ht([w(1)],e.prototype,"opacity",void 0),ht([os(sd)],e.prototype,"gradient",void 0),e})(j),hd=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w("transparent")],e.prototype,"fill",void 0),e})(Qi),cn=(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w("black")],e.prototype,"color",void 0),ht([w("Arial")],e.prototype,"fontFamily",void 0),ht([w(12)],e.prototype,"fontSize",void 0),ht([w(!1)],e.prototype,"italic",void 0),ht([w(!1)],e.prototype,"bold",void 0),ht([w("CollapseSpace")],e.prototype,"whiteSpace",void 0),ht([w("WrapWithOverflow")],e.prototype,"textWrapping",void 0),ht([w("Center")],e.prototype,"textAlign",void 0),ht([w("None")],e.prototype,"textDecoration",void 0),ht([w("Wrap")],e.prototype,"textOverflow",void 0),ht([w("transparent")],e.prototype,"fill",void 0),e})(Qi);(function(n){ki(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ht([w("white")],e.prototype,"fill",void 0),ht([w("Wrap")],e.prototype,"textOverflow",void 0),ht([w(1)],e.prototype,"strokeWidth",void 0),ht([os(sd)],e.prototype,"gradient",void 0),ht([w(1)],e.prototype,"opacity",void 0),ht([w(!1)],e.prototype,"italic",void 0),ht([w("")],e.prototype,"strokeDashArray",void 0),ht([w("black")],e.prototype,"color",void 0),ht([w(12)],e.prototype,"fontSize",void 0),ht([w("Arial")],e.prototype,"fontFamily",void 0),ht([w("CollapseSpace")],e.prototype,"whiteSpace",void 0),ht([w("Center")],e.prototype,"textAlign",void 0),ht([w("None")],e.prototype,"textDecoration",void 0),ht([w(!1)],e.prototype,"bold",void 0),ht([w("black")],e.prototype,"strokeColor",void 0),ht([w("WrapWithOverflow")],e.prototype,"textWrapping",void 0),e})(j);var jt;(function(n){n[n.Default=0]="Default",n[n.expandNode=2]="expandNode",n[n.interaction=4]="interaction",n[n.GroupingInProgress=8]="GroupingInProgress",n[n.GroupClipboardInProcess=16]="GroupClipboardInProcess",n[n.ClearObject=32]="ClearObject"})(jt||(jt={}));var G;(function(n){n[n.Horizontal=1]="Horizontal",n[n.Vertical=2]="Vertical",n[n.Both=3]="Both",n[n.None=0]="None"})(G||(G={}));var zt;(function(n){n[n.Visible=1]="Visible",n[n.Hidden=2]="Hidden",n[n.Hover=4]="Hover",n[n.Connect=8]="Connect"})(zt||(zt={}));var pi;(function(n){n[n.None=0]="None",n[n.ShowHorizontalLines=1]="ShowHorizontalLines",n[n.ShowVerticalLines=2]="ShowVerticalLines",n[n.ShowLines=3]="ShowLines",n[n.SnapToHorizontalLines=4]="SnapToHorizontalLines",n[n.SnapToVerticalLines=8]="SnapToVerticalLines",n[n.SnapToLines=12]="SnapToLines",n[n.SnapToObject=16]="SnapToObject",n[n.All=31]="All"})(pi||(pi={}));var Ae;(function(n){n[n.None=1]="None",n[n.ConnectorSourceThumb=2]="ConnectorSourceThumb",n[n.ConnectorTargetThumb=4]="ConnectorTargetThumb",n[n.ResizeSouthEast=8]="ResizeSouthEast",n[n.ResizeSouthWest=16]="ResizeSouthWest",n[n.ResizeNorthEast=32]="ResizeNorthEast",n[n.ResizeNorthWest=64]="ResizeNorthWest",n[n.ResizeEast=128]="ResizeEast",n[n.ResizeWest=256]="ResizeWest",n[n.ResizeSouth=512]="ResizeSouth",n[n.ResizeNorth=1024]="ResizeNorth",n[n.Rotate=2048]="Rotate",n[n.UserHandle=4096]="UserHandle",n[n.ToolTip=8192]="ToolTip",n[n.ResizeAll=2046]="ResizeAll",n[n.All=16382]="All"})(Ae||(Ae={}));var Ph;(function(n){n.SamePoint="SamePoint",n.DifferentPoint="DifferentPoint"})(Ph||(Ph={}));var Th;(function(n){n.Linear="Linear",n.Nonlinear="Nonlinear"})(Th||(Th={}));var yt;(function(n){n[n.None=1]="None",n[n.Select=2]="Select",n[n.Delete=4]="Delete",n[n.Drag=8]="Drag",n[n.DragSourceEnd=16]="DragSourceEnd",n[n.DragTargetEnd=32]="DragTargetEnd",n[n.DragSegmentThumb=64]="DragSegmentThumb",n[n.AllowDrop=128]="AllowDrop",n[n.Bridging=256]="Bridging",n[n.BridgeObstacle=512]="BridgeObstacle",n[n.InheritBridging=1024]="InheritBridging",n[n.PointerEvents=2048]="PointerEvents",n[n.Tooltip=4096]="Tooltip",n[n.InheritTooltip=8192]="InheritTooltip",n[n.Interaction=4218]="Interaction",n[n.ReadOnly=16384]="ReadOnly",n[n.LineRouting=32768]="LineRouting",n[n.InheritLineRouting=65536]="InheritLineRouting",n[n.ConnectToNearByNode=131072]="ConnectToNearByNode",n[n.ConnectToNearByPort=262144]="ConnectToNearByPort",n[n.ConnectToNearByElement=393216]="ConnectToNearByElement",n[n.InheritSegmentThumbShape=524288]="InheritSegmentThumbShape",n[n.InheritSegmentThumbSize=1048576]="InheritSegmentThumbSize",n[n.Default=2043454]="Default"})(yt||(yt={}));var He;(function(n){n[n.ReadOnly=2]="ReadOnly",n[n.InheritReadOnly=4]="InheritReadOnly",n[n.Select=8]="Select",n[n.Drag=16]="Drag",n[n.Resize=32]="Resize",n[n.Rotate=64]="Rotate",n[n.Tooltip=128]="Tooltip",n[n.Interaction=120]="Interaction",n[n.None=0]="None"})(He||(He={}));var W;(function(n){n[n.None=0]="None",n[n.Select=2]="Select",n[n.Drag=4]="Drag",n[n.Rotate=8]="Rotate",n[n.Shadow=16]="Shadow",n[n.PointerEvents=32]="PointerEvents",n[n.Delete=64]="Delete",n[n.InConnect=128]="InConnect",n[n.OutConnect=256]="OutConnect",n[n.Individual=512]="Individual",n[n.Expandable=1024]="Expandable",n[n.AllowDrop=2048]="AllowDrop",n[n.Inherit=78]="Inherit",n[n.ResizeNorthEast=4096]="ResizeNorthEast",n[n.ResizeEast=8192]="ResizeEast",n[n.ResizeSouthEast=16384]="ResizeSouthEast",n[n.ResizeSouth=32768]="ResizeSouth",n[n.ResizeSouthWest=65536]="ResizeSouthWest",n[n.ResizeWest=131072]="ResizeWest",n[n.ResizeNorthWest=262144]="ResizeNorthWest",n[n.ResizeNorth=524288]="ResizeNorth",n[n.Resize=1044480]="Resize",n[n.AspectRatio=1048576]="AspectRatio",n[n.Tooltip=2097152]="Tooltip",n[n.InheritTooltip=4194304]="InheritTooltip",n[n.ReadOnly=8388608]="ReadOnly",n[n.HideThumbs=16777216]="HideThumbs",n[n.AllowMovingOutsideLane=33554432]="AllowMovingOutsideLane",n[n.Default=5240814]="Default"})(W||(W={}));var le;(function(n){n[n.None=0]="None",n[n.ElementIsPort=2]="ElementIsPort",n[n.ElementIsGroup=4]="ElementIsGroup",n[n.HorizontalLaneHeader=8]="HorizontalLaneHeader"})(le||(le={}));var gt;(function(n){n[n.Rotate=2]="Rotate",n[n.ConnectorSource=4]="ConnectorSource",n[n.ConnectorTarget=8]="ConnectorTarget",n[n.ResizeNorthEast=16]="ResizeNorthEast",n[n.ResizeEast=32]="ResizeEast",n[n.ResizeSouthEast=64]="ResizeSouthEast",n[n.ResizeSouth=128]="ResizeSouth",n[n.ResizeSouthWest=256]="ResizeSouthWest",n[n.ResizeWest=512]="ResizeWest",n[n.ResizeNorthWest=1024]="ResizeNorthWest",n[n.ResizeNorth=2048]="ResizeNorth",n[n.Default=4094]="Default"})(gt||(gt={}));var lt;(function(n){n[n.None=1]="None",n[n.Bridging=2]="Bridging",n[n.UndoRedo=4]="UndoRedo",n[n.Tooltip=8]="Tooltip",n[n.UserInteraction=16]="UserInteraction",n[n.ApiUpdate=32]="ApiUpdate",n[n.PageEditable=48]="PageEditable",n[n.Zoom=64]="Zoom",n[n.PanX=128]="PanX",n[n.PanY=256]="PanY",n[n.Pan=384]="Pan",n[n.ZoomTextEdit=512]="ZoomTextEdit",n[n.Virtualization=1024]="Virtualization",n[n.LineRouting=2048]="LineRouting",n[n.AvoidLineOverlapping=4096]="AvoidLineOverlapping",n[n.RestrictNegativeAxisDragDrop=8192]="RestrictNegativeAxisDragDrop",n[n.AutomaticPortCreation=16384]="AutomaticPortCreation",n[n.Default=500]="Default"})(lt||(lt={}));var Gt;(function(n){n[n.None=0]="None",n[n.SingleSelect=1]="SingleSelect",n[n.MultipleSelect=2]="MultipleSelect",n[n.ZoomPan=4]="ZoomPan",n[n.DrawOnce=8]="DrawOnce",n[n.ContinuousDraw=16]="ContinuousDraw",n[n.Default=3]="Default"})(Gt||(Gt={}));var Zi;(function(n){n[n.Self=1]="Self",n[n.Parent=2]="Parent"})(Zi||(Zi={}));var Ah;(function(n){n[n.Canvas=0]="Canvas",n[n.Svg=1]="Svg"})(Ah||(Ah={}));var dt;(function(n){n[n.None=0]="None",n[n.Control=1]="Control",n[n.Meta=1]="Meta",n[n.Alt=2]="Alt",n[n.Shift=4]="Shift"})(dt||(dt={}));var ut;(function(n){n[n.None=null]="None",n[n.Number0=0]="Number0",n[n.Number1=1]="Number1",n[n.Number2=2]="Number2",n[n.Number3=3]="Number3",n[n.Number4=4]="Number4",n[n.Number5=5]="Number5",n[n.Number6=6]="Number6",n[n.Number7=7]="Number7",n[n.Number8=8]="Number8",n[n.Number9=9]="Number9",n[n.A=65]="A",n[n.B=66]="B",n[n.C=67]="C",n[n.D=68]="D",n[n.E=69]="E",n[n.F=70]="F",n[n.G=71]="G",n[n.H=72]="H",n[n.I=73]="I",n[n.J=74]="J",n[n.K=75]="K",n[n.L=76]="L",n[n.M=77]="M",n[n.N=78]="N",n[n.O=79]="O",n[n.P=80]="P",n[n.Q=81]="Q",n[n.R=82]="R",n[n.S=83]="S",n[n.T=84]="T",n[n.U=85]="U",n[n.V=86]="V",n[n.W=87]="W",n[n.X=88]="X",n[n.Y=89]="Y",n[n.Z=90]="Z",n[n.Left=37]="Left",n[n.Up=38]="Up",n[n.Right=39]="Right",n[n.Down=40]="Down",n[n.Escape=27]="Escape",n[n.Space=32]="Space",n[n.PageUp=33]="PageUp",n[n.PageDown=34]="PageDown",n[n.End=35]="End",n[n.Home=36]="Home",n[n.Delete=46]="Delete",n[n.Tab=9]="Tab",n[n.Enter=13]="Enter",n[n.BackSpace=8]="BackSpace",n[n.F1=112]="F1",n[n.F2=113]="F2",n[n.F3=114]="F3",n[n.F4=115]="F4",n[n.F5=116]="F5",n[n.F6=117]="F6",n[n.F7=118]="F7",n[n.F8=119]="F8",n[n.F9=120]="F9",n[n.F10=121]="F10",n[n.F11=122]="F11",n[n.F12=123]="F12",n[n.Star=56]="Star",n[n.Plus=187]="Plus",n[n.Minus=189]="Minus",n[n.BracketLeft=219]="BracketLeft",n[n.BracketRight=221]="BracketRight"})(ut||(ut={}));var k;(function(n){n[n.Render=2]="Render",n[n.PublicMethod=4]="PublicMethod",n[n.ToolAction=8]="ToolAction",n[n.UndoRedo=16]="UndoRedo",n[n.TextEdit=32]="TextEdit",n[n.Group=64]="Group",n[n.Clear=128]="Clear",n[n.PreventClearSelection=256]="PreventClearSelection",n[n.Interactions=512]="Interactions",n[n.PreventHistory=1024]="PreventHistory",n[n.PreventIconsUpdate=2048]="PreventIconsUpdate",n[n.PreventCollectionChangeOnDragOver=4096]="PreventCollectionChangeOnDragOver",n[n.PreventZIndexOnDragging=8192]="PreventZIndexOnDragging",n[n.isGroupDragging=16384]="isGroupDragging",n[n.DragUsingMouse=32768]="DragUsingMouse",n[n.DecoratorPropertyChange=65536]="DecoratorPropertyChange",n[n.PreventLaneContainerUpdate=131072]="PreventLaneContainerUpdate"})(k||(k={}));var fi;(function(n){n[n.None=2]="None",n[n.DrawSelectorBorder=4]="DrawSelectorBorder",n[n.PreventRenderSelector=8]="PreventRenderSelector"})(fi||(fi={}));var Vt;(function(n){n[n.None=0]="None",n[n.PreventDrag=2]="PreventDrag",n[n.PreventScale=4]="PreventScale",n[n.PreventDataInit=8]="PreventDataInit",n[n.hScrollbarMoved=16]="hScrollbarMoved",n[n.vScrollbarMoved=32]="vScrollbarMoved",n[n.AnimationClick=64]="AnimationClick",n[n.EnableGroupAction=128]="EnableGroupAction",n[n.PanInProgress=256]="PanInProgress",n[n.OverViewAction=512]="OverViewAction"})(Vt||(Vt={}));var ei;(function(n){n[n.None=0]="None",n[n.PropertyChange=1024]="PropertyChange",n[n.Interaction=2048]="Interaction"})(ei||(ei={}));var q;(function(n){n[n.Zero=0]="Zero",n[n.One=1]="One",n[n.Two=2]="Two",n[n.Three=3]="Three",n[n.Four=4]="Four",n[n.Five=5]="Five"})(q||(q={}));var Z;(function(n){n[n.collectionChange=0]="collectionChange",n[n.rotateChange=1]="rotateChange",n[n.positionChange=2]="positionChange",n[n.propertyChange=3]="propertyChange",n[n.selectionChange=4]="selectionChange",n[n.sizeChange=5]="sizeChange",n[n.drop=6]="drop",n[n.sourcePointChange=7]="sourcePointChange",n[n.targetPointChange=8]="targetPointChange",n[n.connectionChange=9]="connectionChange",n[n.animationComplete=10]="animationComplete",n[n.click=11]="click",n[n.doubleClick=12]="doubleClick",n[n.scrollChange=13]="scrollChange",n[n.dragEnter=14]="dragEnter",n[n.dragLeave=15]="dragLeave",n[n.dragOver=16]="dragOver",n[n.textEdit=17]="textEdit",n[n.paletteSelectionChange=18]="paletteSelectionChange",n[n.historyChange=19]="historyChange",n[n.mouseEnter=20]="mouseEnter",n[n.mouseLeave=21]="mouseLeave",n[n.mouseOver=22]="mouseOver",n[n.expandStateChange=23]="expandStateChange",n[n.segmentCollectionChange=24]="segmentCollectionChange",n[n.commandExecute=25]="commandExecute",n[n.historyStateChange=26]="historyStateChange",n[n.onUserHandleMouseDown=27]="onUserHandleMouseDown",n[n.onUserHandleMouseUp=28]="onUserHandleMouseUp",n[n.onUserHandleMouseEnter=29]="onUserHandleMouseEnter",n[n.onUserHandleMouseLeave=30]="onUserHandleMouseLeave",n[n.onImageLoad=31]="onImageLoad",n[n.onDoBindingInit=32]="onDoBindingInit",n[n.keyUp=33]="keyUp",n[n.keyDown=34]="keyDown",n[n.fixedUserHandleClick=35]="fixedUserHandleClick",n[n.elementDraw=36]="elementDraw",n[n.mouseWheel=37]="mouseWheel",n[n.segmentChange=38]="segmentChange",n[n.onFixedUserHandleMouseDown=39]="onFixedUserHandleMouseDown",n[n.onFixedUserHandleMouseUp=40]="onFixedUserHandleMouseUp",n[n.onFixedUserHandleMouseEnter=41]="onFixedUserHandleMouseEnter",n[n.onFixedUserHandleMouseLeave=42]="onFixedUserHandleMouseLeave",n[n.loaded=43]="loaded",n[n.layoutUpdated=44]="layoutUpdated",n[n.diagramImporting=45]="diagramImporting",n[n.diagramExporting=46]="diagramExporting"})(Z||(Z={}));var Ct;(function(n){n[n.None=1]="None",n[n.Drag=2]="Drag",n[n.Draw=4]="Draw",n[n.InConnect=8]="InConnect",n[n.OutConnect=16]="OutConnect",n[n.ToolTip=32]="ToolTip",n[n.InheritTooltip=64]="InheritTooltip",n[n.Default=24]="Default"})(Ct||(Ct={}));var za;(function(n){n[n.None=1]="None",n[n.Source=2]="Source",n[n.Target=4]="Target",n[n.Intermediate=8]="Intermediate",n[n.All=14]="All"})(za||(za={}));var Bn;(function(n){n[n.None=0]="None",n[n.SymmetricAngle=2]="SymmetricAngle",n[n.SymmetricDistance=4]="SymmetricDistance",n[n.Default=6]="Default"})(Bn||(Bn={}));var Be=(function(){function n(){this.pivot={x:.5,y:.5},this.isDirt=!0,this.isExport=!1,this.exportScaleValue={x:0,y:0},this.exportScaleOffset={x:0,y:0},this.canApplyStyle=!0,this.visible=!0,this.offsetX=0,this.offsetY=0,this.cornerRadius=0,this.minHeight=void 0,this.minWidth=void 0,this.maxWidth=void 0,this.maxHeight=void 0,this.width=void 0,this.height=void 0,this.rotateAngle=0,this.margin={left:0,right:0,top:0,bottom:0},this.connectionDirection="Auto",this.horizontalAlignment="Auto",this.verticalAlignment="Auto",this.flip=G.None,this.flipMode="All",this.relativeMode="Point",this.transform=Zi.Self|Zi.Parent,this.style={fill:"white",strokeColor:"black",opacity:1,strokeWidth:1},this.desiredSize=new U,this.actualSize=new U,this.parentTransform=0,this.preventContainer=!1,this.isSvgRender=!1,this.bounds=new it(0,0,0,0),this.shadow=null,this.description="",this.staticSize=!1,this.shapeType="",this.isRectElement=!1,this.isCalculateDesiredSize=!0,this.flipOffset={x:0,y:0},this.elementActions=le.None,this.inversedAlignment=!0,this.position=void 0,this.unitMode=void 0,this.float=!1,this.floatingBounds=void 0}return n.prototype.setOffsetWithRespectToBounds=function(e,t,i){this.unitMode=i,this.position={x:e,y:t}},n.prototype.getAbsolutePosition=function(e){if(this.position!==void 0)return this.unitMode==="Absolute"?this.position:{x:this.position.x*e.width,y:this.position.y*e.height}},Object.defineProperty(n.prototype,"outerBounds",{get:function(){return this.floatingBounds||this.bounds},set:function(e){this.floatingBounds=e},enumerable:!0,configurable:!0}),n.prototype.measure=function(e,t,i){var r=this.width!==void 0?this.width:(e.width||0)-this.margin.left-this.margin.right,a=this.height!==void 0?this.height:(e.height||0)-this.margin.top-this.margin.bottom;return this.id&&a===0&&this.elementActions&le.HorizontalLaneHeader&&(a=this.actualSize.height),this.desiredSize=new U(r,a),this.isCalculateDesiredSize&&(this.desiredSize=this.validateDesiredSize(this.desiredSize,e)),this.desiredSize},n.prototype.arrange=function(e){return this.actualSize=e,this.updateBounds(),this.actualSize},n.prototype.updateBounds=function(){this.bounds=ze(this)},n.prototype.validateDesiredSize=function(e,t){return this.isRectElement&&!this.width&&!this.minWidth&&!this.maxWidth&&(e.width=50),this.isRectElement&&!this.height&&!this.minHeight&&!this.maxHeight&&(e.height=50),(e===void 0||this.width!==void 0&&this.height!==void 0)&&(e=e||new U,e.width=this.width===void 0?(t.width||0)-this.margin.left-this.margin.right:this.width,e.height=this.height===void 0?(t.height||0)-this.margin.top-this.margin.bottom:this.height),this.minWidth!==void 0&&(e.width=Math.max(e.width,this.minWidth)),this.minHeight!==void 0&&(e.height=Math.max(e.height,this.minHeight)),this.maxWidth!==void 0&&this.maxWidth!==0&&(e.width=Math.min(e.width,this.maxWidth)),this.maxHeight!==void 0&&this.maxHeight!==0&&(e.height=Math.min(e.height,this.maxHeight)),e},n})(),bg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Je=(function(n){bg(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.padding=new Pg(0,0,0,0),t.desiredBounds=void 0,t.measureChildren=!0,t.prevRotateAngle=0,t}return e.prototype.hasChildren=function(){return this.children!==void 0&&this.children.length>0},e.prototype.measure=function(t,i,r){this.desiredBounds=void 0;var a=void 0,s,o;if(this.hasChildren()){for(var h=0;h<this.children.length;h++){s=this.children[parseInt(h.toString(),10)],s.horizontalAlignment==="Stretch"&&!t.width&&(t.width=s.bounds.width),s.verticalAlignment==="Stretch"&&!t.height&&(t.height=s.bounds.height);var l=s.horizontalAlignment==="Stretch"||s.verticalAlignment==="Stretch";(this.measureChildren||l||s instanceof e&&s.measureChildren!==void 0)&&s.measure(t,i,r),o=this.GetChildrenBounds(s),s.horizontalAlignment!=="Stretch"&&s.verticalAlignment!=="Stretch"?this.desiredBounds===void 0?this.desiredBounds=o:this.desiredBounds.uniteRect(o):this.actualSize&&!this.actualSize.width&&!this.actualSize.height&&!s.preventContainer&&s.horizontalAlignment==="Stretch"&&s.verticalAlignment==="Stretch"&&(this.desiredBounds===void 0?this.desiredBounds=s.bounds:this.desiredBounds.uniteRect(s.bounds))}if(this.desiredBounds!==void 0&&this.rotateAngle!==0){var d={x:this.desiredBounds.x+this.desiredBounds.width*this.pivot.x,y:this.desiredBounds.y+this.desiredBounds.height*this.pivot.y},f=ye(this.rotateAngle,void 0,void 0,d);this.desiredBounds.x=f.x-this.desiredBounds.width*this.pivot.x,this.desiredBounds.y=f.y-this.desiredBounds.height*this.pivot.y}this.desiredBounds!==void 0&&(this.desiredBounds.width+=this.padding.left+this.padding.right,this.desiredBounds.height+=this.padding.top+this.padding.bottom,this.desiredBounds.x-=this.padding.left,this.desiredBounds.y-=this.padding.top),this.desiredBounds&&(a=new U(this.desiredBounds.width,this.desiredBounds.height))}return a=this.validateDesiredSize(a,t),this.stretchChildren(a),this.desiredSize=a,a},e.prototype.arrange=function(t){var i,r=this.desiredBounds;if(r&&(this.offsetX,this.offsetY,this.offsetX=r.x+r.width*this.pivot.x,this.offsetY=r.y+r.height*this.pivot.y,this.hasChildren()))for(var a=0;a<this.children.length;a++){i=this.children[parseInt(a.toString(),10)];var s=!1;if(i.horizontalAlignment==="Stretch"&&(i.offsetX=this.offsetX,i.parentTransform=this.parentTransform+this.rotateAngle,this.flip&&this.elementActions&le.ElementIsGroup&&(i.parentTransform=this.flip===G.Horizontal||this.flip===G.Vertical?-i.parentTransform:i.parentTransform),s=!0),i.verticalAlignment==="Stretch"&&(i.offsetY=this.offsetY,i.parentTransform=this.parentTransform+this.rotateAngle,s=!0),(s||this.measureChildren||i instanceof e&&i.measureChildren!==void 0)&&i.arrange(i.desiredSize),a===0){var o=i.outerBounds;this.outerBounds=new it(o.x,o.y,o.width,o.height)}else this.outerBounds.uniteRect(i.outerBounds)}return this.actualSize=t,this.updateBounds(),this.prevRotateAngle=this.rotateAngle,t},e.prototype.stretchChildren=function(t){if(this.hasChildren())for(var i=0,r=this.children;i<r.length;i++){var a=r[i];(a.horizontalAlignment==="Stretch"||a.desiredSize.width===void 0)&&(a.desiredSize.width=t.width-a.margin.left-a.margin.right),(a.verticalAlignment==="Stretch"||a.desiredSize.height===void 0)&&(a.desiredSize.height=t.height-a.margin.top-a.margin.bottom),a instanceof e&&a.stretchChildren(a.desiredSize)}},e.prototype.applyPadding=function(t){t.width+=this.padding.left+this.padding.right,t.height+=this.padding.top+this.padding.bottom},e.prototype.findChildOffsetFromCenter=function(t,i){var r={x:i.x-t.desiredSize.width/2,y:i.y-t.desiredSize.height/2},a=ad(r,t);a=ye(t.rotateAngle,i.x,i.y,a),a=ye(this.rotateAngle+this.parentTransform,this.offsetX,this.offsetY,a),t.offsetX=a.x,t.offsetY=a.y},e.prototype.GetChildrenBounds=function(t){var i=t.desiredSize.clone();t.rotateAngle-this.rotateAngle;var r={x:t.offsetX,y:t.offsetY},a=r.x-i.width*t.pivot.x,s=r.y-i.height*t.pivot.y,o=a+i.width,h=s+i.height,l={x:a,y:s},d={x:o,y:s},f={x:a,y:h},p={x:o,y:h};return l=ye(t.rotateAngle,t.offsetX,t.offsetY,l),d=ye(t.rotateAngle,t.offsetX,t.offsetY,d),f=ye(t.rotateAngle,t.offsetX,t.offsetY,f),p=ye(t.rotateAngle,t.offsetX,t.offsetY,p),this.rotateAngle!==0&&(l=ye(-this.rotateAngle,void 0,void 0,l),d=ye(-this.rotateAngle,void 0,void 0,d),f=ye(-this.rotateAngle,void 0,void 0,f),p=ye(-this.rotateAngle,void 0,void 0,p)),it.toBounds([l,d,f,p])},e})(Be),Eg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Tt=(function(n){Eg(e,n);function e(){var t=n.call(this)||this;return t.textContent="",t.canMeasure=!0,t.rotationReference="Parent",t.isLaneOrientation=!1,t.canConsiderBounds=!0,t.annotationVisibility="Visible",t.hyperlink={color:"blue"},t.doWrap=!0,t.textNodes=[],t.style={color:"black",fill:"transparent",strokeColor:"black",strokeWidth:1,fontFamily:"Arial",fontSize:12,whiteSpace:"CollapseSpace",textWrapping:"WrapWithOverflow",textAlign:"Center",italic:!1,bold:!1,textDecoration:"None",strokeDashArray:"",opacity:5,gradient:null,textOverflow:"Wrap"},t.style.fill="transparent",t.style.strokeColor="transparent",t}return Object.defineProperty(e.prototype,"content",{get:function(){return this.textContent},set:function(t){this.textContent!==t&&(this.textContent=t,this.isDirt=!0,this.doWrap=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.textNodes},set:function(t){this.textNodes=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapBounds",{get:function(){return this.textWrapBounds},set:function(t){this.textWrapBounds=t},enumerable:!0,configurable:!0}),e.prototype.refreshTextElement=function(){this.isDirt=!0},e.prototype.measure=function(t){var i;return this.isDirt&&this.canMeasure?i=Ay(this,this.style,this.content,this.isLaneOrientation?t.height:this.width||t.width):i=this.desiredSize,this.width===void 0||this.height===void 0?this.desiredSize=new U(i.width,i.height):this.desiredSize=new U(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return(t.width!==this.actualSize.width||t.height!==this.actualSize.height||this.isDirt)&&(this.doWrap=!0),this.actualSize=t,this.updateBounds(),this.isDirt=!1,this.actualSize},e})(Be),Dg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Pt=(function(n){Dg(e,n);function e(){var t=n.call(this)||this;return t.pathData="",t.transformPath=!0,t.absolutePath="",t.canMeasurePath=!1,t.absoluteBounds=new it,t}return Object.defineProperty(e.prototype,"data",{get:function(){return this.pathData},set:function(t){this.pathData!==t&&(this.pathData=t,this.isDirt=!0)},enumerable:!0,configurable:!0}),e.prototype.getPoints=function(){var t=this;return this.pointTimer||(this.pointTimer=setTimeout(function(){t.points=null,t.pointTimer=null},200)),this.points=this.points||Sy(this),wy(this,this.points)},e.prototype.measure=function(t){return this.staticSize&&this.width!==void 0&&this.height!==void 0?this.absoluteBounds=new it(this.offsetX-this.width*this.pivot.x,this.offsetY-this.height*this.pivot.y,this.width,this.height):(this.isDirt&&(this.transformPath||this.width===void 0||this.height===void 0)&&(!this.absoluteBounds||this.absoluteBounds.height===0)||this.canMeasurePath)&&(this.absoluteBounds=nn(this.data?this.data:"")),this.relativeMode!=="Point"&&this.absoluteBounds&&this.absoluteBounds.width===0&&(this.absoluteBounds.width=this.style.strokeWidth),this.relativeMode!=="Point"&&this.absoluteBounds&&this.absoluteBounds.height===0&&(this.absoluteBounds.height=this.style.strokeWidth),this.width===void 0?this.desiredSize=new U(this.absoluteBounds.width,this.height||this.absoluteBounds.height):this.height===void 0?this.desiredSize=new U(this.width||this.absoluteBounds.width,this.absoluteBounds.height):this.desiredSize=new U(this.width,this.height),this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.canMeasurePath=!1,this.desiredSize},e.prototype.arrange=function(t){return(this.isDirt||this.actualSize.width!==t.width||this.actualSize.height!==t.height)&&(this.isDirt=!0,this.absolutePath=this.updatePath(this.data,this.absoluteBounds,t),this.staticSize||(this.points=null)),this.actualSize=this.desiredSize,this.updateBounds(),this.isDirt=!1,this.actualSize},e.prototype.updatePath=function(t,i,r){var a=!1,s="",o=-i.x,h=-i.y,l=[];return(r.width!==i.width||r.height!==i.height)&&(o=r.width/Number(i.width?i.width:1),h=r.height/Number(i.height?i.height:1),a=!0),l=Hr(t),l=La(l),(a||this.isDirt)&&this.transformPath?s=Da(l,o,h,a,i.x,i.y,0,0):s=id(l),a=!1,s},e})(Be),Lg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),wr=(function(n){Lg(e,n);function e(){var t=n.call(this)||this;return t.imageSource="",t.imageScale="None",t.imageAlign="None",t.stretch="Stretch",t}return Object.defineProperty(e.prototype,"source",{get:function(){return this.imageSource},set:function(t){this.imageSource=t,this.isDirt=!0},enumerable:!0,configurable:!0}),e.prototype.measure=function(t,i,r){return this.isDirt&&(this.stretch!=="Stretch"||this.width===void 0&&this.height===void 0)&&(this.contentSize=by(this.source,this.contentSize,i,r),this.isDirt=!1),this.width!==void 0&&this.height!==void 0?(this.desiredSize=new U(this.width,this.height),this.contentSize=this.desiredSize):this.desiredSize=this.contentSize,this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=new U(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize},e})(Be),Mg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Ht=(function(n){Mg(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.measureChildren=void 0,t}return e.prototype.measure=function(t,i,r){var a=void 0,s=void 0;if(this.hasChildren()){for(var o=0,h=this.children;o<h.length;o++){var l=h[o];l instanceof Tt?l.canMeasure&&(t.width=t.width||this.maxWidth||this.minWidth,l.measure(t)):l instanceof Tt||l.measure(t,i,r);var d=l.desiredSize.clone();l.rotateAngle!==0&&(d=oo(d,l.rotateAngle));var f=d.width+l.margin.right,p=d.height+l.margin.bottom,c=new it(l.margin.left,l.margin.top,f,p);if(l.float){var u=l.getAbsolutePosition(d);if(u!==void 0)continue}(!(l instanceof Tt)||l instanceof Tt&&l.canConsiderBounds)&&(s===void 0?s=c:s.uniteRect(c))}if(s){var g=0,v=0;g=Math.max(s.left,0),v=Math.max(s.top,0),a=new U(s.width+g,s.height+v)}}return a=n.prototype.validateDesiredSize.call(this,a,t),n.prototype.stretchChildren.call(this,a),a.width+=this.padding.left+this.padding.right,a.height+=this.padding.top+this.padding.bottom,this.desiredSize=a,a},e.prototype.arrange=function(t,i){if(this.outerBounds=new it,this.hasChildren())for(var r=this.offsetY-t.height*this.pivot.y+this.padding.top,a=this.offsetX-t.width*this.pivot.x+this.padding.left,s=0,o=this.children;s<o.length;s++){var h=o[s];if((h.transform&Zi.Parent)!==0){h.parentTransform=this.parentTransform+this.rotateAngle,(this.flip!==G.None||this.elementActions&le.ElementIsGroup)&&(this.flip===G.Horizontal||this.flip===G.Vertical)&&!(h.elementActions&le.ElementIsPort)&&this.setParentTransform(h);var l=h.desiredSize.clone(),d=void 0,f={x:0,y:0},p=a,c=r;if(h.relativeMode==="Point"){var u=h.getAbsolutePosition(t);u!==void 0&&(p+=u.x,c+=u.y)}h.relativeMode==="Object"?(d=this.alignChildBasedOnParent(h,l,t,p,c),h.flip=this.flip):d=this.alignChildBasedOnaPoint(h,p,c),f={x:d.x+l.width/2,y:d.y+l.height/2},n.prototype.findChildOffsetFromCenter.call(this,h,f)}i&&(h.horizontalAlignment==="Stretch"||h.verticalAlignment==="Stretch")?h.arrange(t):h instanceof Tt&&h.canMeasure?(h.arrange(h.desiredSize),this.outerBounds.uniteRect(h.outerBounds)):h instanceof Tt||(h.arrange(h.desiredSize),this.outerBounds.uniteRect(h.outerBounds))}return this.actualSize=t,this.updateBounds(),this.outerBounds.uniteRect(this.bounds),t},e.prototype.setParentTransform=function(t){this.flipMode==="All"||t instanceof wr||!(t instanceof wr||t instanceof Tt||t instanceof Pt)&&t instanceof Be?t.parentTransform>0&&(t.parentTransform=-t.parentTransform):t instanceof Tt&&t.position===void 0?t.parentTransform=-t.parentTransform:this.flipMode==="None"?!(t.elementActions&le.ElementIsPort)&&t instanceof Pt&&t.parentTransform>0&&(t.parentTransform=-t.parentTransform):t instanceof Pt?t.parentTransform>0&&(t.parentTransform=-t.parentTransform):(this.flipMode==="LabelText"||this.flipMode==="LabelAndLabelText"||this.flipMode==="PortAndLabelText")&&t instanceof Tt&&t.parentTransform>0&&(t.parentTransform=-t.parentTransform)},e.prototype.alignChildBasedOnParent=function(t,i,r,a,s){switch(t.horizontalAlignment){case"Auto":case"Left":a+=t.margin.left;break;case"Right":a+=r.width-i.width-t.margin.right;break;case"Stretch":case"Center":a+=r.width/2-i.width/2;break}switch(t.verticalAlignment){case"Auto":case"Top":s+=t.margin.top;break;case"Bottom":s+=r.height-i.height-t.margin.bottom;break;case"Stretch":case"Center":s+=r.height/2-i.height/2;break}return{x:a,y:s}},e.prototype.alignChildBasedOnaPoint=function(t,i,r){switch(i+=t.margin.left-t.margin.right,r+=t.margin.top-t.margin.bottom,t.horizontalAlignment){case"Auto":case"Left":i=t.inversedAlignment?i:i-t.desiredSize.width;break;case"Stretch":case"Center":i-=t.desiredSize.width*t.pivot.x;break;case"Right":i=t.inversedAlignment?i-t.desiredSize.width:i;break}switch(t.verticalAlignment){case"Auto":case"Top":r=t.inversedAlignment?r:r-t.desiredSize.height;break;case"Stretch":case"Center":r-=t.desiredSize.height*t.pivot.y;break;case"Bottom":r=t.inversedAlignment?r-t.desiredSize.height:r;break}return{x:i,y:r}},e})(Je);function ka(n){return zg[n.toString()]}var zg={Rectangle:"M0,0 L50,0 L50,50 L0,50 z",Ellipse:"M80.5,12.5 C80.5,19.127417 62.59139,24.5 40.5,24.5 C18.40861,24.5 0.5,19.127417 0.5,12.5C0.5,5.872583 18.40861,0.5 40.5,0.5 C62.59139,0.5 80.5,5.872583 80.5,12.5 z",Hexagon:"M30,0 L60,0 L90,30 L60,60 L30,60 L0,30 L30,0 z",Parallelogram:"M30,0 L60,0 L45,30 L15,30 z",Triangle:"M45,0 L90,45 L0,45 L45,0 z",Plus:"M696.6084,158.2656 L674.8074,158.2656 L674.8074,136.4656 L658.4084,136.4656 L658.4084,158.2656 L636.6084,158.2656L636.6084,174.6646 L658.4084,174.6646 L658.4084,196.4656 L674.8074,196.4656 L674.8074,174.6646 L696.6084,174.6646L696.6084,158.2656 z",Star:"M540.3643,137.9336 L546.7973,159.7016 L570.3633,159.7296 L550.7723,171.9366 L558.9053,194.9966 L540.3643,179.4996L521.8223,194.9966 L529.9553,171.9366 L510.3633,159.7296 L533.9313,159.7016 L540.3643,137.9336 z",Pentagon:"M30,0 L60,30 L50,70 L10,70 L0,30 L30,0 z",Heptagon:"M223.7783,195.7134 L207.1303,174.8364 L213.0713,148.8034 L237.1303,137.2174 L261.1883,148.8034 L267.1303,174.8364L250.4813,195.7134 L223.7783,195.7134 z",Octagon:"M98.7319,196.4653 L81.1579,178.8923 L81.1579,154.0393 L98.7319,136.4653 L123.5849,136.4653L141.1579,154.0393 L141.1579,178.8923 L123.5849,196.4653 L98.7319,196.4653 z",Trapezoid:"M127.2842,291.4492 L95.0322,291.4492 L81.1582,256.3152 L141.1582,256.3152 L127.2842,291.4492 z",Decagon:"M657.3379,302.4141 L642.3369,291.5161 L636.6089,273.8821 L642.3369,256.2481 L657.3379,245.3511 L675.8789,245.3511L690.8789,256.2481 L696.6089,273.8821L690.8789,291.5161 L675.8789,302.4141 L657.3379,302.4141 z",RightTriangle:"M836.293,292.9238 L776.293,292.9238 L776.293,254.8408 L836.293,292.9238 z",Cylinder:"M 542.802,362.009C 542.802,368.452 525.341,373.676 503.802,373.676C 482.263,373.676 464.802,368.452 464.802,362.009L 464.802,466.484C 464.802,472.928 482.263,478.151 503.802,478.151C 525.341,478.151 542.802,472.928 542.802,466.484L 542.802,362.016C 542.802,368.459 525.341,373.534 503.802,373.534C 482.263,373.534 464.802,368.31 464.802,361.867L 464.802,362.016C 464.802,355.572 482.263,350.349 503.802,350.349C 525.341,350.349 542.802,355.572 542.802,362.016",Diamond:"M397.784,287.875 L369.5,316.159 L341.216,287.875 L369.5,259.591 L397.784,287.875 z"},kg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),li=(function(n){kg(e,n);function e(t,i,r){var a=n.call(this)||this;return a.data="",a.nodeId="",a.diagramId="",a.scale="Stretch",a.diagramId=i,a.nodeId=t,a.templateFn=Eo(r),a}return Object.defineProperty(e.prototype,"content",{get:function(){return this.data},set:function(t){this.data=t,this.canReset||(this.canReset=!0,this.isTemplate||(this.template=Ai(this,!1)),this.canReset=!1,this.isDirt=!0)},enumerable:!0,configurable:!0}),e.prototype.getNodeTemplate=function(){return this.templateFn},e.prototype.measure=function(t){if(this.isDirt){var i=Ey(this.template);this.contentSize=new U,this.contentSize.width=i.width,this.contentSize.height=i.height;var r=i.x,a=i.y;this.templatePosition={x:r,y:a},this.isDirt=!1}if(this.width===void 0||this.height===void 0){var s=Dy(this.template);this.desiredSize=new U(s.width,s.height)}else this.desiredSize=new U(this.width,this.height);return this.desiredSize=this.validateDesiredSize(this.desiredSize,t),this.desiredSize},e.prototype.arrange=function(t){return this.actualSize=new U(this.desiredSize.width,this.desiredSize.height),this.updateBounds(),this.actualSize},e})(Be),$i,pr,je,On,Mo=!1;function Rg(n,e){var t=!1,i={left:0,top:0},r=n;if(!n||!e)return i;for(V(e.offsetParent)&&e.style.position==="fixed"&&(t=!0);(e.offsetParent||t)&&n&&e.offsetParent!==n;)i.left+=n.offsetLeft,i.top+=n.offsetTop,n=n.offsetParent;for(n=r;(e.offsetParent||t)&&n&&e.offsetParent!==n;)i.left-=n.scrollLeft,i.top-=n.scrollTop,n=n.parentElement;return i}function _e(n,e,t,i,r){if(pr=void 0,pr=r,Mo=!!i,!n)return{left:0,top:0};e||(e="left"),t||(t="top"),On=n.ownerDocument,je=n;var a={left:0,top:0};return Hg(e.toLowerCase(),t.toLowerCase(),a)}function Ki(n,e){e.left=n}function ji(n,e){e.top=n}function Hg(n,e,t){switch($i=je.getBoundingClientRect(),e+n){case"topcenter":Ki(Ms(),t),ji(Sa(),t);break;case"topright":Ki(Ls(),t),ji(Sa(),t);break;case"centercenter":Ki(Ms(),t),ji(Ds(),t);break;case"centerright":Ki(Ls(),t),ji(Ds(),t);break;case"centerleft":Ki(wa(),t),ji(Ds(),t);break;case"bottomcenter":Ki(Ms(),t),ji(Es(),t);break;case"bottomright":Ki(Ls(),t),ji(Es(),t);break;case"bottomleft":Ki(wa(),t),ji(Es(),t);break;default:case"topleft":Ki(wa(),t),ji(Sa(),t);break}return je=null,t}function ld(){return On.documentElement.scrollTop||On.body.scrollTop}function dd(){return On.documentElement.scrollLeft||On.body.scrollLeft}function Es(){return Mo?$i.bottom:$i.bottom+ld()}function Ds(){return Sa()+$i.height/2}function Sa(){return Mo?$i.top:$i.top+ld()}function wa(){return $i.left+dd()}function Ls(){var n=je&&((je.classList.contains("e-date-wrapper")||je.classList.contains("e-datetime-wrapper"))&&je.classList.contains("e-rtl")||je.classList.contains("e-ddl")&&je.classList.contains("e-rtl")||je.classList.contains("e-date-range-wrapper"))?pr?pr.width:0:pr&&$i.width>=pr.width?pr.width:0;return je&&je.classList.contains("e-rtl")&&je.classList.contains("e-multiselect")&&(n=pr.width),$i.right+dd()-n}function Ms(){return wa()+$i.width/2}var Cr,Ke;function fd(n,e,t,i){if(e===void 0&&(e=null),t===void 0&&(t={X:!1,Y:!1}),!t.Y&&!t.X)return{left:0,top:0};var r=n.getBoundingClientRect();if(Ke=e,Cr=n.ownerDocument,i||(i=_e(n,"left","top")),t.X){var a=Ke?yd():Cd(),s=Ho(),o=Bo(),h=s-i.left,l=i.left+r.width-o;r.width>a?h>0&&l<=0?i.left=o-r.width:l>0&&h<=0?i.left=s:i.left=h>l?o-r.width:s:h>0?i.left+=h:l>0&&(i.left-=l)}if(t.Y){var d=Ke?Sd():xd(),f=Ro(),p=Oo(),c=f-i.top,u=i.top+r.height-p;r.height>d?c>0&&u<=0?i.top=p-r.height:u>0&&c<=0?i.top=f:i.top=c>u?p-r.height:f:c>0?i.top+=c:u>0&&(i.top-=u)}return i}function pd(n,e,t,i){e===void 0&&(e=null);var r=_e(n,"left","top");t&&(r.left=t),i&&(r.top=i);var a=[];Ke=e,Cr=n.ownerDocument;var s=n.getBoundingClientRect(),o=r.top,h=r.left,l=r.left+s.width,d=r.top+s.height,f=md(o,d),p=ud(h,l);return f.topSide&&a.push("top"),p.rightSide&&a.push("right"),p.leftSide&&a.push("left"),f.bottomSide&&a.push("bottom"),a}function Bg(n,e,t,i,r,a,s,o,h){if(s===void 0&&(s=null),o===void 0&&(o={X:!0,Y:!0}),!(!e||!n||!r||!a||!o.X&&!o.Y)){var l={TL:null,TR:null,BL:null,BR:null},d={TL:null,TR:null,BL:null,BR:null},f;if(window.getComputedStyle(n).display==="none"){var p=n.style.visibility;n.style.visibility="hidden",n.style.display="block",f=n.getBoundingClientRect(),n.style.removeProperty("display"),n.style.visibility=p}else f=n.getBoundingClientRect();var c={posX:r,posY:a,offsetX:t,offsetY:i,position:{left:0,top:0}};Ke=s,Cr=e.ownerDocument,Wg(e,l,c,h,f),ko(d,c,f),o.X&&gd(e,d,l,c,f,!0),o.Y&&l.TL.top>-1&&vd(e,d,l,c,f,!0),Og(n,c,f)}}function Og(n,e,t){var i=0,r=0;if(n.offsetParent!=null&&(getComputedStyle(n.offsetParent).position==="absolute"||getComputedStyle(n.offsetParent).position==="relative")){var a=_e(n.offsetParent,"left","top",!1,t);i=a.left,r=a.top}var s=1,o=1,h=cd(n);if(h){var l=getComputedStyle(h).transform;if(l!=="none"){var d=new DOMMatrix(l);s=d.a,o=d.d}var f=getComputedStyle(h).zoom;if(f!=="none"){var p=zo(document.body);s=p*s,o=p*o}}n.style.top=e.position.top/o+e.offsetY-r/o+"px",n.style.left=e.position.left/s+e.offsetX-i/s+"px"}function zo(n){var e=getComputedStyle(n).zoom;return parseFloat(e)||1}function cd(n){for(;n;){var e=window.getComputedStyle(n).transform,t=zo(document.body);if(e&&e!=="none"||t&&t!==1)return n;if(n===document.body)return null;n=n.offsetParent||n.parentElement}return null}function Wg(n,e,t,i,r){t.position=_e(n,t.posX,t.posY,i,r),e.TL=_e(n,"left","top",i,r),e.TR=_e(n,"right","top",i,r),e.BR=_e(n,"left","bottom",i,r),e.BL=_e(n,"right","bottom",i,r)}function ko(n,e,t){n.TL={top:e.position.top+e.offsetY,left:e.position.left+e.offsetX},n.TR={top:n.TL.top,left:n.TL.left+t.width},n.BL={top:n.TL.top+t.height,left:n.TL.left},n.BR={top:n.TL.top+t.height,left:n.TL.left+t.width}}function ud(n,e){var t=!1,i=!1;return n-Ha()<Ho()&&(t=!0),e>Bo()&&(i=!0),{leftSide:t,rightSide:i}}function gd(n,e,t,i,r,a){var s=ud(e.TL.left,e.TR.left);t.TL.left-Ha()<=Ho()&&(s.leftSide=!1),t.TR.left>Bo()&&(s.rightSide=!1),(s.leftSide&&!s.rightSide||!s.leftSide&&s.rightSide)&&(i.posX==="right"?i.posX="left":i.posX="right",i.offsetX=i.offsetX+r.width,i.offsetX=-1*i.offsetX,i.position=_e(n,i.posX,i.posY,!1),ko(e,i,r),a&&gd(n,e,t,i,r,!1))}function vd(n,e,t,i,r,a){var s=md(e.TL.top,e.BL.top);t.TL.top-Ra()<=Ro()&&(s.topSide=!1),t.BL.top>=Oo()&&n.getBoundingClientRect().bottom<window.innerHeight&&(s.bottomSide=!1),(s.topSide&&!s.bottomSide||!s.topSide&&s.bottomSide)&&(i.posY==="top"?i.posY="bottom":i.posY="top",i.offsetY=i.offsetY+r.height,i.offsetY=-1*i.offsetY,i.position=_e(n,i.posX,i.posY,!1,r),ko(e,i,r),a&&vd(n,e,t,i,r,!1))}function md(n,e){var t=!1,i=!1;return n-Ra()<Ro()&&(t=!0),e>Oo()&&(i=!0),{topSide:t,bottomSide:i}}function yd(){return Ke.getBoundingClientRect().width}function Sd(){return Ke.getBoundingClientRect().height}function wd(){return Ke.getBoundingClientRect().left}function Id(){return Ke.getBoundingClientRect().top}function Ro(){return Ke?Id():0}function Ho(){return Ke?wd():0}function Bo(){return Ke?Ha()+wd()+yd():Ha()+Cd()}function Oo(){return Ke?Ra()+Id()+Sd():Ra()+xd()}function Ra(){return Cr.documentElement.scrollTop||Cr.body.scrollTop}function Ha(){return Cr.documentElement.scrollLeft||Cr.body.scrollLeft}function xd(){return window.innerHeight}function Cd(){var n=window.innerWidth,e=document.documentElement.getBoundingClientRect(),t=V(document.documentElement)?0:e.width;return n-(n-t)}function Pd(){Ke=null,Cr=null}var Td=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),oe=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Ng=(function(n){Td(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return oe([w("left")],e.prototype,"X",void 0),oe([w("top")],e.prototype,"Y",void 0),e})(j),ve={ROOT:"e-popup",RTL:"e-rtl",OPEN:"e-popup-open",CLOSE:"e-popup-close"},Xg=(function(n){Td(e,n);function e(t,i){return n.call(this,i,t)||this}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,a=Object.keys(t);r<a.length;r++){var s=a[r];switch(s){case"width":Yi(this.element,{width:Ve(t.width)});break;case"height":Yi(this.element,{height:Ve(t.height)});break;case"zIndex":Yi(this.element,{zIndex:t.zIndex});break;case"enableRtl":this.setEnableRtl();break;case"position":case"relateTo":this.refreshPosition();break;case"offsetX":{var o=t.offsetX-i.offsetX;this.element.style.left=(parseInt(this.element.style.left,10)+o).toString()+"px";break}case"offsetY":{var h=t.offsetY-i.offsetY;this.element.style.top=(parseInt(this.element.style.top,10)+h).toString()+"px";break}case"content":this.setContent();break;case"actionOnScroll":t.actionOnScroll!=="none"?this.wireScrollEvents():this.unwireScrollEvents();break}}},e.prototype.getModuleName=function(){return"popup"},e.prototype.resolveCollision=function(){this.checkCollision()},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.destroy=function(){this.element.classList.contains("e-popup-open")&&this.unwireEvents(),this.element.classList.remove(ve.ROOT,ve.RTL,ve.OPEN,ve.CLOSE),this.content=null,this.relateTo=null,Pd(),n.prototype.destroy.call(this)},e.prototype.render=function(){this.element.classList.add(ve.ROOT);var t={};this.zIndex!==1e3&&(t.zIndex=this.zIndex),this.width!=="auto"&&(t.width=Ve(this.width)),this.height!=="auto"&&(t.height=Ve(this.height)),Yi(this.element,t),this.fixedParent=!1,this.setEnableRtl(),this.setContent()},e.prototype.wireEvents=function(){vt.isDevice&&J.add(window,"orientationchange",this.orientationOnChange,this),this.actionOnScroll!=="none"&&this.wireScrollEvents()},e.prototype.wireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,i=this.getScrollableParent(this.getRelateToElement());t<i.length;t++){var r=i[t];J.add(r,"scroll",this.scrollRefresh,this)}},e.prototype.unwireEvents=function(){vt.isDevice&&J.remove(window,"orientationchange",this.orientationOnChange),this.actionOnScroll!=="none"&&this.unwireScrollEvents()},e.prototype.unwireScrollEvents=function(){if(this.getRelateToElement())for(var t=0,i=this.getScrollableParent(this.getRelateToElement());t<i.length;t++){var r=i[t];J.remove(r,"scroll",this.scrollRefresh)}},e.prototype.getRelateToElement=function(){var t=this.relateTo===""||V(this.relateTo)?document.body:this.relateTo;return this.setProperties({relateTo:t},!0),typeof this.relateTo=="string"?document.querySelector(this.relateTo):this.relateTo},e.prototype.scrollRefresh=function(t){if(this.actionOnScroll==="reposition"?!V(this.element)&&!(this.element.offsetParent===t.target||this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&t.target.parentElement==null)&&this.refreshPosition():this.actionOnScroll==="hide"&&this.hide(),this.actionOnScroll!=="none"&&this.getRelateToElement()){var i=this.isElementOnViewport(this.getRelateToElement(),t.target);!i&&!this.targetInvisibleStatus?(this.trigger("targetExitViewport"),this.targetInvisibleStatus=!0):i&&(this.targetInvisibleStatus=!1)}},e.prototype.isElementOnViewport=function(t,i){for(var r=this.getScrollableParent(t),a=0;a<r.length;a++)if(!this.isElementVisible(t,r[a]))return!1;return!0},e.prototype.isElementVisible=function(t,i){var r=this.checkGetBoundingClientRect(t);if(!r.height||!r.width)return!1;if(V(this.checkGetBoundingClientRect(i))){var s=window,o={top:s.scrollY,left:s.scrollX,right:s.scrollX+s.outerWidth,bottom:s.scrollY+s.outerHeight},h=_e(t),l={top:h.top,left:h.left,right:h.left+r.width,bottom:h.top+r.height},d={top:o.bottom-l.top,left:o.right-l.left,bottom:l.bottom-o.top,right:l.right-o.left};return d.top>0&&d.left>0&&d.right>0&&d.bottom>0}else{var a=i.getBoundingClientRect();return!(r.bottom<a.top)&&!(r.bottom>a.bottom)&&!(r.right>a.right)&&!(r.left<a.left)}},e.prototype.preRender=function(){},e.prototype.setEnableRtl=function(){this.reposition(),this.enableRtl?this.element.classList.add(ve.RTL):this.element.classList.remove(ve.RTL)},e.prototype.setContent=function(){if(!V(this.content))if(this.element.innerHTML="",typeof this.content=="string")this.element.textContent=this.content;else{var t=this.getRelateToElement(),i=this.content.props;(!t.classList.contains("e-dropdown-btn")||V(i))&&this.element.appendChild(this.content)}},e.prototype.orientationOnChange=function(){var t=this;setTimeout(function(){t.refreshPosition()},200)},e.prototype.refreshPosition=function(t,i){V(t)||this.checkFixedParent(t),this.reposition(),i||this.checkCollision()},e.prototype.reposition=function(){var t,i,r=this.getRelateToElement();if(typeof this.position.X=="number"&&typeof this.position.Y=="number")t={left:this.position.X,top:this.position.Y};else if(typeof this.position.X=="string"&&typeof this.position.Y=="number"||typeof this.position.X=="number"&&typeof this.position.Y=="string"){var a=void 0,s=this.element.style.display;this.element.style.display="block",this.element.classList.contains("e-dlg-modal")&&(a=this.element.parentElement.style.display,this.element.parentElement.style.display="block"),i=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY),typeof this.position.X=="string"?t={left:i.left,top:this.position.Y}:t={left:this.position.X,top:i.top},this.element.style.display=s,this.element.classList.contains("e-dlg-modal")&&(this.element.parentElement.style.display=a)}else if(r){var o=this.element.clientHeight,s=this.element.style.display;this.element.style.display="block",t=this.getAnchorPosition(r,this.element,this.position,this.offsetX,this.offsetY,o),this.element.style.display=s}else t={left:0,top:0};V(t)||(this.element.style.left=t.left+"px",this.element.style.top=t.top+"px")},e.prototype.checkGetBoundingClientRect=function(t){var i;try{return i=t.getBoundingClientRect(),i}catch{return null}},e.prototype.getAnchorPosition=function(t,i,r,a,s,o){o===void 0&&(o=0);var h=this.checkGetBoundingClientRect(i),l=this.checkGetBoundingClientRect(t);if(V(h)||V(l))return null;var d=t,f={left:0,top:0};switch(i.offsetParent&&i.offsetParent.tagName==="BODY"&&t.tagName==="BODY"?f=_e(t):(i.classList.contains("e-dlg-modal")&&d.tagName!=="BODY"&&(i=i.parentElement),f=Rg(d,i)),r.X){default:case"left":break;case"center":i.classList.contains("e-dlg-modal")&&d.tagName==="BODY"&&this.targetType==="container"?f.left+=window.innerWidth/2-h.width/2:this.targetType==="container"?f.left+=l.width/2-h.width/2:f.left+=l.width/2;break;case"right":if(i.classList.contains("e-dlg-modal")&&d.tagName==="BODY"&&this.targetType==="container")f.left+=window.innerWidth-h.width;else if(this.targetType==="container"){var p=1,c=cd(i);if(c){var u=getComputedStyle(c).transform;if(u!=="none"){var g=new DOMMatrix(u);p=g.a}var v=getComputedStyle(c).zoom;if(v!=="none"){var m=zo(document.body);p=m*p}}f.left+=(l.width-h.width)/p}else f.left+=l.width;break}switch(r.Y){default:case"top":break;case"center":i.classList.contains("e-dlg-modal")&&d.tagName==="BODY"&&this.targetType==="container"?f.top+=window.innerHeight/2-h.height/2:this.targetType==="container"?f.top+=l.height/2-h.height/2:f.top+=l.height/2;break;case"bottom":i.classList.contains("e-dlg-modal")&&d.tagName==="BODY"&&this.targetType==="container"?f.top+=window.innerHeight-h.height:this.targetType==="container"&&!i.classList.contains("e-dialog")?f.top+=l.height-h.height:this.targetType==="container"&&i.classList.contains("e-dialog")?f.top+=l.height-o:f.top+=l.height;break}return f.left+=a,f.top+=s,f},e.prototype.callFlip=function(t){var i=this.getRelateToElement();Bg(this.element,i,this.offsetX,this.offsetY,this.position.X,this.position.Y,this.viewPortElement,t,this.fixedParent)},e.prototype.callFit=function(t){if(pd(this.element,this.viewPortElement).length!==0)if(V(this.viewPortElement)){var i=fd(this.element,this.viewPortElement,t);t.X&&(this.element.style.left=i.left+"px"),t.Y&&(this.element.style.top=i.top+"px")}else{var r=this.checkGetBoundingClientRect(this.element),a=this.checkGetBoundingClientRect(this.viewPortElement);if(V(r)||V(a))return null;t&&t.Y===!0&&(a.top>r.top?this.element.style.top="0px":a.bottom<r.bottom&&(this.element.style.top=parseInt(this.element.style.top,10)-(r.bottom-a.bottom)+"px")),t&&t.X===!0&&(a.right<r.right?this.element.style.left=parseInt(this.element.style.left,10)-(r.right-a.right)+"px":a.left>r.left&&(this.element.style.left=parseInt(this.element.style.left,10)+(a.left-r.left)+"px"))}},e.prototype.checkCollision=function(){var t=this.collision.X,i=this.collision.Y;t==="none"&&i==="none"||(t==="flip"&&i==="flip"?this.callFlip({X:!0,Y:!0}):t==="fit"&&i==="fit"?this.callFit({X:!0,Y:!0}):(t==="flip"?this.callFlip({X:!0,Y:!1}):i==="flip"&&this.callFlip({Y:!0,X:!1}),t==="fit"?this.callFit({X:!0,Y:!1}):i==="fit"&&this.callFit({X:!1,Y:!0})))},e.prototype.show=function(t,i){var r=this;if(this.wireEvents(),this.getRelateToElement(),this.zIndex===1e3||!V(i)){var a=V(i)?this.element:i;this.zIndex=Ug(a),Yi(this.element,{zIndex:this.zIndex})}t=!V(t)&&typeof t=="object"?t:this.showAnimation,(this.collision.X!=="none"||this.collision.Y!=="none")&&(We([this.element],ve.CLOSE),he([this.element],ve.OPEN),this.checkCollision(),We([this.element],ve.OPEN),he([this.element],ve.CLOSE)),V(t)?(We([this.element],ve.CLOSE),he([this.element],ve.OPEN),this.trigger("open")):(t.begin=function(){r.isDestroyed||(We([r.element],ve.CLOSE),he([r.element],ve.OPEN))},t.end=function(){r.isDestroyed||r.trigger("open")},new ur(t).animate(this.element))},e.prototype.hide=function(t){var i=this;t=!V(t)&&typeof t=="object"?t:this.hideAnimation,V(t)?(We([this.element],ve.OPEN),he([this.element],ve.CLOSE),this.trigger("close")):(t.end=function(){i.isDestroyed||(We([i.element],ve.OPEN),he([i.element],ve.CLOSE),i.trigger("close"))},new ur(t).animate(this.element)),this.unwireEvents()},e.prototype.getScrollableParent=function(t){return this.checkFixedParent(t),Yg(t,this.fixedParent)},e.prototype.checkFixedParent=function(t){for(var i=t.parentElement;i&&i.tagName!=="HTML";){var r=getComputedStyle(i);(r.position==="fixed"||r.position==="sticky")&&!V(this.element)&&this.element.offsetParent&&this.element.offsetParent.tagName==="BODY"&&getComputedStyle(this.element.offsetParent).overflow!=="hidden"&&(this.element.style.top=window.scrollY>parseInt(this.element.style.top,10)?Ve(window.scrollY-parseInt(this.element.style.top,10)):Ve(parseInt(this.element.style.top,10)-window.scrollY),this.element.style.position="fixed",this.fixedParent=!0),i=i.parentElement,!V(this.element)&&V(this.element.offsetParent)&&r.position==="fixed"&&this.element.style.position==="fixed"&&(this.fixedParent=!0)}},oe([w("auto")],e.prototype,"height",void 0),oe([w("auto")],e.prototype,"width",void 0),oe([w(null)],e.prototype,"content",void 0),oe([w("container")],e.prototype,"targetType",void 0),oe([w(null)],e.prototype,"viewPortElement",void 0),oe([w({X:"none",Y:"none"})],e.prototype,"collision",void 0),oe([w("")],e.prototype,"relateTo",void 0),oe([X({},Ng)],e.prototype,"position",void 0),oe([w(0)],e.prototype,"offsetX",void 0),oe([w(0)],e.prototype,"offsetY",void 0),oe([w(1e3)],e.prototype,"zIndex",void 0),oe([w(!1)],e.prototype,"enableRtl",void 0),oe([w("reposition")],e.prototype,"actionOnScroll",void 0),oe([w(null)],e.prototype,"showAnimation",void 0),oe([w(null)],e.prototype,"hideAnimation",void 0),oe([ot()],e.prototype,"open",void 0),oe([ot()],e.prototype,"close",void 0),oe([ot()],e.prototype,"targetExitViewport",void 0),e=oe([Po],e),e})(Vr);function Yg(n,e){for(var t=getComputedStyle(n),i=[],r=/(auto|scroll)/,a=n.parentElement;a&&a.tagName!=="HTML";){var s=getComputedStyle(a);!(t.position==="absolute"&&s.position==="static")&&r.test(s.overflow+s.overflowY+s.overflowX)&&i.push(a),a=a.parentElement}return e||i.push(document),i}function Ug(n){for(var e=n.parentElement,t=[];e&&e.tagName!=="BODY";){var i=document.defaultView.getComputedStyle(e,null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(e,null).getPropertyValue("position");i!=="auto"&&r!=="static"&&parseInt(i,10)<2147483647&&t.push(i),e=e.parentElement}for(var a=[],s=0;s<document.body.children.length;s++)if(!n.isEqualNode(document.body.children[s])){var i=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(document.body.children[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&parseInt(i,10)<2147483647&&a.push(i)}a.push("999");var o=[];if(!V(n.parentElement)&&n.parentElement.tagName!=="BODY"){for(var h=[].slice.call(n.parentElement.children),s=0;s<h.length;s++)if(!n.isEqualNode(h[s])){var i=document.defaultView.getComputedStyle(h[s],null).getPropertyValue("z-index"),r=document.defaultView.getComputedStyle(h[s],null).getPropertyValue("position");i!=="auto"&&r!=="static"&&parseInt(i,10)<2147483647&&o.push(i)}}var l=t.concat(a,o),d=Math.max.apply(Math,l)+1;return d>2147483647?2147483647:d}var Ad=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Wt=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Fg=1500,Vg=500,bh=0,Eh=8,Gg=2,Hi=2,zs="e-tooltip",Dh="e-rtl",Zg="e-bigger",Lh="e-icons",Mh="e-tooltip-close",ks="e-tooltip-wrap",zh="e-tip-content",qr="e-arrow-tip",kh="e-arrow-tip-outer",sa="e-arrow-tip-inner",gn="e-tip-bottom",Rs="e-tip-top",Rh="e-tip-left",Hs="e-tip-right",Bs="e-popup",vn="e-popup-open",Os="e-popup-close",oa="e-lib",$g="e-hidden",Hh="e-tooltip-popup-container",qg=(function(n){Ad(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Wt([w({effect:"FadeIn",duration:150,delay:0})],e.prototype,"open",void 0),Wt([w({effect:"FadeOut",duration:150,delay:0})],e.prototype,"close",void 0),e})(j),Ba=(function(n){Ad(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.mouseMoveEvent=null,r.mouseMoveTarget=null,r.containerElement=null,r.isBodyContainer=!0,r}return e.prototype.initialize=function(){this.formatPosition(),he([this.element],zs)},e.prototype.formatPosition=function(){var t,i;this.position&&(this.position.indexOf("Top")===0||this.position.indexOf("Bottom")===0?(t=this.position.split(/(?=[A-Z])/),this.tooltipPositionY=t[0],this.tooltipPositionX=t[1]):(i=this.position.split(/(?=[A-Z])/),this.tooltipPositionX=i[0],this.tooltipPositionY=i[1]))},e.prototype.renderArrow=function(){this.setTipClass(this.position);var t=this.createElement("div",{className:qr+" "+this.tipClass});t.appendChild(this.createElement("div",{className:kh+" "+this.tipClass})),t.appendChild(this.createElement("div",{className:sa+" "+this.tipClass})),this.tooltipEle.appendChild(t)},e.prototype.setTipClass=function(t){t.indexOf("Right")===0?this.tipClass=Rh:t.indexOf("Bottom")===0?this.tipClass=Rs:t.indexOf("Left")===0?this.tipClass=Hs:this.tipClass=gn},e.prototype.renderPopup=function(t){var i=this.mouseTrail?{top:0,left:0}:this.getTooltipPosition(t);this.tooltipEle.classList.remove(oa),this.popupObj=new Xg(this.tooltipEle,{height:this.height,width:this.width,position:{X:i.left,Y:i.top},enableRtl:this.enableRtl,open:this.openPopupHandler.bind(this),close:this.closePopupHandler.bind(this)})},e.prototype.getScalingFactor=function(t){if(!t)return{x:1,y:1};var i={x:1,y:1},r=t.closest('[style*="transform: scale"]');if(r&&r!==this.tooltipEle&&r.contains(this.tooltipEle)){var a=window.getComputedStyle(r),s=a.getPropertyValue("transform"),o=s.match(/matrix\(([^)]+)\)/)[1].split(",").map(parseFloat);i.x=o[0],i.y=o[3]}return i},e.prototype.getTooltipPosition=function(t){this.tooltipEle.style.display="block";var i=this.element.closest('[style*="zoom"]');i&&(i.contains(this.tooltipEle)||(this.tooltipEle.style.zoom=getComputedStyle(i).zoom));var r=_e(t,this.tooltipPositionX,this.tooltipPositionY,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect()),a=this.getScalingFactor(t),s=this.calculateTooltipOffset(this.position,a.x,a.y),o=this.calculateElementPosition(r,s),h=o[0],l=o[1],d=this.collisionFlipFit(t,h,l);return d.left=d.left/a.x,d.top=d.top/a.y,this.tooltipEle.style.display="",d},e.prototype.windowResize=function(){this.reposition(this.findTarget())},e.prototype.reposition=function(t){if(this.popupObj&&t){var i=this.getTooltipPosition(t);this.popupObj.position={X:i.left,Y:i.top},this.popupObj.dataBind()}},e.prototype.openPopupHandler=function(){!this.mouseTrail&&this.needTemplateReposition()&&this.reposition(this.findTarget()),this.trigger("afterOpen",this.tooltipEventArgs),this.tooltipEventArgs=null},e.prototype.closePopupHandler=function(){this.isReact&&!(this.opensOn==="Click"||typeof this.content=="function")&&this.clearTemplate(["content"]),this.clear();var t={type:this.tooltipEventArgs.event?this.tooltipEventArgs.event.type:null,cancel:!1,target:this.tooltipEventArgs.target,event:this.tooltipEventArgs.event?this.tooltipEventArgs.event:null,element:this.tooltipEle,isInteracted:!V(this.tooltipEventArgs.event)};this.trigger("afterClose",t),t=null},e.prototype.calculateTooltipOffset=function(t,i,r){i===void 0&&(i=1),r===void 0&&(r=1);var a={top:0,left:0},s,o,h,l,d,f,p,c;if(i!==1||r!==1){var u=this.tooltipEle.getBoundingClientRect(),g=void 0;h=Math.round(u.width),l=Math.round(u.height),d=Bt("."+qr,this.tooltipEle),d&&(g=d.getBoundingClientRect()),s=d?Math.round(g.width):0,o=d?Math.round(g.height):0,f=this.showTipPointer?bh:Eh,p=o/2+Hi+(l-this.tooltipEle.clientHeight*r),c=s/2+Hi+(h-this.tooltipEle.clientWidth*i)}else h=this.tooltipEle.offsetWidth,l=this.tooltipEle.offsetHeight,d=Bt("."+qr,this.tooltipEle),s=d?d.offsetWidth:0,o=d?d.offsetHeight:0,f=this.showTipPointer?bh:Eh,p=o/2+Hi+(this.tooltipEle.offsetHeight-this.tooltipEle.clientHeight),c=s/2+Hi+(this.tooltipEle.offsetWidth-this.tooltipEle.clientWidth);switch(this.mouseTrail&&(f+=Gg),t){case"RightTop":a.left+=s+f,a.top-=l-p;break;case"RightCenter":a.left+=s+f,a.top-=l/2;break;case"RightBottom":a.left+=s+f,a.top-=p;break;case"BottomRight":a.top+=o+f,a.left-=c;break;case"BottomCenter":a.top+=o+f,a.left-=h/2;break;case"BottomLeft":a.top+=o+f,a.left-=h-c;break;case"LeftBottom":a.left-=s+h+f,a.top-=p;break;case"LeftCenter":a.left-=s+h+f,a.top-=l/2;break;case"LeftTop":a.left-=s+h+f,a.top-=l-p;break;case"TopLeft":a.top-=l+o+f,a.left-=h-c;break;case"TopRight":a.top-=l+o+f,a.left-=c;break;default:a.top-=l+o+f,a.left-=h/2;break}return a.left+=this.offsetX,a.top+=this.offsetY,a},e.prototype.updateTipPosition=function(t){var i=fr("."+qr+",."+kh+",."+sa,this.tooltipEle),r=[gn,Rs,Rh,Hs];We(i,r),this.setTipClass(t),he(i,this.tipClass)},e.prototype.adjustArrow=function(t,i,r,a){var s=Bt("."+qr,this.tooltipEle);if(!(this.showTipPointer===!1||s===null)){this.updateTipPosition(i);var o,h;this.tooltipEle.style.display="block";var l=this.tooltipEle.clientWidth,d=this.tooltipEle.clientHeight,f=Bt("."+sa,this.tooltipEle),p=s.offsetWidth,c=s.offsetHeight;if(this.tooltipEle.style.display="",this.tipClass===gn||this.tipClass===Rs){if(this.tipClass===gn?(h="99.9%",f.style.top="-"+(c-2)+"px"):(h=-(c-1)+"px",f.style.top="-"+(c-6)+"px"),t){var u=r!=="Center"||l>t.offsetWidth||this.mouseTrail;u&&r==="Left"||!u&&this.tipPointerPosition==="End"?o=l-p-Hi+"px":u&&r==="Right"||!u&&this.tipPointerPosition==="Start"?o=Hi+"px":u&&(this.tipPointerPosition==="End"||this.tipPointerPosition==="Start")?o=this.tipPointerPosition==="End"?t.offsetWidth+(this.tooltipEle.offsetWidth-t.offsetWidth)/2-p/2-Hi+"px":(this.tooltipEle.offsetWidth-t.offsetWidth)/2-p/2+Hi+"px":o=l/2-p/2+"px"}}else{this.tipClass===Hs?(o="99.9%",f.style.left="-"+(p-2)+"px"):(o=-(p-1)+"px",f.style.left=-p+(p-2)+"px");var u=a!=="Center"||d>t.offsetHeight||this.mouseTrail;u&&a==="Top"||!u&&this.tipPointerPosition==="End"?h=d-c-Hi+"px":u&&a==="Bottom"||!u&&this.tipPointerPosition==="Start"?h=Hi+"px":h=d/2-c/2+"px"}s.style.top=h,s.style.left=o}},e.prototype.renderContent=function(t){var i=this,r=Bt("."+zh,this.tooltipEle);if(this.cssClass&&he([this.tooltipEle],this.cssClass.split(" ")),t&&!V(t.getAttribute("title"))&&(t.setAttribute("data-content",t.getAttribute("title")),t.removeAttribute("title")),V(this.content))t&&!V(t.getAttribute("data-content"))&&(r.innerHTML=t.getAttribute("data-content"));else if(r.innerHTML="",this.content instanceof HTMLElement)r.appendChild(this.content);else if(typeof this.content=="string")if(this.isAngular?this.setProperties({content:this.enableHtmlSanitizer?jr.sanitize(this.content):this.content},!0):this.content=this.enableHtmlSanitizer?jr.sanitize(this.content):this.content,this.enableHtmlParse){var a=Re(this.content),s=a({},this,"content",this.element.id+"content",void 0,void 0,r,this.root);s&&ba(s,r)}else r.textContent=this.content;else{var o=Re(this.content),s=o({},this,"content",this.element.id+"content",void 0,void 0,r);s&&(this.isAngular&&this.animation.open.effect==="ZoomIn"&&setTimeout(function(){i.reposition(t)},1),ba(s,r)),this.renderReactTemplates()}},e.prototype.renderCloseIcon=function(){if(!this.isSticky){var t=this.tooltipEle.querySelector("."+Lh+"."+Mh);t&&sn(t);return}var i=this.createElement("div",{className:Lh+" "+Mh,attrs:{role:"button","aria-label":"Press escape to close the Tooltip"}});this.tooltipEle.appendChild(i),J.add(i,vt.touchStartEvent,this.onStickyClose,this)},e.prototype.addDescribedBy=function(t,i){var r=(t.getAttribute("aria-describedby")||"").split(/\s+/);r.indexOf(i)<0&&r.push(i),Kr(t,{"aria-describedby":r.join(" ").trim(),"data-tooltip-id":i})},e.prototype.removeDescribedBy=function(t){var i=t.getAttribute("data-tooltip-id"),r=(t.getAttribute("aria-describedby")||"").split(/\s+/),a=r.indexOf(i);a!==-1&&r.splice(a,1),t.removeAttribute("data-tooltip-id");var s=r.join(" ").trim();s?t.setAttribute("aria-describedby",s):t.removeAttribute("aria-describedby")},e.prototype.tapHoldHandler=function(t){clearTimeout(this.autoCloseTimer),this.targetHover(t.originalEvent)},e.prototype.touchEndHandler=function(){var t=this;if(!this.isSticky){var i=function(){t.close()};this.autoCloseTimer=setTimeout(i,Fg)}},e.prototype.targetClick=function(t){var i;if(this.target?i=re(t.target,this.target):i=this.element,!V(i)){var r=t;i.getAttribute("data-tooltip-id")===null?r.type==="mousedown"&&r.button===2||this.targetHover(t):this.isSticky||this.hideTooltip(this.animation.close,t,i)}},e.prototype.targetHover=function(t){var i;if(this.target?i=re(t.target,this.target):i=this.element,!(V(i)||i.getAttribute("data-tooltip-id")!==null&&this.closeDelay===0)){!V(this.tooltipEle)&&this.tooltipEle.getAttribute("e-animation-id")&&(ur.stop(this.tooltipEle),this.clear());for(var r=[].slice.call(fr('[data-tooltip-id= "'+this.ctrlId+'_content"]',document)),a=0,s=r;a<s.length;a++){var o=s[a];this.restoreElement(o)}this.showTooltip(i,this.animation.open,t)}},e.prototype.mouseMoveBeforeOpen=function(t){this.mouseMoveEvent=t},e.prototype.mouseMoveBeforeRemove=function(){this.mouseMoveTarget&&J.remove(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen)},e.prototype.showTooltip=function(t,i,r){var a=this;clearTimeout(this.showTimer),clearTimeout(this.hideTimer),this.openDelay&&this.mouseTrail&&(this.mouseMoveBeforeRemove(),this.mouseMoveTarget=t,J.add(this.mouseMoveTarget,"mousemove touchstart",this.mouseMoveBeforeOpen,this)),this.tooltipEventArgs={type:r?r.type:null,cancel:!1,target:t,event:r||null,element:this.tooltipEle,isInteracted:!V(r)};var s=function(o){a.beforeRenderCallback(o,t,r,i)};this.trigger("beforeRender",this.tooltipEventArgs,s.bind(this))},e.prototype.beforeRenderCallback=function(t,i,r,a){t.cancel?(this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove()):(this.isHidden=!1,V(this.tooltipEle)?(this.ctrlId=this.element.getAttribute("id")?Rr(this.element.getAttribute("id")):Rr("tooltip"),this.tooltipEle=this.createElement("div",{className:ks+" "+Bs+" "+oa,attrs:{role:"tooltip","aria-hidden":"false",id:this.ctrlId+"_content"}}),this.tooltipEle.style.width=Ve(this.width),this.tooltipEle.style.height=Ve(this.height),this.tooltipEle.style.position="absolute",this.tooltipBeforeRender(i,this),this.tooltipAfterRender(i,r,a,this)):i&&(this.adjustArrow(i,this.position,this.tooltipPositionX,this.tooltipPositionY),this.addDescribedBy(i,this.ctrlId+"_content"),this.renderContent(i),ur.stop(this.tooltipEle),this.reposition(i),this.tooltipAfterRender(i,r,a,this)))},e.prototype.appendContainer=function(t){typeof this.container=="string"?this.container==="body"?this.containerElement=document.body:(this.isBodyContainer=!1,this.containerElement=Bt(this.container,document)):this.container instanceof HTMLElement&&(this.containerElement=this.container,this.isBodyContainer=this.containerElement.tagName==="BODY"),this.isBodyContainer||he([this.containerElement],Hh),this.containerElement.appendChild(t.tooltipEle)},e.prototype.tooltipBeforeRender=function(t,i){t&&(vt.isDevice&&he([i.tooltipEle],Zg),i.width!=="auto"&&(i.tooltipEle.style.maxWidth=Ve(i.width)),i.tooltipEle.appendChild(i.createElement("div",{className:zh})),this.appendContainer(i),We([i.tooltipEle],$g),i.addDescribedBy(t,i.ctrlId+"_content"),i.renderContent(t),he([i.tooltipEle],vn),i.showTipPointer&&i.renderArrow(),i.renderCloseIcon(),i.renderPopup(t),i.adjustArrow(t,i.position,i.tooltipPositionX,i.tooltipPositionY),ur.stop(i.tooltipEle),i.reposition(t))},e.prototype.tooltipAfterRender=function(t,i,r,a){if(t){We([a.tooltipEle],vn),he([a.tooltipEle],Os),a.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:t,event:i||null,element:a.tooltipEle,isInteracted:!V(i)},a.needTemplateReposition()&&!a.mouseTrail&&(r.effect==="None"||r.effect==="FadeIn"||this.isReact&&typeof a.content!="string")&&(a.tooltipEle.style.display="none");var s=function(o){a.beforeOpenCallback(o,t,r,i)};a.trigger("beforeOpen",a.tooltipEventArgs,s.bind(a))}},e.prototype.beforeOpenCallback=function(t,i,r,a){var s=this;if(t.cancel)this.isHidden=!0,this.clear(),this.mouseMoveBeforeRemove(),this.restoreElement(i);else{var o={name:r.effect==="None"&&tn==="Enable"?"FadeIn":this.animation.open.effect,duration:r.duration,delay:r.delay,timingFunction:"easeOut"};if(r.effect==="None"&&(o=void 0),this.openDelay>0){var h=function(){s.mouseTrail&&J.add(i,"mousemove touchstart mouseenter",s.onMouseMove,s),s.popupObj&&(s.popupObj.show(o,i),s.mouseMoveEvent&&s.mouseTrail&&s.onMouseMove(s.mouseMoveEvent))};this.showTimer=setTimeout(h,this.openDelay)}else this.popupObj&&this.popupObj.show(o,i)}a&&this.wireMouseEvents(a,i)},e.prototype.needTemplateReposition=function(){var t=this;return!V(t.viewContainerRef)&&typeof t.viewContainerRef!="string"||this.isReact},e.prototype.checkCollision=function(t,i,r){var a={left:i,top:r,position:this.position,horizontal:this.tooltipPositionX,vertical:this.tooltipPositionY},s=pd(this.tooltipEle,this.checkCollideTarget(),i,r);return s.length>0&&(a.horizontal=s.indexOf("left")>=0?"Right":s.indexOf("right")>=0?"Left":this.tooltipPositionX,a.vertical=s.indexOf("top")>=0?"Bottom":s.indexOf("bottom")>=0?"Top":this.tooltipPositionY),a},e.prototype.calculateElementPosition=function(t,i){return[this.isBodyContainer?t.left+i.left:t.left-this.containerElement.getBoundingClientRect().left+i.left+window.pageXOffset+this.containerElement.scrollLeft,this.isBodyContainer?t.top+i.top:t.top-this.containerElement.getBoundingClientRect().top+i.top+window.pageYOffset+this.containerElement.scrollTop]},e.prototype.collisionFlipFit=function(t,i,r){var a=this.checkCollision(t,i,r),s=a.position;if(this.tooltipPositionY!==a.vertical&&(s=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?a.vertical+this.tooltipPositionX:this.tooltipPositionX+a.vertical),this.tooltipPositionX!==a.horizontal&&(s.indexOf("Left")===0&&(a.vertical=s==="LeftTop"||s==="LeftCenter"?"Top":"Bottom",s=a.vertical+"Left"),s.indexOf("Right")===0&&(a.vertical=s==="RightTop"||s==="RightCenter"?"Top":"Bottom",s=a.vertical+"Right"),a.horizontal=this.tooltipPositionX),this.tooltipEventArgs={type:null,cancel:!1,target:t,event:null,element:this.tooltipEle,collidedPosition:s},this.trigger("beforeCollision",this.tooltipEventArgs),this.tooltipEventArgs.cancel)s=this.position;else{var o=a.vertical,h=a.horizontal;if(a.position!==s){var l=_e(t,h,o,!this.isBodyContainer,this.isBodyContainer?null:this.containerElement.getBoundingClientRect());this.adjustArrow(t,s,h,o);var d=this.getScalingFactor(t),f=this.calculateTooltipOffset(s,d.x,d.y);f.top-=this.getOffSetPosition("TopBottom",s,this.offsetY),f.left-=this.getOffSetPosition("RightLeft",s,this.offsetX),a.position=s;var p=this.calculateElementPosition(l,f);a.left=p[0],a.top=p[1]}else this.adjustArrow(t,s,h,o)}var c={left:a.left,top:a.top},u=this.isBodyContainer?fd(this.tooltipEle,this.checkCollideTarget(),{X:!0,Y:this.windowCollision},c):c;this.tooltipEle.style.display="block";var g=Bt("."+qr,this.tooltipEle);if(this.showTipPointer&&g!=null&&(s.indexOf("Bottom")===0||s.indexOf("Top")===0)){var v=parseInt(g.style.left,10)-(u.left-a.left);v<0?v=0:v+g.offsetWidth>this.tooltipEle.clientWidth&&(v=this.tooltipEle.clientWidth-g.offsetWidth),g.style.left=v.toString()+"px"}return this.tooltipEle.style.display="",c.left=u.left,c.top=u.top,c},e.prototype.getOffSetPosition=function(t,i,r){return t.indexOf(this.position.split(/(?=[A-Z])/)[0])!==-1&&t.indexOf(i.split(/(?=[A-Z])/)[0])!==-1?2*r:0},e.prototype.checkCollideTarget=function(){return!this.windowCollision&&this.target?this.element:null},e.prototype.hideTooltip=function(t,i,r){var a=this;if(this.closeDelay>0){clearTimeout(this.hideTimer),clearTimeout(this.showTimer);var s=function(){a.closeDelay&&a.tooltipEle&&a.isTooltipOpen||a.tooltipHide(t,i,r)};this.hideTimer=setTimeout(s,this.closeDelay)}else this.tooltipHide(t,i,r)},e.prototype.tooltipHide=function(t,i,r){var a=this,s;i?s=this.target?r||i.target:this.element:s=Bt('[data-tooltip-id= "'+this.ctrlId+'_content"]',document),this.tooltipEventArgs={type:i?i.type:null,cancel:!1,target:s,event:i||null,element:this.tooltipEle,isInteracted:!V(i)},this.trigger("beforeClose",this.tooltipEventArgs,function(o){o.cancel?a.isHidden=!1:(a.mouseMoveBeforeRemove(),a.popupHide(t,s,i))})},e.prototype.popupHide=function(t,i,r){i&&r&&this.restoreElement(i),this.isHidden=!0;var a={name:t.effect==="None"&&tn==="Enable"?"FadeOut":this.animation.close.effect,duration:t.duration,delay:t.delay,timingFunction:"easeIn"};t.effect==="None"&&(a=void 0),this.popupObj&&this.popupObj.hide(a)},e.prototype.restoreElement=function(t){this.unwireMouseEvents(t),V(t.getAttribute("data-content"))||(t.setAttribute("title",t.getAttribute("data-content")),t.removeAttribute("data-content")),this.removeDescribedBy(t)},e.prototype.clear=function(){var t=this.findTarget();t&&this.restoreElement(t),this.tooltipEle&&(We([this.tooltipEle],Os),he([this.tooltipEle],vn)),this.isHidden&&(this.popupObj&&this.popupObj.destroy(),this.tooltipEle&&sn(this.tooltipEle),this.tooltipEle=null,this.popupObj=null)},e.prototype.tooltipHover=function(){this.tooltipEle&&(this.isTooltipOpen=!0)},e.prototype.tooltipMouseOut=function(t){this.isTooltipOpen=!1,this.hideTooltip(this.animation.close,t,this.findTarget())},e.prototype.onMouseOut=function(t){var i=t.relatedTarget;if(i&&!this.mouseTrail){var r=re(i,"."+ks+"."+oa+"."+Bs);r?J.add(r,"mouseleave",this.tooltipElementMouseOut,this):(this.hideTooltip(this.animation.close,t,this.findTarget()),this.closeDelay===0&&(this.animation.close.effect==="None"||this.isReact&&typeof this.content!="string")&&this.clear())}else this.hideTooltip(this.animation.close,t,this.findTarget()),this.clear();this.popupObj&&!this.popupObj.element.classList.contains(vn)&&this.clear()},e.prototype.tooltipElementMouseOut=function(t){this.hideTooltip(this.animation.close,t,this.findTarget()),J.remove(this.element,"mouseleave",this.tooltipElementMouseOut),this.clear()},e.prototype.onStickyClose=function(){this.close()},e.prototype.onMouseMove=function(t){var i=0,r=0;if(t.type.indexOf("touch")>-1?(t.preventDefault(),i=t.touches[0].pageX,r=t.touches[0].pageY):(i=t.pageX,r=t.pageY),!V(this.tooltipEle)){ur.stop(this.tooltipEle),We([this.tooltipEle],Os),he([this.tooltipEle],vn),this.adjustArrow(t.target,this.position,this.tooltipPositionX,this.tooltipPositionY);var a=this.getScalingFactor(t.target),s=this.calculateTooltipOffset(this.position,a.x,a.y),o=i+s.left+this.offsetX,h=r+s.top+this.offsetY,l=this.checkCollision(t.target,o,h);if(this.tooltipPositionX!==l.horizontal||this.tooltipPositionY!==l.vertical){var d=this.position.indexOf("Bottom")===0||this.position.indexOf("Top")===0?l.vertical+l.horizontal:l.horizontal+l.vertical;l.position=d,this.adjustArrow(t.target,l.position,l.horizontal,l.vertical);var f=this.calculateTooltipOffset(l.position,a.x,a.y);l.left=i+f.left-this.offsetX,l.top=r+f.top-this.offsetY}this.tooltipEle.style.left=l.left+"px",this.tooltipEle.style.top=l.top+"px"}},e.prototype.keyDown=function(t){this.tooltipEle&&t.keyCode===27&&this.close()},e.prototype.touchEnd=function(t){this.tooltipEle&&re(t.target,"."+zs)===null&&!this.isSticky&&this.close()},e.prototype.scrollHandler=function(t){this.tooltipEle&&!this.isSticky&&!re(t.target,"."+ks+"."+oa+"."+Bs)&&!this.isSticky&&this.close()},e.prototype.render=function(){this.initialize(),this.wireEvents(this.opensOn),this.renderComplete()},e.prototype.preRender=function(){this.tipClass=gn,this.tooltipPositionX="Center",this.tooltipPositionY="Top",this.isHidden=!0},e.prototype.wireEvents=function(t){for(var i=this.getTriggerList(t),r=0,a=i;r<a.length;r++){var s=a[r];if(s==="Custom")return;s==="Focus"&&this.wireFocusEvents(),s==="Click"&&(vt.isIos7||vt.isIos)&&J.add(this.element,"mousedown",this.targetClick,this),s==="Click"&&!(vt.isIos7||vt.isIos)&&J.add(this.element,vt.touchStartEvent,this.targetClick,this),s==="Hover"&&(vt.isDevice?(this.touchModule=new ju(this.element,{tapHoldThreshold:Vg,tapHold:this.tapHoldHandler.bind(this)}),J.add(this.element,vt.touchEndEvent,this.touchEndHandler,this)):J.add(this.element,"mouseover",this.targetHover,this))}this.windowResizeBound=this.windowResize.bind(this),this.keyDownBound=this.keyDown.bind(this),this.touchEndBound=this.touchEnd.bind(this),this.scrollWheelBound=this.scrollHandler.bind(this),document.addEventListener("wheel",this.scrollWheelBound),document.addEventListener("scroll",this.scrollWheelBound),document.addEventListener("touchend",this.touchEndBound),document.addEventListener("keydown",this.keyDownBound),window.addEventListener("resize",this.windowResizeBound)},e.prototype.getTriggerList=function(t){return t?(t==="Auto"&&(t=vt.isDevice?"Hover":"Hover Focus"),t.split(" ")):[]},e.prototype.wireFocusEvents=function(){if(V(this.target))J.add(this.element,"focusin",this.targetHover,this);else{var t=[].slice.call(fr(this.target,this.element));if(this.targetsList=t,!V(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=t;i<r.length;i++){var a=r[i];J.add(a,"focus",this.targetHover,this)}else J.add(this.element,"focusin",this.targetHover,this)}},e.prototype.wireMouseEvents=function(t,i){this.tooltipEle&&(this.isSticky||(t.type==="focus"&&J.add(i,"blur",this.onMouseOut,this),t.type==="focusin"&&J.add(i,"focusout",this.onMouseOut,this),t.type==="mouseover"&&J.add(i,"mouseleave",this.onMouseOut,this),this.closeDelay&&(J.add(this.tooltipEle,"mouseenter",this.tooltipHover,this),J.add(this.tooltipEle,"mouseleave",this.tooltipMouseOut,this))),this.mouseTrail&&this.openDelay===0&&J.add(i,"mousemove touchstart mouseenter",this.onMouseMove,this))},e.prototype.unwireEvents=function(t){for(var i=this.getTriggerList(t),r=0,a=i;r<a.length;r++){var s=a[r];if(s==="Custom")return;s==="Focus"&&this.unwireFocusEvents(),s==="Click"&&J.remove(this.element,vt.touchStartEvent,this.targetClick),s==="Hover"&&(vt.isDevice?(this.touchModule&&this.touchModule.destroy(),J.remove(this.element,vt.touchEndEvent,this.touchEndHandler)):J.remove(this.element,"mouseover",this.targetHover))}document.removeEventListener("touchend",this.touchEndBound),this.touchEndBound=null,document.removeEventListener("wheel",this.scrollWheelBound),document.removeEventListener("scroll",this.scrollWheelBound),this.scrollWheelBound=null,window.removeEventListener("resize",this.windowResizeBound),this.windowResizeBound=null,document.removeEventListener("keydown",this.keyDownBound),this.keyDownBound=null},e.prototype.unwireFocusEvents=function(){if(V(this.target))J.remove(this.element,"focusin",this.targetHover);else{var t=[].slice.call(fr(this.target,this.element));if(!V(this.targetsList)&&this.targetsList.length>0)for(var i=0,r=t;i<r.length;i++){var a=r[i];J.remove(a,"focus",this.targetHover)}else J.remove(this.element,"focusin",this.targetHover)}},e.prototype.unwireMouseEvents=function(t){if(!this.isSticky){for(var i=this.getTriggerList(this.opensOn),r=0,a=i;r<a.length;r++){var s=a[r];s==="Focus"&&(J.remove(t,"blur",this.onMouseOut),J.remove(t,"focusout",this.onMouseOut)),s==="Hover"&&!vt.isDevice&&J.remove(t,"mouseleave",this.onMouseOut)}this.closeDelay&&(J.remove(t,"mouseenter",this.tooltipHover),J.remove(t,"mouseleave",this.tooltipMouseOut))}this.mouseTrail&&J.remove(t,"mousemove touchstart mouseenter",this.onMouseMove)},e.prototype.findTarget=function(){var t=Bt('[data-tooltip-id= "'+this.ctrlId+'_content"]',document);return t},e.prototype.getModuleName=function(){return"tooltip"},e.prototype.getPersistData=function(){return this.addOnPersist([])},e.prototype.onPropertyChanged=function(t,i){for(var r=this.findTarget(),a=0,s=Object.keys(t);a<s.length;a++){var o=s[a];switch(o){case"width":this.tooltipEle&&r&&(this.tooltipEle.style.width=this.tooltipEle.style.maxWidth=Ve(t.width),this.reposition(r));break;case"height":this.tooltipEle&&r&&(this.tooltipEle.style.height=Ve(t.height),this.reposition(r));break;case"content":this.tooltipEle&&this.renderContent();break;case"opensOn":this.unwireEvents(i.opensOn),this.wireEvents(t.opensOn);break;case"position":if(this.formatPosition(),this.tooltipEle&&r){var h=Bt("."+sa,this.tooltipEle);h&&(h.style.top=h.style.left=null),this.reposition(r)}break;case"tipPointerPosition":this.tooltipEle&&r&&this.reposition(r);break;case"offsetX":if(this.tooltipEle){var l=t.offsetX-i.offsetX;this.tooltipEle.style.left=(parseInt(this.tooltipEle.style.left,10)+l).toString()+"px"}break;case"offsetY":if(this.tooltipEle){var d=t.offsetY-i.offsetY;this.tooltipEle.style.top=(parseInt(this.tooltipEle.style.top,10)+d).toString()+"px"}break;case"cssClass":this.tooltipEle&&(i.cssClass&&We([this.tooltipEle],i.cssClass.split(" ")),t.cssClass&&he([this.tooltipEle],t.cssClass.split(" ")));break;case"enableRtl":this.tooltipEle&&(this.enableRtl?he([this.tooltipEle],Dh):We([this.tooltipEle],Dh));break;case"isSticky":this.tooltipEle&&r&&(this.renderCloseIcon(),this.reposition(r));break;case"container":V(this.containerElement)||We([this.containerElement],Hh),this.container=t.container,this.tooltipEle&&r&&(this.appendContainer(this),this.reposition(r))}}},e.prototype.open=function(t,i){V(i)&&(i=this.animation.open),V(t)&&(t=this.element),t.style.display!=="none"&&this.showTooltip(t,i)},e.prototype.close=function(t){t||(t=this.animation.close),this.hideTooltip(t)},e.prototype.refresh=function(t){if(this.tooltipEle&&this.renderContent(t),this.popupObj&&t&&this.reposition(t),!V(this.targetsList)&&!V(this.target)){var i=fr(this.target,this.element);i.length!==this.targetsList.length&&(this.unwireEvents(this.opensOn),this.wireEvents(this.opensOn))}},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.tooltipEle&&sn(this.tooltipEle),this.popupObj&&this.popupObj.destroy(),Pd(),We([this.element],zs),this.unwireEvents(this.opensOn),this.unwireMouseEvents(this.element),this.tooltipEle=null,this.popupObj=null;for(var t=fr('[data-tooltip-id= "'+this.ctrlId+'_content"]',this.element),i=0,r=t;i<r.length;i++){var a=r[i];this.restoreElement(a)}this.containerElement=null,this.tipClass=null,this.tooltipPositionX=null,this.tooltipPositionY=null,this.ctrlId=null,this.tooltipEventArgs=null,this.touchModule=null,this.mouseMoveEvent=null,this.mouseMoveTarget=null,this.containerElement=null,this.targetsList=null},Wt([w("auto")],e.prototype,"width",void 0),Wt([w("auto")],e.prototype,"height",void 0),Wt([w()],e.prototype,"content",void 0),Wt([w("body")],e.prototype,"container",void 0),Wt([w()],e.prototype,"target",void 0),Wt([w("TopCenter")],e.prototype,"position",void 0),Wt([w(0)],e.prototype,"offsetX",void 0),Wt([w(0)],e.prototype,"offsetY",void 0),Wt([w(!0)],e.prototype,"showTipPointer",void 0),Wt([w(!0)],e.prototype,"enableHtmlParse",void 0),Wt([w(!1)],e.prototype,"windowCollision",void 0),Wt([w("Auto")],e.prototype,"tipPointerPosition",void 0),Wt([w("Auto")],e.prototype,"opensOn",void 0),Wt([w(!1)],e.prototype,"mouseTrail",void 0),Wt([w(!1)],e.prototype,"isSticky",void 0),Wt([X({},qg)],e.prototype,"animation",void 0),Wt([w(0)],e.prototype,"openDelay",void 0),Wt([w(0)],e.prototype,"closeDelay",void 0),Wt([w()],e.prototype,"cssClass",void 0),Wt([w(!0)],e.prototype,"enableHtmlSanitizer",void 0),Wt([w("")],e.prototype,"htmlAttributes",void 0),Wt([ot()],e.prototype,"beforeRender",void 0),Wt([ot()],e.prototype,"beforeOpen",void 0),Wt([ot()],e.prototype,"afterOpen",void 0),Wt([ot()],e.prototype,"beforeClose",void 0),Wt([ot()],e.prototype,"afterClose",void 0),Wt([ot()],e.prototype,"beforeCollision",void 0),Wt([ot()],e.prototype,"created",void 0),Wt([ot()],e.prototype,"destroyed",void 0),e=Wt([Po],e),e})(Vr),Qg=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),tr=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Gr=(function(n){Qg(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return tr([w("")],e.prototype,"content",void 0),tr([w("TopLeft")],e.prototype,"position",void 0),tr([w("Mouse")],e.prototype,"relativeMode",void 0),tr([w(!0)],e.prototype,"showTipPointer",void 0),tr([w("auto")],e.prototype,"width",void 0),tr([w("auto")],e.prototype,"height",void 0),tr([w("Auto")],e.prototype,"openOn",void 0),tr([w()],e.prototype,"animation",void 0),tr([w(!1)],e.prototype,"isSticky",void 0),e})(j);function Bh(n){var e=new Ba;e=bd(n.tooltip,e);var t=new Ba(e);return t.beforeCollision=_g,t.beforeOpen=Jg,t.cssClass="e-diagram-tooltip",t.opensOn="custom",t.appendTo("#"+n.element.id),t.close(),t}function Jg(n){(this.content===""||this.content===void 0)&&(n.element.style.display="none")}function _g(n){n.collidedPosition&&n.collidedPosition!==this.position&&(n.element.style.display="none")}function Oh(n,e){var t=n.tooltipObject,i=e?e.tooltip:n.tooltip;return bd(i,t),t}function bd(n,e){if(n.content){if(e.content=n.content,typeof n.content=="string"){var t=function(){return n.content};e.content=xr(t)}e.position=n.position,e.showTipPointer=n.showTipPointer,e.width=n.width,e.height=n.height,n.animation?e.animation=n.animation:e.animation={close:{effect:"None"}}}else e.close();return e}var Wo=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),ce=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},No=(function(n){Wo(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.inEdges=[],s.outEdges=[],s}return ce([w("")],e.prototype,"id",void 0),ce([w("Center")],e.prototype,"horizontalAlignment",void 0),ce([w("Center")],e.prototype,"verticalAlignment",void 0),ce([X({},Ie)],e.prototype,"margin",void 0),ce([w(12)],e.prototype,"width",void 0),ce([w(12)],e.prototype,"height",void 0),ce([X({},Qi)],e.prototype,"style",void 0),ce([w("Square")],e.prototype,"shape",void 0),ce([w("Auto")],e.prototype,"connectionDirection",void 0),ce([w(zt.Connect)],e.prototype,"visibility",void 0),ce([w("")],e.prototype,"pathData",void 0),ce([w(Ct.Default)],e.prototype,"constraints",void 0),ce([w()],e.prototype,"addInfo",void 0),ce([w()],e.prototype,"outEdges",void 0),ce([w()],e.prototype,"inEdges",void 0),ce([X({},Gr)],e.prototype,"tooltip",void 0),e})(j),Se=(function(n){Wo(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.getClassName=function(){return"PointPort"},ce([X({x:.5,y:.5},b)],e.prototype,"offset",void 0),e})(No),ke=(function(n){Wo(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.getClassName=function(){return"PathPort"},ce([w(.5)],e.prototype,"offset",void 0),ce([X({x:0,y:0},b)],e.prototype,"displacement",void 0),ce([w("Center")],e.prototype,"alignment",void 0),e})(No),ls=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Xt=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Kg=(function(n){ls(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Xt([w("blue")],e.prototype,"color",void 0),Xt([w("")],e.prototype,"content",void 0),Xt([w("")],e.prototype,"link",void 0),Xt([w("None")],e.prototype,"textDecoration",void 0),Xt([w("NewTab")],e.prototype,"hyperlinkOpenState",void 0),e})(j),Ed=(function(n){ls(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return r.id||(t.parentObj&&t.parentObj.propName&&t.parentObj.propName==="phases"?s.id=t.parentObj.id:s.id=K()),s}return Xt([w("")],e.prototype,"content",void 0),Xt([w(void 0)],e.prototype,"template",void 0),Xt([w("String")],e.prototype,"annotationType",void 0),Xt([w(!0)],e.prototype,"visibility",void 0),Xt([w(He.InheritReadOnly)],e.prototype,"constraints",void 0),Xt([X(void 0,Kg)],e.prototype,"hyperlink",void 0),Xt([w("")],e.prototype,"id",void 0),Xt([w()],e.prototype,"width",void 0),Xt([w()],e.prototype,"height",void 0),Xt([w(0)],e.prototype,"rotateAngle",void 0),Xt([w("Parent")],e.prototype,"rotationReference",void 0),Xt([X({strokeWidth:0,strokeColor:"transparent",fill:"transparent"},cn)],e.prototype,"style",void 0),Xt([w("Center")],e.prototype,"horizontalAlignment",void 0),Xt([w("Center")],e.prototype,"verticalAlignment",void 0),Xt([X({},Ie)],e.prototype,"margin",void 0),Xt([X({top:void 0,bottom:void 0,left:void 0,right:void 0},Ie)],e.prototype,"dragLimit",void 0),Xt([w("Shape")],e.prototype,"type",void 0),Xt([X({},Gr)],e.prototype,"tooltip",void 0),Xt([w()],e.prototype,"addInfo",void 0),e})(j),ae=(function(n){ls(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.getClassName=function(){return"ShapeAnnotation"},Xt([X({x:.5,y:.5},b)],e.prototype,"offset",void 0),e})(Ed),Qt=(function(n){ls(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.getClassName=function(){return"PathAnnotation"},Xt([w(.5)],e.prototype,"offset",void 0),Xt([X({x:0,y:0},b)],e.prototype,"displacement",void 0),Xt([w("Center")],e.prototype,"alignment",void 0),Xt([w(!1)],e.prototype,"segmentAngle",void 0),e})(Ed);function Xo(n){return iv[n.toString()]}function jg(n,e){return n==="Custom"?e.pathData:rv[""+n]}function tv(n){return nv[""+n]}function Wh(n){return av[""+n]}function ev(n){var e;switch(n.shape){case"Minus":e="M0,50 L100,50";break;case"Plus":e="M0,-50 L0,50 M-50,0 L50,0";break;case"ArrowUp":e="M0,100 L50,0 L100,100 Z";break;case"ArrowDown":e="M0,0 L50,100 L100,0 Z";break;case"Path":e=n.pathData;break}return e}var iv={X:"M14,14 L106,106 M106,14 L14,106",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z",Square:"M0,0 L10,0 L10,10 L0,10 z"},rv={OpenArrow:"M15.9,23 L5,16 L15.9,9 L17,10.7 L8.7,16 L17,21.3Z",Square:"M0,0 L10,0 L10,10 L0,10 z",Fletch:"M14.8,10c0,0-3.5,6,0.2,12c0,0-2.5-6-10.9-6C4.1,16,11.3,16,14.8,10z",OpenFetch:"M6,17c-0.6,0-1-0.4-1-1s0.4-1,1-1c10.9,0,11-5,11-5c0-0.6,0.4-1,1-1s1,0.4,1,1C19,10.3,18.9,17,6,17C6,17,6,17,6,17z M18,23c-0.5,0-1-0.4-1-1c0-0.2-0.3-5-11-5c-0.6,0-1-0.5-1-1s0.4-1,1-1c0,0,0,0,0,0c12.9,0,13,6.7,13,7    C19,22.6,18.6,23,18,23z",IndentedArrow:"M17,10c0,0-4.5,5.5,0,12L5,16L17,10z",OutdentedArrow:"M14.6,10c0,0,5.4,6,0,12L5,16L14.6,10z",DoubleArrow:"M19,10 L19,22 L13,16Z M12,10 L12,22 L6,16Z",Arrow:"M15,10 L15,22 L5,16Z",Diamond:"M12,23l-7-7l7-7l6.9,7L12,23z",Circle:"M0,50 A50,50,0 1 1 100,50 A50,50,0 1 1 0,50 Z"},nv={Square:"M0,0 L10,0 L10,10 L0,10 z",Rhombus:"M10,5 L5,10 L0,5 L5,0 L10,5 Z ",Rectangle:"M0,0 L15,0 L15,10 L0,10 z ",OpenArrow:"M15.9,23 L5,16 L15.9,9 L17,10.7 L8.7,16 L17,21.3Z",Fletch:"M9.82,0 C9.82,0,6.61,5,10,10 C10,10,7.71,5,0,5 C0,5,6.61,5,9.82,0 Z ",OpenFetch:"M0.71,5.71 C0.29,5.71,0,5.43,0,5 C0,4.57,0.29,4.29,0.71,4.29 C8.5,4.29,8.57,0.71,8.57,0.71 C8.57,0.29,8.86,0,9.29,0 C9.719999999999999,0,10,0.29,10,0.71 C10,0.93,9.93,5.71,0.71,5.71 C0.71,5.71,0.71,5.71,0.71,5.71 Z M9.29,10 C8.93,10,8.57,9.71,8.57,9.29 C8.57,9.14,8.36,5.71,0.71,5.71 C0.29,5.71,0,5.36,0,5 C0,4.64,0.29,4.29,0.71,4.29 C0.71,4.29,0.71,4.29,0.71,4.29 C9.93,4.29,10,9.07,10,9.29 C10,9.71,9.71,10,9.29,10 Z ",IndentedArrow:"M10,0 C10,0,6.25,4.58,10,10 L0,5 L10,0 Z ",OutdentedArrow:"M8,0 C8,0,12.5,5,8,10 L0,5 L8,0 Z ",DoubleArrow:"M19,10 L19,22 L13,16Z M12,10 L12,22 L6,16Z",Arrow:"M15,10 L15,22 L5,16Z",Diamond:"M10,5 L5,10 L0,5 L5,0 L10,5 Z  ",Circle:"M10,5 C10,7.76,7.76,10,5,10 C2.24,10,0,7.76,0,5 C0,2.24,2.24,0,5,0 C7.76,0,10,2.24,10,5 Z ",Ellipse:"M15,5 C15,7.76,11.64,10,7.5,10 C3.36,10,0,7.76,0,5 C0,2.24,3.36,0,7.5,0 C11.64,0,15,2.24,15,5 Z  "},av={Square:"M0,0 L10,0 L10,10 L0,10 z",Rhombus:"M10,5 L5,10 L0,5 L5,0 L10,5 Z ",Rectangle:"M0,0 L15,0 L15,10 L0,10 z",OpenArrow:"M23,15.9 L16,5 L9,15.9 L10.7,17 L16,8.7 L21,17.3Z",Fletch:"M9.82,0 C9.82,0,6.61,5,10,10 C10,10,7.71,5,0,5 C0,5,6.61,5,9.82,0 Z ",OpenFetch:"M0.71,5.71 C0.29,5.71,0,5.43,0,5 C0,4.57,0.29,4.29,0.71,4.29 C8.5,4.29,8.57,0.71,8.57,0.71 C8.57,0.29,8.86,0,9.29,0 C9.719999999999999,0,10,0.29,10,0.71 C10,0.93,9.93,5.71,0.71,5.71 C0.71,5.71,0.71,5.71,0.71,5.71 Z M9.29,10 C8.93,10,8.57,9.71,8.57,9.29 C8.57,9.14,8.36,5.71,0.71,5.71 C0.29,5.71,0,5.36,0,5 C0,4.64,0.29,4.29,0.71,4.29 C0.71,4.29,0.71,4.29,0.71,4.29 C9.93,4.29,10,9.07,10,9.29 C10,9.71,9.71,10,9.29,10 Z ",IndentedArrow:"M10,0 C10,0,6.25,4.58,10,10 L0,5 L10,0 Z ",OutdentedArrow:"M8,0 C8,0,12.5,5,8,10 L0,5 L8,0 Z ",DoubleArrow:"M10,19 L22,19 L16,13Z M10,12 L22,12 L16,6Z",Arrow:"M10,15 L22,15 L16,5Z",Diamond:"M10,5 L5,10 L0,5 L5,0 L10,5 Z ",Circle:"M10,5 C10,7.76,7.76,10,5,10 C2.24,10,0,7.76,0,5 C0,2.24,2.24,0,5,0 C7.76,0,10,2.24,10,5 Z ",Ellipse:"M15,5 C15,7.76,11.64,10,7.5,10 C3.36,10,0,7.76,0,5 C0,2.24,3.36,0,7.5,0 C11.64,0,15,2.24,15,5 Z   "};function Yo(n){return sv[n.toString()]}var sv={Process:"M419.511,76.687L359.511,76.687L359.511,43.086L419.511,43.086z",Decision:"M 253.005,115.687L 200.567,146.071L 148.097,115.687L 200.534,85.304L 253.005,115.687 Z",Document:"M 60 31.9 c 0 0 -11 -7.7 -30 0 s -30 0 -30 0 V 0 h 60 V 31.9 Z",PreDefinedProcess:"M 0,0 L 50,0 L 50,50 L 0,50 Z  M 8.334,0 L 8.334,50 M 41.667,0 L 41.667,50",Terminator:"M 269.711,29.33C 269.71,44.061 257.77,56 243.04,56L 158.058,56C 143.33,56 131.39,44.061 131.39,29.33L 131.39,29.33C 131.391,14.6057 143.33,2.669 158.058,2.669L 243.044,2.669C 257.772,2.669 269.711,14.6057 269.711,29.333 Z",PaperTap:"M0.0009,17.2042 L0.0009,47.165 C0.001,47.165 14.403,53.5455 25.00,47.165 C35.599,40.7852 44.403,43.5087 50.00,47.165L50.001,17.2042 M50.001,32.7987 L50.001,2.8405 C50.001,2.8405 35.599,-3.5427 25.001,2.8405C14.403,9.2237 5.599,6.494 0.0009,2.8405 L0.0009,32.7987",DirectData:"M 132.62 0 L 17.38 0 C 7.78 0 0 13.43 0 30 C 0 46.57 7.78 60 17.38 60 L 132.62 60 M 132.62 0C 123.02 0 115.24 13.43 115.24 30 C 115.24 46.57 123.02 60 132.62 60 C 142.22 60 150 46.57 150 30 C 150 13.43 142.22 0 132.62 0 z ",SequentialData:"M0.0029,24.999 C0.0029,11.1922 10.433,0.0021 23.295,0.0021 C36.159,0.00216 46.585,11.1922 46.585,24.999C46.585,38.8057 36.159,49.9979 23.295,49.9979 C10.433,49.9979 0.0029,38.8057 0.0029,24.999 z M23.294,49.999 L50.002,49.999",Sort:"M50.001,24.9971 L25.001,49.9971 L0.00097,24.9971 L25.001,-0.00286865 L50.001,24.9971 z M0.000976562,24.9971 L50.001,24.9971",MultiDocument:"M43.6826,40 C44.8746,40.6183 45.8586,41.3502 46.8366,42.1122 L46.8366,4.74487 L3.09857,4.74487 L3.09857,10.9544 M46.837,35.143 C48.027,35.765 49.025,36.604 50.003,37.369 L50.003,0.002 L6.264,0.002 L6.264,4.744 M43.682,47.113 L43.682,10.765 L0.0025,10.7652 L0.0025,47.1132 C0.0025,47.1132 12.5846,53.6101 21.8426,47.1132 C31.1006,40.6163 38.792,43.393 43.6826,47.1132 z",Collate:"M50.001,0.0028 L25.001,25.0029 L0.00097,0.0028 L50.001,0.002 z M0.0009,50.002 L25.001,25.002L50.001,50.002 L0.0009,50.0029 z",SummingJunction:"M7.3252,42.6768 L42.6772,7.3247 M42.6768,42.6768 L7.3248,7.3247 M0.0009,25.001 C0.0009,11.193 11.197,0.0009 25.001,0.0009 C38.809,0.0009 50.001,11.193 50.001,25.001 C50.001,38.809 38.809,50.001 25.001,50.001 C11.197,50.00 0.0009,38.809 0.0009,25.00 z",Or:"M 0 50 L 100 50 M 50 100 L 50 0.0 M 0 50 C 0 22.384 22.392 0 50 0 C 77.616 0 100 22.384 100 50 C 100 77.616 77.616 100 50 100 C 22.392 100 0 77.616 0 50 Z",InternalStorage:"M 0 3.81946A 2.5,3.81946 0 0,1 2.5,0L 47.5 0A 2.5,3.81946 0 0,1 50,3.81946L 50 45.836A 2.5,3.819446 0 0,1 47.5,49.652778L 2.5 49.652778A 2.5,3.819446 0 0,1 0,45.8336L 0 3.819446ZM 0 11.45834L 50 11.4583334M 12.5 0L 12.5 49.652778",Extract:"M0,35 L30,0 L60,35 Z",ManualOperation:"M46.4,28.8 L14.8,28.8 L0,0 L60,0 Z",Merge:"M60,0 L30,35 L0,0 Z",OffPageReference:"M60,33.3 L30.1,39 L0,33.3 L0,0 L60,0 Z",SequentialAccessStorage:"M 60 30 C 60 13.4 46.6 0 30 0 S 0 13.4 0 30 s 13.4 30 30 30 h 28.6 v -6.5 h -9.9C 55.5 48 60 39.5 60 30 Z",Annotation:"M49.9984,50.0029 L-0.00271199,50.0029 L-0.00271199,0.00286865 L49.9984,0.00286865",Annotation2:"M49.9977,50.0029 L25.416,50.0029 L25.416,0.00286865 L49.9977,0.00286865 M25.4166,25.0029 L-0.00227869,25.0029",Data:"M 10 0 L 40 0 L 30 40 L 0 40 Z",Card:"M275,60 L400,60 L400,110 L260,110 L260,75 Z",Delay:"M0,0 L12.029,0 C14.212999,0 16,1.7869979 16,3.9709952 C16,6.1549926 14.212999,7.9409904 12.029,7.9409904 L0,7.9409904 z",Preparation:"M 1048.17 572 C 1051.06 568.86 1055.17 567.05 1059.5 567 L 1094.51 567 C 1098.84 567.05 1102.95 568.86 1105.84 572 L 1126.43 595 C 1127.01 596.28 1127.01 597.72 1126.43 599 L 1105.84 622 C 1102.95 625.14 1098.84 626.95 1094.51 627 L 1059.5 627 C 1055.17 626.95 1051.06 625.14 1048.17 622 L 1027.58 599 C 1027 597.72 1027 596.28 1027.58 595 L 1048.17 572 Z",Display:"M47.8809,19.2914 L32.7968,-0.00594145 L11.3902,-0.00594145 C7.93166,-0.00594145 0.00124586,11.187 0.00124586,24.9968C0.00124586,38.8032 7.93166,49.9962 11.3902,49.9962 L32.7968,49.99 L47.615,31.038 C47.615,31.0388 52.798,24.9968 47.880,19.2914 z",ManualInput:"M 912 732 L 1006.85 707 C 1008.2 707 1009.5 707.53 1010.46 708.46 C 1011.41 709.4 1011.95 710.67 1011.95 712 L 1011.95 762C 1012 764.41 1010.28 766.52 1007.87 767 L 917.1 767 C 915.75 767 914.45 766.47 913.49 765.54 C 912.54 764.6 912 763.33 912 762 L 912 732 Z",LoopLimit:"M 8 9 L 27 9 L 33 15 L 33 26 C 33 27 33 27 32 27 L 4 27 C 3 27 2 27 2 26 L 2 15 L 8 9 Z",StoredData:"M 5.55 0L 50 0A 1.5,30 0 0,1 50,0A 5.555,25 0 0,0 50,50A 1.5,30 0 0,1 50,50L 5.555 50A 5.55,25 0 0,1 5.555,0Z"};function Nh(n,e,t){var i;n.type==="Straight"||!n.sourceWrapper?i=ov(n):i=n.sourceWrapper.corners.center;var r=lv(n,i,n.targetPoint,e,t);return Fh(n,r[0],!1),Fh(n,r[r.length-1],!0),r}function ov(n){var e;if(n.sourcePortWrapper){var t=n.sourcePortWrapper,i={x:t.offsetX,y:t.offsetY};e=i}else if(n.sourceID&&n.sourceWrapper)if(n.targetWrapper){var r=n.sourceWrapper.corners.center,a=n.targetWrapper.corners.center;e=Ei(n,n.sourceWrapper,r,a,!1)}else e=n.sourcePoint;else e=n.sourcePoint;return e}function hv(n,e,t){t==="LeftToRight"?(n.direction=n.direction?n.direction:"Right",e.direction=e.direction?e.direction:"Left"):t==="RightToLeft"?(n.direction=n.direction?n.direction:"Left",e.direction=e.direction?e.direction:"Right"):t==="TopToBottom"?(n.direction=n.direction?n.direction:"Bottom",e.direction=e.direction?e.direction:"Top"):t==="BottomToTop"&&(n.direction=n.direction?n.direction:"Top",e.direction=e.direction?e.direction:"Bottom")}function lv(n,e,t,i,r){var a=n.sourceWrapper,s=n.targetWrapper,o=n.sourcePortWrapper,h=n.targetPortWrapper,l,d,f=[],p,c,u=Ri(n),g={left:5,right:5,bottom:5,top:5},v={left:5,right:5,bottom:5,top:5},m={corners:l,point:e,direction:p,margin:g},y={corners:d,point:t,direction:c,margin:v},S,x;if(a!==void 0&&s!==void 0&&(S=se(a),x=se(s),m.corners=a.corners,y.corners=s.corners),o&&o.isPathPort&&h&&(t={x:h.offsetX,y:h.offsetY}),o!==void 0){var I={x:o.offsetX,y:o.offsetY};o.connectionDirection==="Left"||o.connectionDirection==="Top"||o.connectionDirection==="Bottom"||o.connectionDirection==="Right"?m.direction=o.connectionDirection:o.isPathPort?m.direction=ho(n.parentObj,n.sourceID,o,t):m.direction=ui(I,S,a.bounds)}if(h!==void 0){var C={x:h.offsetX,y:h.offsetY};h.connectionDirection==="Left"||h.connectionDirection==="Right"||h.connectionDirection==="Bottom"||h.connectionDirection==="Top"?y.direction=h.connectionDirection:h.isPathPort?y.direction=ho(n.parentObj,n.targetID,h,e):y.direction=ui(C,x,s.bounds)}if(n.type==="Bezier"&&!n.isBezierEditing&&n.segments.length>0)for(var P=n.segments.length-1;P>=0;){var A=n.segments[parseInt(P.toString(),10)];A.isInternalSegment&&n.segments.pop(),P--}if(a!==void 0&&s!==void 0)return(m.direction===void 0||y.direction===void 0)&&(i?hv(m,y,i):m.corners.top>y.corners.bottom&&Math.abs(m.corners.top-y.corners.bottom)>u?(m.direction=m.direction?m.direction:"Top",y.direction=y.direction?y.direction:"Bottom"):m.corners.bottom<y.corners.top&&Math.abs(m.corners.bottom-y.corners.top)>u?(m.direction=m.direction?m.direction:"Bottom",y.direction=y.direction?y.direction:"Top"):m.corners.right<y.corners.left&&Math.abs(m.corners.right-y.corners.left)>u||m.corners.right+u<y.corners.left||y.corners.right>=m.corners.left-u&&m.corners.left>y.corners.left?(m.direction=m.direction?m.direction:"Right",y.direction=y.direction?y.direction:"Left"):m.corners.left>y.corners.right&&Math.abs(m.corners.left-y.corners.right)>m.margin.left+m.margin.right||y.corners.right+u<m.corners.left||m.corners.right>=y.corners.left-u&&m.corners.left<y.corners.left?(m.direction=m.direction?m.direction:"Left",y.direction=y.direction?y.direction:"Right"):a.id!==s.id&&!S.equals(S,x)&&x.containsPoint(S.topCenter,m.margin.top)?(m.direction=m.direction?m.direction:"Bottom",y.direction=y.direction?y.direction:"Top"):(m.direction=m.direction?m.direction:"Top",y.direction=y.direction?y.direction:"Bottom")),Sv(n,m.direction,y.direction,m.point,y.point,r,t);if(Wn(n),(n.sourceWrapper||n.targetWrapper)&&vv(n,m,y),n.type==="Straight"||n.type==="Bezier")f=lo(n,m,y);else if(n.type==="Orthogonal"&&n.segments&&n.segments.length>0&&n.segments[0].length!==null&&n.segments[0].direction!==null)f=gv(n,m,y,a,s,o,h,t);else{var T=void 0;m.direction?T=Bd(a.bounds,m,20):m.direction=y.direction?n.targetPortWrapper!==void 0?y.direction:de(y.direction):b.direction(m.point,y.point),n.segments[0].points=f=Ne(n,m,y,T)}return f}function ho(n,e,t,i){var r=null,a=n.nameTable[""+e];if(t&&a){var s={x:t.offsetX,y:t.offsetY},o=dv(s,a);o&&(r=o==="Horizontal"?i.y>s.y?"Bottom":"Top":i.x>s.x?"Right":"Left")}return r}function dv(n,e){for(var t=e.intermediatePoints,i=0;i<t.length-1;i++){var r=t[parseInt(i.toString(),10)],a=t[i+1];if(fv(n,r,a))return r.x===a.x?"Vertical":"Horizontal"}if(t.length>=2){var s=t[t.length-2],o=t[t.length-1];return s.x===o.x?"Vertical":"Horizontal"}return null}function fv(n,e,t){return e.x===t.x&&n.x===e.x?n.y>=Math.min(e.y,t.y)&&n.y<=Math.max(e.y,t.y):e.y===t.y&&n.y===e.y?n.x>=Math.min(e.x,t.x)&&n.x<=Math.max(e.x,t.x):!1}function Dd(n,e){n.direction=e.direction,e.points=[],e.points.push(n.point);var t=e.direction==="Left"||e.direction==="Top"?-e.length:e.length,i=e.direction==="Left"||e.direction==="Right"?0:90,r=ue(n.point,t,i);return e.points.push(r),r}function pv(n,e,t){var i,r,a;if(e.corners=n.sourceWrapper?n.sourceWrapper.corners:void 0,n.sourcePortWrapper){var s={x:n.sourcePortWrapper.offsetX,y:n.sourcePortWrapper.offsetY};a=ui(s,se(n.sourceWrapper),n.sourceWrapper.bounds),e.corners&&(e.direction==="Bottom"||e.direction==="Top")?t.point.x>e.corners.left&&t.point.x<e.corners.right&&(r=e.point.y>t.point.y?"Top":"Bottom"):e.corners&&(e.direction==="Left"||e.direction==="Right")&&t.point.y>e.corners.top&&t.point.y<e.corners.bottom&&(r=e.point.x>t.point.x?"Left":"Right")}if(n.sourcePortWrapper&&a===de(r)){var o;(a==="Left"||a==="Right")&&e.point.y>=e.corners.top&&e.point.y<=e.corners.center.y&&t.point.y>=e.corners.top&&t.point.y<=e.corners.center.y?(e.direction="Top",o=e.point.y-e.corners.top+20):(a==="Left"||a==="Right")&&e.point.y>e.corners.center.y&&e.point.y<=e.corners.bottom&&t.point.y>e.corners.center.y&&t.point.y<=e.corners.bottom?(e.direction="Bottom",o=e.corners.bottom-e.point.y+20):(a==="Top"||a==="Bottom")&&e.point.x>=e.corners.left&&e.point.x<=e.corners.center.x&&t.point.x>=e.corners.left&&t.point.x<=e.corners.center.x?(e.direction="Left",o=e.point.x-e.corners.left+20):(a==="Top"||a==="Bottom")&&e.point.x<=e.corners.right&&e.point.x>e.corners.center.x&&t.point.x<=e.corners.right&&t.point.x<e.corners.center.x&&(e.direction="Right",o=e.corners.right-e.point.x+20),e.direction&&o&&(i=Ne(n,e,t,o,!0))}else e.direction=r||Uo(e.direction,e.point,t.point),i=Gi(e,t);return i}function cv(n,e,t){var i;t.corners=n.targetWrapper.corners,Nn(n.targetWrapper,e,t,n);var r=Uo(t.direction,e.point,t.point);if(e.direction===t.direction&&(e.direction==="Left"||e.direction==="Right")){e.direction=r,i=Ne(n,e,t,n.targetWrapper.width/2+20);var a=e;a.point=i[1],Nn(n.targetWrapper,e,t,n),i=Ne(n,e,t)}else e.direction=r,i=Gi(e,t);return i}function Xh(n,e,t){t.corners=n.targetWrapper.corners;var i,r;e.direction!=="Left"&&e.direction!=="Right"?t.corners.center.y===e.point.y&&!(t.corners.left<=e.point.x&&e.point.x<=t.corners.right)?(i="Top",r=t.corners.height/2+20):t.corners.center.y===e.point.y&&n.segments[n.segments.length-2].direction==="Bottom"||t.corners.center.y>e.point.y&&e.point.y>=t.corners.top?(i="Top",r=e.point.y-t.corners.top+20):t.corners.center.y===e.point.y&&n.segments[n.segments.length-2].direction==="Top"||t.corners.center.y<e.point.y&&e.point.y<=t.corners.bottom?(i="Bottom",r=t.corners.bottom-e.point.y+20):n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&e.corners.top<=e.point.y&&e.point.y<=e.corners.bottom&&(i=e.direction,r=e.point.y>t.point.y?e.point.y-e.corners.top+20:e.corners.bottom-e.point.y+20):t.corners.center.x===e.point.x&&!(t.corners.top<e.point.y&&e.point.y<=t.corners.bottom)?(i="Left",r=t.corners.width/2+20):t.corners.center.x===e.point.x&&n.segments[n.segments.length-2].direction==="Right"||t.corners.center.x>e.point.x&&e.point.x>=t.corners.left?(i="Left",r=e.point.x-t.corners.left+20):t.corners.center.x===e.point.x&&n.segments[n.segments.length-2].direction==="Left"||t.corners.center.x<=e.point.x&&e.point.x<=t.corners.right?(i="Right",r=t.corners.right-e.point.x+20):n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&e.corners.left<=e.point.x&&e.point.x<=e.corners.right&&(i=e.direction,r=e.point.x>t.point.x?e.point.x-e.corners.left+20:e.corners.right-e.point.x+20);var a=i==="Left"||i==="Top"?-r:r,s=i==="Left"||i==="Right"?0:90,o=e.point;e.point=ue(e.point,a,s),e.direction=b.direction(e.point,t.point),n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&(e.corners.center.x===t.corners.center.x||e.corners.center.y===t.corners.center.y)&&(e.direction=t.direction);var h=Ne(n,e,t);return h.splice(0,0,o),h}function uv(n,e,t,i){var r=!1;switch(t.direction){case"Left":n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&i==="Right"&&e.point.x>t.point.x&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom||(i==="Bottom"&&e.point.y>t.point.y||i==="Top"&&e.point.y<t.point.y)&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right?(e.direction=i==="Right"?e.point.y>t.point.y?"Top":"Bottom":e.point.x<t.point.x?"Right":"Left",r=!0):e.point.x>t.point.x&&(e.point.y>t.point.y||e.point.y<t.point.y)&&!(t.corners.top>e.point.y&&t.corners.bottom<e.point.y)?e.direction="Left":e.point.x<t.point.x&&e.point.y>t.point.y||e.point.x>t.point.x&&e.point.y<=t.point.y&&t.corners.top<e.point.y&&t.corners.center.y>=e.point.y?e.direction="Top":e.point.x<t.point.x&&e.point.y<t.point.y||e.point.x>t.point.x&&e.point.y>t.point.y&&t.corners.bottom<e.point.y&&t.corners.center.y>e.point.y?e.direction="Bottom":e.point.y===t.point.y&&e.point.x<t.point.x&&(e.direction="Right");break;case"Right":n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&(i==="Bottom"&&e.point.y>t.point.y||i==="Top"&&e.point.y<t.point.y)&&e.point.x>t.point.x&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right?(e.direction=e.point.x>t.point.x?"Left":"Right",r=!0):n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&i==="Left"&&e.point.x<t.point.x&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom?(e.direction=e.point.y>t.point.y?"Top":"Bottom",r=!0):e.point.x<t.point.x&&t.corners.top<=e.point.y&&t.corners.bottom>=e.point.y&&e.point.y===t.point.y||e.point.y>t.point.y&&e.point.x>t.point.x?e.direction="Top":e.point.y<t.point.y&&e.point.x>t.point.x?e.direction="Bottom":e.point.x<t.point.x&&(e.point.y>t.point.y||e.point.y<t.point.y)?e.direction="Right":e.point.y===t.point.y&&e.point.x>t.point.x&&(e.direction="Left");break;case"Top":n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&i==="Bottom"&&e.point.y>t.point.y&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right||(i==="Right"&&e.point.x>t.point.x||i==="Left"&&t.point.y>e.point.y&&t.point.x>e.point.x)&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom?(e.direction=i==="Bottom"?e.point.x>t.point.x?"Left":"Right":e.point.y<t.point.y?"Bottom":"Top",r=!0):e.point.x===t.point.x&&e.point.y<t.point.y?e.direction="Bottom":e.point.y>t.point.y&&e.point.x>t.corners.left&&e.point.x<t.corners.right?e.direction="Left":e.point.y>=t.point.y?e.direction="Top":e.point.y<t.point.y&&e.point.x>t.point.x?e.direction="Left":e.point.y<t.point.y&&e.point.x<t.point.x&&(e.direction="Right");break;case"Bottom":n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&((i==="Right"||i==="Left"&&t.point.x>e.point.x)&&e.point.y>t.point.y&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom||i==="Top"&&e.point.y<t.point.y&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right)?(i==="Right"||i==="Left"?e.direction=e.point.y>t.point.y?"Top":"Bottom":e.direction=e.point.x>t.point.x?"Left":"Right",r=!0):e.point.y<t.point.y&&e.point.x>t.corners.left&&t.corners.right>e.point.x?e.point.y<t.point.y&&e.point.x>t.corners.left&&t.corners.center.x>=e.point.x?e.direction="Left":e.point.y<t.point.y&&e.point.x<t.corners.right&&t.corners.center.x<e.point.x&&(e.direction="Right"):e.point.y>t.point.y&&e.point.x>t.point.x?e.direction="Left":e.point.y>t.point.y&&e.point.x<t.point.x?e.direction="Right":e.point.y<=t.point.y&&(e.point.x>t.point.x||t.point.x>e.point.x)&&(e.direction="Bottom");break}return r}function Ld(n,e,t){var i;t.corners=n.targetWrapper.corners;var r,a;if(n.sourcePortWrapper!==void 0){var s={x:n.sourcePortWrapper.offsetX,y:n.sourcePortWrapper.offsetY};r=ui(s,se(n.sourceWrapper),n.sourceWrapper.bounds)}var o=uv(n,e,t,r);return!n.selectedSegmentIndex&&n.sourcePortWrapper!==void 0&&n.targetPortWrapper!==void 0&&t.direction===de(r)&&((t.direction==="Left"&&e.point.x>t.point.x||t.direction==="Right"&&e.point.x<t.point.x)&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom||t.direction==="Bottom"&&e.point.y<t.point.y&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right)?i=Xh(n,e,t):!n.selectedSegmentIndex&&e.direction===t.direction?i=Ne(n,e,t):!n.selectedSegmentIndex&&(t.direction==="Left"&&e.point.x>t.point.x||t.direction==="Right"&&e.point.x<t.point.x)&&(e.direction==="Top"||e.direction==="Bottom")&&e.point.y<=t.point.y&&t.corners.top<=e.point.y&&t.corners.bottom>=e.point.y||t.direction==="Top"&&e.point.y>t.point.y||t.direction==="Bottom"&&e.point.y<t.point.y&&t.corners.left<=e.point.x&&t.corners.right>=e.point.x?n.selectedSegmentIndex?i=Gi(e,t):i=Xh(n,e,t):!n.selectedSegmentIndex&&n.sourceWrapper!==void 0&&n.targetWrapper!==void 0&&n.targetPortWrapper!==void 0&&(e.direction==="Left"||e.direction==="Right")&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom&&(t.direction==="Top"||t.direction==="Bottom")&&t.corners.center.x===e.corners.center.x?(e.direction=t.direction==="Top"?"Bottom":"Top",a=t.direction==="Top"?e.corners.bottom-e.point.y+20:e.point.y-e.corners.top+20,i=Ne(n,e,t,a)):!n.selectedSegmentIndex&&n.sourceWrapper!==void 0&&n.targetWrapper!==void 0&&n.targetPortWrapper!==void 0&&(e.direction==="Top"||e.direction==="Bottom")&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right&&(t.direction==="Left"||t.direction==="Right")&&t.corners.center.y===e.corners.center.y?(e.direction=t.direction==="Left"?"Right":"Left",a=t.direction==="Left"?e.corners.right-e.point.x+20:e.point.x-e.corners.left+20,i=Ne(n,e,t,a)):o?(e.direction==="Left"||e.direction==="Right"?a=e.direction==="Left"?e.point.x-e.corners.left+20:e.corners.right-e.point.x+20:a=e.direction==="Top"?e.point.y-e.corners.top+20:e.corners.bottom-e.point.y+20,i=Ne(n,e,t,a)):i=Gi(e,t),i}function gv(n,e,t,i,r,a,s,o){var h,l,d=[],f,p;Wn(n);var c;if(n.segments.length>0){for(var u=0;u<n.segments.length;u++){var g=n.segments[parseInt(u.toString(),10)];if(u===0&&n.sourcePortWrapper!==void 0&&(p={x:a.offsetX,y:a.offsetY},f=ui(p,se(i),i.bounds),g.direction===de(f)&&(g.direction=f)),u>0&&n.segments[u-1].direction===g.direction)u=kd(n,u,e);else{var v=n.segments[u-1];e.point=g.direction?Dd(e,g):v.points[v.points.length-1]}if(u===n.segments.length-1&&(!s&&!r?l=pv(n,e,t):n.targetWrapper&&n.targetPortWrapper===void 0?(Rd(n,e),l=cv(n,e,t)):l=Ld(n,e,t),l))if(zd(l,n),g.points=[],l.length>=2)for(h=0;h<l.length;h++)g.points.push(l[parseInt(h.toString(),10)]);else c=u;if(a&&u===0){var m=Md(n,a,i,o);m&&(e.point=m)}}c!==void 0&&(c===n.segments.length-1&&(n.segments[c-1].direction=null,n.segments[c-1].length=null),n.segments.splice(c,1)),d=Hd(n,d)}return d}function Md(n,e,t,i){var r={x:e.offsetX,y:e.offsetY},a,s=se(t),o;e.isPathPort&&i?o=ho(n.parentObj,n.sourceID,e,i):o=ui(r,s,t.bounds);var h=n.segments[0];return h.direction!==o&&(xv(h,o,s,h.points[0],h.points[h.points.length-1]),a=h.points[h.points.length-1],h.direction=b.direction(h.points[h.points.length-2],h.points[h.points.length-1])),a}function zd(n,e,t){var i=e.segments[e.segments.length-2],r=i.points[i.points.length-1],a;((i.direction==="Top"||i.direction==="Bottom")&&r.x===n[1].x||(i.direction==="Left"||i.direction==="Right")&&r.y===n[1].y)&&(i.points[i.points.length-1]=n[1],a=b.direction(i.points[0],i.points[i.points.length-1]),e.sourceWrapper!==void 0&&e.sourcePortWrapper===void 0&&a===de(i.direction)&&(i.direction==="Left"||i.direction==="Right"?i.points[0].x=i.direction==="Right"?i.points[0].x-e.sourceWrapper.corners.width:i.points[0].x+e.sourceWrapper.corners.width:i.points[0].y=i.direction==="Bottom"?i.points[0].y-e.sourceWrapper.corners.height:i.points[0].y+e.sourceWrapper.corners.height),i.direction=a,i.length=b.distancePoints(i.points[0],i.points[i.points.length-1]),n.splice(0,1))}function vv(n,e,t){var i=n.sourcePortWrapper,r=n.targetPortWrapper,a=n.sourceWrapper,s=e.point,o={left:0,right:0,top:0,bottom:0},h={x:0,y:0},l,d="Top";if(a?(s=t.point,o=e.margin):(a=n.targetWrapper,o=t.margin),n.type==="Orthogonal")if(n.segments&&n.segments.length>0&&n.sourceWrapper&&n.segments[0].direction)e.direction=n.segments[0].direction,h=Fi(a.corners,e.direction),l=Fi(a.corners,de(e.direction)),h=Ei(n,a,h,l,!1);else{var f={corners:null,direction:null,point:s,margin:o},p={corners:null,direction:null,point:null,margin:null};Nn(a,f,p,n),h=p.point,d=p.direction}else{var c=void 0;n.segments&&n.segments.length>1&&(a===n.sourceWrapper?c=n.segments[0].point:c=n.segments[n.segments.length-2].point),h=Ei(n,a,a.bounds.center,n.segments&&n.segments.length>1?c:s,a===n.targetWrapper)}a===n.sourceWrapper?(e.direction=e.direction||d,e.point=h,n.sourcePortWrapper&&(e.point={x:i.offsetX,y:i.offsetY},n.sourcePadding&&(e.point=Oa(n,e,t,!1)))):(t.direction=t.direction||d,t.point=h,n.targetPortWrapper&&(t.point={x:r.offsetX,y:r.offsetY},n.targetPadding&&(t.point=Oa(n,e,t,!0))))}function Oa(n,e,t,i){var r=n.sourcePortWrapper,a=n.targetPortWrapper,s=i?n.targetPadding:n.sourcePadding,o=i?a:r,h=new it(o.bounds.x-s,o.bounds.y-s,o.actualSize.width+2*s,o.actualSize.height+2*s),l=[h.topLeft,h.topRight,h.bottomRight,h.bottomLeft];l[l.length]=l[0];var d={x1:e.point.x,y1:e.point.y,x2:t.point.x,y2:t.point.y},f=i?t.point:e.point;return Fo(d,l,!0,f)||f}function mv(n,e,t){for(var i=Yh(n,t.sourcePadding),r=Yh(e,t.targetPadding),a=0;a<i.length-1;a++)for(var s=i[parseInt(a.toString(),10)],o=0;o<r.length-1;o++){var h=r[parseInt(o.toString(),10)];if(ea(s,h).enabled)return!0}return!1}function Yh(n,e){var t=[],i=sf(n,n.corners,e);i.push(i[0]);for(var r=0;r<i.length-1;r++)t.push(yv(i[parseInt(r.toString(),10)],i[r+1]));return t}function yv(n,e){var t={x1:n.x,y1:n.y,x2:e.x,y2:e.y};return t}function Wa(n,e,t){var i,r=n.rotateAngle+n.parentTransform;if(r){if(r<45)return e;if(r<=135)i={width:e.width,height:e.height,topLeft:e.bottomLeft,topCenter:e.middleLeft,topRight:e.topLeft,middleLeft:e.bottomCenter,center:t.center,middleRight:e.topCenter,bottomLeft:e.bottomRight,bottomCenter:e.middleRight,bottomRight:e.topRight,left:t.left,right:t.right,top:t.top,bottom:t.bottom};else if(r<=225)i={width:e.width,height:e.height,topLeft:e.bottomLeft,topCenter:e.bottomCenter,topRight:e.bottomRight,middleLeft:e.middleRight,center:t.center,middleRight:e.middleLeft,bottomLeft:e.topLeft,bottomCenter:e.topCenter,bottomRight:e.topRight,left:t.left,right:t.right,top:t.top,bottom:t.bottom};else if(r<=315)i={width:e.width,height:e.height,topLeft:e.topRight,topCenter:e.middleRight,topRight:e.bottomRight,middleLeft:e.topCenter,center:t.center,middleRight:e.bottomCenter,bottomLeft:e.topLeft,bottomCenter:e.middleLeft,bottomRight:e.bottomLeft,left:t.left,right:t.right,top:t.top,bottom:t.bottom};else return e;return i}return e}function Sv(n,e,t,i,r,a,s){var o=n.sourceWrapper,h=n.targetWrapper,l=n.sourcePortWrapper,d=n.targetPortWrapper,f=[],p,c=o.corners,u=h.corners;u.center;var g={left:5,right:5,bottom:5,top:5},v={left:5,right:5,bottom:5,top:5},m={corners:c,point:i,direction:e,margin:g},y={corners:u,point:r,direction:t,margin:v},S=Wa(o,c,n.sourceWrapper.bounds),x=Wa(h,u,n.targetWrapper.bounds),I=!1;if(n.sourceWrapper&&n.targetWrapper&&(I=mv(n.sourceWrapper,n.targetWrapper,n)),l!==void 0){switch(m.point={x:l.offsetX,y:l.offsetY},m.direction){case"Bottom":case"Top":m.point.y=m.point.y;break;case"Left":case"Right":m.point.x=m.point.x;break}n.sourcePadding&&!I&&(d&&(y.point={x:d.offsetX,y:d.offsetY}),m.point=Oa(n,m,y,!1))}else n.type==="Orthogonal"||n.type==="Bezier"?(n.segments&&n.segments.length>0&&n.segments[0].direction&&(m.direction=n.segments[0].direction),m.point=Fi(S,m.direction),p=Fi(S,de(m.direction)),m.point=Ei(n,o,m.point,p,!1)):m.point=o.corners.center;if(d!==void 0){switch(y.point={x:d.offsetX,y:d.offsetY},y.direction){case"Bottom":case"Top":y.point.y=y.point.y;break;case"Left":case"Right":y.point.x=y.point.x;break}n.targetPadding&&!I&&(y.point=Oa(n,m,y,!0))}else n.type==="Orthogonal"||n.type==="Bezier"?(y.point=Fi(x,y.direction),p=Fi(x,de(y.direction)),y.point=Ei(n,h,y.point,p,!0)):y.point=h.corners.center;if(n.type!=="Orthogonal"){var C=void 0,P=void 0;if(n.type==="Bezier"){if(n.bezierSettings.allowSegmentsReset||n.segments.length===0||!b.isEmptyPoint(n.segments[n.segments.length-1].point))return f=Uh(n,m,y,void 0,a),f=lo(n,m,y),f;Wn(n)}else Wn(n);if(n.sourcePortWrapper===void 0){m.point=m.corners.center,n.segments&&n.segments.length>0&&(P=n.segments[0],C=b.isEmptyPoint(P.point)?void 0:P);var A=C!==void 0?C.point:y.point;if(n.type==="Bezier"&&n.segments.length>0&&n.segments[0].vector1.angle&&n.segments[0].vector1.distance){var T=Math.max(m.corners.width,m.corners.height);A=b.transform(m.point,n.segments[0].vector1.angle,T/2)}m.point=I?n.sourceWrapper.bounds.center:Ei(n,o,m.point,A,!1)}if(n.targetPortWrapper===void 0){y.point=y.corners.center,n.segments&&n.segments.length>1&&(P=n.segments[n.segments.length-2],C=b.isEmptyPoint(P.point)?void 0:P);var z=C?C.point:m.point;if(n.type==="Bezier"&&n.segments.length>0&&n.segments[n.segments.length-1].vector2.angle&&n.segments[n.segments.length-1].vector2.distance){var T=Math.max(m.corners.width,m.corners.height);z=b.transform(y.point,n.segments[0].vector2.angle,T/2)}y.point=I?n.targetWrapper.bounds.center:Ei(n,h,z,y.point,!0)}f=lo(n,m,y)}else if(n.type==="Orthogonal"&&n.segments&&n.segments.length>0&&n.segments[0].direction!==null)f=Iv(n,m,y,l,d,o,h,s);else{if(!n.segments[0]){var C=new Te(n,"segments",{type:"Orthogonal"},!0);n.segments.push(C)}n.segments[0].points=f=Uh(n,m,y,void 0,a)}return f}function lo(n,e,t){var i=[];if(n.segments&&n.segments.length>0){var r=void 0,a=[],s=e.point;for(r=0;r<n.segments.length;r++){var o=n.segments[parseInt(r.toString(),10)];if(a=[],a.push(s),r!==n.segments.length-1?(a.push(o.point),s=o.point):a.push(t.point),n.segments[parseInt(r.toString(),10)].points=a,n.segments.length>1&&b.equals(o.points[0],o.points[1])&&n.segments.splice(r,1),o)for(var h=0;h<o.points.length;h++)(h>0||r===0)&&i.push(o.points[parseInt(h.toString(),10)])}}return i}function Uo(n,e,t){var i=n==="Top"||n==="Bottom"?t.x>e.x?"Right":"Left":t.y>e.y?"Bottom":"Top";return i}function Wn(n){if(n.type==="Straight"||n.type==="Bezier"){if(n.segments.length===0||n.segments.length>0&&!b.isEmptyPoint(n.segments[n.segments.length-1].point))if(n.type==="Bezier"){var e=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0},!0);n.segments.push(e)}else{var e=new qi(n,"segments",{type:"Straight"},!0);n.segments.push(e)}}else{if(n.segments.length>0)for(var t=!1,i=0;i<n.segments.length;){var r=n.segments[parseInt(i.toString(),10)];t||r&&!(r instanceof Te||r instanceof qi||r instanceof Me)?(n.segments.splice(i,1),t=!0):i++}if(n.segments.length===0||n.segments[n.segments.length-1].direction){var e=new Te(n,"segments",{type:"Orthogonal"},!0);n.segments.push(e)}}}function kd(n,e,t){var i=n.segments[parseInt(e.toString(),10)],r=i.direction==="Left"||i.direction==="Top"?-i.length:i.length,a=i.direction==="Left"||i.direction==="Right"?0:90,s=ue(t.point,r,a);return n.segments[e-1].length+=i.length,n.segments[e-1].points[1]=t.point=s,n.segments.splice(e,1),e--,e}function wv(n,e,t){var i,r;if(n.sourcePortWrapper){var a={x:n.sourcePortWrapper.offsetX,y:n.sourcePortWrapper.offsetY};r=ui(a,se(n.sourceWrapper),n.sourceWrapper.bounds)}Nn(n.targetWrapper,e,t,n);var s=Uo(t.direction,e.point,t.point);if(n.sourcePortWrapper!==void 0&&e.direction===t.direction&&((e.direction==="Top"||e.direction==="Bottom")&&e.corners.center.x===t.corners.center.x||(e.direction==="Left"||e.direction==="Right")&&e.corners.center.y===t.corners.center.y)){e.direction=s,i=s==="Top"||s==="Bottom"?Ne(n,e,t,n.sourceWrapper.height/2+20):Ne(n,e,t,n.sourceWrapper.width/2+20);var o=e;o.point=i[1],s==="Left"||s==="Right"?(t.direction=s,t.point=s==="Left"?t.corners.middleLeft:t.corners.middleRight):Nn(n.targetWrapper,e,t,n),i=Ne(n,e,t)}else if(t.point.x>=e.corners.left&&t.point.x<=e.corners.right&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom){e.direction=t.point.y>e.point.y?"Bottom":"Top";var h=e.direction==="Top"?e.point.y-e.corners.top+20:e.corners.bottom-e.point.y+20;i=Ne(n,e,t,h)}else if(n.sourcePortWrapper&&r===de(s)){var l;(r==="Left"||r==="Right")&&e.point.y>=e.corners.top&&e.point.y<=e.corners.bottom?(e.direction=t.point.y>e.point.y?"Bottom":"Top",l=e.corners.height/2+20):(r==="Top"||r==="Bottom")&&e.point.x>=e.corners.left&&e.point.x<=e.corners.right&&(e.direction=t.point.x>e.point.x?"Right":"Left",l=e.corners.width/2+20),e.direction&&l?i=Ne(n,e,t,l,!0):(e.direction=s,i=Gi(e,t))}else if(n.sourcePortWrapper&&r===t.direction&&(r==="Top"||r==="Bottom")&&e.corners.center.x===t.corners.center.x){e.direction=t.point.y>e.point.y?"Bottom":"Top";var d=e.direction==="Bottom"?e.corners.bottom-e.point.y+20:e.point.y-e.corners.top+20;i=Ne(n,e,t,d)}else if(e.direction===t.direction)if((e.direction==="Left"||e.direction==="Right")&&t.point.y>e.corners.top-20&&t.point.y<e.corners.bottom+20||(e.direction==="Top"||e.direction==="Bottom")&&t.point.x>e.corners.left-20&&t.point.x<e.corners.right+20){var f=e.direction;e.direction=s,i=Na(e,t,f,i,20,!1)}else e.direction=s,i=Gi(e,t);else e.direction=s,i=Gi(e,t);return i}function Rd(n,e){if(n.targetWrapper!==void 0&&n.targetPortWrapper===void 0){var t=1;if(se(n.targetWrapper).containsPoint(e.point,t)){var i=n.targetWrapper,r=n.segments[n.segments.length-2],a=r.points[r.points.length-1],s=de(r.direction);s==="Bottom"?a.y<i.corners.bottom+t&&(r.points[r.points.length-1].y=i.corners.bottom+20,r.length=b.distancePoints(r.points[0],r.points[r.points.length-1])):s==="Top"?a.y>i.corners.top-t&&(r.points[r.points.length-1].y=i.corners.top-20,r.length=b.distancePoints(r.points[0],r.points[r.points.length-1])):s==="Left"?a.x>i.corners.left-t&&(r.points[r.points.length-1].x=i.corners.left-20,r.length=b.distancePoints(r.points[0],r.points[r.points.length-1])):s==="Right"&&a.x<i.corners.right+t&&(r.points[r.points.length-1].x=i.corners.right+20,r.length=b.distancePoints(r.points[0],r.points[r.points.length-1])),e.point=r.points[r.points.length-1]}}}function Iv(n,e,t,i,r,a,s,o){var h,l=[],d,f,p;Wn(n);for(var c=0;c<n.segments.length;c++){if(d=n.segments[parseInt(c.toString(),10)],i&&e.direction===de(d.direction)&&(d.direction=e.direction),c>0&&n.segments[c-1].direction===d.direction)c=kd(n,c,e);else if(d.direction)e.point=Dd(e,n.segments[parseInt(c.toString(),10)]);else{var u=n.segments[c-1];u&&u.points&&u.points.length>0&&(e.point=u.points[u.points.length-1])}if(c===n.segments.length-1)if(Rd(n,e),r===void 0?h=wv(n,e,t):h=Ld(n,e,t),zd(h,n),d.points=[],h.length>=2)for(f=0;f<h.length;f++)if(!n.selectedSegmentIndex)d.points.push(h[parseInt(f.toString(),10)]);else if(f===h.length-1&&h.length>2&&n.segments.length>2){var g={x:h[parseInt(f.toString(),10)].x,y:e.point.y};d.points=[],d.points.push(g),d.points.push(h[parseInt(f.toString(),10)]);var u=n.segments[c-1];n.segments.length<4&&u.points.pop(),u.points=u.points.concat(d.points)}else d.points.push(h[parseInt(f.toString(),10)]);else p=c;if(p!==void 0&&!n.selectedSegmentIndex&&(p===n.segments.length-1&&(n.segments[p-1].direction=null,n.segments[p-1].length=null),n.segments.splice(p,1)),i&&c===0){var v=Md(n,i,a,o);v&&(e.point=v)}}return Hd(n,l)}function Hd(n,e){for(var t=0;t<n.segments.length;t++)for(var i=n.segments[parseInt(t.toString(),10)],r=0;r<i.points.length;r++)(r>0||t===0)&&e.push(i.points[parseInt(r.toString(),10)]);return e}function Nn(n,e,t,i){var r,a={x:0,y:0},s=Wa(n,n.corners,n.bounds),o=e.margin,h=e.point;if(s.bottomCenter.y+o.bottom<h.y)r="Bottom",a=s.bottomCenter;else if(s.topCenter.y-o.top>h.y)r="Top",a=s.topCenter;else if(s.middleLeft.x-o.left>h.x)r="Left",a=s.middleLeft;else if(s.middleRight.x+o.right<h.x)r="Right",a=s.middleRight;else{var l=Math.abs(h.y-s.topCenter.y),d=Math.abs(h.x-s.middleRight.x),f=Math.abs(h.y-s.bottomCenter.y),p=Math.abs(h.x-s.middleLeft.x),c=Number.MAX_VALUE;c=l,r="Top",a=s.topCenter,c>d&&(c=d,r="Right",a=s.middleRight),c>f&&(c=f,r="Bottom",a=s.bottomCenter),c>p&&(r="Left",a=s.middleLeft)}t.point=a,t.direction=r;var u=Fi(s,de(t.direction));t.point=Ei(i,n,t.point,u,n===i.targetWrapper)}function Uh(n,e,t,i,r){var a=!1,s=[],o;if(a=Bv(e.direction,t.direction),a&&$h(e,t),e.direction==="Right"&&t.direction==="Left")o=Cv(n,e,t,a);else if(e.direction==="Right"&&t.direction==="Right")o=Pv(n,e,t);else if(e.direction==="Right"&&t.direction==="Top")o=Tv(n,e,t,a);else if(e.direction==="Right"&&t.direction==="Bottom")o=Av(n,e,t,a);else if(e.direction==="Bottom"&&t.direction==="Top")o=bv(n,e,t);else if(e.direction==="Bottom"&&t.direction==="Bottom"){var h=Ri(n);e.margin={left:h,right:h,top:h,bottom:h},t.margin={left:h,right:h,top:h,bottom:h},o=Dv(n,e,t)}else e.direction==="Bottom"&&t.direction==="Left"?o=Ev(n,e,t,a):e.direction==="Left"&&t.direction==="Left"?o=Mv(n,e,t):e.direction==="Left"&&t.direction==="Top"?o=Lv(n,e,t,a):e.direction==="Top"&&t.direction==="Top"&&(o=zv(n,e,t));return a&&$h(e,t),s=kv(n,o,e,t,i,r),n.type==="Bezier"&&Hv(n,o,s),s}function Ri(n){var e;return n.connectorSpacing>=13?e=13:n.connectorSpacing<=1?e=1:e=n.connectorSpacing,e}function At(n,e){var t={x:e.x,y:n.y},i=b.findLength(t,e),r=b.findLength(e,n),a=Math.asin(i/r);return a=a*180/Math.PI,n.x<e.x?n.y>e.y&&(a=360-a):n.y<e.y?a=180-a:a=180+a,a}function Fi(n,e){var t;switch(e){case"Left":t=n.middleLeft;break;case"Top":t=n.topCenter;break;case"Right":t=n.middleRight;break;case"Bottom":t=n.bottomCenter;break}return t}function xv(n,e,t,i,r,a){var s=13,o,h=[],l;h.push(i);var d=i.y===r.y&&(e==="Left"&&r.x<i.x||e==="Right"&&r.x>i.x)||i.x===r.x&&(e==="Top"&&r.y<i.y||e==="Bottom"&&r.y>i.y);d||(e==="Top"||e==="Bottom"?e==="Top"&&r.y<i.y&&r.y>i.y-s||e==="Bottom"&&r.y>i.y&&r.y<i.y+s?(l=e==="Top"?t.top-s:t.bottom+s,h.push({x:i.x,y:l}),h.push({x:i.x+(r.x-i.x)/2,y:l}),h.push({x:i.x+(r.x-i.x)/2,y:r.y})):Math.abs(i.x-r.x)>s&&(e==="Top"&&r.y<i.y||e==="Bottom"&&r.y>i.y)?h.push({x:i.x,y:r.y}):(l=e==="Top"?t.top-s:t.bottom+s,o=r.x<i.x?t.left-s:t.right+s,h.push({x:i.x,y:l}),h.push({x:r.x,y:l})):e==="Left"&&r.x<i.x&&r.x>i.x-s||e==="right"&&r.x>i.x&&r.x<i.x+s?(o=e==="Left"?t.left-s:t.right+s,h.push({x:o,y:i.y}),h.push({x:o,y:i.y+(r.y-i.y)/2}),h.push({x:r.x,y:i.y+(r.y-i.y)/2})):Math.abs(i.y-r.y)>s&&(e==="Left"&&r.x<i.x||e==="Right"&&r.x>i.x)?h.push({x:r.x,y:i.y}):(o=e==="Left"?t.left-s:t.right+s,h.push({x:o,y:i.y}),h.push({x:o,y:r.y})),n.points=h)}function ue(n,e,t){var i=b.transform(n,t,e);return i}function Ei(n,e,t,i,r){t={x:t.x,y:t.y},i={x:i.x,y:i.y};var a=r?n.targetWrapper:n.sourceWrapper,s=r?n.targetPadding:n.sourcePadding,o,h,l=r||n.type==="Orthogonal"||n.type==="Bezier"?t:i,d=a,f=ye(-a.parentTransform,a.offsetX,a.offsetY,t),p=ye(-a.parentTransform,a.offsetX,a.offsetY,i);if(n.type==="Orthogonal"||n.type==="Bezier"){var c=5;f.x===p.x&&(f.y<p.y?f.y-=c:f.y+=c),f.y===p.y&&(f.x<p.x?f.x-=c:f.x+=c),t=ye(a.parentTransform,a.offsetX,a.offsetY,f)}else if(r){var u=b.findAngle(t,i);i=b.transform({x:i.x,y:i.y},u,Math.max(a.actualSize.width,a.actualSize.height))}else{var u=b.findAngle(i,t);t=b.transform({x:t.x,y:t.y},u,Math.max(a.actualSize.width,a.actualSize.height))}(n.sourcePadding||n.targetPadding)&&(o=new it(a.bounds.x-s,a.bounds.y-s,a.actualSize.width+2*s,a.actualSize.height+2*s)),a instanceof Pt&&a.data?(h=o?[o.topLeft,o.topRight,o.bottomRight,o.bottomLeft]:d.getPoints(),d.data.split("m").length-1+(d.data.split("M").length-1)===1&&(h[h.length]=h[0])):(h=o?[o.topLeft,o.topRight,o.bottomRight,o.bottomLeft]:sf(a,a.corners),h[h.length]=h[0]);var g={x1:t.x,y1:t.y,x2:i.x,y2:i.y};return Fo(g,h,!0,l)||t}function Fh(n,e,t){return e.x=Math.round(e.x*100)/100,e.y=Math.round(e.y*100)/100,t?n.targetPoint=e:n.sourcePoint=e,e}function Fo(n,e,t,i){var r=e.length,a,s={x1:e[0].x,y1:e[0].y,x2:e[1].x,y2:e[1].y},o=Vh(n,s);if(o&&(a=b.distancePoints(o,i)),isNaN(a)||a>0)for(var h=1;h<r-1;h++){s={x1:e[parseInt(h.toString(),10)].x,y1:e[parseInt(h.toString(),10)].y,x2:e[h+1].x,y2:e[h+1].y};var l=Vh(n,s);if(l){var d=b.distancePoints(l,i);if((isNaN(a)||a>d)&&(a=d,o=l),a>=0&&a<=1)break}}return o}function Vh(n,e){var t=n.x1,i=n.y1,r=n.x2,a=n.y2,s=e.x1,o=e.y1,h=e.x2,l=e.y2,d,f,p,c,u,g,v,m,y,S,x,I,C,P;if(d=a-i,p=t-r,u=r*i-t*a,x=d*s+p*o+u,I=d*h+p*l+u,x!==0&&I!==0&&Gh(x,I)||(f=l-o,c=s-h,g=h*o-s*l,y=f*t+c*i+g,S=f*r+c*a+g,y!==0&&S!==0&&Gh(y,S)))return null;var A=d*c-f*p;return A===0?null:(A<0?C=-A/2:C=A/2,C=0,P=p*g-c*u,P<0?v=(P-C)/A:v=(P+C)/A,P=f*u-d*g,P<0?m=(P-C)/A:m=(P+C)/A,{x:v,y:m})}function Gh(n,e){return n*e>=0}function Cv(n,e,t,i){var r=n.sourcePortWrapper,a,s=Math.round(Math.abs(e.point.y-t.point.y)),o={x:Math.max(e.point.x,e.corners.right),y:e.point.y},h={x:Math.min(t.point.x,t.corners.left),y:t.point.y},l=Ri(n);if(i){var d=h;h=o,o=d}return e.corners.bottom+l<t.corners.top-l||e.corners.top-l>t.corners.bottom+l||(n.type!=="Bezier"||t.corners.left-e.corners.right<=l*2&&t.corners.left-e.corners.right>=5)&&(l=0),e.margin={left:l,right:l,top:l,bottom:l},t.margin={left:l,right:l,top:l,bottom:l},s===0&&(e.corners.right<t.corners.left||i&&e.corners.right<t.corners.left)?a=q.One:e.point.x+e.margin.right<t.point.x-t.margin.left||n.sourceWrapper!==n.targetWrapper&&(se(n.sourceWrapper).containsPoint(h)||se(n.targetWrapper).containsPoint(o))?a=q.Three:(e.corners.bottom<=t.corners.top||e.corners.top>=t.corners.top||r!==void 0&&r.offsetY<=t.corners.top||r===void 0&&e.corners.right<=t.corners.top||r!==void 0&&r.offsetY>=t.corners.bottom||r===void 0&&e.corners.right>=t.corners.bottom,a=q.Five),a}function Pv(n,e,t){var i=n.sourcePortWrapper,r=n.targetPortWrapper,a,s=e.point.x-t.point.x,o=e.point.y-t.point.y,h=Ri(n);return t.margin={left:h,right:h,top:h,bottom:h},e.margin={left:h,right:h,top:h,bottom:h},e.corners.right>=t.corners.right?i!==void 0&&(i.offsetY<t.corners.top-t.margin.top||i.offsetY>t.corners.bottom+t.margin.bottom)||i===void 0&&e.corners.middleRight.y<t.corners.top||i!==void 0&&i.offsetY>t.corners.bottom+t.margin.bottom&&e.corners.top>t.corners.bottom||i===void 0&&e.corners.middleRight.y>t.corners.bottom||i!==void 0&&i.offsetY<t.corners.top-t.margin.top&&e.corners.bottom>t.corners.top||i===void 0&&e.corners.middleRight.y>t.corners.bottom?a=q.Three:e.corners.right<t.corners.left||t.corners.right<e.corners.left?a=q.Five:s===0||o===0?a=q.One:a=q.Three:r!==void 0&&e.corners.bottom<r.offsetY-t.margin.top||r===void 0&&e.corners.bottom<t.corners.middleRight.y||r!==void 0&&e.corners.top>r.offsetY+t.margin.right||r===void 0&&e.corners.top>t.corners.middleRight.y||r!==void 0&&(i!==void 0&&i.offsetX<t.corners.left&&i.offsetX!==r.offsetX&&Math.abs(e.corners.right-t.corners.left)<=20||i===void 0&&e.corners.right<t.corners.left&&e.corners.center.x!==t.corners.center.x&&e.corners.center.y!==t.corners.center.y)?a=q.Three:e.corners.right<t.corners.left?a=q.Five:s===0||o===0?a=q.One:a=q.Three,a}function Tv(n,e,t,i){var r=n.targetPortWrapper,a=n.sourcePortWrapper,s={x:Math.max(e.point.x,e.corners.right),y:e.point.y},o={x:t.point.x,y:Math.min(t.point.y,t.corners.top)},h=Ri(n),l;if(t.margin={left:h,right:h,top:h,bottom:h},e.margin={top:h,bottom:h,left:h,right:h},i){var d=a;a=r,r=d;var f=s;s=o,o=f}return a!==void 0&&a.offsetY<t.corners.top-t.margin.top||a===void 0&&e.corners.bottom<t.corners.top-t.margin.top?e.corners.bottom<t.corners.top?r!==void 0&&e.corners.right+e.margin.right<r.offsetX||r===void 0&&e.corners.right+e.margin.right<t.corners.topCenter.x?l=q.Two:l=q.Four:r!==void 0&&e.corners.left>r.offsetX||r===void 0&&e.corners.left>t.corners.topCenter.x?l=q.Four:l=q.Two:a!==void 0&&Math.abs(e.corners.right-t.corners.left)<=5&&Math.abs(a.offsetY-t.corners.top)<=5||r!==void 0&&e.corners.right<t.corners.left&&Math.abs(r.offsetX-e.corners.topCenter.x)>=25&&e.corners.middleRight.y+e.margin.right<r.offsetY?l=q.Two:e.corners.right<t.corners.left?l=q.Four:n.sourceWrapper!==n.targetWrapper&&(se(n.sourceWrapper).containsPoint(o)||se(n.targetWrapper).containsPoint(s))?l=q.Two:l=q.Four,l}function Av(n,e,t,i){var r=Ri(n);e.margin={left:r,right:r,top:r,bottom:r},t.margin={left:r,right:r,top:r,bottom:r};var a,s=n.sourcePortWrapper,o=n.targetPortWrapper;if(i){var h=s;s=o,o=h}return s!==void 0&&s.offsetY>t.corners.bottom+t.margin.bottom||s===void 0&&e.corners.middleRight.y>t.corners.bottom+t.margin.bottom?e.corners.top>t.corners.bottom?o!==void 0&&e.corners.right+e.margin.right<o.offsetX||o===void 0&&e.corners.right+e.margin.right<t.corners.bottomCenter.x?a=q.Two:a=q.Four:o!==void 0&&e.corners.left>o.offsetX||o===void 0&&e.corners.left>t.corners.bottomCenter.x?a=q.Four:a=q.Two:s!==void 0&&Math.abs(e.corners.right-t.corners.left)<=25&&Math.abs(s.offsetY-t.corners.bottom)<=25?a=q.Two:(e.corners.right<t.corners.left,a=q.Four),a}function bv(n,e,t){var i,r=e.point.x-t.point.x,a=Ri(n);return e.corners.right+a<t.corners.left-a||e.corners.left-a>t.corners.right+a||(n.type!=="Bezier"||t.corners.top-e.corners.bottom<=a*2&&t.corners.top-e.corners.bottom>=5)&&(a=0),e.margin={left:a,right:a,top:a,bottom:a},t.margin={left:a,right:a,top:a,bottom:a},r===0&&e.corners.bottom<t.corners.top?i=q.One:e.corners.bottom+e.margin.bottom<t.corners.top-t.margin.top?i=q.Three:(e.corners.right+e.margin.right<t.corners.left-t.margin.left||e.corners.left-e.margin.left>t.corners.right+t.margin.right,i=q.Five),i}function Ev(n,e,t,i){var r=n.sourcePortWrapper,a=n.targetPortWrapper,s=Ri(n);t.margin={left:s,right:s,top:s,bottom:s},e.margin={top:s,bottom:s,left:s,right:s};var o;if(i){var h=r;r=a,a=h}return r!==void 0&&r.offsetX<t.corners.left-t.margin.left||r===void 0&&e.corners.bottomCenter.x<t.corners.bottomLeft.x-t.margin.left?e.corners.right<t.corners.left?a!==void 0&&e.corners.bottom+e.margin.bottom<a.offsetY||a===void 0&&e.corners.bottom+e.margin.bottom<t.corners.middleLeft.y?o=q.Two:o=q.Four:a!==void 0&&e.corners.top>a.offsetY||a===void 0&&e.corners.top>t.corners.middleLeft.y?o=q.Four:o=q.Two:a!==void 0&&Math.abs(e.corners.right-t.corners.left)<=25&&Math.abs(a.offsetY-e.corners.bottom)<=25?o=q.Two:o=q.Four,o}function Dv(n,e,t){var i=n.sourcePortWrapper,r=n.targetPortWrapper,a=Math.round(Math.abs(e.point.x-t.point.x)),s=Math.round(Math.abs(t.point.y-t.point.y)),o;return e.corners.bottom<t.corners.bottom?i!==void 0&&i.offsetX<t.corners.left-t.margin.left||i===void 0&&e.corners.bottomCenter.x<t.corners.left-t.margin.left||i!==void 0&&i.offsetX>t.corners.right+t.margin.right||i===void 0&&e.corners.bottomCenter.x>t.corners.right+t.margin.right?o=q.Three:e.corners.bottom<t.corners.top?o=q.Five:a===0||s===0?o=q.One:o=q.Three:r!==void 0&&e.corners.left-e.margin.left>r.offsetX||r===void 0&&e.corners.left>t.corners.left||r!==void 0&&e.corners.right+e.margin.right<r.offsetX||r===void 0&&e.corners.right<t.corners.right?o=q.Three:e.corners.top>t.corners.bottom?o=q.Five:a===0||s===0?o=q.One:o=q.Three,o}function Lv(n,e,t,i){var r,a=n.sourcePortWrapper,s=Ri(n);t.margin={left:s,right:s,top:s,bottom:s},e.margin={top:s,bottom:s,left:s,right:s};var o=n.targetPortWrapper,h={x:Math.min(e.point.x,e.corners.left),y:e.point.y},l={x:t.point.x,y:Math.min(t.point.y,t.corners.top)};if(i){var d=a;a=o,o=d;var f=h;h=l,l=f}return a!==void 0&&a.offsetY<t.corners.top-t.margin.top||a===void 0&&(e.corners.bottom<t.corners.top-t.margin.top||e.corners.middleLeft.y<t.corners.top-t.margin.top)?e.corners.bottom<t.corners.top?o!==void 0&&e.corners.left-e.margin.left>o.offsetX||o===void 0&&e.corners.left-e.margin.left>t.corners.topCenter.x?r=q.Two:r=q.Four:o!==void 0&&e.corners.right<o.offsetX||o===void 0&&e.corners.right<t.corners.topCenter.x?r=q.Four:r=q.Two:a!==void 0&&Math.abs(e.corners.left-t.corners.right)<=25&&Math.abs(a.offsetY-t.corners.top)<=25||n.sourceWrapper!==n.targetWrapper&&(se(n.sourceWrapper).containsPoint(l)||se(n.targetWrapper).containsPoint(h))?r=q.Two:(e.corners.left>t.corners.right,r=q.Four),r}function Mv(n,e,t){var i=n.sourcePortWrapper,r=n.targetPortWrapper,a=Ri(n);e.margin={left:a,right:a,top:a,bottom:a},t.margin={left:a,right:a,top:a,bottom:a};var s=Math.round(Math.abs(e.point.x-t.point.x)),o=Math.round(Math.abs(e.point.y-t.point.y)),h;return e.corners.left<t.corners.left?r!==void 0&&e.corners.bottom+e.margin.bottom<r.offsetY||r===void 0&&e.corners.bottom+e.margin.bottom<t.corners.middleLeft.y||r!==void 0&&e.corners.top-e.margin.top>r.offsetY||r===void 0&&e.corners.top-e.margin.top>t.corners.middleLeft.y?h=q.Three:e.corners.right<t.corners.left||t.corners.right<e.corners.left?h=q.Five:s===0||o===0?h=q.One:h=q.Three:i!==void 0&&i.offsetY<t.corners.top-t.margin.top||i===void 0&&e.corners.middleLeft.y<t.corners.top||i!==void 0&&i.offsetY>t.corners.bottom+t.margin.bottom||i===void 0&&e.corners.middleLeft.y>t.corners.bottom+t.margin.bottom?h=q.Three:e.corners.left>t.corners.right?h=q.Five:s===0||o===0?h=q.One:h=q.Three,h}function zv(n,e,t){var i=n.sourcePortWrapper,r=n.targetPortWrapper,a=Math.round(Math.abs(e.point.x-t.point.x)),s=Math.round(Math.abs(e.point.y-t.point.y)),o=Ri(n);t.margin={left:o,right:o,top:o,bottom:o},e.margin={top:o,bottom:o,left:o,right:o};var h;return e.corners.top<t.corners.top?r!==void 0&&e.corners.left-e.margin.left>r.offsetX||r===void 0&&e.corners.left>t.corners.left||r!==void 0&&e.corners.right+e.margin.right<r.offsetX||r===void 0&&e.corners.right<t.corners.right?h=q.Three:e.corners.bottom<t.corners.top?h=q.Five:a===0||s===0?h=q.One:h=q.Three:i!==void 0&&i.offsetX>t.corners.right+t.margin.right||i===void 0&&e.corners.left>t.corners.right||i!==void 0&&i.offsetX<t.corners.left-t.margin.left||i===void 0&&e.corners.bottomRight.x<t.corners.left?h=q.Three:e.corners.top>t.corners.bottom?h=q.Five:a===0||s===0?h=q.One:h=q.Three,h}function kv(n,e,t,i,r,a){var s=n.sourceWrapper,o=n.targetWrapper,h,l=s.corners,d=o.corners,f,p=20,c={corners:t.corners,point:t.point,direction:t.direction,margin:t.margin},u={corners:i.corners,point:i.point,direction:i.direction,margin:i.margin};if((c.direction!==u.direction||e===q.Five)&&(c.direction===de(u.direction)||e===q.Three))switch(c.direction){case"Left":l.middleLeft.x>d.middleRight.x&&(f=(l.middleLeft.x-d.middleRight.x)/2,p=a?f:Math.min(p,f));break;case"Right":l.middleRight.x<d.middleLeft.x&&(f=(d.middleLeft.x-l.middleRight.x)/2,p=a?f:Math.min(p,f));break;case"Top":l.topCenter.y>d.bottomCenter.y&&(f=(l.topCenter.y-d.bottomCenter.y)/2,p=a?f:Math.min(p,f));break;case"Bottom":l.bottomCenter.y<d.topCenter.y&&(f=(d.topCenter.y-l.bottomCenter.y)/2,p=a?f:Math.min(p,f));break}p=Bd(l,c,p);var g=n.type==="Bezier";if(e===q.One&&(h=[c.point,u.point]),e===q.Two&&(h=Gi(c,u)),e===q.Three&&(h=Ne(n,c,u,p,void 0,g)),e===q.Four){var v=void 0;h=Na(c,u,v,h,p,g)}return e===q.Five&&(h=Rv(c,u,p,g)),h}function Bd(n,e,t){switch(e.direction){case"Left":e.point.x>n.left&&(t=e.point.x-n.left>t?e.point.x-n.left+t:t);break;case"Right":e.point.x<n.right&&(t=n.right-e.point.x>t?n.right-e.point.x+t:t);break;case"Top":e.point.y>n.top&&(t=e.point.y-n.top>t?e.point.y-n.top+t:t);break;case"Bottom":e.point.y<n.bottom&&(t=n.bottom-e.point.y>t?n.bottom-e.point.y+t:t);break}return t}function Gi(n,e){var t;switch(n.direction){case"Left":case"Right":var i={x:e.point.x,y:n.point.y};t=b.equals(n.point,i)||b.equals(e.point,i)?[n.point,e.point]:[n.point,i,e.point];break;case"Top":case"Bottom":var r={x:n.point.x,y:e.point.y};t=b.equals(n.point,r)||b.equals(e.point,r)?[n.point,e.point]:[n.point,r,e.point];break}return t}function Ne(n,e,t,i,r,a){a===void 0&&(a=!1),i||(i=20),a&&e.direction!==t.direction&&(e.direction==="Left"||e.direction==="Right"?i=Math.floor(Math.abs(e.point.x-t.point.x)*.5):i=Math.floor(Math.abs(e.point.y-t.point.y)*.5));var s=n.sourcePortWrapper,o,h,l,d=t.point.x-e.point.x,f=t.point.y-e.point.y,p;if(!r&&(Math.abs(d)<.001||Math.abs(f)<.001)&&t.direction===void 0)return o=[e.point,t.point],o;if(n.targetWrapper===void 0&&Math.abs(d)<=31&&Math.abs(f)<=31){if(e.direction==="Left"||e.direction==="Right"?Math.abs(f)<12&&(e.direction=e.point.y>t.point.y?"Top":"Bottom"):Math.abs(d)<12&&(e.direction=e.point.x>t.point.x?"Left":"Right"),Math.abs(d)>12||Math.abs(f)>12)return Gi(e,t);i+=5}return e.direction==="Left"||e.direction==="Right"?(e.direction==="Right"?(t.direction!==void 0&&t.direction==="Right"&&(i=Math.max(e.point.x,t.point.x)-e.point.x+i),e.point.x>t.point.x&&s===void 0&&(i=-i)):(t.direction!==void 0&&t.direction==="Left"&&(i=e.point.x-Math.min(e.point.x,t.point.x)+i),(e.point.x>t.point.x||s!==void 0||e.direction==="Left")&&(i=-i)),p=t.point.y-e.point.y,h=ue(e.point,i,0),p=t.point.y-h.y,p!==0&&(l=ue(h,t.point.y-h.y,90))):(e.direction==="Top"||e.direction==="Bottom")&&(e.direction==="Bottom"?t.direction!==void 0&&t.direction==="Bottom"&&(i=Math.max(e.point.y,t.point.y)-e.point.y+i):(t.direction!==void 0&&t.direction==="Top"&&(i=e.point.y-Math.min(e.point.y,t.point.y)+i),(e.point.y>t.point.y||s!==void 0||e.direction==="Top")&&(i=-i)),p=t.point.x-e.point.x,e.direction,h=ue(e.point,i,90),p=t.point.x-h.x,p!==0&&(l=ue(h,t.point.x-h.x,0))),p===0?o=[e.point,t.point]:(o=[e.point,h,l,t.point],o)}function Rv(n,e,t,i){t===void 0&&(t=20),i===void 0&&(i=!1),i&&(t=20);var r,a=t,s=n.corners.left-n.margin.left,o=n.corners.right+n.margin.right,h=n.corners.bottom+n.margin.bottom,l=n.corners.top-n.margin.top,d=e.corners.left-e.margin.left,f=e.corners.right+e.margin.right,p=e.corners.bottom+e.margin.bottom,c=e.corners.top-e.margin.top,u;switch(n.direction){case"Left":(l>c&&l<p||h<p&&h>c)&&s>d&&s<=f&&t>=20&&(a=n.point.x-e.corners.left+a),i&&n.direction===e.direction&&n.corners.left>e.corners.left&&n.corners.left-e.corners.right>=20&&(a=(n.corners.left-e.corners.right)/2),u=ue(n.point,a,180);break;case"Top":(s>d&&s<f||o<f&&o>d)&&l>c&&l<=p&&t>=20&&(a=n.point.y-e.corners.top+a),i&&n.direction===e.direction&&n.corners.top>e.corners.top&&n.corners.top-e.corners.bottom>=20&&(a=(n.corners.top-e.corners.bottom)/2),u=ue(n.point,a,270);break;case"Right":(l>c&&l<p||h<p&&h>c)&&o<f&&o>=d&&t>=20&&(a=e.corners.right-n.point.x+a),i&&n.direction===e.direction&&n.corners.right<e.corners.right&&e.corners.left-n.corners.right>=20&&(a=(e.corners.left-n.corners.right)/2),u=ue(n.point,a,0);break;case"Bottom":(s>d&&s<f||o<f&&o>d)&&h<p&&h>=c&&t>=20&&(a=e.corners.bottom-n.point.y+a),i&&n.direction===e.direction&&n.corners.bottom<e.corners.bottom&&e.corners.top-n.corners.bottom>=20&&(a=(e.corners.top-n.corners.bottom)/2),u=ue(n.point,a,90);break}r=[n.point,u];var g=void 0;if(n.direction==="Top"||n.direction==="Bottom"){var v=n.direction;n.direction=u.x>e.point.x?"Left":"Right",n.point=u,g=i?Math.abs(u.x-e.point.x)*.5:g,r=Na(n,e,v,r,g,i)}else{var v=n.direction;n.direction=u.y>e.point.y?"Top":"Bottom",n.point=u,g=i?Math.abs(u.y-e.point.y)*.5:g,r=Na(n,e,v,r,g,i)}return r}function Na(n,e,t,i,r,a){r===void 0&&(r=20),a===void 0&&(a=!1);var s;switch(t===void 0?(n.margin={left:2,right:2,top:2,bottom:2},e.margin={left:0,right:5,top:0,bottom:5},a&&(n.margin={left:10,right:10,top:10,bottom:10},e.margin={left:10,right:10,top:10,bottom:10},n.direction==="Left"?(r=Ns(n,e,t,r),n.corners.left-e.corners.right>=5&&(r=Math.abs(n.point.x-n.corners.left)+Math.floor(n.corners.left-e.corners.right)*.5)):n.direction==="Right"?(r=Xs(n,e,r,t),e.corners.left-n.corners.right>=5&&(r=Math.abs(n.point.x-n.corners.right)+Math.floor(e.corners.left-n.corners.right)*.5)):n.direction==="Top"?(r=Ws(n,e,t,r),n.corners.top-e.corners.bottom>=5&&(r=Math.abs(n.point.y-n.corners.top)+Math.floor(n.corners.top-e.corners.bottom)*.5)):n.direction==="Bottom"&&(r=Ys(n,e,r,t),e.corners.top-n.corners.bottom>=5&&(r=Math.abs(n.point.y-n.corners.bottom)+Math.floor(e.corners.top-n.corners.bottom)*.5)))):(n.direction==="Bottom"?a?e.corners.top-n.corners.bottom<20&&(r=e.corners.bottom-n.point.y+25):e.corners.top>n.corners.bottom&&e.corners.top-n.corners.bottom<20&&(r=(e.corners.top-n.corners.bottom)/2):n.direction==="Top"?a?n.corners.top-e.corners.bottom<20&&(r=n.point.y-e.corners.top+25):e.corners.bottom<n.corners.top&&n.corners.top-e.corners.bottom<20&&(r=(n.corners.top-e.corners.bottom)/2):n.direction==="Right"?a?e.corners.left-n.corners.right<20&&(r=e.corners.right-n.point.x+25):e.corners.left>n.corners.right&&e.corners.left-n.corners.right<20&&(r=(e.corners.left-n.corners.right)/2):n.direction==="Left"&&(a?n.corners.left-e.corners.right<20&&(r=n.point.x-e.corners.left+25):e.corners.right<n.corners.left&&n.corners.left-e.corners.right<20&&(r=(n.corners.left-e.corners.right)/2)),t===e.direction&&a&&(e.direction==="Bottom"&&n.point.y>e.point.y||e.direction==="Top"&&n.point.y<e.point.y?n.direction==="Left"?r=Ns(n,e,t,20):n.direction==="Right"&&(r=Xs(n,e,20,t)):(e.direction==="Right"&&n.point.x>e.point.x||e.direction==="Left"&&n.point.x<e.point.x)&&(n.direction==="Top"?r=Ws(n,e,t,20):n.direction==="Bottom"&&(r=Ys(n,e,20,t))))),n.direction){case"Left":r=a?r:Ns(n,e,t,r),s=ue(n.point,r,180);break;case"Right":r=a?r:Xs(n,e,r,t),s=ue(n.point,r,0);break;case"Top":r=a?r:Ws(n,e,t,r),s=ue(n.point,r,270);break;case"Bottom":r=a?r:Ys(n,e,r,t),s=ue(n.point,r,90)}return i!==void 0?i.push(s):i=[n.point,s],n.direction==="Top"||n.direction==="Bottom"?Zh(s,"horizontal",n,e,i,a):(n.direction==="Right"||n.direction==="Left")&&Zh(s,"vertical",n,e,i,a),i}function Zh(n,e,t,i,r,a){var s,o,h;e==="horizontal"?(t.margin={left:0,right:10,top:0,bottom:10},i.margin={left:0,right:10,top:0,bottom:10}):e==="vertical"&&(t.margin={left:10,right:0,top:10,bottom:0},i.margin={left:10,right:0,top:10,bottom:0});var l=20;if(e==="horizontal"){switch(i.direction){case"Left":if(t.corners.right+t.margin.right<i.corners.left-i.margin.left&&(i.corners.left-t.margin.right-t.corners.right>l||t.corners.top-t.margin.top<=i.point.y&&t.corners.bottom+t.margin.bottom>=i.point.y))if(a&&(t.direction==="Top"||t.direction==="Bottom")){var d=Math.abs(i.corners.left-t.corners.right)/2;l=t.corners.right-n.x+d}else{var d=Math.min(Math.abs(i.corners.left-t.corners.right)/2,20);l=t.corners.right-n.x+d}else t.direction==="Top"&&n.y>i.point.y||t.direction==="Bottom"&&n.y<i.point.y?l=Math.min(i.corners.left,n.x)-n.x-20:n.x>=t.corners.left-t.margin.left&&n.x<=t.corners.right+t.margin.right?l=Math.min(i.corners.left,t.corners.left)-n.x-20:l=i.corners.left-n.x-20;break;case"Right":if(t.corners.left-t.margin.left>i.corners.right+i.margin.right&&(t.corners.left-t.margin.right-i.corners.right>l||t.corners.top-t.margin.top<=i.point.y&&t.corners.bottom+t.margin.bottom>=i.point.y))if(a&&(t.direction==="Top"||t.direction==="Bottom")){var d=Math.abs(t.corners.left-i.corners.right)/2;l=t.corners.left-n.x-d}else{var d=Math.min(Math.abs(t.corners.left-i.corners.right)/2,20);l=t.corners.left-n.x-d}else t.direction==="Top"&&n.y>i.point.y||t.direction==="Bottom"&&n.y<i.point.y?l=Math.max(i.corners.right,n.x)-n.x+20:n.x>=t.corners.left-t.margin.left&&n.x<=t.corners.right+t.margin.right?l=Math.max(i.corners.right,t.corners.right)-n.x+20:l=i.corners.right-n.x+20;break}s=ue(n,l,0),o=ue(s,i.point.y-n.y,90),h=i.point}else if(e==="vertical"){switch(i.direction){case"Top":if(t.corners.bottom+t.margin.bottom<i.corners.top-i.margin.top&&(i.corners.top-t.margin.top-t.corners.bottom>l||t.corners.left-t.margin.left<=i.point.x&&t.corners.right+t.margin.right>=i.point.x))if(a&&(t.direction==="Right"||t.direction==="Left")){var d=Math.abs(i.corners.top-t.corners.bottom)/2;l=t.corners.bottom-n.y+d}else{var d=Math.min(Math.abs(i.corners.top-t.corners.bottom)/2,20);l=t.corners.bottom-n.y+d}else t.direction==="Left"&&n.x>i.point.x||t.direction==="Right"&&n.x<i.point.x?l=Math.min(i.corners.top,n.y)-n.y-20:n.y>=t.corners.top-t.margin.top&&n.y<=t.corners.bottom+t.margin.bottom?l=Math.min(i.corners.top,t.corners.top)-n.y-20:l=i.corners.top-n.y-20;break;case"Bottom":if(t.corners.top-t.margin.top>i.corners.bottom+i.margin.bottom&&(t.corners.top-t.margin.top-i.corners.bottom>l||t.corners.left-t.margin.left<=i.point.x&&t.corners.right+t.margin.right>=i.point.x))if(a&&(t.direction==="Right"||t.direction==="Left")){var d=Math.abs(t.corners.top-i.corners.bottom)/2;l=t.corners.top-n.y-d}else{var d=Math.min(Math.abs(t.corners.top-i.corners.bottom)/2,20);l=t.corners.top-n.y-d}else t.direction==="Left"&&n.x>i.point.x||t.direction==="Right"&&n.x<i.point.x?l=Math.max(i.corners.bottom,n.y)-n.y+20:n.y>=t.corners.top-t.margin.top&&n.y<=t.corners.bottom+t.margin.bottom?l=Math.max(i.corners.bottom,t.corners.bottom)-n.y+20:l=i.corners.bottom-n.y+20;break}s=ue(n,l,90),o=ue(s,i.point.x-n.x,0),h=i.point}r.push(s),r.push(o),r.push(h)}function Ws(n,e,t,i){return n.corners.top-n.margin.top>e.corners.top+e.margin.top&&n.corners.top-n.margin.top<=e.corners.bottom+e.margin.bottom?((e.direction==="Right"&&n.point.x<e.point.x||e.direction==="Left"&&n.point.x>e.point.x)&&(i+=n.corners.top-e.corners.top),i+=n.point.y-n.corners.top):t!==void 0&&t!=="Left"&&e.direction==="Right"&&n.point.x<e.point.x||t!==void 0&&t!=="Right"&&e.direction==="Left"&&e.point.x<n.point.x?i+=Math.abs(n.point.y-e.corners.bottom):i+=n.point.y-n.corners.top,i}function Ns(n,e,t,i){return n.corners.left-n.margin.left>e.corners.left-e.margin.left&&n.corners.left-n.margin.left<=e.corners.right+e.margin.right?((e.direction==="Bottom"&&n.point.y<e.point.y||e.direction==="Top"&&n.point.y>e.point.y)&&(i+=n.corners.left-e.corners.left),i+=n.point.x-n.corners.left):t!==void 0&&t!=="Top"&&e.direction==="Bottom"&&n.point.y<e.point.y||t!==void 0&&t!=="Bottom"&&e.direction==="Top"&&e.point.y<n.point.y?i+=Math.abs(n.point.x-e.corners.right):i+=n.point.x-n.corners.left,i}function Xs(n,e,t,i){return n.corners.right+n.margin.right<e.corners.right+e.margin.right&&n.corners.right+n.margin.right>=e.corners.left-e.margin.left?((e.direction==="Bottom"&&n.point.y<e.point.y||e.direction==="Top"&&n.point.y>e.point.y)&&(t+=e.corners.right-n.corners.right),t+=n.corners.right-n.point.x):i!==void 0&&i!=="Top"&&e.direction==="Bottom"&&n.point.y<e.point.y||i!==void 0&&i!=="Bottom"&&e.direction==="Top"&&e.point.y<n.point.y?t+=Math.abs(n.point.x-e.corners.right):t+=n.corners.right-n.point.x,t}function Ys(n,e,t,i){return n.corners.bottom+n.margin.bottom<e.corners.bottom+e.margin.bottom&&n.corners.bottom+n.margin.bottom>=e.corners.top-e.margin.top?((e.direction==="Right"&&n.point.x<e.point.x||e.direction==="Left"&&n.point.x>e.point.x)&&(t+=e.corners.bottom-n.corners.bottom),t+=n.corners.bottom-n.point.y):i!==void 0&&i!=="Left"&&e.direction==="Right"&&n.point.x<e.point.x||i!==void 0&&i!=="Right"&&e.direction==="Left"&&e.point.x<n.point.x?t+=Math.abs(n.point.y-e.corners.bottom):t+=n.corners.bottom-n.point.y,t}function Hv(n,e,t){if(n.type==="Bezier")if(n.segments.length===0){var i=t[0],r=t[t.length-1];if(e===q.One){var a=Math.min(20,b.findLength(i,r)*.5),s={angle:At(i,r),distance:a},o={angle:At(r,i),distance:a},h=b.direction(i,r),l=h==="Left"||h==="Right"?"Horizontal":"Vertical",d=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:s,vector2:o,orientation:l},!0);n.segments.push(d)}else if(e===q.Two){var f=t[1],s={angle:At(i,f),distance:b.findLength(i,f)*.5},o={angle:At(r,f),distance:b.findLength(r,f)*.5},h=b.direction(i,f),l=h==="Left"||h==="Right"?"Horizontal":"Vertical",d=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:s,vector2:o,orientation:l},!0);n.segments.push(d)}else if(e===q.Three){var p=t[1],c=t[t.length-2],f={x:(p.x+c.x)*.5,y:(p.y+c.y)*.5},s={angle:At(i,p),distance:b.findLength(i,p)*.5},o={angle:At(f,p),distance:b.findLength(f,p)*.5},u=b.direction(i,p),g=u==="Left"||u==="Right"?"Horizontal":"Vertical",v=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:s,vector2:o,point:f,orientation:g},!0);n.segments.push(v);var m={angle:At(f,c),distance:b.findLength(f,c)*.5},y={angle:At(r,c),distance:b.findLength(r,c)*.5},S=b.direction(f,c),x=S==="Left"||S==="Right"?"Horizontal":"Vertical",I=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:m,vector2:y,orientation:x},!0);n.segments.push(I)}else if(e===q.Four){var p=t[1],c=t[2],C=t[3],P={x:(p.x+c.x)*.5,y:(p.y+c.y)*.5},A={x:(c.x+C.x)*.5,y:(c.y+C.y)*.5},s={angle:At(i,p),distance:b.findLength(i,p)*.5},o={angle:At(P,p),distance:b.findLength(P,p)*.5},u=b.direction(i,p),g=u==="Left"||u==="Right"?"Horizontal":"Vertical",v=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:s,vector2:o,point:P,orientation:g},!0);n.segments.push(v);var m={angle:At(P,c),distance:b.findLength(P,c)*.5},y={angle:At(A,c),distance:b.findLength(A,c)*.5},S=b.direction(P,c),x=S==="Left"||S==="Right"?"Horizontal":"Vertical",I=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:m,vector2:y,point:A,orientation:x},!0);n.segments.push(I);var T={angle:At(A,C),distance:b.findLength(A,C)*.5},z={angle:At(r,C),distance:b.findLength(r,C)*.5},L=b.direction(A,C),R=L==="Left"||L==="Right"?"Horizontal":"Vertical",O=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:T,vector2:z,orientation:R},!0);n.segments.push(O)}else if(e===q.Five){var p=t[1],c=t[2],C=t[3],N=t[4],P={x:(p.x+c.x)*.5,y:(p.y+c.y)*.5},A={x:(c.x+C.x)*.5,y:(c.y+C.y)*.5},H={x:(C.x+N.x)*.5,y:(C.y+N.y)*.5},s={angle:At(i,p),distance:b.findLength(i,p)*.5},o={angle:At(P,p),distance:b.findLength(P,p)*.5},u=b.direction(i,p),g=u==="Left"||u==="Right"?"Horizontal":"Vertical",v=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:s,vector2:o,point:P,orientation:g},!0);n.segments.push(v);var m={angle:At(P,c),distance:b.findLength(P,c)*.5},y={angle:At(A,c),distance:b.findLength(A,c)*.5},S=b.direction(P,c),x=S==="Left"||S==="Right"?"Horizontal":"Vertical",I=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:m,vector2:y,point:A,orientation:x},!0);n.segments.push(I);var T={angle:At(A,C),distance:b.findLength(A,C)*.5},z={angle:At(H,C),distance:b.findLength(H,C)*.5},L=b.direction(A,C),R=L==="Left"||L==="Right"?"Horizontal":"Vertical",O=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:T,vector2:z,point:H,orientation:R},!0);n.segments.push(O);var F={angle:At(H,N),distance:b.findLength(H,N)*.5},Y={angle:At(r,N),distance:b.findLength(r,N)*.5},et=b.direction(H,N),at=et==="Left"||et==="Right"?"Horizontal":"Vertical",tt=new Me(n,"segments",{type:"Bezier",isInternalSegment:!0,vector1:F,vector2:Y,orientation:at},!0);n.segments.push(tt)}else{var d=new Me(n,"segments",{type:"Bezier"},!0);n.segments.push(d)}}else for(var nt=0;nt<n.segments.length;nt++)n.bezierSettings.allowSegmentsReset&&(n.segments[parseInt(nt.toString(),10)].isInternalSegment=!0)}function Bv(n,e){var t=!1;switch(n){case"Left":switch(e){case"Right":case"Bottom":t=!0;break}break;case"Top":switch(e){case"Left":case"Right":case"Bottom":t=!0;break}break;case"Bottom":e==="Right"&&(t=!0);break}return t}function $h(n,e){var t=n.direction;n.direction=e.direction,e.direction=t;var i=n.point;n.point=e.point,e.point=i;var r=n.corners;n.corners=e.corners,e.corners=r}function ui(n,e,t,i){var r,a=e===void 0?t:e,s=a.topLeft,o=a.topRight,h=a.bottomRight,l=a.bottomLeft,d=a.center,f=At(d,n),p=At(d,h),c=At(d,l),u=At(d,s),g=At(d,o);return f>u&&f<g?r="Top":f>=p&&f<c?r="Bottom":f>=c&&f<=u?r="Left":(f>=g||f<p,r="Right"),r}function Od(n){var e=n.wrapper.children[0].bounds;return n.sourceDecorator.shape!=="None"&&e.uniteRect(n.wrapper.children[1].bounds),n.targetDecorator.shape!=="None"&&e.uniteRect(n.wrapper.children[2].bounds),e}function de(n){switch(n){case"Top":return"Bottom";case"Bottom":return"Top";case"Left":return"Right";case"Right":return"Left"}return"auto"}var Wd=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),cr=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Xa=(function(n){Wd(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return cr([w()],e.prototype,"width",void 0),cr([w()],e.prototype,"height",void 0),e})(j),Ov=(function(n){Wd(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return cr([w()],e.prototype,"width",void 0),cr([w()],e.prototype,"height",void 0),cr([w()],e.prototype,"fit",void 0),cr([w()],e.prototype,"description",void 0),cr([w()],e.prototype,"template",void 0),cr([w()],e.prototype,"tooltip",void 0),e})(j),Wv=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Bi=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Nd=(function(n){Wv(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Bi([w("")],e.prototype,"id",void 0),Bi([w(Number.MIN_VALUE)],e.prototype,"zIndex",void 0),Bi([X({},Ie)],e.prototype,"margin",void 0),Bi([w(!0)],e.prototype,"visible",void 0),Bi([X({},Gr)],e.prototype,"tooltip",void 0),Bi([w(!1)],e.prototype,"excludeFromLayout",void 0),Bi([w()],e.prototype,"addInfo",void 0),Bi([w(G.None)],e.prototype,"flip",void 0),Bi([w("All")],e.prototype,"flipMode",void 0),Bi([X({},Ov)],e.prototype,"symbolInfo",void 0),e})(j),Nv=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),we=(function(n){Nv(e,n);function e(t,i,r,a){var s=n.call(this)||this;return s.data="",s.nodeId="",s.annotationId="",s.diagramId="",s.diagramId=i,s.nodeId=t,s.annotationId=r,s.templateFn=Eo(a),s}return e.prototype.getNodeTemplate=function(){return this.templateFn},Object.defineProperty(e.prototype,"content",{get:function(){return this.data},set:function(t){this.data=t,this.canReset||(this.canReset=!0,this.isTemplate||(this.template=Ai(this,!0)),this.canReset=!1,this.isDirt=!0)},enumerable:!0,configurable:!0}),e})(Be),Vo=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Pe=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Xd=(function(n){Vo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Pe([w("")],e.prototype,"id",void 0),Pe([w("transparent")],e.prototype,"fill",void 0),Pe([w("black")],e.prototype,"iconStrokeColor",void 0),Pe([w(0)],e.prototype,"iconStrokeWidth",void 0),Pe([w(!0)],e.prototype,"visibility",void 0),Pe([w(10)],e.prototype,"width",void 0),Pe([w(10)],e.prototype,"height",void 0),Pe([w("transparent")],e.prototype,"handleStrokeColor",void 0),Pe([w(1)],e.prototype,"handleStrokeWidth",void 0),Pe([w("")],e.prototype,"pathData",void 0),Pe([w(0)],e.prototype,"cornerRadius",void 0),Pe([X({left:0,right:0,top:0,bottom:0},Ie)],e.prototype,"padding",void 0),Pe([X({},Gr)],e.prototype,"tooltip",void 0),e})(j),Go=(function(n){Vo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Pe([X({x:0,y:0},b)],e.prototype,"offset",void 0),Pe([X({},Ie)],e.prototype,"margin",void 0),e})(Xd),Xn=(function(n){Vo(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Pe([w(.5)],e.prototype,"offset",void 0),Pe([w("Center")],e.prototype,"alignment",void 0),Pe([X({x:0,y:0},b)],e.prototype,"displacement",void 0),e})(Xd);function Wr(n){if(n){var e=0;return n instanceof ae||n instanceof Qt?e=n.constraints&He.Select:n instanceof B?e=n.constraints&yt.Select:e=n.constraints&W.Select,e}return 1}function Qe(n){if(n){var e=0;return n instanceof ae||n instanceof Qt?e=n.constraints&He.Drag:n instanceof B?e=n.constraints&yt.Drag:n instanceof It?e=1:e=n.constraints&W.Drag,e}return 1}function Xv(n,e){var t=0;return n instanceof B?t=n.constraints&yt.PointerEvents:t=n.constraints&W.PointerEvents,t}function ha(n){var e=0;return n instanceof B?e=n.constraints&yt.Delete:e=n.constraints&W.Delete,e}function Yv(n,e){var t=0;return n.constraints&yt.LineRouting?t=n.constraints&yt.LineRouting:n.constraints&yt.InheritLineRouting&&(t=e.constraints&lt.LineRouting),t}function Ya(n){return n.constraints&yt.DragSourceEnd}function Ua(n){return n.constraints&yt.DragTargetEnd}function Fa(n){return n.constraints&yt.DragSegmentThumb}function Va(n){return n instanceof ae||n instanceof Qt?n.constraints&He.Rotate:n.constraints&W.Rotate}function Ia(n){return n.constraints&W.Shadow}function ii(n){return n instanceof M&&n.constraints&W.InConnect?n.constraints&W.InConnect:0}function Li(n){return n&&n.constraints&&!(n.constraints&Ct.None)&&n.constraints&Ct.InConnect?n.constraints&Ct.InConnect:0}function Di(n){return n instanceof M&&n.constraints&W.OutConnect?n.constraints&W.OutConnect:0}function ar(n){return n&&n.constraints&&!(n.constraints&Ct.None)&&n.constraints&Ct.OutConnect?n.constraints&Ct.OutConnect:0}function Wi(n,e){var t=0;return n instanceof ae||n instanceof Qt?t=n.constraints&He.Resize:n&&(e==="SouthEast"?t=n.constraints&W.ResizeSouthEast:e==="East"?t=n.constraints&W.ResizeEast:e==="NorthEast"?t=n.constraints&W.ResizeNorthEast:e==="South"?t=n.constraints&W.ResizeSouth:e==="North"?t=n.constraints&W.ResizeNorth:e==="SouthWest"?t=n.constraints&W.ResizeSouthWest:e==="West"?t=n.constraints&W.ResizeWest:e==="NorthWest"&&(t=n.constraints&W.ResizeNorthWest)),t}function Ga(n){var e=0;return n instanceof B?e=n.constraints&yt.AllowDrop:e=n.constraints&W.AllowDrop,e}function Le(n){return n.constraints&lt.Virtualization}function Uv(n,e){var t=0;return n instanceof B?n.constraints&yt.Tooltip?t=n.constraints&yt.Tooltip:n.constraints&yt.InheritTooltip&&(t=e.constraints&lt.Tooltip):n instanceof Se||n instanceof ke?n.constraints&Ct.ToolTip?t=n.constraints&Ct.ToolTip:n.constraints&Ct.InheritTooltip&&(t=e.constraints&lt.Tooltip):n instanceof ae||n instanceof Qt?n.constraints&He.Tooltip&&(t=n.constraints&He.Tooltip):n.constraints&W.Tooltip?t=n.constraints&W.Tooltip:n.constraints&W.InheritTooltip&&(t=e.constraints&lt.Tooltip),t}function Yn(n){return n.tool&Gt.SingleSelect}function Un(n){return n.tool&Gt.MultipleSelect}function vr(n){return n.tool&Gt.ZoomPan}function ds(n){return n.tool&Gt.ContinuousDraw}function Yd(n){return n.tool&Gt.DrawOnce}function xa(n){return n.tool&Gt.SingleSelect||n.tool&Gt.MultipleSelect}function Fv(n){return n.constraints&lt.Zoom}function Vv(n){return n.constraints&lt.Pan}function mn(n){return n.constraints&lt.UserInteraction}function Gv(n){return n.constraints&lt.ApiUpdate}function Zv(n){return n.constraints&lt.PanX}function $v(n){return n.constraints&lt.PanY}function Ud(n){return n.constraints&lt.ZoomTextEdit}function yn(n){return Gv(n)||n.diagramActions&k.ToolAction}function qv(n,e){var t=0;return t=e instanceof B?yt.ReadOnly:W.ReadOnly,e.shape.type==="Text"?e.constraints&W.ReadOnly:e.constraints&t?n.constraints&He.InheritReadOnly?1:0:n.constraints&He.ReadOnly?1:0}function fo(n,e){return n.constraints&Ct.Draw}function Zo(n,e){return n.constraints&Ct.Drag}function Qv(n){return!!(n&k.PreventClearSelection)}function Za(n){return!(n&fi.DrawSelectorBorder)}function qh(n){return!!(n&fi.PreventRenderSelector)}var $o=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Fn=(function(n){$o(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.childTable=[],t.cellStyle={},t.desiredRowHeight=[],t.desiredCellWidth=[],t}return e.prototype.rowDefinitions=function(){return this.rowDefns},e.prototype.columnDefinitions=function(){return this.colDefns},e.prototype.addObject=function(t,i,r,a,s){if(this.rows.length>=i){var o=this.rows[parseInt(i.toString(),10)];if(o.cells.length>r){s=s||1,a=a||1;var h=o.cells[parseInt(r.toString(),10)];h.columnSpan=Math.max(s,h.columnSpan),h.rowSpan=Math.max(a,h.rowSpan);var l=new Jv;l=t,l.rowId=i,l.columnId=r,l.columnSpan=s,this.childTable[l.id]=l,this.addObjectToCell(l,h)}}},e.prototype.addObjectToCell=function(t,i){i.children||(i.children=[]),t.style.strokeColor="black",t.style.strokeWidth=1,i.children.push(t)},e.prototype.updateProperties=function(t,i,r,a){this.offsetX=t,this.offsetY=i,this.width=r,this.height=a},e.prototype.setDefinitions=function(t,i){this.rowDefns=t,this.colDefns=i,this.children=[],this.rows=this.rows||[];for(var r=0;r<t.length;r++){var a=t[parseInt(r.toString(),10)],s=new Qh;s.cells=[];var o=new Nr;o.width=this.width;var h=this.colDefns;(h===void 0||h.length<1)&&(h=[o]),this.addCellInRow(h,a,s),this.rows.push(s)}},e.prototype.addCellInRow=function(t,i,r){for(var a=0;a<t.length;a++){var s=t[parseInt(a.toString(),10)],o=new Jh;o.children=[],this.cellStyle.fill="none",this.cellStyle.strokeColor="none",o.id=K(),o.style=this.cellStyle,o.desiredCellWidth=o.minWidth=s.width,o.desiredCellHeight=o.minHeight=i.height,r.cells.push(o),this.children.push(o)}},e.prototype.calculateSize=function(){for(var t=this.rows||[],i=0,r=0,a=0;a<t.length;a++){var s=this.rows[parseInt(a.toString(),10)];r=0;for(var o=0;o<s.cells.length;o++)if(r+=s.cells[parseInt(o.toString(),10)].desiredCellWidth,o===s.cells.length-1&&(this.width&&this.width!==r&&(s.cells[parseInt(o.toString(),10)].desiredCellWidth+=this.width-r,s.cells[parseInt(o.toString(),10)].minWidth=s.cells[parseInt(o.toString(),10)].desiredCellWidth,s.cells[parseInt(o.toString(),10)].children&&s.cells[parseInt(o.toString(),10)].children.length&&(s.cells[parseInt(o.toString(),10)].children[0].width=s.cells[parseInt(o.toString(),10)].desiredCellWidth),this.colDefns[parseInt(o.toString(),10)].width=s.cells[parseInt(o.toString(),10)].desiredCellWidth),i+=s.cells[parseInt(o.toString(),10)].desiredCellHeight,a===t.length-1&&this.height&&this.height!==i)){var h=this.height-i;if(h>0){for(var l=0;l<s.cells.length;l++)s.cells[parseInt(l.toString(),10)].desiredCellHeight+=h,s.cells[parseInt(l.toString(),10)].minHeight=s.cells[parseInt(l.toString(),10)].desiredCellHeight=s.cells[parseInt(l.toString(),10)].desiredCellHeight,s.cells[parseInt(l.toString(),10)].children&&s.cells[parseInt(l.toString(),10)].children.length&&(s.cells[parseInt(l.toString(),10)].children[0].height=s.cells[parseInt(l.toString(),10)].desiredCellHeight);this.rowDefns[parseInt(a.toString(),10)].height+=h}}}},e.prototype.updateRowHeight=function(t,i,r,a,s){var o=this.rows[parseInt(t.toString(),10)];this.rowDefns[parseInt(t.toString(),10)].height=i,this.height!==void 0&&(this.height+=i-o.cells[0].desiredCellHeight);for(var h=0;h<o.cells.length;h++)o.cells[parseInt(h.toString(),10)].desiredCellHeight=o.cells[parseInt(h.toString(),10)].minHeight=i,o.cells[parseInt(h.toString(),10)].children&&o.cells[parseInt(h.toString(),10)].children.length&&(o.cells[parseInt(h.toString(),10)].children[0].height=i,this.setTextRefresh(o.cells[parseInt(h.toString(),10)].children[0]));if(this.desiredRowHeight[parseInt(t.toString(),10)]=i,this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize),r){var l=a!==void 0?this.calculateCellHeightBasedOnChildren(t,a):this.calculateCellHeight(t);l>i&&!s&&this.updateRowHeight(t,l,!1)}},e.prototype.setTextRefresh=function(t){if(t.children&&t.children.length)for(var i=t.children,r=0;r<i.length;r++)i[parseInt(r.toString(),10)]instanceof Tt&&i[parseInt(r.toString(),10)].refreshTextElement(),i[parseInt(r.toString(),10)]instanceof Ht&&this.setTextRefresh(i[parseInt(r.toString(),10)])},e.prototype.updateColumnWidth=function(t,i,r,a,s){this.colDefns[parseInt(t.toString(),10)].width=i,this.width!==void 0&&(this.width+=i-this.rows[this.rows.length-1].cells[parseInt(t.toString(),10)].desiredCellWidth);for(var o=0;o<this.rows.length;o++)this.setTextRefresh(this.rows[parseInt(o.toString(),10)].cells[0]),this.rows[parseInt(o.toString(),10)].cells[parseInt(t.toString(),10)].desiredCellWidth=this.rows[parseInt(o.toString(),10)].cells[parseInt(t.toString(),10)].minWidth=i,this.rows[parseInt(o.toString(),10)].cells[parseInt(t.toString(),10)].children&&this.rows[parseInt(o.toString(),10)].cells[parseInt(t.toString(),10)].children.length&&(this.rows[parseInt(o.toString(),10)].cells[parseInt(t.toString(),10)].children[0].width=i);if(this.desiredCellWidth[parseInt(t.toString(),10)]=i,this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize),r){var h=a!==void 0?this.calculateCellWidthBasedOnChildren(t,a):this.calculateCellWidth(t);h>i&&!s&&this.updateColumnWidth(t,h,!1)}},e.prototype.calculateCellWidth=function(t){for(var i,r,a,s=0;s<this.rows.length;s++)a=this.rows[parseInt(s.toString(),10)].cells[parseInt(t.toString(),10)],a.columnSpan===1&&(r=a.outerBounds.width>a.bounds.width&&(a.children.length===0||a.children[0].maxWidth===void 0)?a.outerBounds.width:a.bounds.width,i?i=i<r?r:i:i=r);return i},e.prototype.calculateCellHeight=function(t){for(var i,r,a,s=this.rows[parseInt(t.toString(),10)],o=0;o<s.cells.length;o++)a=s.cells[parseInt(o.toString(),10)],r=a.outerBounds.height>a.bounds.height?a.outerBounds.height:a.bounds.height,i?i=i<r?r:i:i=r;return i},e.prototype.calculateCellSizeBasedOnChildren=function(t,i,r,a){var s,o=t&&t.children.length>0?t.children[0]:void 0;if(o&&t.columnSpan===1){s=i==="Width"?o.bounds.right:o.bounds.bottom,a||(a=i==="Width"?o.bounds.width:o.bounds.height);for(var h=0;h<o.children.length;h++){var l=o.children[parseInt(h.toString(),10)];if(l instanceof Ht&&l.id.indexOf("header")===-1){var d=(i==="Width"?l.bounds.right:l.bounds.bottom)+r;if(d>s){var f=d-s+(i==="Width"?o.bounds.width:o.bounds.height);a&&(a=a<f?f:a)}}}}return a},e.prototype.calculateCellWidthBasedOnChildren=function(t,i){for(var r,a,s=0;s<this.rows.length;s++)a=this.rows[parseInt(s.toString(),10)].cells[parseInt(t.toString(),10)],r=this.calculateCellSizeBasedOnChildren(a,"Width",i,r);return r},e.prototype.calculateCellHeightBasedOnChildren=function(t,i){for(var r,a,s=this.rows[parseInt(t.toString(),10)],o=0;o<s.cells.length;o++)a=s.cells[parseInt(o.toString(),10)],r=this.calculateCellSizeBasedOnChildren(a,"Height",i,r);return r},e.prototype.addRow=function(t,i,r){this.rowDefns.length>0?this.rowDefns.splice(t,0,i):this.rowDefns.push(i);var a=new Qh;a.cells=[];var s=new Nr;s.width=this.width;var o=this.colDefns;this.addCellInRow(o,i,a),t>this.rows.length-1?this.rows.push(a):this.rows.splice(t,0,a),r&&(this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize))},e.prototype.addColumn=function(t,i,r){var a,s,o,h,l=this.rows;this.colDefns.length>0?this.colDefns.splice(t,0,i):this.colDefns.push(i),this.width!==void 0&&(this.width+=i.width);for(var d=0;d<l.length;d++)a=l[parseInt(d.toString(),10)],s=this.rowDefns[parseInt(d.toString(),10)],o=i,h=new Jh,h.style=this.cellStyle,h.desiredCellWidth=h.minWidth=o.width,h.desiredCellHeight=h.minHeight=s.height,h.children=[],t>a.cells.length-1?a.cells.push(h):a.cells.splice(t,0,h),this.children.push(h);r&&(this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize))},e.prototype.removeRow=function(t){var i,r,a=this.rows,s=a[parseInt(t.toString(),10)];this.height-=this.rowDefns[parseInt(t.toString(),10)].height;for(var o=0;o<s.cells.length;o++)i=s.cells[parseInt(o.toString(),10)],this.children.splice(this.children.indexOf(i),1),r=document.getElementById(i.id+"_groupElement"),r&&r.parentElement&&r.parentElement.removeChild(r);this.rows.splice(t,1),this.rowDefns.splice(t,1),this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize)},e.prototype.removeColumn=function(t){var i,r,a=this.rows;this.width-=this.colDefns[parseInt(t.toString(),10)].width;for(var s=0;s<a.length;s++)i=a[parseInt(s.toString(),10)].cells[parseInt(t.toString(),10)],this.children.splice(this.children.indexOf(i),1),r=document.getElementById(i.id+"_groupElement"),r&&r.parentElement&&r.parentElement.removeChild(r),a[parseInt(s.toString(),10)].cells.splice(t,1);this.colDefns.splice(t,1),this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize)},e.prototype.updateRowIndex=function(t,i){var r=this.rows[parseInt(t.toString(),10)];this.rows.splice(t,1),this.rows.splice(i,0,r);var a=this.rowDefns[parseInt(t.toString(),10)];this.rowDefns.splice(t,1),this.rowDefns.splice(i,0,a),this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize)},e.prototype.updateColumnIndex=function(t,i,r){for(var a,s,o=t;o<this.rows.length;o++)a=this.rows[parseInt(o.toString(),10)],s=this.rows[parseInt(o.toString(),10)].cells[parseInt(i.toString(),10)],a.cells.splice(i,1),a.cells.splice(r,0,s);var h=this.colDefns[parseInt(i.toString(),10)];this.colDefns.splice(i,1),this.colDefns.splice(r,0,h);var l=this.desiredCellWidth[parseInt(i.toString(),10)];this.desiredCellWidth.splice(i,1),this.desiredCellWidth.splice(r,0,l),this.measure(new U(this.width,this.height)),this.arrange(this.desiredSize)},e.prototype.measure=function(t){var i=void 0;if(this.rows!==void 0&&this.rows.length>0){var r=0,a=0;i=new U(0,0),this.calculateSize();for(var s=0,o=this.rows;s<o.length;s++){var h=o[s];a=0;for(var l=0,d=h.cells;l<d.length;l++){var f=d[l],p=f.measure(new U(f.desiredCellWidth,f.desiredCellHeight));f.rowSpan===1&&(a===0||this.desiredRowHeight[parseInt(r.toString(),10)]===void 0?this.desiredRowHeight[parseInt(r.toString(),10)]=p.height:this.desiredRowHeight[parseInt(r.toString(),10)]=Math.max(p.height,this.desiredRowHeight[parseInt(r.toString(),10)])),f.columnSpan===1&&(r===0||this.desiredCellWidth[parseInt(a.toString(),10)]===void 0?this.desiredCellWidth[parseInt(a.toString(),10)]=p.width:this.desiredCellWidth[parseInt(a.toString(),10)]=Math.max(p.width,this.desiredCellWidth[parseInt(a.toString(),10)]),r===this.rows.length-1&&(i.width+=this.desiredCellWidth[parseInt(a.toString(),10)])),a++}i.height+=this.desiredRowHeight[parseInt(r.toString(),10)],r++}r=a=0;for(var c=0,u=0,g=this.rows;u<g.length;u++){var h=g[u];a=0;for(var v=0,m=0,y=h.cells;m<y.length;m++){var f=y[m];if(f.columnSpan!==1){f.desiredSize.width=0;for(var S=0;S<f.columnSpan;S++)S+a<h.cells.length&&(f.desiredSize.width+=this.desiredCellWidth[S+a],f.minWidth=f.desiredSize.width,f.measure(f.desiredSize));a++}else f.desiredSize.width=this.desiredCellWidth[parseInt(v.toString(),10)],f.measure(f.desiredSize);if(f.rowSpan!==1){f.desiredSize.height=0;for(var S=0;S<f.rowSpan;S++)S+c<this.rows.length&&(f.desiredSize.height+=this.desiredRowHeight[S+c],f.minHeight=f.desiredSize.height,f.measure(f.desiredSize))}else f.desiredSize.height=this.desiredRowHeight[parseInt(c.toString(),10)],f.measure(f.desiredSize);r++,v++}c++}}return i===void 0&&(i=n.prototype.validateDesiredSize.call(this,i,t)),n.prototype.stretchChildren.call(this,i),this.desiredSize=i,i},e.prototype.arrange=function(t,i){var r=0,a=0;if(this.rows!==void 0&&this.rows.length>0){for(var s=this.offsetX-t.width*this.pivot.x,o=this.offsetY-t.height*this.pivot.y,h=s,l=0,d=this.rows;l<d.length;l++){var f=d[l];h=s,r=0;for(var p=0,c=f.cells;p<c.length;p++){var u=c[p],g=Math.max(this.desiredCellWidth[parseInt(r.toString(),10)],u.desiredSize.width),v=Math.max(this.desiredRowHeight[parseInt(a.toString(),10)],u.desiredSize.height);u.offsetX=h+g*u.pivot.x,u.offsetY=o+v*u.pivot.y,h+=this.desiredCellWidth[parseInt(r.toString(),10)],u.arrange(new U(g,v)),r++}o+=this.desiredRowHeight[parseInt(a.toString(),10)],a++}if(i){var u=void 0,f=void 0,m=void 0,y=void 0,S=void 0;for(a=0;a<this.rows.length;a++)for(f=this.rows[parseInt(a.toString(),10)],r=0;r<f.cells.length;r++)if(u=f.cells[parseInt(r.toString(),10)],u.columnSpan>1&&this.children.splice(this.children.indexOf(u)+1,u.columnSpan-1),u.rowSpan>1)for(m=a,y=0;m+u.rowSpan-1<this.rows.length&&y<u.rowSpan-1;m++,y++)S=this.rows[m+1].cells[parseInt(r.toString(),10)],this.children.splice(this.children.indexOf(S),1)}}return this.actualSize=t,this.updateBounds(),t},e})(Je),jn=(function(){function n(){this.height=void 0}return n})(),Nr=(function(){function n(){this.width=void 0}return n})(),Qh=(function(){function n(){this.cells=null}return n})(),Jh=(function(n){$o(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.columnSpan=1,t.rowSpan=1,t}return e})(Ht),Jv=(function(n){$o(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.rowId=0,t.columnId=0,t.rowSpan=1,t.columnSpan=1,t}return e})(Be);function _v(n,e,t){!t.width&&t.shape.phases.length===0&&(t.width=100);var i=[],r=[],a=0,s=t.shape,o=s.orientation==="Horizontal";if(s.header&&s.hasHeader&&En(i,s.header.height),jv(i,o,t),tm(r,o,t),n.setDefinitions(i,r),s.header&&s.hasHeader&&(Kv(n,e,t),a++),s.phases.length>0&&s.phaseSize){for(var h=0;h<s.phases.length;h++)s.phases[parseInt(h.toString(),10)].id===""&&(s.phases[parseInt(h.toString(),10)].id=K()),qo(n,e,t,a,o,h);a++}if(s.lanes.length>0)for(var h=0;h<s.lanes.length;h++)s.lanes[parseInt(h.toString(),10)].id===""&&(s.lanes[parseInt(h.toString(),10)].id=K()),Fd(n,e,t,a,h,o),a++}function Vn(n,e,t,i,r,a,s,o){var h=new M(n,"nodes",i,!0);h.parentId=t.id,h.isHeader=!!r,h.isPhase=!!a,h.isLane=!!s,h.pivot=t.pivot;var l=a?"PhaseHeaderParent":"LaneHeaderParent";if(o&&(h[""+l]=o),h.constraints&=~(W.InConnect|W.OutConnect),h.constraints|=W.HideThumbs,n.initObject(h),n.nodes.push(h),h.wrapper.children.length>0){for(var d=0;d<h.wrapper.children.length;d++){var f=h.wrapper.children[parseInt(d.toString(),10)];f instanceof Be&&(f.isCalculateDesiredSize=!1),f instanceof Tt&&(f.canConsiderBounds=!1,(!r&&t.shape.orientation==="Vertical"&&a||t.shape.orientation!=="Vertical"&&s)&&(f.isLaneOrientation=!0,f.refreshTextElement()))}h.wrapper.measure(new U(void 0,void 0)),h.wrapper.arrange(h.wrapper.desiredSize)}return h.wrapper}function Kv(n,e,t){for(var i=0,r=n.columnDefinitions(),a=t.shape,s=0;s<r.length;s++)i+=r[parseInt(s.toString(),10)].width;a.header.id=a.header.id||K();var o={id:t.id+a.header.id,annotations:[E(a.header.annotation)],style:a.header.style?a.header.style:void 0,offsetX:t.offsetX,offsetY:t.offsetY,rowIndex:0,columnIndex:0,maxWidth:i,pivot:t.pivot,container:{type:"Canvas",orientation:"Horizontal"}};Wr(t)||(o.constraints&=~W.Select);var h=Vn(e,n,t,o,!0);n.addObject(h,0,0,1,n.columnDefinitions().length)}function qo(n,e,t,i,r,a){var s=0,o=0,h,l=t.shape;r?(o=a,s=i,h=n.columnDefinitions()[parseInt(a.toString(),10)].width):s=l.header&&l.hasHeader?a+1:a;var d={annotations:[E(l.phases[parseInt(a.toString(),10)].header.annotation)],maxWidth:h,id:t.id+l.phases[parseInt(a.toString(),10)].id+"_header",addInfo:l.phases[parseInt(a.toString(),10)].addInfo,offsetX:t.offsetX,offsetY:t.offsetY,style:l.phases[parseInt(a.toString(),10)].style,rowIndex:s,columnIndex:o,pivot:t.pivot,container:{type:"Canvas",orientation:r?"Horizontal":"Vertical"}};d[l.orientation==="Horizontal"?"height":"width"]=l.phaseSize,d.annotations[0].rotateAngle=r?0:270,Wr(t)||(d.constraints&=~W.Select),l.phases[parseInt(a.toString(),10)].header.id=d.id;var f=Vn(e,n,t,d,!1,!0,!1,l.phases[parseInt(a.toString(),10)].id);n.addObject(f,s,o)}function Fd(n,e,t,i,r,a){for(var s,o,h,l,d,f=t.shape,p=f.phases.length||1,c=f.header&&f.hasHeader?1:0,u=a?i:c,g=f.phaseSize&&f.phases.length>0?1:0,v=0;v<p;v++){var m=a?v:r+g;if(h=n.rows[parseInt(u.toString(),10)].cells[parseInt(m.toString(),10)],l={id:t.id+f.lanes[parseInt(r.toString(),10)].id+v,rowIndex:u,columnIndex:m,width:h.minWidth,height:h.minHeight,offsetX:t.offsetX,offsetY:t.offsetY,style:f.lanes[parseInt(r.toString(),10)].style,addInfo:f.lanes[parseInt(r.toString(),10)].addInfo,pivot:t.pivot,constraints:W.Default|W.ReadOnly|W.AllowDrop,container:{type:"Canvas",orientation:a?"Horizontal":"Vertical"}},Wr(t)||(l.constraints&=~W.Select),o=Vn(e,n,t,l,!1,!1,!0),f.phases&&f.phases.length>0&&f.phases[parseInt(v.toString(),10)]){var y=e.nameTable[f.phases[parseInt(v.toString(),10)].header.id];y&&y.laneGrids.splice(r,0,l.id)}o.children[0].isCalculateDesiredSize=!1,v===0&&(s={id:t.id+f.lanes[parseInt(r.toString(),10)].id+"_"+v+"_header",style:f.lanes[parseInt(r.toString(),10)].header.style,annotations:[E(f.lanes[parseInt(r.toString(),10)].header.annotation)],offsetX:t.offsetX,offsetY:t.offsetY,rowIndex:u,columnIndex:m,pivot:t.pivot,container:{type:"Canvas",orientation:a?"Horizontal":"Vertical"}},s.annotations[0].rotateAngle=a?270:0,f.lanes[parseInt(r.toString(),10)].header.id=s.id,a?s.width=f.lanes[r].header.width:s.height=f.lanes[parseInt(r.toString(),10)].header.height,Wr(t)||(s.constraints&=~W.Select),d=Vn(e,n,t,s,!1,!1,!0,f.lanes[parseInt(r.toString(),10)].id),a&&(d.children[0].elementActions=d.children[0].elementActions|le.HorizontalLaneHeader),o.children.push(d)),n.addObject(o,u,m),a||u++,m=a?v:r+1}}function En(n,e){var t=new jn;t.height=e,n.push(t)}function Sn(n){var e=new Nr;return e.width=n,e}function jv(n,e,t){var i=0,r,a=t.shape;if(n.length>0)for(var s=0;s<n.length;s++)i+=n[parseInt(s.toString(),10)].height;if(e){if(a.phases.length>0&&a.phaseSize&&(i+=a.phaseSize,En(n,a.phaseSize)),a.lanes.length>0)for(var s=0;s<a.lanes.length;s++)r=a.lanes[parseInt(s.toString(),10)].height,i+=r,s===a.lanes.length-1&&i<t.height&&(r+=t.height-i),En(n,r)}else if(a.phases.length>0)for(var o=0,s=0;s<a.phases.length;s++){var h=a.phases[parseInt(s.toString(),10)].offset;s===0||(h-=o),o+=h,r=h,i+=r,s===a.phases.length-1&&i<t.height&&(r+=t.height-i),En(n,r)}else r=a.lanes[0].height,i+=r,i<t.height&&(r+=t.height-i),En(n,r)}function tm(n,e,t){var i=0,r=t.shape,a,s,o,h;if(r.phases.length>0&&r.orientation==="Horizontal")for(h=0;h<r.phases.length;h++)a=r.phases[parseInt(h.toString(),10)].offset,h===0||(a-=i),i+=a,s=Sn(a),h===r.phases.length-1&&i<t.width&&(s.width+=t.width-i),n.push(s);else if(e)s=Sn(t.width),n.push(s);else{for(r.phaseSize&&r.phases.length>0?r.lanes.length+1:r.lanes.length,r.phaseSize&&r.phases.length>0&&(i+=r.phaseSize,s=Sn(r.phaseSize),n.push(s)),o=0;o<r.lanes.length;o++)i+=r.lanes[parseInt(o.toString(),10)].width,s=Sn(r.lanes[parseInt(o.toString(),10)].width),o===r.lanes.length-1&&i<t.width&&(s.width+=t.width-i),n.push(s);r.phases.length===0&&r.lanes.length===0&&(s=Sn(t.width),n.push(s))}}function sr(n,e,t,i){for(var r=[],a=0,s,o,h,l,d,f,p=e.rowDefinitions().length,c,u=0;u<p;u++)for(f=e.rows[parseInt(u.toString(),10)],l=0;l<f.cells.length;l++)if(d=f.cells[parseInt(l.toString(),10)].children[0],d&&d.children&&d.children.length){for(h=1;h<d.children.length;h++)if(s=d.children[parseInt(h.toString(),10)],o=n.getObject(s.id),o&&(o.inEdges.length>0||o.outEdges.length>0))for(c=o.inEdges.concat(o.outEdges),a=0;a<c.length;a++)r.indexOf(c[parseInt(a.toString(),10)])===-1&&r.push(c[parseInt(a.toString(),10)])}return r}function ta(n){var e=n.wrapper;if(e.measure(new U(n.width,n.height)),e.children[0]instanceof Fn){var t=e.children[0],i=!1;(t.width&&t.width<t.desiredSize.width||t.width===void 0&&t.desiredSize.width!==void 0)&&(i=!0,t.width=t.desiredSize.width),(t.height&&t.height<t.desiredSize.height||t.height===void 0&&t.desiredSize.height!==void 0)&&(i=!0,t.height=t.desiredSize.height),i&&t.measure(new U(t.width,t.height))}e.arrange(e.desiredSize)}function un(n,e,t){var i=e.wrapper.children[0],r,a,s,o,h,l,d,f,p;for(r=t;r<i.rows.length;r++)for(d=i.rows[parseInt(r.toString(),10)],a=0;a<d.cells.length;a++)if(f=d.cells[parseInt(a.toString(),10)],f.children&&f.children.length>0)for(s=0;s<f.children.length;s++){if(p=f.children[parseInt(s.toString(),10)],h=n.nameTable[p.id],h.isLane&&p.children.length>1)for(o=1;o<p.children.length;o++)l=n.nameTable[p.children[parseInt(o.toString(),10)].id],l&&l.isLane&&(l.rowIndex=r,l.columnIndex=a);h.rowIndex=r,h.columnIndex=a}}function em(n,e){var t=e.wrapper.children[0],i=e.shape,r=i.padding,a=i.lanes,s=t.bounds.y,o,h,l=i.phaseSize>0?i.phases.length:0,d,f,p,c,u,g,v=i.orientation==="Horizontal",m=v?i.phases.length||1:a.length+1,y=v?(i.header&&i.hasHeader?1:0)+(i.phases.length>0?1:0)+i.lanes.length:(i.header&&i.hasHeader?1:0)+i.phases.length;if(l===0&&!v&&i.lanes.length&&(y+=1),v?(o=(i.header&&i.hasHeader?1:0)+(l>0?1:0),h=0):(o=i.header&&i.hasHeader?1:0,h=l>0?1:0),a.length>0)for(s+=i.header&&i.hasHeader?i.header.height:0,c=0;c<a.length;c++){for(u=0;u<a[parseInt(c.toString(),10)].children.length;u++)if(d=a[parseInt(c.toString(),10)].children[parseInt(u.toString(),10)],d.offsetX=a[parseInt(c.toString(),10)].width,d.offsetY=a[parseInt(c.toString(),10)].height,n.initObject(d),n.nodes.push(d),f=d.wrapper,v){for(g=h;g<m;g++)if(p=t.rows[parseInt(o.toString(),10)].cells[parseInt(g.toString(),10)],f.margin.left<p.bounds.right-t.bounds.x){d.parentId=p.children[0].id,g>h?f.margin.left=f.margin.left-(p.bounds.left-t.bounds.left):p.children[0].children[1].actualSize.width+r>=f.margin.left&&(f.margin.left=p.children[0].children[1].actualSize.width+r),f.margin.left<r&&(f.margin.left=r),f.margin.top<r&&(f.margin.top=r),_h(f,d,n);break}}else for(var S=o;S<y;S++)if(p=t.rows[parseInt(S.toString(),10)].cells[parseInt(h.toString(),10)],f.margin.top<p.bounds.bottom-s){d.parentId=p.children[0].id,S>o?f.margin.top=f.margin.top-(p.bounds.top-s):p.children[0].children[1].actualSize.height+r>=f.margin.top&&(f.margin.top=p.children[0].children[1].actualSize.height+r),f.margin.left<r&&(f.margin.left=r),f.margin.top<r&&(f.margin.top=r),_h(f,d,n);break}v?o++:h++}t.measure(new U(e.width,e.height)),t.arrange(t.desiredSize),im(t,e),e.width=e.wrapper.width=t.width,e.height=e.wrapper.height=t.height,Tr(n,e),e.wrapper.measure(new U(e.width,e.height)),e.wrapper.arrange(t.desiredSize),vm(e),fs(e,n),Vd(e)}function _h(n,e,t){n.measure(new U(e.width,e.height)),n.arrange(n.desiredSize);var i=t.getObject(e.parentId);t.addChild(i,e.id)}function im(n,e){var t=n.columnDefinitions(),i=n.rowDefinitions(),r,a,s,o,h,l,d=ps(e);e.shape.orientation==="Vertical"&&d===0&&(d=e.shape.header&&e.shape.hasHeader?1:0);var f=e.shape.padding;for(r=0;r<t.length;r++)n.updateColumnWidth(r,t[parseInt(r.toString(),10)].width,!0,f);for(r=d;r<i.length;r++)n.updateRowHeight(r,i[parseInt(r.toString(),10)].height,!0,f);for(a=0;a<i.length;a++)for(l=n.rows[parseInt(a.toString(),10)],r=0;r<t.length;r++)if(o=l.cells[parseInt(r.toString(),10)],o.children&&o.children.length>0)for(s=0;s<o.children.length;s++)h=o.children[parseInt(s.toString(),10)],h.maxWidth&&(h.maxWidth=o.actualSize.width),h.maxHeight&&(h.maxHeight=o.actualSize.height)}function Vd(n){if(n.shape.type==="SwimLane"&&!n.shape.isLane&&!n.shape.isPhase){var e=void 0,t=void 0,i=void 0,r=void 0,a=void 0,s=n.shape.lanes,o=ps(n),h=n.wrapper.children[0].rowDefinitions(),l=n.wrapper.children[0].columnDefinitions(),d=void 0,f=void 0;for(t=0;t<s.length;t++,o++)if(e=s[parseInt(t.toString(),10)],n.shape.orientation==="Horizontal")for(a=h[parseInt(o.toString(),10)].height,e.height!==a&&(e.height=a),i=0;i<l.length;i++)d=l[parseInt(i.toString(),10)].width,e.width!==d&&(e.width=d);else for(a=l[parseInt(o.toString(),10)].width,e.width!==a&&(e.width=a),r=0;r<h.length;r++)f=h[parseInt(r.toString(),10)].height,e.height!==f&&(e.height=f)}}function fs(n,e){var t=n.shape,i=t.phases,r,a,s,o,h=t.header&&t.hasHeader?1:0,l=n.wrapper.children[0],d=l.bounds.y+(t.header&&t.hasHeader?t.header.height:0);if(n.shape.type==="SwimLane"&&(n=e.getObject(n.id)||n,i.length>0))if(l=n.wrapper.children[0],t.orientation==="Horizontal")for(s=t.header&&t.hasHeader?l.rows[1]:l.rows[0],r=0;r<i.length;r++)o=s.cells[parseInt(r.toString(),10)].children[0],a=o.bounds.right-l.bounds.x,i[parseInt(r.toString(),10)].offset!==a&&(i[parseInt(r.toString(),10)].offset=a),e.nameTable[o.id].maxWidth=o.maxWidth;else for(r=0;r<i.length;r++)o=l.rows[h+r].cells[0].children[0],a=o.bounds.bottom-d,i[parseInt(r.toString(),10)].offset!==a&&(i[parseInt(r.toString(),10)].offset=a),e.nameTable[o.id].maxWidth=o.maxWidth}function Pr(n,e){if(n&&n.length>0){var t=void 0;e.lineRoutingModule&&e.constraints&lt.LineRouting&&(e.avoidLineOverlappingModule&&e.avoidLineOverlappingModule.removeConnectors(n),e.lineRoutingModule.renderVirtualRegion(e,!0));for(var i=0;i<n.length;i++)t=e.getObject(n[parseInt(i.toString(),10)]),e.lineRoutingModule&&e.constraints&lt.LineRouting&&t.type==="Orthogonal"?e.lineRoutingModule.refreshConnectorSegments(e,t,!0):e.connectorPropertyChange(t,{},{sourceID:t.sourceID,targetID:t.targetID})}}function rm(n,e,t,i){var r,a,s,o,h,l,d,f,p,c=n.getObject(e.parentId),u=c.shape,g=c.wrapper.children[0],v=u.lanes,m=sr(n,g,e.rowIndex);if(u.orientation==="Horizontal"&&e.rowIndex!==t.rowIndex||u.orientation==="Vertical"&&e.columnIndex!==t.columnIndex){if(u.orientation==="Horizontal")h=e.rowIndex,l=t.rowIndex,r=(u.header&&u.hasHeader?1:0)+(u.phases.length&&u.phaseSize?1:0),f=e.rowIndex-r,p=t.rowIndex-r,v[parseInt(f.toString(),10)].canMove&&(f<p?i&&t.wrapper.offsetY>i.y&&(l+=p>0?-1:1,p+=p>0?-1:1):i&&t.wrapper.offsetY<i.y&&(l+=1,p+=1),h!==l&&(g.updateRowIndex(h,l),Kh(f,p,c,n)));else if(h=e.columnIndex,l=t.columnIndex,r=u.phases.length&&u.phaseSize?1:0,f=e.columnIndex-r,p=t.columnIndex-r,u.header&&u.hasHeader,v[parseInt(f.toString(),10)].canMove&&(f<p?i&&t.wrapper.offsetX>i.x&&(l+=p>0?-1:1,p+=p>0?-1:1):i&&t.wrapper.offsetX<i.x&&(l+=1,p+=1),h!==l)){if((u.phaseSize===0||u.phases.length===0)&&(l===0||h===0)&&u.header&&u.hasHeader){var y=l===0?h:l;g.rows[0].cells[parseInt(y.toString(),10)].children=g.rows[0].cells[0].children,g.rows[0].cells[parseInt(y.toString(),10)].columnSpan=g.rows[0].cells[0].columnSpan,g.rows[0].cells[0].children=[]}g.updateColumnIndex(0,h,l),Kh(f,p,c,n)}h!==l&&(d=v[parseInt(f.toString(),10)],d.canMove&&(a={target:E(t),source:E(e)},d=v[parseInt(f.toString(),10)],v.splice(f,1),v.splice(p,0,d),o={target:E(a.source),source:E(a.target)},s={type:"LanePositionChanged",redoObject:o,undoObject:a,category:"Internal"},n.diagramActions&k.UndoRedo||n.commandHandler.addHistoryEntry(s),un(n,c,0),Pr(m,n),Sm(v,n),c.wrapper.measure(new U(c.width,c.height)),c.wrapper.arrange(c.wrapper.desiredSize),n.updateDiagramObject(c)))}n.updateDiagramElementQuad()}function Kh(n,e,t,i){var r=t.shape.phases;if(r&&r.length>0)for(var a=0;a<r.length;a++){var s=t.id+r[parseInt(a.toString(),10)].id+"_header",o=i.nameTable[""+s];if(o&&o.laneGrids&&n>=0&&e>=0&&n<o.laneGrids.length&&e<o.laneGrids.length){var h=o.laneGrids.splice(n,1)[0];o.laneGrids.splice(e,0,h)}}}function jh(n,e,t,i,r,a){var s=n.getObject(t.id),o=s.shape,h=o.header&&o.hasHeader?1:0,l=o.lanes,d=o.phases,f=i.wrapper.actualSize.width,p=i.wrapper.actualSize.height;e.wrapper.actualSize.width,e.wrapper.actualSize.height;var c,u,g=!1;n.diagramActions&k.UndoRedo&&(g=!0);var v=s.wrapper.children[0];if(s.shape.type==="SwimLane")if(o.orientation==="Horizontal")if(e.isPhase){for(var m=e.columnIndex;m<d.length;m++){d[parseInt(m.toString(),10)].offset+=r;var y=n.nameTable[d[parseInt(m.toString(),10)].header.id];if(y){var S=v.rows[y.rowIndex].cells[y.columnIndex],x=S.minWidth;d[parseInt(m.toString(),10)].offset<x&&!g&&(d[parseInt(m.toString(),10)].offset=x)}}for(c=0;c<l.length;c++)l[parseInt(c.toString(),10)].width=g?f:e.wrapper.width}else h=o.phaseSize&&o.phases.length>0?h+1:h,l[e.rowIndex-h].height=g?p:e.wrapper.height;else if(e.isPhase){for(var m=e.rowIndex-h;m<d.length;m++){d[parseInt(m.toString(),10)].offset+=a;var y=n.nameTable[d[parseInt(m.toString(),10)].header.id];if(y){var S=v.rows[y.rowIndex].cells[y.columnIndex],I=S.minHeight;d[parseInt(m.toString(),10)].offset<I&&!g&&(d[parseInt(m.toString(),10)].offset=I)}}for(u=0;u<l.length;u++)l[parseInt(u.toString(),10)].height=e.wrapper.height}else h=o.phaseSize&&o.phases.length>0?1:0,l[e.columnIndex-h].width=e.wrapper.width}function Qo(n,e){var t,i=n.shape,r=i.header&&i.hasHeader?1:0;return i.orientation==="Horizontal"?(r+=i.phases.length>0?1:0,t=e.rowIndex-r):t=e.columnIndex-(i.phaseSize&&i.phases.length>0?1:0),t}function nm(n,e){var t=e.shape,i=t.header&&t.hasHeader?1:0,r=t.orientation==="Horizontal"?n.columnIndex:n.rowIndex-i;return r}function ps(n){var e=0,t=n.shape;return t.orientation==="Horizontal"&&(e=t.header&&t.hasHeader?1:0),t.phases.length>0&&t.phaseSize&&(e+=1),e}function $a(n,e,t,i){var r=n.shape;if(r.phases.length>0){var a=e.nameTable[r.phases[parseInt(i.toString(),10)].header.id];a&&a.maxWidth<t.outerBounds.width&&(a.maxWidth=t.outerBounds.width,a.wrapper.maxWidth=t.outerBounds.width)}}function Tr(n,e){if(e.shape.header&&e.shape.hasHeader){var t=e.wrapper.children[0],i=t.rows[0].cells[0].children[0].id,r=n.nameTable[""+i];r&&r.isHeader&&(r.maxWidth<e.width||r.wrapper.maxWidth<e.width)&&(r.maxWidth=e.width,r.wrapper.maxWidth=e.width)}}function am(n,e,t,i){var r,a=n.nameTable[e.id];if(a.shape.type==="SwimLane"){n.protectPropertyChange(!0);var s=a.wrapper.children[0],o=s.bounds,h=a.shape,l=void 0,d=!1,f=void 0,p=void 0,c=void 0,u=void 0,g=void 0,v=void 0,m=void 0,y=void 0,S=void 0,x=new Fr(h,"lanes",t,!0);t.height=t.height||x.height,t.width=t.width||x.width,p=h.orientation==="Vertical"||h.header&&h.hasHeader?1:0,h.orientation==="Horizontal"&&(d=!0,p=h.phases.length>0?p+1:p);var I=sr(n,s),C=i!==void 0?i:h.lanes.length;if(p+=C,r={element:x,cause:n.diagramActions,diagramAction:n.itemType,state:"Changing",type:"Addition",cancel:!1,laneIndex:C},n.triggerEvent(Z.collectionChange,r),!r.cancel){if(d){var P=new jn;P.height=t.height,s.addRow(p,P,!1),a.height=a.height!==void 0?a.height+t.height:a.height,a.wrapper.height=s.height=a.height}else{var A=new Nr;A.width=t.width,s.addColumn(C+1,A,!1),a.width&&(a.width+=t.width,a.wrapper.width=s.width=a.width),h.hasHeader&&(s.rows[0].cells[0].columnSpan+=1)}n.diagramActions&k.UndoRedo||(x.id=x.id===""?K():x.id),i!==void 0?h.lanes.splice(i,0,x):h.lanes.push(x),r={element:x,cause:n.diagramActions,diagramAction:n.itemType,state:"Changed",type:"Addition",cancel:!1,laneIndex:C},n.triggerEvent(Z.collectionChange,r),Fd(s,n,a,p,C,d),l=h.orientation==="Horizontal"?n.nameTable[s.rows[parseInt(p.toString(),10)].cells[0].children[0].id]:h.header&&h.hasHeader?n.nameTable[s.rows[1].cells[parseInt(p.toString(),10)].children[0].id]:n.nameTable[s.rows[0].cells[parseInt(p.toString(),10)].children[0].id],n.diagramActions&k.UndoRedo||(f={type:"LaneCollectionChanged",changeType:"Insert",undoObject:E(x),redoObject:E(l),category:"Internal"},n.addHistoryEntry(f));var T=h.orientation==="Horizontal"?p:h.header&&h.hasHeader?1:0;un(n,a,T),ta(a),Tr(n,a),c=t.children;var z=!1;if(c&&c.length>0)for(u=0;u<c.length;u++){z=!1,y=c[parseInt(u.toString(),10)],S={x:y.wrapper.offsetX,y:y.wrapper.offsetY};var L={left:0,right:0,top:0,bottom:0};if(h.orientation==="Horizontal")for(L.bottom=o.y-s.bounds.y,m=s.rows[parseInt(p.toString(),10)].cells[parseInt(u.toString(),10)],g=0;g<s.rows[parseInt(p.toString(),10)].cells.length;g++)tl(n,s.rows[parseInt(p.toString(),10)].cells[parseInt(g.toString(),10)],S,y,L);else t:for(var R=0;R<=s.rows.length;R++)for(v=0;v<s.rows[parseInt(R.toString(),10)].cells.length;v++)if(L.right=o.x-s.bounds.x,m=s.rows[parseInt(R.toString(),10)].cells[parseInt(v.toString(),10)],z=tl(n,m,S,y,L),z)break t}Pr(I,n),n.drag(a,o.x-s.bounds.x,o.y-s.bounds.y)}n.itemType="PublicMethod",n.protectPropertyChange(!1)}}function tl(n,e,t,i,r){var a=!1;if(e.children&&e.children.length>0){var s=e.children[0],o=n.nameTable[s.id];sm(s.bounds,t,r)&&(n.addChild(o,i),a=!0)}return a}function sm(n,e,t){var i=t.left||0,r=t.right||0,a=t.top||0,s=t.bottom||0;return n.left-i<=e.x&&n.right+r>=e.x&&n.top-a<=e.y&&n.bottom+s>=e.y}function om(n,e,t){if(e.shape.type==="SwimLane"){var i=void 0,r=void 0,a=void 0,s=void 0,o=void 0,h=void 0,l=void 0,d=e.wrapper.bounds.x,f=e.wrapper.bounds.y,p=e.shape,c=p.padding,u=p.phases,g=void 0,v=e.wrapper.children[0],m=p.orientation==="Horizontal";i=p.header&&p.hasHeader?0:-1,p.phases.length>0&&(i+=1);var y=m?p.lanes[0].header.width:p.lanes[0].header.height;if(t.offset>y){for(l=0;l<u.length;l++)if(a=u[parseInt(l.toString(),10)],s=l>0?u[l-1]:a,a.offset>t.offset)if(g=l>0?t.offset-s.offset:t.offset,m){var S=v.columnDefinitions()[parseInt(l.toString(),10)];S.width-=g,o=n.nameTable[p.phases[parseInt(l.toString(),10)].header.id],o.maxWidth=o.wrapper.maxWidth=S.width,v.updateColumnWidth(l,S.width,!1);var x=new Nr;x.width=g,h=l,v.addColumn(l,x,!1);break}else{var I=v.rowDefinitions()[l+i];I.height-=g,o=n.nameTable[p.phases[parseInt(l.toString(),10)].header.id],v.updateRowHeight(l+i,I.height,!1);var C=new jn;C.height=g,h=l,v.addRow(l+i,C,!1);break}if(n.diagramActions&k.UndoRedo&&h===void 0){var P=n.historyManager.currentEntry.next;P.isLastPhase&&(h=u.length,hm(h,e,P,v,m))}if(h>=0){var A=new ys(e.shape,"phases",t,!0);if(n.diagramActions&k.UndoRedo||(A.id+=K()),p.phases.splice(h,0,A),qo(v,n,e,i,m,h),m){if(r=n.nameTable[v.rows[parseInt(i.toString(),10)].cells[parseInt(h.toString(),10)].children[0].id],h===0&&p.header&&p.hasHeader){v.rows[0].cells[0].children=v.rows[0].cells[1].children,v.rows[0].cells[1].children=[];for(var T=v.rows[0],z=0;z<T.cells.length;z++)T.cells[parseInt(z.toString(),10)].minWidth=void 0,z===0?T.cells[parseInt(z.toString(),10)].columnSpan=v.rows[0].cells.length:T.cells[parseInt(z.toString(),10)].columnSpan=1}lm(n,e,v,h,m,t);var L=v.columnDefinitions();if(v.updateColumnWidth(h,L[parseInt(h.toString(),10)].width,!0,c),r.maxWidth=r.wrapper.maxWidth=L[parseInt(h.toString(),10)].width,L.length>h+1){var R=n.nameTable[v.rows[parseInt(i.toString(),10)].cells[h+1].children[0].id];v.updateColumnWidth(h+1,L[h+1].width,!0,c),R.maxWidth=R.wrapper.maxWidth=L[h+1].width}e.width=e.wrapper.width=e.wrapper.children[0].width=v.width}else{r=n.nameTable[v.rows[i+h].cells[0].children[0].id];var O=v.rowDefinitions(),N=O[i+h].height;dm(n,e,v,i+h,m,t),v.updateRowHeight(i+h,N,!0,c),O.length>i+h+1&&(N=O[i+h+1].height,v.updateRowHeight(i+h+1,N,!0,c)),e.height=e.wrapper.height=e.wrapper.children[0].height=v.actualSize.height}if(ta(e),e.width=e.wrapper.actualSize.width,Tr(n,e),n.drag(e,d-e.wrapper.bounds.x,f-e.wrapper.bounds.y),fs(e,n),n.commandHandler.select(r),!(n.diagramActions&k.UndoRedo)){var P={type:"PhaseCollectionChanged",changeType:"Insert",undoObject:E(A),redoObject:E(r),category:"Internal"};n.addHistoryEntry(P)}n.updateDiagramObject(e)}}}}function hm(n,e,t,i,r,a){var s=e.shape,o=s.phases[n-2],h=t.previousPhase.offset;if(r){var l=i.columnDefinitions()[n-1],d=new Nr;n>1?(d.width=l.width-(h-o.offset),l.width=h-o.offset):(d.width=l.width-h,l.width=h),i.updateColumnWidth(n-1,l.width,!1),i.addColumn(n,d,!1)}else{var l=i.rowDefinitions()[parseInt(n.toString(),10)],f=new jn;n>1?(f.height=t.undoObject.offset-h,l.height=h-o.offset):(f.height=l.height-h,l.height=h),i.updateRowHeight(n,l.height,!1),i.addRow(1+n,f,!1)}}function lm(n,e,t,i,r,a){var s=e.shape,o,h,l,d,f,p=ps(e);for(s.header&&s.hasHeader&&(t.rows[0].cells[0].columnSpan=t.rows[0].cells.length),h=p;h<t.rows.length;h++)f=t.rows[parseInt(h.toString(),10)],l=f.cells[i-1],d=f.cells[parseInt(i.toString(),10)],o=f.cells[i+1],Gd(n,e,l,d,o,h,i,a);un(n,e,1)}function dm(n,e,t,i,r,a){for(var s,o,h,l=t.rows[parseInt(i.toString(),10)],d=t.rows[i+1],f=t.rows[i-1],p=1;p<l.cells.length;p++)o=l.cells[parseInt(p.toString(),10)],h=d?d.cells[parseInt(p.toString(),10)]:void 0,s=f?f.cells[parseInt(p.toString(),10)]:void 0,Gd(n,e,s,o,h,i,p,a);un(n,e,1)}function Gd(n,e,t,i,r,a,s,o){var h,l,d=e.shape,f=d.orientation==="Horizontal",p=e.wrapper.children[0],c=i.desiredCellWidth,u=i.desiredCellHeight,g,v=f?e.shape.hasHeader?a:a+1:s;t?(h=f?t.bounds.x+t.bounds.width:t.bounds.x,l=f?t.bounds.y:t.bounds.y+t.bounds.height):(h=p.bounds.x,l=r.bounds.y),!f&&r&&r.bounds&&(h=r.bounds.x,l=r.bounds.y);for(var m=new it(h,l,c,u),y=e.shape.hasHeader?a-1:a,S=e.id+(f?d.lanes[v-2]:d.lanes[v-1]).id,x=(f?s-1:y-1).toString()+(f?s:y).toString(),I=S+x;Object.prototype.hasOwnProperty.call(n.nameTable,I);)x=(f?s-1:y-1).toString()+x,I=S+x;var C={id:I,rowIndex:a,columnIndex:s,width:i.minWidth,height:i.minHeight,style:(f?d.lanes[v-2]:d.lanes[v-1]).style,constraints:W.Default|W.AllowDrop,container:{type:"Canvas",orientation:f?"Horizontal":"Vertical"}},P=d.hasHeader?0:-1;if(o.laneGrids&&o.laneGrids.length>0){var A=f?a-(2+P):s-1;n.nameTable[o.laneGrids[parseInt(A.toString(),10)]]||(C.id=o.laneGrids[parseInt(A.toString(),10)])}var T=f?s:a-1;if(d.phases[parseInt(T.toString(),10)]){var z=n.nameTable[d.phases[parseInt(T.toString(),10)].header.id];z&&z.laneGrids.push(C.id)}var L=Vn(n,p,e,C,!1,!1,!0);if(L.children[0].isCalculateDesiredSize=!1,p.addObject(L,a,s),r&&r.children&&r.children.length)for(g=0;g<r.children.length;g++)f?n.nameTable[r.children[parseInt(g.toString(),10)].id].columnIndex+=1:n.nameTable[r.children[parseInt(g.toString(),10)].id].rowIndex+=1;fm(n,r,i,m,L,f,t)}function fm(n,e,t,i,r,a,s){var o,h,l,d=n.nameTable[r.id],f=e||s,p=n.nameTable[d.parentId],c=p.shape.padding;if(f.children&&f.children[0].children.length>1)for(var u=1;u<f.children[0].children.length;u++)o=f.children[0].children[parseInt(u.toString(),10)],l=n.nameTable[o.id],h=a?{x:o.bounds.x,y:o.bounds.center.y}:{x:o.bounds.center.x,y:o.bounds.top},i.containsPoint(h)?(t.children[0].children.push(o),f.children[0].children.splice(u,1),u--,n.deleteChild(l,void 0,!0),l.isLane||(l.parentId=r.id),d.children||(d.children=[]),e||(a?l.margin.left=l.wrapper.bounds.x-f.children[0].bounds.right:l.margin.top=l.wrapper.bounds.y-f.children[0].bounds.bottom),d.children.push(o.id),l.zIndex=d.zIndex+1,n.removeElements(l)):e&&(a?(l.margin.left-=t.desiredCellWidth,c>l.margin.left&&(l.margin.left=c)):(l.margin.top-=t.desiredCellHeight,c>l.margin.top&&(l.margin.top=c)))}function el(n,e,t){if(e.shape.type==="SwimLane"&&(t==="ResizeSouth"||t==="ResizeEast")){var i=e.shape,r=e.wrapper.children[0],a=void 0,s=void 0;t==="ResizeSouth"?i.orientation==="Vertical"?a=r.rows[r.rows.length-1].cells[0]:(s=r.rows.length-1,a=r.rows[parseInt(s.toString(),10)].cells[r.rows[parseInt(s.toString(),10)].cells.length-1]):(s=i.header&&i.hasHeader?1:0,a=r.rows[parseInt(s.toString(),10)].cells[r.rows[parseInt(s.toString(),10)].cells.length-1]),n.commandHandler.select(n.nameTable[a.children[0].id])}}function po(n,e,t,i,r,a){var s,o,h,l,d,f=K(),p,c,u,g=n.shape,v=g.phases,m=n.offsetX-n.wrapper.actualSize.width/2,y=n.offsetY-n.wrapper.actualSize.height/2,S=[];if(g.orientation==="Vertical"&&(y+=g.header&&g.hasHeader?g.header.height:0),!a)for(r||(n.id+=f,g&&g.header&&g.hasHeader?g.header.id+=f:g.header=void 0),s=0;v&&s<v.length;s++)l=v[parseInt(s.toString(),10)],l.id+=f;var x=r?[t.childTable[i.id]]:g.lanes;for(s=0;x&&s<x.length;s++)for(h=x[parseInt(s.toString(),10)],a||(h.id+=f),o=0;h.children&&o<h.children.length;o++)d=h.children[parseInt(o.toString(),10)],S.push(d.id),c=d.wrapper.offsetX-d.width/2,u=d.wrapper.offsetY-d.height/2,d.zIndex=Number.MIN_VALUE,d.inEdges=d.outEdges=[],(a||t&&(t.pasteIndex===1||t.pasteIndex===0))&&(g.orientation==="Vertical"?d.margin.top=u-y:d.margin.left=c-m),a||(d.id+=f);if(!a){if(r){var I={lanes:x,phases:v,phaseSize:g.phaseSize,type:"SwimLane",orientation:g.orientation,header:{annotation:{content:"Title"},height:50}};if(p={shape:I},g.orientation==="Horizontal"){var C=0;g.hasHeader&&(C=g.header.height),p.width=n.wrapper.actualSize.width,p.height=i.wrapper.actualSize.height+C+g.phaseSize,p.offsetX=n.wrapper.offsetX+t.pasteIndex*10,p.offsetY=i.wrapper.offsetY+t.pasteIndex*10}else p.width=i.wrapper.actualSize.width,p.height=n.wrapper.actualSize.height,p.offsetX=i.wrapper.offsetX+t.pasteIndex*10,p.offsetY=n.wrapper.offsetY+t.pasteIndex*10;n=p}if(t.pasteIndex!==0&&(n.offsetX+=10,n.offsetY+=10),e.itemType="Clipboard",n.zIndex=Number.MIN_VALUE,n=e.add(n),!r)for(var P=0,A=Object.keys(t.childTable);P<A.length;P++){var T=A[P],z=t.childTable[""+T];z.parentSwimlaneId&&z.parentSwimlaneId+f===n.id?(z.id+=f,S.indexOf(z.sourceID)!==-1&&(z.sourceID+=f),S.indexOf(z.targetID)!==-1&&(z.targetID+=f),z.zIndex=Number.MIN_VALUE,e.add(z),z.parentSwimlaneId+=f):S.indexOf(z.sourceID)!==-1?z.sourceID+=f:S.indexOf(z.targetID)!==-1&&(z.targetID+=f)}e.mode!=="SVG"&&e.refreshDiagramLayer(),e.select([n])}return n}function Us(n,e,t,i){var r,a=e.nodes[0];if(i||ne(n,a,!0)){var s=void 0,o=void 0,h=void 0,l=new Be;t&&(h=n.nameTable[""+t].parentId,s=a=n.nameTable[""+t]);var d=t?s.wrapper:a.wrapper,f=n.nameTable[h||a.parentId];f&&f.container.type==="Grid"&&(r=new Ht,r.children=[],(i||!a.isHeader)&&(f.container.orientation==="Horizontal"&&a.isPhase||f.container.orientation==="Vertical"&&(a.rowIndex>0&&a.columnIndex>0||a.isLane)?(o=Im(f,s?s.columnIndex:a.columnIndex,!!(f.shape.header&&f.shape.hasHeader)),r.offsetX=o.center.x,r.offsetY=o.center.y,l.width=o.width,l.height=o.height):(r.offsetX=f.offsetX,r.offsetY=d.offsetY,l.width=f.wrapper.actualSize.width,l.height=d.actualSize.height),(f.container.orientation==="Vertical"&&a.isPhase||f.container.orientation==="Horizontal"&&a.isLane)&&(r.pivot=a.pivot)),r.children.push(l),r.measure(new U),r.arrange(r.desiredSize))}return r}function Zd(n,e,t,i,r){r=r!==void 0?r:Qo(e,t);for(var a=!1,s=e.shape.lanes[parseInt(r.toString(),10)],o=s.children.length-1;o>=0;o--)i?i.id===s.children[parseInt(o.toString(),10)].id&&s.children.splice(o,1):(n.removeDependentConnector(s.children[parseInt(o.toString(),10)]),n.diagramActions&k.UndoRedo||(n.diagramActions=n.diagramActions|k.UndoRedo,a=!0),n.remove(s.children[parseInt(o.toString(),10)]),s.children.splice(o,1),a&&(n.diagramActions=n.diagramActions&~k.UndoRedo))}function pm(n){var e=n.children[0];return e}function cm(n,e){var t=e.wrapper.children[0].rows,i,r,a,s,o,h;for(r=0;r<t.length;r++)for(a=0;a<t[parseInt(r.toString(),10)].cells.length;a++){if(o=pm(t[parseInt(r.toString(),10)].cells[parseInt(a.toString(),10)]),o&&o.children)for(s=o.children.length-1;s>=0;s--)o.children[parseInt(s.toString(),10)].children&&(h=n.nameTable[o.children[parseInt(s.toString(),10)].id],h&&(h.isLane?Gn(n,h):(n.removeDependentConnector(h),n.diagramActions|=k.PreventHistory,h.constraints&W.Delete?n.remove(h):$d(n,h,{},!1),n.diagramActions&=~k.PreventHistory)));o&&(i=n.nameTable[o.id],i&&Gn(n,i))}}function Gn(n,e){e&&(n.nodes.splice(n.nodes.indexOf(e),1),n.removeFromAQuad(e),n.removeObjectsFromLayer(e),delete n.nameTable[e.id],n.removeElements(e))}function il(n,e,t,i){var r;if(t.shape.type==="SwimLane"){var a=t.shape,s=void 0;if(a.lanes.length===1)n.remove(t);else{var o=t.wrapper.bounds.x,h=t.wrapper.bounds.y,l=void 0,d=void 0,f=void 0,p=void 0,c=void 0,u=t.wrapper.children[0];if(s=Qo(t,e),r={element:e,cause:n.diagramActions,diagramAction:n.itemType,state:"Changing",type:"Removal",cancel:!1,laneIndex:s},n.triggerEvent(Z.collectionChange,r),!r.cancel){var g=a.lanes[parseInt(s.toString(),10)],v=g.children;g.children=[];for(var m=0;m<v.length;m++){var y=n.getObject(v[parseInt(m.toString(),10)].id);y&&g.children.push(y)}var S=E(a.lanes[parseInt(s.toString(),10)]);if(Zd(n,t,e,void 0,s),!(n.diagramActions&k.UndoRedo)){var x={type:"LaneCollectionChanged",changeType:"Remove",undoObject:S,redoObject:E(e),category:"Internal"};n.addHistoryEntry(x)}a.lanes.splice(s,1);var I=e?a.orientation==="Horizontal"?e.rowIndex:e.columnIndex:ps(t)+s;if(a.orientation==="Horizontal"){for(l=u.rows[parseInt(I.toString(),10)],d=0;d<l.cells.length;d++)if(f=l.cells[parseInt(d.toString(),10)],f&&f.children.length>0)for(p=0;p<f.children.length;p++)c=f.children[parseInt(p.toString(),10)],co(n,c),rl(c,t,n);u.removeRow(I)}else{for(t.width=t.width!==void 0?t.width-u.rows[0].cells[parseInt(I.toString(),10)].actualSize.width:t.width,d=0;d<u.rows.length;d++)if(f=u.rows[parseInt(d.toString(),10)].cells[parseInt(I.toString(),10)],f&&f.children.length>0)for(p=0;p<f.children.length;p++)c=f.children[parseInt(p.toString(),10)],co(n,c),rl(c,t,n);u.removeColumn(I)}r={element:e,cause:n.diagramActions,diagramAction:n.itemType,state:"Changed",type:"Removal",cancel:!1,laneIndex:s},n.triggerEvent(Z.collectionChange,r),t.width=t.wrapper.width=u.width,t.height=t.wrapper.height=u.height,ta(t),t.shape.orientation==="Vertical"&&(I=0),un(n,t,I),n.drag(t,o-t.wrapper.bounds.x,h-t.wrapper.bounds.y),n.updateDiagramObject(t)}}}}function rl(n,e,t){var i=n.id,r=e.shape.phases;if(r&&r.length>0)for(var a=0;a<r.length;a++){var s=e.id+r[parseInt(a.toString(),10)].id+"_header",o=t.nameTable[""+s],h=o.laneGrids.indexOf(i);h!==-1&&o.laneGrids.splice(h,1)}}function co(n,e){var t,i;if(e instanceof Ht){if(e.children.length>0)for(t=0;t<e.children.length;t++)e.children[parseInt(t.toString(),10)]instanceof Ht&&co(n,e.children[parseInt(t.toString(),10)]);i=n.getObject(e.id),Gn(n,i)}}function nl(n,e,t,i){n.protectPropertyChange(!0),t.wrapper.bounds.x,t.wrapper.bounds.y;var r=!1,a,s=t.shape,o=t.wrapper.children[0],h=nm(e,t),l=s.phases.length;if(s.phases.length>1){h===l-1&&(r=!0,a=E(s.phases[h-1]));var d=E(s.phases[parseInt(h.toString(),10)]);if(s.phases.splice(h,1),!(n.diagramActions&k.UndoRedo)){var f={type:"PhaseCollectionChanged",changeType:"Remove",undoObject:d,previousPhase:a,redoObject:E(e),category:"Internal",isLastPhase:r};f.undoObject.laneGrids=e.laneGrids,f.redoObject.laneGrids=e.laneGrids,n.addHistoryEntry(f)}s.orientation==="Horizontal"?um(n,o,e,h):gm(n,o,e,h,t),Tr(n,t),un(n,t,t.isHeader?1:0),fs(t,n),n.protectPropertyChange(!1),n.updateDiagramObject(t)}}function um(n,e,t,i){var r,a,s,o,h,l;i=i!==void 0?i:t.columnIndex;var d,f,p,c,u,g;for(d=0;d<e.rows.length;d++)if(r=e.rows[parseInt(d.toString(),10)],r.cells.length>1&&(a=r.cells[parseInt(i.toString(),10)],s=r.cells.length-1===i?r.cells[i-1]:r.cells[i+1],h=s.children[0],a.children.length>0))if(o=a.children[0],u=n.nameTable[o.id],s.children.length===0&&a.children.length>0)s.children=a.children,s.columnSpan=a.columnSpan-1;else{for(f=0;f<o.children.length;f++){if(c=o.children[parseInt(f.toString(),10)],c instanceof Ht){if(g=n.nameTable[c.id],g.isLane||(g.parentId=h.id),r.cells.length-1===i&&(g.margin.left=g.wrapper.bounds.x-h.bounds.x,c.margin.left=g.wrapper.bounds.x-h.bounds.x),h.children.push(c),n.nameTable[h.id]){var v=n.nameTable[h.id];v.children||(v.children=[]),v.children.push(c.id)}o.children.splice(f,1),f--,u&&u.children&&u.children.indexOf(g.id)!==-1&&u.children.splice(u.children.indexOf(g.id),1)}if(r.cells.length-1!==i)for(p=0;p<h.children.length;p++){var m=h.children[parseInt(p.toString(),10)];if(m instanceof Ht){var y=n.nameTable[m.id];y.margin.left=y.wrapper.bounds.x-o.bounds.x,m.margin.left=y.wrapper.bounds.x-o.bounds.x}}}if(u&&u.isPhase){var S=n.nameTable[h.id];S&&(h.maxWidth=S.wrapper.maxWidth=S.wrapper.maxWidth+=u.wrapper.maxWidth)}Gn(n,u)}var x=e.columnDefinitions()[parseInt(i.toString(),10)].width;e.removeColumn(i),i<e.columnDefinitions().length?(l=e.columnDefinitions()[parseInt(i.toString(),10)].width,l+=x,e.updateColumnWidth(i,l,!0)):(l=e.columnDefinitions()[i-1].width,l+=x,e.updateColumnWidth(i-1,l,!0))}function gm(n,e,t,i,r){var a,s,o,h,l,d,f,p=r.shape,c,u,g=i!==void 0?p.hasHeader&&p.header?i+1:i:t.rowIndex,v=e.rows[parseInt(g.toString(),10)],m=r.wrapper.bounds.y,y=p.phases.length;p.header!==void 0&&p.hasHeader&&(m+=e.rowDefinitions()[0].height);var S=i===y?e.rows[g-1]:e.rows[g+1];for(o=0;o<v.cells.length;o++)if(a=v.cells[parseInt(o.toString(),10)],d=S.cells[parseInt(o.toString(),10)],f=d.children[0],a.children.length>0){var x=a.children[0],I=n.nameTable[x.id];if(i<y)for(l=0;l<f.children.length;l++)c=f.children[parseInt(l.toString(),10)],c instanceof Ht&&(u=n.nameTable[c.id],u.margin.top=u.wrapper.bounds.y-(i===0?m:x.bounds.y),c.margin.top=u.wrapper.bounds.y-(i===0?m:x.bounds.y));for(h=0;h<x.children.length;h++)c=x.children[parseInt(h.toString(),10)],c instanceof Ht&&(u=n.nameTable[c.id],u.parentId=f.id,i===y&&(u.margin.top=u.wrapper.bounds.y-(i===0?m:f.bounds.y),c.margin.top=u.wrapper.bounds.y-(i===0?m:f.bounds.y)),f.children.push(c),x.children.splice(h,1),h--,I.children&&I.children.indexOf(u.id)!==-1&&I.children.splice(I.children.indexOf(u.id),1));Gn(n,I)}var C=e.rowDefinitions()[parseInt(g.toString(),10)].height;e.removeRow(g),g<e.rowDefinitions().length?(s=e.rowDefinitions()[parseInt(g.toString(),10)].height,s+=C,e.updateRowHeight(g,s,!0)):(s=e.rowDefinitions()[g-1].height,s+=C,e.updateRowHeight(g-1,s,!0))}function uo(n,e,t){var i=n.nameTable[e.parentId];if(i&&i.isLane){var r=n.nameTable[i.parentId],a=r.wrapper.children[0];n.multiselect||(a.updateColumnWidth(i.columnIndex,a.columnDefinitions()[i.columnIndex].width,!0,t),a.updateRowHeight(i.rowIndex,a.rowDefinitions()[i.rowIndex].height,!0,t));var s=i.wrapper,o=void 0;e.diffX=e.diffX||0,e.diffY=e.diffY||0,e.diffX>0&&(e.margin.left+=e.diffX+t),e.diffY>0&&(e.margin.top+=e.diffY+t),e.margin.left<t&&(e.margin.left=t),e.margin.top<t&&(e.margin.top=t);for(var h=0;h<s.children.length;h++){var l=s.children[parseInt(h.toString(),10)];if(l instanceof Ht){var d=n.nameTable[l.id];if(d.isLane){o=d.wrapper;break}}}o&&(r.shape.orientation==="Horizontal"?e.margin.left<t+o.actualSize.width&&(e.margin.left=t+o.actualSize.width):e.margin.top<t+o.actualSize.height&&(e.margin.top=t+o.actualSize.height)),r.wrapper.measure(new U(r.width,r.height)),r.wrapper.arrange(r.wrapper.desiredSize),e.offsetX=e.wrapper.offsetX,e.offsetY=e.wrapper.offsetY,n.nodePropertyChange(e,{},{margin:{left:e.margin.left,top:e.margin.top}}),e.isResized=!1,a.measure(new U(a.width,a.height)),a.arrange(a.desiredSize),r.width=r.wrapper.width=r.wrapper.children[0].actualSize.width,r.height=r.wrapper.height=r.wrapper.children[0].actualSize.height}}function vm(n){if(n.shape.type==="SwimLane")for(var e=n.shape.lanes,t=void 0,i=void 0,r=0;r<e.length;r++){t=e[parseInt(r.toString(),10)];for(var a=0;a<t.children.length;a++)i=t.children[parseInt(a.toString(),10)],i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY}}function Zn(n,e){var t;if(n.isLane){var i=e.getObject(n.parentId);if(i&&i.shape.type==="SwimLane"&&n.isLane){var r=Qo(i,n);t=i.shape.lanes[parseInt(r.toString(),10)]}}return t}function mm(n,e){return n.parentId&&e.selectedItems.nodes.indexOf(e.nameTable[n.parentId])!==-1}function ym(n,e,t){return!!(n.isLane&&e.isLane&&n.id!==e.id&&n.parentId===e.parentId&&Zn(n,t)===Zn(e,t))}function go(n,e){if(n.isLane){var t=Zn(n,e),i="eventHandler",r=e[""+i].action,a=r.includes("Resize");if(a||t.canMove)return!0}return!1}function Sm(n,e){for(var t,i,r=0;r<n.length;r++){t=n[parseInt(r.toString(),10)];for(var a=0;a<t.children.length;a++)i=e.nameTable[t.children[parseInt(a.toString(),10)].id],i.offsetX=i.wrapper.offsetX,i.offsetY=i.wrapper.offsetY}}function wm(n,e,t,i){var r,a=[],s=!1;if(ne(n,e,!0)){n.protectPropertyChange(!0),r=n.nameTable[e.parentId];var o=r.wrapper;if(n.selectedItems.nodes.length>1?n.multiselect=!0:n.multiselect=!1,r&&r.container.type==="Canvas"){if(i||o.bounds.x<=t.x&&o.bounds.right>=t.x&&o.bounds.y<=t.y&&o.bounds.bottom>=t.y&&!n.multiselect){var h=void 0,l=o.bounds.y,d=o.bounds.x,f=n.nameTable[r.parentId]||r,p=f.shape;if(p.type==="SwimLane")s=kr(r,f,e,n,!0);else{var c=n.nameTable[r.parentId]||r,u=c.shape;h=c.wrapper,o.actualSize.width<o.outerBounds.width&&!(o.bounds.x>o.outerBounds.x)&&(r.rowIndex!==void 0?(h.updateColumnWidth(r.columnIndex,o.outerBounds.width,!0),u.orientation==="Horizontal"&&u.phaseSize&&$a(c,n,o,r.columnIndex),Tr(n,c),n.drag(c,d-o.bounds.x,l-o.bounds.y)):n.scale(r,1+(o.outerBounds.width-o.actualSize.width)/o.actualSize.width,1,o.outerBounds.x<o.bounds.x?{x:1,y:.5}:{x:0,y:.5})),o.actualSize.height<o.outerBounds.height&&!(o.bounds.y>o.outerBounds.y)&&(r.rowIndex!==void 0?(h.updateRowHeight(r.rowIndex,o.outerBounds.height,!0),n.drag(c,d-o.bounds.x,l-o.bounds.y)):n.scale(r,1,1+(o.outerBounds.height-o.actualSize.height)/o.actualSize.height,o.outerBounds.y<o.bounds.y?{x:.5,y:1}:{x:.5,y:0}))}}n.select([e]),Pr(a,n)}n.protectPropertyChange(!1)}return s}function $d(n,e,t,i){var r;if(ne(n,e,!0)&&!n.cancelPositionChange){var a="isProtectedOnChange",s=n[""+a];n.protectPropertyChange(!0),r=n.nameTable[e.parentId];var o=r.wrapper;if(r&&r.container.type==="Canvas"&&!i&&!(o.bounds.x<=t.x&&o.bounds.right>=t.x&&o.bounds.y<=t.y&&o.bounds.bottom>=t.y)&&!(e.constraints&W.AllowMovingOutsideLane)){var h=E(e);n.clearSelection(),Jo(n,e),e.parentId="",e.parentObj=n,e.propName="nodes";var l={type:"ChildCollectionChanged",category:"Internal",undoObject:h,redoObject:E(e)};n.addHistoryEntry(l),n.commandHandler.isContainer&&(n.commandHandler.isContainer=!1,n.endGroupAction()),qd(e,n)}n.protectPropertyChange(s)}}function Im(n,e,t){for(var i=new it,r=n.shape.type==="SwimLane"?n.wrapper.children[0].rows:n.wrapper.rows,a=t?1:0;a<r.length;a++)i.uniteRect(r[parseInt(a.toString(),10)].cells[parseInt(e.toString(),10)].bounds);return i}function xm(n,e){for(var t,i={},r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];i[""+s]=e[""+s]}return Fe(e)===M&&(t=new M(n,"nodes",i,!0),t.id=e.id,n.initObject(t)),n.updateDiagramObject(t),t}function la(n,e){n.enableServerDataBinding(!1);var t,i,r;if(n.selectedObject.helperObject)r=n.selectedObject.helperObject;else if(n.selectedItems.nodes.length>0||n.selectedItems.connectors.length>0){e instanceof It&&e.nodes.length+e.connectors.length===1?(t=e.nodes.length>0?e.nodes[0]:e.connectors[0],i=n.selectedItems.wrapper.children[0]):(t=e,i=n.selectedItems.wrapper),n.selectedObject.actualObject=t;var a=t instanceof It&&t.nodes.length>0?t.nodes[0]:t;if(n.selectedObject.actualObject=t,!n.currentSymbol&&(a.isLane&&go(a,n)&&ne(n,a)||!a.isLane&&ne(n,a)||n.constraints&lt.LineRouting&&n.selectedItems.nodes.length>0)){var s={id:"helper",rotateAngle:i.rotateAngle,offsetX:i.offsetX,offsetY:i.offsetY,minWidth:i.minWidth,minHeight:i.minHeight,maxWidth:i.maxWidth,maxHeight:i.maxHeight,width:i.actualSize.width,height:i.actualSize.height,pivot:i.pivot,style:{strokeDashArray:"2 2",fill:"transparent",strokeColor:"#7D7D7D",strokeWidth:2}};r=xm(n,s),n.selectedObject.helperObject=r}}return n.enableServerDataBinding(!0),r}function ne(n,e,t){var i=t?n.nameTable[e.parentId]:n.nameTable[e.parentId]||e;return!!(i&&i.container)}function Mn(n,e){var t=n.nameTable[e.parentId];if(e.laneMargin={left:e.margin.left,right:e.margin.right,top:e.margin.top,bottom:e.margin.bottom},e.hasTextAnnotation)for(var i=0;i<e.outEdges.length;i++){var r=n.nameTable[e.outEdges[parseInt(i.toString(),10)]];if(r.isBpmnAnnotationConnector){var a=n.nameTable[r.targetID],s={width:e.wrapper.actualSize.width,height:e.wrapper.actualSize.height,offsetX:e.wrapper.offsetX,offsetY:e.wrapper.offsetY},o=e.wrapper.offsetX,h=e.wrapper.offsetY,l=n.getTextAnnotationOffset(e,a,s,o,h),d=l.x-o,f=l.y-h;(d||f||e.width!==e.wrapper.actualSize.width||e.height!==e.wrapper.actualSize.height)&&(e.isResized=!0,e.resizeDif||(e.resizeDif=[]),e.resizeDif[a.id]={x:d,y:f})}}t&&t.container.type==="Canvas"&&(e.margin.left=e.offsetX-t.wrapper.bounds.x-e.width/2,e.margin.top=e.offsetY-t.wrapper.bounds.y-e.height/2),n.nodePropertyChange(e,{},{width:e.width,height:e.height,offsetX:e.offsetX,offsetY:e.offsetY,margin:{left:e.margin.left,right:e.margin.right,top:e.margin.top,bottom:e.margin.bottom},rotateAngle:e.rotateAngle}),n.undoRedoModule&&t&&t.isLane&&n.undoRedoModule.checkRedo&&(e.margin.left<0||e.margin.top<0)&&Jo(n,e),t&&!t.isLane&&(t.wrapper.measure(new U),t.wrapper.arrange(t.wrapper.desiredSize))}function Jo(n,e){if(e.parentId&&e.parentId!==""){var t=n.nameTable[e.parentId];if(t.isLane&&t.parentId){for(var i=n.nameTable[t.parentId],r=t.id.slice(i.id.length),a=r.substring(0,r.length-1),s=i.shape.lanes,o=void 0,h=0;h<s.length;h++)if(o=s[parseInt(h.toString(),10)],a===o.id)for(var l=0;l<o.children.length;l++)o.children[parseInt(l.toString(),10)].id===e.id&&(o.children.splice(l,1),l--)}n.deleteChild(e)}}function zn(n,e,t,i,r,a){if(!n.currentSymbol){n.protectPropertyChange(!0);var s=n.nameTable[e.parentId];t=n.getObject(t.id)||t,s&&s.zIndex>t.zIndex;var o=n.nodes.indexOf(t)!==-1?t.id:t;if(e.container.type==="Canvas"&&!r){var h=t.wrapper.offsetX-t.wrapper.actualSize.width*t.pivot.x-(e.wrapper.offsetX-e.wrapper.actualSize.width*e.wrapper.pivot.x),l=t.wrapper.offsetY-t.wrapper.actualSize.height*t.pivot.y-(e.wrapper.offsetY-e.wrapper.actualSize.height*e.wrapper.pivot.y);t.margin.left=h,t.margin.top=l}else if(s){var d=s.wrapper.bounds,f=e.wrapper.bounds;if(s.shape.orientation==="Horizontal")t.margin.left-=f.x-d.x;else{var p=e.parentId+s.shape.lanes[0].id+"_0_header";t.margin.top-=f.y-d.y-n.nameTable[""+p].wrapper.bounds.height}}var c=n.nameTable[e.id];if(c.children||(c.children=[]),c.children.indexOf(t.id)===-1){Jo(n,t),n.getObject(t.id)&&n.removeElements(t);var u=E(t);if(n.addChild(c,o),t=n.getObject(t.id),c.isLane&&c.parentId){s=n.nameTable[c.parentId];for(var g=s.shape.lanes,v=c.id.slice(s.id.length),m=v.substring(0,v.length-1),y=0;y<g.length;y++)c.isLane&&m===g[parseInt(y.toString(),10)].id&&((t.parentObj instanceof Xe||t.parentObj instanceof Fr)&&(t.parentObj=g[parseInt(y.toString(),10)],t.propName="children"),n.nameTable.hasOwnProperty(t.id)||g[parseInt(y.toString(),10)].children.push(t))}if(n.updateDiagramObject(t),qd(t,n),c.parentId?n.multiselect?(uo(n,t,20),n.updateDiagramElementQuad()):kr(c,s,t,n):n.updateDiagramObject(c),!(n.diagramActions&k.UndoRedo)){var S={type:"ChildCollectionChanged",category:"Internal",undoObject:u,redoObject:E(t),historyAction:r?"AddNodeToLane":void 0};n.addHistoryEntry(S)}}else n.multiselect&&(uo(n,t,20),n.updateDiagramElementQuad());n.protectPropertyChange(!1)}}function qd(n,e){var t=St(n.id+"_groupElement",e.element.id),i=n.parentId?n.parentId+"_groupElement":e.element.id+"_diagramLayer",r=St(i,e.element.id);t&&r&&r.appendChild(t)}function Cm(n,e,t,i){var r=t.nameTable[n.parentId],a=!0;kr(n,r,e,t,i,a)}function kr(n,e,t,i,r,a){var s=E(n),o,h,l=!1,d=e.shape.padding,f=n.wrapper.bounds,p=n.wrapper.outerBounds,c=t.wrapper.bounds;if(e&&e.shape.type==="SwimLane"&&(f.right<c.right+d||f.bottom<c.bottom+d||a&&f.top>c.top+d)){var u=e.wrapper.children[0],g=u.bounds.x,v=u.bounds.y,m=void 0,y=void 0,S=n.wrapper.children.find(function(C){return C.id.includes("header")}),x=e.shape.orientation==="Horizontal";if(f.right<c.right+d&&p.x<=f.x&&(x&&S?(y=S?S.width:0,m=c.right-f.right+(f.left-c.left)+y+d*2):m=c.right-f.right+(f.left-c.left)+d*2,h=!0,u.updateColumnWidth(n.columnIndex,f.width+m,!0,d)),f.bottom<c.bottom+d&&p.y<=f.y&&(!x&&S?(y=S?S.height:0,m=c.bottom-f.bottom+(f.top-c.top)+y+d*2):m=c.bottom-f.bottom+(f.top-c.top)+d*2,o=!0,u.updateRowHeight(n.rowIndex,f.height+m,!0,d)),a&&f.top>c.top-d&&p.y<=f.y&&(!x&&S?(y=S?S.height:0,m=f.top-c.top+(c.bottom-f.bottom)+y+d*2):m=f.top-c.top+(c.bottom-f.bottom)+d*2,m>0&&(o=!0,u.updateRowHeight(n.rowIndex,f.height+m,!0,d))),i.isRowHeightUpdate=o,!(i.diagramActions&k.UndoRedo)){if(r&&(i.startGroupAction(),l=!0),o){var I={category:"Internal",type:"RowHeightChanged",undoObject:s,redoObject:E(n)};i.addHistoryEntry(I)}if(h){var I={category:"Internal",type:"ColumnWidthChanged",undoObject:s,redoObject:E(n)};i.addHistoryEntry(I)}}e.width=e.wrapper.width=u.width,e.height=e.wrapper.height=u.height,ta(e),e.shape.orientation==="Horizontal"&&$a(e,i,n.wrapper,n.columnIndex),Tr(i,e),i.drag(e,g-u.bounds.x,v-u.bounds.y),fs(e,i),Vd(e)}return a||uo(i,t,d),i.updateDiagramElementQuad(),l}function Qd(n,e,t,i,r,a){var s=Vi(i.element.id);i.diagramRenderer.renderStackHighlighter(n,s,i.scroller.transform,e,t,r,a)}function Pm(n,e,t,i){var r=n,a=t.nameTable[r.parentId],s=t.nameTable[r.parentId];if(e&&s&&s.container&&s.container.type==="Stack"&&e.container&&e.container.type==="Stack"&&s.id!==e.parentId&&s.shape.type!=="UmlClassifier"){var o=s.wrapper.children.indexOf(r.wrapper);o>-1&&(t.nameTable[r.id].parentId=e.id,s.wrapper.children.splice(o,1))}if(e&&e.parentId&&r.parentId&&i==="Drag"&&s.container&&s.container.type==="Stack"){var h=a.wrapper.children.indexOf(e.wrapper),l=a.wrapper.children.indexOf(r.wrapper),d={targetIndex:h,target:e,sourceIndex:l,source:n};a.wrapper.children.splice(l,1),a.wrapper.children.splice(h,0,r.wrapper);var f={targetIndex:l,target:e,sourceIndex:h,source:n},p={type:"StackChildPositionChanged",redoObject:f,undoObject:d,category:"Internal"};t.commandHandler.addHistoryEntry(p)}}function Tm(n,e,t,i,r,a,s){if(a&&a.length>1&&r&&r.length>1)return"PinchZoom";if(i.currentSymbol)return"Drag";var o="eventHandler";if(i[""+o].action==="PortDraw"&&(i.tool&=~Gt.DrawOnce),(Yd(i)||ds(i))&&i.drawingObject)return"Draw";if(Si(i)){var h=i.selectedItems;if(h.wrapper&&Kt(h.constraints,"UserHandle"))for(var l=0,d=h.userHandles;l<d.length;l++){var f=d[l];if(f.visible&&!(f.disableConnectors&&i.selectedItems.connectors.length>0||f.disableNodes&&i.selectedItems.nodes.length>0)){var p=eh(h,f,i.scroller.transform);if($t(t,p,f.size/(2*i.scroller.transform.scale)))return f.name}}}if(Si(i)){var c=i.selectedItems.annotation?i.selectedItems.wrapper.children[0]:i.selectedItems.wrapper,u=c.bounds,h=i.selectedItems,g=0,v=0,p=void 0;if(c.flippedPoint?(g=c.flippedPoint.x,v=c.flippedPoint.y,p=new it(g,v,u.width,u.height)):p=new it(u.x,u.y,u.width,u.height),_d(i)&&!i.selectedItems.annotation){var m=i.selectedItems.connectors[0],y=i.selectedItems.handleSize/2/i.scrollSettings.currentZoom,S=i.selectedItems.handleSize/2/i.scrollSettings.currentZoom;if(Kt(h.constraints,"ResizeAll")){if(Kt(h.constraints,"ConnectorSourceThumb")&&Ya(m)&&$t(t,m.sourcePoint,y))return"ConnectorSourceEnd";if(Kt(h.constraints,"ConnectorTargetThumb")&&Ua(m)&&$t(t,m.targetPoint,S))return"ConnectorTargetEnd";var x=bm(m,h,t,i);if(x!=="OrthoThumb"){if(Kt(h.constraints,"ConnectorSourceThumb")&&Ya(m)&&x||Kt(h.constraints,"ConnectorTargetThumb")&&Ua(m)&&x)return x}else return x}}else{var I=i.selectedItems.handleSize/2/i.scroller.currentZoom,C=10/i.scroller.currentZoom,P=xt(),A=c.offsetX,T=c.offsetY;c.flippedPoint&&(A=A+c.flippedPoint.x-c.corners.topLeft.x,T=T+c.flippedPoint.y-c.corners.topLeft.y),Rt(P,c.rotateAngle+c.parentTransform,A,T);var z=A-c.pivot.x*c.actualSize.width,L=T-c.pivot.y*c.actualSize.height,R={x:z+(c.pivot.x===.5?c.pivot.x*2:c.pivot.x)*c.actualSize.width/2,y:L-30/i.scroller.currentZoom};R=st(P,R);var O=!!i.selectedItems.annotation,N=!!(O&&Va(i.selectedItems.annotation));if(Kt(h.constraints,"Rotate")&&$t(t,R,C)&&i.selectedItems.thumbsConstraints&gt.Rotate){if(O&&N)return"LabelRotate";if(!O)return"Rotate"}if(p.Inflate(I),p.containsPoint(t)){var x=Am(i,c,t,P,z,L);if(x)return x}}}if(vr(i)&&!n)return"Pan";if((s instanceof Se||s instanceof ke)&&(!vr(i)||Yn(i)||Un(i))){var x=Jd(i,s);if(x!=="None")return x}if((s instanceof ae||s instanceof Qt)&&!vr(i)&&Wr(s))return Ut(i,s,void 0,e)&&Qe(s)?"LabelDrag":"LabelSelect";if(n!==null)if(n instanceof M||n instanceof B){if(e&&e.id){var H=e.id.split(n.id)[1];if(H&&H.match("^_icon"))return"LayoutAnimation"}if(e&&e.id){for(var F=void 0,Y=0;Y<n.fixedUserHandles.length;Y++)if(F=n.fixedUserHandles[parseInt(Y.toString(),10)].id,e.id&&e.id.indexOf(F)>-1)return"FixedUserHandle"}if(e instanceof Tt&&e.hyperlink.link)return"Hyperlink";if(Qe(n)&&Ut(i,n,!1)&&i.selectedItems.annotation===void 0){if(n instanceof B&&!($t(t,n.sourcePoint,n.hitPadding)||$t(t,n.targetPoint,n.hitPadding))||!(n instanceof B))return"Drag"}else return n&&vr(i)&&!xa(i)?"Pan":i.selectedItems.nodes.length&&i.selectedItems.nodes[0].isLane&&i.selectedItems.wrapper&&i.selectedItems.wrapper.bounds.containsPoint(t)?"Drag":"Select"}else return"Select";return"Select"}function Am(n,e,t,i,r,a){var s,o=n.selectedItems;return n.selectedItems.nodes.length===1&&n.selectedItems.connectors.length===0&&n.selectedItems.nodes[0].container&&!o.annotation&&(s=Em(n,e,t,r,a)),!s&&(o.annotation||!n.selectedItems.nodes[0]||!n.selectedItems.nodes[0].isPhase&&!n.selectedItems.nodes[0].isLane&&n.selectedItems.nodes[0].shape.type!=="SwimLane")&&(s=Dm(n,e,t,i,r,a)),s||null}function bm(n,e,t,i){var r=e.handleSize/2/i.scrollSettings.currentZoom,a=e.handleSize/2/i.scrollSettings.currentZoom;if(n.type==="Bezier"&&i.connectorEditingToolModule)for(var s=0;s<n.segments.length;s++){var o=n.segments[parseInt(s.toString(),10)];if($t(t,b.isEmptyPoint(o.point1)?o.bezierPoint1:o.point1,a)&&(s===0&&yr(n.bezierSettings.controlPointsVisibility,"Source")||s!==0&&yr(n.bezierSettings.controlPointsVisibility,"Intermediate")))return"BezierSourceThumb";if($t(t,b.isEmptyPoint(o.point2)?o.bezierPoint2:o.point2,r)&&(s===n.segments.length-1&&yr(n.bezierSettings.controlPointsVisibility,"Target")||s!==n.segments.length-1&&yr(n.bezierSettings.controlPointsVisibility,"Intermediate")))return"BezierTargetThumb"}if(i.connectorEditingToolModule&&Fa(n)){var h=n.constraints&yt.InheritSegmentThumbSize,l=h?i.segmentThumbSize:n.segmentThumbSize,d=l>20&&n.type!=="Straight"?l/2:10;if(d=d/i.scrollSettings.currentZoom,n.type==="Straight"||n.type==="Bezier")for(var s=0;s<n.segments.length;s++){var o=n.segments[parseInt(s.toString(),10)];if($t(t,o.point,d))return"SegmentEnd"}else for(var s=0;s<n.segments.length;s++){var f={x:0,y:0},o=n.segments[parseInt(s.toString(),10)];if(o.allowDrag)for(var p=0;p<o.points.length-1;p++){var c=b.distancePoints(o.points[parseInt(p.toString(),10)],o.points[p+1]);if(c>=50&&(f.x=(o.points[parseInt(p.toString(),10)].x+o.points[p+1].x)/2,f.y=(o.points[parseInt(p.toString(),10)].y+o.points[p+1].y)/2,$t(t,f,d)))return"OrthoThumb"}}}else Fa(n)&&console.warn('[WARNING] :: Module "ConnectorEditing" is not available in Diagram component! You either misspelled the module name or forgot to load it.');return null}function Jd(n,e,t,i){if(Zo(e)&&(ci(e,zt.Hover)||ci(e,zt.Visible))){if(e.constraints&Ct.Drag)return"PortDrag"}else if(fo(e)&&(ci(e,zt.Hover)||ci(e,zt.Visible))&&e.constraints&Ct.Draw){n.drawingObject={};var r={type:"Orthogonal",sourcePortID:e.id};return n.drawingObject=r,n.tool|=Gt.DrawOnce,n.currentDrawingObject instanceof B||(n.currentDrawingObject=r),"PortDraw"}return"None"}function Em(n,e,t,i,r){var a=10/n.scroller.currentZoom,s=n.selectedItems,o=e.actualSize.width,h=e.actualSize.height,l=new it(i,r,e.style.strokeWidth,h),d=new it(i+o,r,e.style.strokeWidth,h),f=new it(i,r,o,e.style.strokeWidth),p=new it(i,r+h,o,e.style.strokeWidth),c=ne(n,n.selectedItems.nodes[0],!0)?n.nameTable[n.selectedItems.nodes[0].parentId]:n.selectedItems.nodes[0];if(hi(s.constraints,"ResizeEast",s.thumbsConstraints,s)&&d.containsPoint(t,a))return"ResizeEast";if(hi(s.constraints,"ResizeSouth",s.thumbsConstraints,s)&&p.containsPoint(t,a))return"ResizeSouth";if(c.container.type!=="Grid"){if(hi(s.constraints,"ResizeWest",s.thumbsConstraints,s)&&l.containsPoint(t,a))return"ResizeWest";if(hi(s.constraints,"ResizeNorth",s.thumbsConstraints,s)&&f.containsPoint(t,a))return"ResizeNorth"}return null}function Dm(n,e,t,i,r,a){var s=40/n.scroller.currentZoom,o=n.selectedItems.handleSize/2/n.scroller.currentZoom,h=n.selectedItems,l=!!h.annotation;if(e.actualSize.width>=s&&e.actualSize.height>=s){if(hi(h.constraints,"ResizeSouthEast",h.thumbsConstraints,h)&&$t(t,st(i,{x:r+e.actualSize.width,y:a+e.actualSize.height}),o))return l?"LabelResizeSouthEast":"ResizeSouthEast";if(hi(h.constraints,"ResizeSouthWest",h.thumbsConstraints,h)&&$t(t,st(i,{x:r,y:a+e.actualSize.height}),o))return l?"LabelResizeSouthWest":"ResizeSouthWest";if(hi(h.constraints,"ResizeNorthEast",h.thumbsConstraints,h)&&$t(t,st(i,{x:r+e.actualSize.width,y:a}),o))return l?"LabelResizeNorthEast":"ResizeNorthEast";if(hi(h.constraints,"ResizeNorthWest",h.thumbsConstraints,h)&&$t(t,st(i,{x:r,y:a}),o))return l?"LabelResizeNorthWest":"ResizeNorthWest"}return hi(h.constraints,"ResizeEast",h.thumbsConstraints,h)&&$t(t,st(i,{x:r+e.actualSize.width,y:a+e.actualSize.height/2}),o)?l?"LabelResizeEast":"ResizeEast":hi(h.constraints,"ResizeWest",h.thumbsConstraints,h)&&$t(t,st(i,{x:r,y:a+e.actualSize.height/2}),o)?l?"LabelResizeWest":"ResizeWest":hi(h.constraints,"ResizeSouth",h.thumbsConstraints,h)&&$t(t,st(i,{x:r+e.actualSize.width/2,y:a+e.actualSize.height}),o)?l?"LabelResizeSouth":"ResizeSouth":hi(h.constraints,"ResizeNorth",h.thumbsConstraints,h)&&$t(t,st(i,{x:r+e.actualSize.width/2,y:a}),o)?l?"LabelResizeNorth":"ResizeNorth":null}function $t(n,e,t){return n.x>=e.x-t&&n.x<=e.x+t&&n.y>=e.y-t&&n.y<=e.y+t}function Si(n){return n.selectedItems.nodes.length>0||n.selectedItems.connectors.length>0}function _d(n){return n.selectedItems.connectors.length===1&&!n.selectedItems.nodes.length}function Ut(n,e,t,i){if(t===void 0&&(t=!0),e instanceof It)return!0;if(e instanceof M)for(;e;){if(n.selectedItems.nodes.indexOf(e)!==-1&&n.selectedItems.annotation===void 0)return!0;if(n.selectedItems.selectedObjects.indexOf(e)!==-1&&n.selectedItems.annotation===void 0)return!0;if(t)break;var r=e;e=n.nameTable[e.parentId],r&&n.nameTable[r.parentId]&&n.nameTable[r.parentId].shape.type==="Container"&&(e=void 0)}else if(e instanceof B){if(n.selectedItems.connectors.indexOf(e)!==-1&&n.selectedItems.annotation===void 0)return!0}else if((e instanceof ae||e instanceof Qt)&&n.selectedItems.annotation&&n.selectedItems.wrapper.children[0].id===i.id)return!0;return!1}function Lm(n,e){if(e+=360,e%=360,n.indexOf("Resize")===-1)return Fs[""+n];var t=Fs[""+n];if(e>=0&&e<25||e>=160&&e<=205||e>=340&&e<=360)return t;if(e>=25&&e<=70||e>=205&&e<=250)return t==="n-resize"||t==="s-resize"?"ne-resize":t==="nw-resize"||t==="se-resize"?"n-resize":t==="e-resize"||t==="w-resize"?"nw-resize":"e-resize";if(e>=70&&e<=115||e>=250&&e<=295)return t==="n-resize"||t==="s-resize"?"e-resize":t==="nw-resize"||t==="se-resize"?"ne-resize":t==="e-resize"||t==="w-resize"?"n-resize":"nw-resize";if(e>=115&&e<=155||e>=295&&e<=340){if(t==="n-resize"||t==="s-resize")return"nw-resize";if(t==="nw-resize"||t==="se-resize")return"e-resize";if(t==="e-resize"||t==="w-resize")return"ne-resize"}else return"n-resize";return Fs[""+n]}var Fs={None:"default",Rotate:"crosshair",Select:"default",Drag:"move",ResizeWest:"w-resize",ResizeEast:"e-resize",ResizeSouth:"s-resize",ResizeNorth:"n-resize",Draw:"crosshair",PortDraw:"crosshair",ResizeNorthEast:"ne-resize",ResizeNorthWest:"nw-resize",ResizeSouthEast:"se-resize",ResizeSouthWest:"sw-resize",ConnectorSourceEnd:"move",ConnectorTargetEnd:"move",BezierSourceThumb:"move",BezierTargetThumb:"move",OrthoThumb:"move",SegmentEnd:"move",Pan:"grab",Hyperlink:"pointer",PortDrag:"pointer",LabelSelect:"pointer",LabelDrag:"move",LabelRotate:"crosshair",LabelResizeWest:"w-resize",LabelResizeEast:"e-resize",LabelResizeSouth:"s-resize",LabelResizeNorth:"n-resize",LabelResizeNorthEast:"ne-resize",LabelResizeNorthWest:"nw-resize",LabelResizeSouthEast:"se-resize",LabelResizeSouthWest:"sw-resize"},De=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Xr=function(n,e,t,i){return new(t||(t=Promise))(function(r,a){function s(l){try{h(i.next(l))}catch(d){a(d)}}function o(l){try{h(i.throw(l))}catch(d){a(d)}}function h(l){l.done?r(l.value):new t(function(d){d(l.value)}).then(s,o)}h((i=i.apply(n,e||[])).next())})},Yr=function(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(d){return h([l,d])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(d){l=[6,d],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},xe=(function(){function n(e,t){t===void 0&&(t=!1),this.commandHandler=null,this.inAction=!1,this.isProtectChange=!1,this.currentElement=null,this.blocked=!1,this.isTooltipVisible=!1,this.childTable={},this.undoElement={nodes:[],connectors:[]},this.checkProperty=!0,this.undoParentElement={nodes:[],connectors:[]},this.undoContainerElement={nodes:[],connectors:[]},this.toolName="ToolBase",this.commandHandler=e,this.isProtectChange=t}return n.prototype.startAction=function(e){this.currentElement=e,this.inAction=!0},n.prototype.mouseDown=function(e){this.currentElement=e.source,this.startPosition=this.currentPosition=this.prevPosition=e.position,this.isTooltipVisible=!0,this.startAction(e.source),this.checkProperty=!0,this.mouseDownElement=e.source},n.prototype.checkPropertyValue=function(){this.checkProperty&&this.commandHandler.startTransaction(this.isProtectChange)},n.prototype.mouseMove=function(e){return this.currentPosition=e.position,this.inAction&&(this.commandHandler.startTransaction(this.isProtectChange),this.checkProperty=!1),!this.blocked},n.prototype.mouseUp=function(e){this.checkPropertyValue(),this.currentPosition=e.position,this.isTooltipVisible=!1,this.commandHandler.endTransaction(this.isProtectChange),this.endAction(),this.mouseDownElement=null},n.prototype.endAction=function(){this.isTooltipVisible||this.commandHandler.closeTooltip(),this.commandHandler=null,this.currentElement=null,this.currentPosition=null,this.inAction=!1,this.blocked=!1},n.prototype.mouseWheel=function(e){this.currentPosition=e.position},n.prototype.mouseLeave=function(e){this.mouseUp(e)},n.prototype.updateSize=function(e,t,i,r,a,s){e=this.commandHandler.renderContainerHelper(e)||e;var o={snapped:!1,offset:0,left:!1,right:!1},h={snapped:!1,offset:0,top:!1,bottom:!1},l=this.currentPosition.x-this.startPosition.x,d=this.currentPosition.y-this.startPosition.y,f=!(e instanceof Tt)&&this.commandHandler.snappingModule&&this.commandHandler.snappingModule.canSnap(),p=f?this.commandHandler.snappingModule.getLayer():null,c=e instanceof Tt?s:e.rotateAngle,u;u=xt(),Rt(u,-c,0,0);var g=e.offsetX,v=e.offsetY,m=e.width,y=e.height;g=g-m*e.pivot.x,v=v-y*e.pivot.y;var S=0,x=0,I,C=e instanceof Tt?e.actualSize.width:e.width,P=e instanceof Tt?e.actualSize.height:e.height;switch(r){case"ResizeWest":I=st(u,{x:l,y:d}),l=I.x,d=I.y,x=1,l=f?this.commandHandler.snappingModule.snapLeft(o,h,p,l,d,e,i===t,a):l,d=0,S=(a.width-l)/C;break;case"ResizeEast":I=st(u,{x:l,y:d}),l=I.x,d=I.y,l=f?this.commandHandler.snappingModule.snapRight(o,h,p,l,d,e,i===t,a):l,d=0,S=(a.width+l)/C,x=1;break;case"ResizeNorth":S=1,I=st(u,{x:l,y:d}),l=I.x,d=I.y,d=f?this.commandHandler.snappingModule.snapTop(o,h,p,l,d,e,i===t,a):d,x=(a.height-d)/P;break;case"ResizeSouth":S=1,I=st(u,{x:l,y:d}),l=I.x,d=I.y,d=f?this.commandHandler.snappingModule.snapBottom(o,h,p,l,d,e,i===t,a):d,x=(a.height+d)/P;break;case"ResizeNorthEast":I=st(u,{x:l,y:d}),l=I.x,d=I.y,l=f?this.commandHandler.snappingModule.snapRight(o,h,p,l,d,e,i===t,a):l,d=f?this.commandHandler.snappingModule.snapTop(o,h,p,l,d,e,i===t,a):d,S=(a.width+l)/C,x=(a.height-d)/P;break;case"ResizeNorthWest":I=st(u,{x:l,y:d}),l=I.x,d=I.y,d=f?this.commandHandler.snappingModule.snapTop(o,h,p,l,d,e,i===t,a):d,l=f?this.commandHandler.snappingModule.snapLeft(o,h,p,l,d,e,i===t,a):l,S=(a.width-l)/C,x=(a.height-d)/P;break;case"ResizeSouthEast":I=st(u,{x:l,y:d}),l=I.x,d=I.y,d=f?this.commandHandler.snappingModule.snapBottom(o,h,p,l,d,e,i===t,a):d,l=f?this.commandHandler.snappingModule.snapRight(o,h,p,l,d,e,i===t,a):l,x=(a.height+d)/P,S=(a.width+l)/C;break;case"ResizeSouthWest":I=st(u,{x:l,y:d}),l=I.x,d=I.y,d=f?this.commandHandler.snappingModule.snapBottom(o,h,p,l,d,e,i===t,a):d,l=f?this.commandHandler.snappingModule.snapLeft(o,h,p,l,d,e,i===t,a):l,S=(a.width-l)/C,x=(a.height+d)/P;break}return{width:S,height:x}},n.prototype.getPivot=function(e){switch(e){case"ResizeWest":return{x:1,y:.5};case"ResizeEast":return{x:0,y:.5};case"ResizeNorth":return{x:.5,y:1};case"ResizeSouth":return{x:.5,y:0};case"ResizeNorthEast":return{x:0,y:1};case"ResizeNorthWest":return{x:1,y:1};case"ResizeSouthEast":return{x:0,y:0};case"ResizeSouthWest":return{x:1,y:0}}return{x:.5,y:.5}},n.prototype.getShapeType=function(){var e;return this.commandHandler.diagram.drawingObject.shape.type==="Image"||this.commandHandler.diagram.drawingObject.shape.type==="HTML"||this.commandHandler.diagram.drawingObject.shape.type==="Native"||this.commandHandler.diagram.drawingObject.shape.type==="Path"?e=this.commandHandler.diagram.drawingObject.shape.type:e=this.commandHandler.diagram.drawingObject.shape.shape,e},n.prototype.triggerElementDrawEvent=function(e,t,i,r,a){var s={source:e,state:t,objectType:i,cancel:!1,elementType:r};this.commandHandler.triggerEvent(Z.elementDraw,s),a&&s.cancel&&(this.commandHandler.diagram.resetTool(),this.inAction=!1)},n})(),Qr=(function(n){De(e,n);function e(t,i,r){var a=n.call(this,t,!0)||this;return a.action=r,a}return e.prototype.mouseDown=function(t){this.inAction=!0,n.prototype.mouseDown.call(this,t)},e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),this.inAction&&b.equals(this.currentPosition,this.prevPosition)===!1){var i=it.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.clearSelectedItems(),this.commandHandler.drawSelectionRectangle(i.x,i.y,i.width,i.height)}return!this.blocked},e.prototype.mouseUp=function(t,i){if(this.checkPropertyValue(),!this.commandHandler.isUserHandle(this.currentPosition))if(b.equals(this.currentPosition,this.prevPosition)===!1&&this.inAction){var r=it.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.doRubberBandSelection(r)}else{var a=this.commandHandler.getSelectedObject();!this.commandHandler.hasSelection()||!t.info||!t.info.ctrlKey?(i!==2||!a.some(function(s){return s===t.source}))&&(this.commandHandler.clearSelection(t.source===null),this.action==="LabelSelect"?this.commandHandler.labelSelect(t.source,t.sourceWrapper,a):t.source&&this.commandHandler.selectObjects([t.source],!1,a)):t&&t.source&&(this.commandHandler.isSelected(t.source)?t.clickCount===1&&this.commandHandler.unSelect(t.source):this.commandHandler.selectObjects([t.source],!0))}this.inAction=!1,n.prototype.mouseUp.call(this,t)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e})(xe),Mm=(function(n){De(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.mouseUp=function(t){this.checkPropertyValue(),this.inAction=!1;for(var i=t.source,r,a=t.sourceWrapper.id,s=0;s<i.fixedUserHandles.length;s++)a.indexOf(i.fixedUserHandles[parseInt(s.toString(),10)].id)>-1&&(r=i.fixedUserHandles[parseInt(s.toString(),10)]);var o={fixedUserHandle:r,element:t.source},h=Z.fixedUserHandleClick;this.commandHandler.triggerEvent(h,o),n.prototype.mouseUp.call(this,t)},e})(xe),zr=(function(n){De(e,n);function e(t,i){var r=n.call(this,t,!0)||this;return r.isConnected=!1,r.endPoint=i,r.toolName="ConnectTool",r}return e.prototype.mouseDown=function(t){return Xr(this,void 0,void 0,function(){var i,r,a,s,o;return Yr(this,function(h){if(this.inAction=!0,this.undoElement=void 0,this instanceof qe||(this.undoElement=E(t.source)),n.prototype.mouseDown.call(this,t),t.source&&t.source.connectors&&(this.prevPosition.x,this.prevPosition.y,i=t.source.connectors[0],this.oldConnector=E(i)),this.endPoint==="BezierSourceThumb"||this.endPoint==="BezierTargetThumb")for(r=0;r<i.segments.length;r++)a=i.segments[parseInt(r.toString(),10)],s=b.isEmptyPoint(a.point1)?a.bezierPoint1:a.point1,o=b.isEmptyPoint(a.point2)?a.bezierPoint2:a.point2,this.currentElement.handleSize!==i.hitPadding&&(i.hitPadding=this.currentElement.handleSize),($t(this.currentPosition,s,i.hitPadding)||$t(this.currentPosition,o,i.hitPadding))&&(this.selectedSegment=a);return this.currentPosition=t.position,[2]})})},e.prototype.mouseUp=function(t){return Xr(this,void 0,void 0,function(){var i,r,v,a,s,p,o,h,v,l,d,f,p,u,g,c,u,g,v;return Yr(this,function(m){return i=this.toolName==="ConnectorDrawingTool",r=!t||!t.source||!t.source.connectors||!t.source.connectors.length,(i||r)&&this.inAction?(this.checkPropertyValue(),this.commandHandler.updateSelector(),this.commandHandler.removeSnap(),xe.prototype.mouseUp(t),[2]):(this.isConnected&&t.source&&t.source.connectors&&(v=t.source.connectors[0],a=this.endPoint==="ConnectorSourceEnd"?"sourceID":"targetID",s=this.endPoint==="ConnectorSourceEnd"?"sourcePortID":"targetPortID",p={connector:v,oldValue:{nodeId:this.oldConnector[""+a],portId:this.oldConnector[""+s]},newValue:{nodeId:v[""+a],portId:v[""+s]},cancel:!1,state:"Changed",connectorEnd:this.endPoint},(v[""+a]!==this.oldConnector[""+a]||v[""+s]!==this.oldConnector[""+s])&&(this.commandHandler.triggerEvent(Z.connectionChange,p),this.isConnected=!1)),this.checkPropertyValue(),this.commandHandler.updateSelector(),this.commandHandler.removeSnap(),t.source&&t.source.connectors&&!(this instanceof qe)&&(this.endPoint==="ConnectorSourceEnd"&&t.source.connectors.length&&(!b.equals(t.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)||t.source.connectors[0].sourceID!==this.undoElement.connectors[0].sourceID)||this.endPoint==="ConnectorTargetEnd"&&(!b.equals(t.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint)||t.source.connectors[0].targetID!==this.undoElement.connectors[0].targetID))?(o=void 0,h=void 0,v=void 0,t.source&&t.source.connectors&&this.endPoint==="ConnectorSourceEnd"?(o={x:this.oldConnector.sourcePoint.x,y:this.oldConnector.sourcePoint.y},v=t.source.connectors[0],h={x:v.sourcePoint.x,y:v.sourcePoint.y}):t.source&&t.source.connectors&&this.endPoint==="ConnectorTargetEnd"&&(o={x:this.oldConnector.targetPoint.x,y:this.oldConnector.targetPoint.y},v=t.source.connectors[0],h={x:v.targetPoint.x,y:v.targetPoint.y}),l=void 0,d=void 0,t.target&&(f=this.commandHandler.findTarget(t.targetWrapper,t.target,this.endPoint==="ConnectorSourceEnd",!0),d=f.id,f instanceof Se&&(l=f.id,d=t.target.id)),this.commandHandler.diagram.diagramActions&k.ToolAction&&(this.commandHandler.diagram.diagramActions&=~k.ToolAction),p={connector:v,state:"Completed",targetNode:d,oldValue:o,newValue:h,cancel:!1,targetPort:l},this.undoElement&&t.source&&(u=void 0,u=E(t.source),g={type:"ConnectionChanged",redoObject:E(u),undoObject:E(this.undoElement),category:"Internal"},this.commandHandler.addHistoryEntry(g)),c=this.endPoint==="ConnectorSourceEnd"?Z.sourcePointChange:Z.targetPointChange,this.commandHandler.triggerEvent(c,p)):!(this instanceof qe)&&(this.endPoint==="BezierTargetThumb"||this.endPoint==="BezierSourceThumb")&&this.undoElement&&t.source&&(u=E(t.source),g={type:"SegmentChanged",redoObject:u,undoObject:this.undoElement,category:"Internal"},this.commandHandler.addHistoryEntry(g)),this.canCancel=void 0,this.tempArgs=void 0,t.source&&t.source.connectors&&(v=t.source.connectors[0],v.isBezierEditing&&(v.isBezierEditing=!1)),n.prototype.mouseUp.call(this,t),[2])})})},e.prototype.mouseMove=function(t){var i=this;n.prototype.mouseMove.call(this,t);var r;if(!(this instanceof qe)&&(this.endPoint==="ConnectorSourceEnd"&&b.equals(t.source.connectors[0].sourcePoint,this.undoElement.connectors[0].sourcePoint)||this.endPoint==="ConnectorTargetEnd"&&b.equals(t.source.connectors[0].targetPoint,this.undoElement.connectors[0].targetPoint))){var a=void 0,s=void 0;t.source&&t.source.connectors&&(a={x:this.prevPosition.x,y:this.prevPosition.y},s=t.source.connectors[0]);var o=void 0,h=void 0;if(t.target){h=t.target.id;var l=this.commandHandler.findTarget(t.targetWrapper,t.target,this.endPoint==="ConnectorSourceEnd",!0);l instanceof Se||l instanceof Ir?o=l.id:h=l.id}var d={connector:s,state:"Start",targetNode:h,oldValue:a,newValue:a,cancel:!1,targetPort:o},f=this.endPoint==="ConnectorSourceEnd"?Z.sourcePointChange:Z.targetPointChange;this.commandHandler.triggerEvent(f,d)}if(this.currentPosition=t.position,this.currentPosition&&this.prevPosition){var p=this.currentPosition.x-this.prevPosition.x,c=this.currentPosition.y-this.prevPosition.y,u=void 0,a=void 0,g=void 0,v=void 0;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition);var m=void 0;t.source&&t.source.connectors&&(u={x:this.currentPosition.x,y:this.currentPosition.y},a={x:this.prevPosition.x,y:this.prevPosition.y},m=t.source.connectors[0]);var y=void 0,S=void 0,l=void 0;t.target&&(l=this.commandHandler.findTarget(t.targetWrapper,t.target,this.endPoint==="ConnectorSourceEnd",!0),l instanceof Se||l instanceof ke?y=l.id:S=l.id);var d={connector:m,state:"Progress",targetNode:S,oldValue:a,newValue:u,cancel:!1,targetPort:y};if(!(this instanceof qe)){var f=this.endPoint==="ConnectorSourceEnd"?Z.sourcePointChange:Z.targetPointChange;this.commandHandler.triggerEvent(f,d)}if(t.target&&(g=hn(t.target,!0),v=hn(t.target,!1)),!d.cancel&&this.inAction&&this.endPoint!==void 0&&(p!==0||c!==0))if(this.endPoint==="ConnectorSourceEnd"&&m&&m.type==="Orthogonal"&&m.segments&&m.segments.length>0){var x=m.segments[0],I=x.direction,C=function(Y,et,at){i.blocked=!i.commandHandler.dragConnectorEnds(i.endPoint,t.source,at||i.currentPosition,i.selectedSegment,et?t.target:void 0,Y)},P=m.sourcePortID!==y||m.sourceID!==S;if(P&&!S&&!y)this.commandHandler.canDisconnect(this.endPoint,t,y,S)&&(r=this.commandHandler.disConnect(t.source,this.endPoint,this.canCancel),this.isConnected=!0,C(y,S));else if(y&&m.sourcePortID!==y)this.checkConnect(l)&&(C(y,t.target.id),r=this.commandHandler.connect(this.endPoint,t,this.canCancel),this.isConnected=!0);else if(l instanceof M)if(P&&this.commandHandler.canDisconnect(this.endPoint,t,y,S)&&(r=this.commandHandler.disConnect(t.source,this.endPoint,this.canCancel)),Di(l)){var A=S?this.commandHandler.diagram.nameTable[""+S].wrapper.corners:void 0,T=function(){if(!I||!A)return i.currentPosition;switch(I){case"Bottom":return A.bottomCenter;case"Top":return A.topCenter;case"Left":return A.middleLeft;case"Right":return A.middleRight;default:return i.currentPosition}};C(void 0,t.target.id,T()),r=this.commandHandler.connect(this.endPoint,t,this.canCancel),this.isConnected=!0}else C(void 0,void 0);else l instanceof ke&&(this.blocked=!this.commandHandler.dragConnectorEnds(this.endPoint,t.source,this.currentPosition,this.selectedSegment,t.target,y),r=this.commandHandler.connect(this.endPoint,t,this.canCancel))}else if(d.cancel||(this.blocked=!this.commandHandler.dragConnectorEnds(this.endPoint,t.source,this.currentPosition,this.selectedSegment,t.target,y),this.commandHandler.updateSelector()),t.target&&(this.endPoint==="ConnectorSourceEnd"&&(Di(t.target)||ar(v))||this.endPoint==="ConnectorTargetEnd"&&(ii(t.target)||Li(g)))){this.commandHandler.canDisconnect(this.endPoint,t,y,S)&&(r=this.commandHandler.disConnect(t.source,this.endPoint,this.canCancel),this.isConnected=!0);var z=this.commandHandler.findTarget(t.targetWrapper,t.target,this.endPoint==="ConnectorSourceEnd",!0);if(z instanceof M)(ii(z)&&this.endPoint==="ConnectorTargetEnd"||Di(z)&&this.endPoint==="ConnectorSourceEnd")&&(r=this.commandHandler.connect(this.endPoint,t,this.canCancel),this.isConnected=!0);else{var L=this.checkConnect(z);L&&(this.isConnected=!0,r=this.commandHandler.connect(this.endPoint,t,this.canCancel))}}else this.endPoint.indexOf("Bezier")===-1&&(this.isConnected=!0,r=this.commandHandler.disConnect(t.source,this.endPoint,this.canCancel),this.commandHandler.updateSelector());if(this.commandHandler.canEnableDefaultTooltip()){var R=this.getTooltipContent(t.position),O=function(){return R};this.commandHandler.showTooltip(t.source,t.position,xr(O),"ConnectTool",this.isTooltipVisible),this.isTooltipVisible=!1}else this.isTooltipVisible&&(this.commandHandler.closeTooltip(),this.isTooltipVisible=!1);r&&(this.tempArgs=r)}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.getTooltipContent=function(t){return"X:"+Math.round(t.x)+" Y:"+Math.round(t.y)},e.prototype.checkConnect=function(t){return Li(t)&&this.endPoint==="ConnectorTargetEnd"||ar(t)&&this.endPoint==="ConnectorSourceEnd"?!0:!(t.constraints&Ct.None)&&!Li(t)&&!ar(t)&&(t.constraints===void 0||(t.constraints&(Ct.Default&~(Ct.InConnect|Ct.OutConnect)))>0)},e.prototype.endAction=function(){n.prototype.endAction.call(this),this.prevPosition=null,this.endPoint=null},e})(xe),oi=(function(n){De(e,n);function e(t,i){var r=n.call(this,t,!0)||this;return r.currentTarget=null,r.isStartAction=!1,r.canCancel=!1,r.canTrigger=!1,r.objectType=i,r}return e.prototype.mouseDown=function(t){if(t.source instanceof M||t.source instanceof B){var i=this.commandHandler.getSelectedObject();this.commandHandler.selectObjects([t.source],t.info&&t.info.ctrlKey,i);var r={nodes:[],connectors:[]};t.source instanceof M?r.nodes.push(E(t.source)):r.connectors.push(E(t.source)),this.undoElement=E(r);var a=t.source.wrapper;this.undoElement.offsetX=a.offsetX,this.undoElement.offsetY=a.offsetY}else this.undoElement=E(t.source);this.commandHandler.trackConnectorChange(this.undoElement),this.undoParentElement=this.commandHandler.getSubProcess(t.source),this.undoContainerElement=this.commandHandler.getContainer(t.source),this.objectType==="Port"&&(this.portId=t.sourceWrapper.id),this.commandHandler.insertBlazorConnector(t.source),n.prototype.mouseDown.call(this,t),this.initialOffset={x:0,y:0}},e.prototype.getPort=function(t){for(var i,r=t.source.id,a=t.source.ports,s=0;s<a.length;s++)if(t.sourceWrapper.id===r+"_"+a[parseInt(s.toString(),10)].id){i=a[parseInt(s.toString(),10)];break}return i},e.prototype.mouseUp=function(t,i){return Xr(this,void 0,void 0,function(){var r,a,s,o,h,l,d,f,p,H,c,u,g,v,m,y,F,S,x,H,L,I,C,P,H,H,F,A,T,H,H,z,L,R,O,N,H,H,F;return Yr(this,function(Y){if(this.checkPropertyValue(),o=!1,l={nodes:[],connectors:[]},this.objectType!=="Port"){if(t.source instanceof M||t.source instanceof B?(t.source instanceof M?l.nodes.push(E(t.source)):l.connectors.push(E(t.source)),s=E(l),d=t.source.wrapper,s.offsetX=d.offsetX,s.offsetY=d.offsetY):s=E(t.source),this.commandHandler.trackConnectorChange(s),h=this.commandHandler.renderContainerHelper(t.source)||t.source||this.commandHandler.renderContainerHelper(t.source),h.id==="helper"||h.id!=="helper"){if(f=!1,h instanceof It&&(p=E(h),p.selectedObjects.length===this.undoElement.selectedObjects.length)){for(H=0;H<p.selectedObjects.length;H++)if(p.selectedObjects[parseInt(H.toString(),10)].id!==this.undoElement.selectedObjects[parseInt(H.toString(),10)].id){f=!0;break}}if(c=h instanceof It,u=h instanceof It&&h.selectedObjects&&h.selectedObjects.length===1,g=h instanceof It&&Math.round(h.width)===Math.round(this.undoElement.width)&&Math.round(h.height)===Math.round(this.undoElement.height),v=h.offsetX!==this.undoElement.offsetX||h.offsetY!==this.undoElement.offsetY,m=h.sourcePoint!==this.undoElement.sourcePoint,y=h.targetPoint!==this.undoElement.targetPoint,!f&&(c&&(g||u)||!c)&&(v||m||y)||this.isSelectionHasConnector(h)){if(t.source&&(a={offsetX:t.source.wrapper.offsetX,offsetY:t.source.wrapper.offsetY},r={offsetX:t.source.wrapper.offsetX,offsetY:t.source.wrapper.offsetY}),F={source:t.source,state:"Completed",oldValue:this.intialValue,newValue:a,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:!0,cancel:!1},F={source:t.source,state:"Completed",oldValue:this.intialValue,newValue:a,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:F.allowDrop,cancel:F.cancel},S=!0,h.id==="helper")if(this.canTrigger){if((s.nodes.length>1||s.connectors.length>1)&&this.commandHandler.diagram.lineRoutingModule&&this.commandHandler.diagram.constraints&lt.LineRouting){for(x=this.commandHandler.diagram.nameTable,H=0;H<s.nodes.length;H++)if(!(x[s.nodes[parseInt(H.toString(),10)].parentId]&&x[s.nodes[parseInt(H.toString(),10)].parentId].isLane)){S=!1;break}}else S=!0;this.commandHandler.triggerEvent(Z.positionChange,F),this.connectorEndPointChangeEvent(F)}else S=!1;else this.commandHandler.triggerEvent(Z.positionChange,F),this.connectorEndPointChangeEvent(F);!i&&S&&(this.commandHandler.startGroupAction(),o=!0,L={type:"PositionChanged",redoObject:E(s),undoObject:E(this.undoElement),category:"Internal"},s.nodes[0]&&s.nodes[0].processId&&(I={type:"SizeChanged",category:"Internal",undoObject:this.undoParentElement,redoObject:this.commandHandler.getSubProcess(t.source)},this.commandHandler.addHistoryEntry(I)),s.nodes[0]&&s.nodes[0].parentId&&this.commandHandler.diagram.nameTable[s.nodes[0].parentId].shape.type==="Container"&&(C={type:"SizeChanged",category:"Internal",undoObject:this.undoContainerElement,redoObject:this.commandHandler.getContainer(t.source)},this.commandHandler.addHistoryEntry(C)),this.commandHandler.addHistoryEntry(L))}}if(this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,0,0),this.commandHandler.removeSnap(),this.commandHandler.removeHighlighter(),t.source&&this.currentTarget&&Ga(this.currentTarget)&&this.commandHandler.isDroppable(t.source,this.currentTarget)){if(P=!0,this.commandHandler.drop(this.currentElement,this.currentTarget,this.currentPosition),this.currentTarget&&this.currentTarget instanceof B&&this.commandHandler.diagram.enableConnectorSplit===!0){if(this.currentElement&&this.currentElement instanceof M){if(this.currentElement.children!==void 0)for(H=0;H<this.currentElement.children.length;H++)(this.currentElement.children[parseInt(H.toString(),10)]===this.currentTarget.sourceID||this.currentElement.children[parseInt(H.toString(),10)]===this.currentTarget.targetID)&&(P=!1);else(this.currentElement.id===this.currentTarget.sourceID||this.currentElement.id===this.currentTarget.targetID)&&(P=!1);P&&this.commandHandler.connectorSplit(this.currentElement,this.currentTarget)}else if(this.currentElement instanceof It&&!this.commandHandler.PreventConnectorSplit){if(this.currentElement.nodes[0].children)for(H=0;H<this.currentElement.nodes[0].children.length;H++)(this.currentElement.nodes[0].children[parseInt(H.toString(),10)]===this.currentTarget.sourceID||this.currentElement.nodes[0].children[parseInt(H.toString(),10)]===this.currentTarget.targetID)&&(P=!1);else(this.currentElement.nodes[0].id===this.currentTarget.sourceID||this.currentElement.nodes[0].id===this.currentTarget.targetID)&&(P=!1);P&&(this.commandHandler.connectorSplit(this.currentElement.nodes[0],this.currentTarget),this.commandHandler.PreventConnectorSplit=!1)}}if(F={element:t.source,target:this.currentTarget,position:this.currentPosition,cancel:!1},this.commandHandler.triggerEvent(Z.drop,F),!F.cancel&&t.source&&this.commandHandler.isParentAsContainer(this.currentTarget)&&!this.commandHandler.isTargetSubProcess(this.currentTarget)){for(A=t.source instanceof It?t.source.nodes:[t.source],T=!1,H=0;H<A.length&&A[0].parentId===A[parseInt(H.toString(),10)].parentId;H++);for(this.commandHandler.diagram.selectedItems.nodes.length!==A.length&&(A=this.commandHandler.diagram.selectedItems.nodes),this.commandHandler.diagram.selectedItems.nodes.length>1?(A=this.calculateDiff(this.commandHandler.diagram.selectedItems,this.currentTarget,this.commandHandler.diagram),this.commandHandler.diagram.multiselect=!0):this.commandHandler.diagram.multiselect=!1,H=0;H<A.length;H++)!A[parseInt(H.toString(),10)].container&&!this.commandHandler.diagram.cancelPositionChange&&(T=!0,this.commandHandler.updateLaneChildrenZindex(A[parseInt(H.toString(),10)],this.currentTarget),this.commandHandler.dropChildToContainer(this.currentTarget,A[parseInt(H.toString(),10)]),this.commandHandler.renderContainerHelper(A[parseInt(H.toString(),10)]));A.length>1&&(z=this.commandHandler.diagram.nameTable.helper,z&&Cm(this.currentTarget,z,this.commandHandler.diagram)),o&&this.commandHandler.isContainer&&T&&this.commandHandler.endGroupAction()}}t.source&&this.currentTarget&&this.commandHandler.dropAnnotation(t.source,this.currentTarget),this.commandHandler.updateSelector(),o&&!this.commandHandler.isContainer&&this.commandHandler.endGroupAction()}else{if(l.nodes.push(E(t.source)),t.portId=this.portId,s=E(l),L={type:"PortPositionChanged",objectId:this.portId,redoObject:E(s),undoObject:E(this.undoElement),category:"Internal"},this.commandHandler.addHistoryEntry(L),R=this.getPort(t),R){for(O=this.undoElement.nodes.length>0?this.undoElement.nodes[0].ports:[],N=this.undoElement.connectors.length>0?this.undoElement.connectors[0].ports:[],H=0;H<O.length;H++)if(R.id===O[parseInt(H.toString(),10)].id){r={offsetX:O[parseInt(H.toString(),10)].offset.x,offsetY:O[parseInt(H.toString(),10)].offset.y},a={offsetX:R.offset.x,offsetY:R.offset.y};break}for(H=0;H<N.length;H++)if(R.id===N[parseInt(H.toString(),10)].id){r={offset:N[parseInt(H.toString(),10)].offset},a={offset:R.offset};break}}F={source:R,state:"Completed",oldValue:r,newValue:a,target:this.currentTarget,targetPosition:this.currentPosition,allowDrop:!0,cancel:!1},this.commandHandler.triggerEvent(Z.positionChange,F)}return n.prototype.mouseUp.call(this,t),[2]})})},e.prototype.clearDiff=function(t){t.forEach(function(i,r){delete i.diffX,delete i.diffY})},e.prototype.calculateDiff=function(t,i,r){this.clearDiff(t.nodes);var a=t.wrapper.bounds.left,s=t.wrapper.bounds.top,o=i.wrapper.bounds.left,h=i.wrapper.bounds.top,l,d,f=r.nameTable[i.parentId];i.columnIndex===0&&f&&f.shape.orientation==="Horizontal"&&(o+=50),i.rowIndex===1&&f&&f.shape.orientation==="Vertical"&&(h+=50),a<o?l=o-a:l=0,s<h?d=h-s:d=0;var p=t.nodes;return p.forEach(function(c,u){c.diffX=l,c.diffY=d}),p},e.prototype.connectorEndPointChangeEvent=function(t,i){var r=t.source;if(r instanceof It&&r.nodes.length>0)for(var a=0;a<r.nodes.length;a++){var s=r.nodes[parseInt(a.toString(),10)];if(s&&s.inEdges.length>0)for(var o=0;o<s.inEdges.length;o++){var h=this.commandHandler.diagram.getObject(s.inEdges[parseInt(o.toString(),10)]);h&&this.triggerEndPointEvent(h,t,i,"targetPointChange")}if(s&&s.outEdges.length>0)for(var o=0;o<s.outEdges.length;o++){var h=this.commandHandler.diagram.getObject(s.outEdges[parseInt(o.toString(),10)]);h&&this.triggerEndPointEvent(h,t,i,"sourcePointChange")}}},e.prototype.triggerEndPointEvent=function(t,i,r,a){var s={connector:t,state:i.state,targetNode:t.targetID,targetPort:t.targetPortID,sourceNode:t.sourceID,sourcePort:t.sourcePortID,oldValue:{x:t.targetPoint.x,y:t.targetPoint.y},newValue:{x:t.targetPoint.x+(r?r.x:0),y:t.targetPoint.y+(r?r.y:0)},cancel:i.cancel};this.commandHandler.triggerEvent(a==="targetPointChange"?Z.targetPointChange:Z.sourcePointChange,s)},e.prototype.isSelectionHasConnector=function(t){return!!(t.nodes&&t.connectors&&t.nodes.length>0&&t.connectors.length>0&&(t.width!==this.undoElement.width||t.height!==this.undoElement.height))},e.prototype.mouseMove=function(t){n.prototype.mouseMove.call(this,t);var i=!1,r;if(r=this.commandHandler.renderContainerHelper(t.source)||t.source,!r)return!1;r instanceof M||r instanceof B?r instanceof M&&this.undoElement.nodes[0]?r.offsetX===this.undoElement.nodes[0].offsetX&&r.offsetY===this.undoElement.nodes[0].offsetY&&(i=!0):this.undoElement.connectors[0]&&b.equals(r.sourcePoint,this.undoElement.connectors[0].sourcePoint)&&b.equals(r.targetPoint,this.undoElement.connectors[0].targetPoint)&&(i=!0):r&&r.wrapper&&r.wrapper.offsetX===this.undoElement.wrapper.offsetX&&r.wrapper.offsetY===this.undoElement.wrapper.offsetY&&(i=!0);var a;r&&(a={offsetX:r.wrapper.offsetX,offsetY:r.wrapper.offsetY});var s={source:r,state:"Start",oldValue:a,newValue:a,target:t.target,targetPosition:t.position,allowDrop:!0,cancel:!1};if(s={source:r,state:"Start",oldValue:a,newValue:a,target:t.target,targetPosition:t.position,allowDrop:s.allowDrop,cancel:s.cancel},this.objectType==="Port"){var o=this.getPort(t);if(o){for(var h=this.undoElement.nodes.length>0?this.undoElement.nodes[0].ports:[],l=this.undoElement.connectors.length>0?this.undoElement.connectors[0].ports:[],d=0;d<h.length;d++)if(a={offsetX:o.offset.x,offsetY:o.offset.y},o.offset.x!==h[parseInt(d.toString(),10)].offset.x||o.offset.y!==h[parseInt(d.toString(),10)].offset.y){i=!1;break}for(var d=0;d<l.length;d++)if(a={offset:o.offset},o.offset!==l[parseInt(d.toString(),10)].offset){i=!1;break}}s={source:o,state:"Start",oldValue:a,newValue:a,target:t.target,targetPosition:t.position,allowDrop:!0,cancel:!1}}if(!this.isStartAction&&(this.intialValue={offsetX:r.wrapper.offsetX,offsetY:r.wrapper.offsetY},this.commandHandler.diagram.lineRoutingModule&&this.commandHandler.diagram.constraints&lt.LineRouting&&this.commandHandler.diagram.layout.type!=="ComplexHierarchicalTree")){var f=40,p=ze(r.wrapper);p.Inflate(f);for(var c=this.commandHandler.diagram.spatialSearch.findObjects(p),u=0,g=c;u<g.length;u++){var v=g[u];v instanceof B&&this.commandHandler.diagram.routedConnectors.indexOf(v.id)}}if(i&&(this.commandHandler.triggerEvent(Z.positionChange,s),this.connectorEndPointChangeEvent(s),this.isStartAction=!0),this.commandHandler.diagram.cancelPositionChange=s.cancel,this.currentPosition=t.position,this.objectType!=="Port"){this.currentPosition.x-this.prevPosition.x,this.currentPosition.y-this.prevPosition.y;var m=this.initialOffset.x+(this.currentPosition.x-this.prevPosition.x),y=this.initialOffset.y+(this.currentPosition.y-this.prevPosition.y);this.commandHandler.dragOverElement(t,this.currentPosition),this.commandHandler.disConnect(t.source),this.commandHandler.removeSnap();var S,x=void 0,I=this.commandHandler.snapPoint(this.prevPosition,this.currentPosition,m,y);this.initialOffset.x=m-I.x,this.initialOffset.y=y-I.y,r&&(S={offsetX:r.wrapper.offsetX,offsetY:r.wrapper.offsetY},x={offsetX:r.wrapper.offsetX+I.x,offsetY:r.wrapper.offsetY+I.y}),this.currentTarget&&t.target!==this.currentTarget&&this.commandHandler.removeChildFromBPmn(t.source,t.target,this.currentTarget),this.currentTarget=t.target;var C={source:r,state:"Progress",oldValue:S,newValue:x,target:t.target,targetPosition:t.position,allowDrop:!0,cancel:!1};if(this.commandHandler.triggerEvent(Z.positionChange,C),this.commandHandler.diagram.cancelPositionChange=C.cancel,this.canTrigger=!0,this.connectorEndPointChangeEvent(C,I),!C.cancel&&!this.canCancel){this.blocked=!this.commandHandler.dragSelectedObjects(I.x,I.y);var P=!this.commandHandler.mouseOver(this.currentElement,this.currentTarget,this.currentPosition);this.blocked=this.blocked||P}if(this.commandHandler.removeStackHighlighter(),this.commandHandler.renderStackHighlighter(t),this.currentTarget&&t.source!==this.currentTarget&&this.commandHandler.isDroppable(t.source,this.currentTarget)&&t.source.id!=="helper"){var A=t.source instanceof It?t.source.nodes[0]||t.source.connectors[0]:t.source;!this.commandHandler.isParentAsContainer(A,!0)&&A.shape.type!=="SwimLane"&&!A.shape.isPhase&&(this.currentTarget.isLane?this.commandHandler.renderStackHighlighter(t,this.currentTarget):this.commandHandler.drawHighlighter(this.currentTarget))}else this.commandHandler.removeHighlighter();if(this.commandHandler.canEnableDefaultTooltip()){var T=this.getTooltipContent(t.source),z=function(){return T};this.commandHandler.showTooltip(t.source,t.position,xr(z),"MoveTool",this.isTooltipVisible),this.isTooltipVisible=!1}else this.isTooltipVisible&&(this.commandHandler.closeTooltip(),this.isTooltipVisible=!1)}else{var L=xt(),R=t.source,O,x=void 0,h=this.undoElement.nodes.length>0?this.undoElement.nodes[0].ports:[],l=this.undoElement.connectors.length>0?this.undoElement.connectors[0].ports:[],o=this.getPort(t);if(o){for(var d=0;d<h.length;d++){O={offsetX:o.offset.x,offsetY:o.offset.y};break}for(var d=0;d<l.length;d++){O={offset:o.offset};break}}Rt(L,-R.rotateAngle||-R.wrapper.rotateAngle,R.offsetX||R.wrapper.offsetX,R.offsetY||R.wrapper.offsetY);var N=st(L,{x:this.prevPosition.x,y:this.prevPosition.y}),H=st(L,{x:t.position.x,y:t.position.y});if(this.commandHandler.portDrag(t.source,t.sourceWrapper,H.x-N.x,H.y-N.y),o){for(var d=0;d<h.length;d++){x={offsetX:o.offset.x,offsetY:o.offset.y};break}for(var d=0;d<l.length;d++){x={offset:o.offset};break}}var F={source:o,state:"Progress",oldValue:O,newValue:x,target:t.target,targetPosition:t.position,allowDrop:!0,cancel:!1};this.commandHandler.triggerEvent(Z.positionChange,F)}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.getTooltipContent=function(t){return"X:"+Math.round(t.wrapper.bounds.x)+" Y:"+Math.round(t.wrapper.bounds.y)},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.endAction=function(){n.prototype.endAction.call(this),this.currentTarget=null,this.prevPosition=null},e})(xe),Vs=(function(n){De(e,n);function e(t){var i=n.call(this,t,!0)||this;return i.rotateStart=!1,i}return e.prototype.mouseDown=function(t){if(this.undoElement=E(t.source),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children)for(var i=[],r=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],i),a=0;a<r.length;a++){var s=this.commandHandler.cloneChild(r[parseInt(a.toString(),10)].id);this.childTable[r[parseInt(a.toString(),10)].id]=E(s)}this.commandHandler.trackConnectorChange(this.undoElement),n.prototype.mouseDown.call(this,t)},e.prototype.mouseUp=function(t){return Xr(this,void 0,void 0,function(){var i,r,a,s,o,h;return Yr(this,function(l){return this.checkPropertyValue(),i=this.commandHandler.renderContainerHelper(t.source)||t.source,this.undoElement.rotateAngle!==i.wrapper.rotateAngle&&(r={rotateAngle:this.undoElement.rotateAngle},a={rotateAngle:i.wrapper.rotateAngle},s={source:t.source,state:"Completed",oldValue:r,newValue:a,cancel:!1},this.commandHandler.triggerEvent(Z.rotateChange,s),o=void 0,o=E(t.source),this.commandHandler.trackConnectorChange(o),h={type:"RotationChanged",redoObject:E(o),undoObject:E(this.undoElement),category:"Internal",childTable:this.childTable},this.commandHandler.addHistoryEntry(h),this.rotateStart=!1),this.commandHandler.updateSelector(),this.canCancel=void 0,this.tempArgs=void 0,n.prototype.mouseUp.call(this,t),[2]})})},e.prototype.mouseMove=function(t){n.prototype.mouseMove.call(this,t);var i;if(i=this.commandHandler.renderContainerHelper(t.source)||t.source,this.undoElement.rotateAngle===i.wrapper.rotateAngle&&!this.rotateStart){var r={rotateAngle:i.wrapper.rotateAngle},a={source:t.source,state:"Start",oldValue:r,newValue:r,cancel:!1};this.commandHandler.triggerEvent(Z.rotateChange,a),this.rotateStart=!0}this.currentPosition=t.position;var s={x:i.wrapper.offsetX,y:i.wrapper.offsetY},o=b.findAngle(s,this.currentPosition)+90,h=this.commandHandler.snapAngle(o);o=h!==0?h:o,o=(o+360)%360;var l={rotateAngle:i.wrapper.rotateAngle},d={rotateAngle:o},f={source:t.source,cancel:!1},p={source:t.source,state:"Progress",oldValue:l,newValue:d,cancel:f.cancel};if(this.commandHandler.triggerEvent(Z.rotateChange,p),p.cancel||(this.blocked=!this.commandHandler.rotateSelectedItems(o-i.wrapper.rotateAngle)),this.commandHandler.canEnableDefaultTooltip()){var c=this.getTooltipContent(t.source),u=function(){return c};this.commandHandler.showTooltip(t.source,t.position,xr(u),"RotateTool",this.isTooltipVisible),this.isTooltipVisible=!1}return!this.blocked},e.prototype.getTooltipContent=function(t){return Math.round(t.rotateAngle%360).toString()+""},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.endAction=function(){n.prototype.endAction.call(this)},e})(xe),Lr=(function(n){De(e,n);function e(t,i){var r=n.call(this,t,!0)||this;return r.resizeStart=!1,r.initialBounds=new it,r.canCancel=!1,r.corner=i,r}return e.prototype.mouseDown=function(t){if(this.undoElement=E(t.source),this.undoParentElement=this.commandHandler.getSubProcess(t.source),this.undoContainerElement=this.commandHandler.getContainer(t.source),n.prototype.mouseDown.call(this,t),this.undoElement.nodes[0]&&this.undoElement.nodes[0].children)for(var i=[],r=this.commandHandler.getAllDescendants(this.undoElement.nodes[0],i),a=0;a<r.length;a++){var s=this.commandHandler.cloneChild(r[parseInt(a.toString(),10)].id);this.childTable[r[parseInt(a.toString(),10)].id]=E(s)}this.commandHandler.trackConnectorChange(this.undoElement),this.commandHandler.checkSelection(t.source,this.corner),n.prototype.mouseDown.call(this,t),this.initialBounds.x=t.source.wrapper.offsetX,this.initialBounds.y=t.source.wrapper.offsetY,this.initialBounds.height=t.source.wrapper.actualSize.height,this.initialBounds.width=t.source.wrapper.actualSize.width},e.prototype.mouseUp=function(t,i){return Xr(this,void 0,void 0,function(){var r,a,s,o,h,l,d,f;return Yr(this,function(p){return this.checkPropertyValue(),this.commandHandler.removeSnap(),this.commandHandler.updateSelector(),r=this.commandHandler.renderContainerHelper(t.source)||t.source,(this.undoElement.offsetX!==r.wrapper.offsetX||this.undoElement.offsetY!==r.wrapper.offsetY||this.undoElement.width!==r.wrapper.bounds.width||this.undoElement.height!==r.wrapper.bounds.height)&&(a=this.updateSize(t.source,this.currentPosition,this.prevPosition,this.corner,this.initialBounds),this.blocked=this.scaleObjects(a.width,a.height,this.corner,this.currentPosition,this.prevPosition,r),s={width:t.source.wrapper.actualSize.width,height:t.source.wrapper.actualSize.height},o={source:t.source,state:"Completed",oldValue:this.startValues,newValue:s,cancel:!1},this.commandHandler.triggerEvent(Z.sizeChange,o),h=E(t.source),this.commandHandler.trackConnectorChange(h),l={type:"SizeChanged",redoObject:E(h),undoObject:E(this.undoElement),category:"Internal",childTable:this.childTable},this.resizeStart=!1,i||(this.commandHandler.startGroupAction(),h.nodes[0]&&h.nodes[0].processId&&(d={type:"SizeChanged",redoObject:this.commandHandler.getSubProcess(t.source),undoObject:this.undoParentElement,category:"Internal"},this.commandHandler.addHistoryEntry(d)),h.nodes[0]&&h.nodes[0].parentId&&this.commandHandler.diagram.nameTable[h.nodes[0].parentId].shape.type==="Container"&&(f={type:"SizeChanged",redoObject:this.commandHandler.getContainer(t.source),undoObject:this.undoContainerElement,category:"Internal"},this.commandHandler.addHistoryEntry(f)),this.commandHandler.addHistoryEntry(l),this.commandHandler.endGroupAction())),n.prototype.mouseUp.call(this,t),[2,!this.blocked]})})},e.prototype.mouseMove=function(t){n.prototype.mouseMove.call(this,t);var i;if(i=this.commandHandler.renderContainerHelper(t.source)||t.source,this.undoElement.offsetX===i.wrapper.offsetX&&this.undoElement.offsetY===i.wrapper.offsetY&&!this.resizeStart){var r={width:t.source.wrapper.actualSize.width,height:t.source.wrapper.actualSize.height};this.startValues=r;var a={source:t.source,state:"Start",oldValue:r,newValue:this.currentElement,cancel:!1};this.commandHandler.triggerEvent(Z.sizeChange,a),this.resizeStart=!0}this.currentPosition=t.position;var s=this.currentPosition.x-this.startPosition.x,o=this.currentPosition.y-this.startPosition.y,h={x:s,y:o};h=ye(-this.currentElement.wrapper.rotateAngle,void 0,void 0,h),(this.currentElement.wrapper.actualSize.width+h.x)/this.currentElement.wrapper.actualSize.width,(this.currentElement.wrapper.actualSize.height+h.y)/this.currentElement.wrapper.actualSize.height,h=this.getChanges(h),this.commandHandler.removeSnap();var l=this.updateSize(t.source,this.startPosition,this.currentPosition,this.corner,this.initialBounds);if(this.blocked=!this.scaleObjects(l.width,l.height,this.corner,this.startPosition,this.currentPosition,i),this.commandHandler.canEnableDefaultTooltip()){var d=this.getTooltipContent(t.source),f=function(){return d};this.commandHandler.showTooltip(t.source,t.position,xr(f),"ResizeTool",this.isTooltipVisible),this.isTooltipVisible=!1}else this.isTooltipVisible&&(this.commandHandler.closeTooltip(),this.isTooltipVisible=!1);return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.getTooltipContent=function(t){return"W:"+Math.round(t.wrapper.bounds.width)+" H:"+Math.round(t.wrapper.bounds.height)},e.prototype.getChanges=function(t){switch(this.corner){case"ResizeEast":return{x:t.x,y:0};case"ResizeSouthEast":return t;case"ResizeSouth":return{x:0,y:t.y};case"ResizeNorth":return{x:0,y:-t.y};case"ResizeNorthEast":return{x:t.x,y:-t.y};case"ResizeNorthWest":return{x:-t.x,y:-t.y};case"ResizeWest":return{x:-t.x,y:0};case"ResizeSouthWest":return{x:-t.x,y:t.y}}return t},e.prototype.scaleObjects=function(t,i,r,a,s,o){var h=this.commandHandler.diagram.selectedItems;(o instanceof It&&o.nodes.length===1&&o.nodes[0].constraints&W.AspectRatio||o instanceof M&&o.id==="helper"&&h.nodes.length===1&&h.nodes[0].constraints&W.AspectRatio)&&(r==="ResizeWest"||r==="ResizeEast"||r==="ResizeNorth"||r==="ResizeSouth"?i===1&&t===1||(i=t=Math.max(i===1?0:i,t===1?0:t)):i=t=Math.max(i,t));var l={width:o.width,height:o.height};this.blocked=this.commandHandler.scaleSelectedItems(t,i,this.getPivot(this.corner));var d={width:o.width,height:o.height},f;f={source:o,state:"Progress",oldValue:l,newValue:d,cancel:!1};var p;return p={source:o,state:"Progress",oldValue:l,newValue:d,cancel:f.cancel},this.commandHandler.triggerEvent(Z.sizeChange,p),(p.cancel||this.canCancel)&&this.commandHandler.scaleSelectedItems(1/t,1/i,this.getPivot(this.corner)),this.blocked},e})(xe),da=(function(n){De(e,n);function e(t,i){var r=n.call(this,t,!0)||this;return r.sourceObject=i,r}return e.prototype.mouseDown=function(t){n.prototype.mouseDown.call(this,t),this.inAction=!0,this.commandHandler.setFocus(),this.triggerElementDrawEvent(t.source,"Start","Node",this.getShapeType(),!0)},e.prototype.mouseMove=function(t){n.prototype.mouseMove.call(this,t);var i,r={offsetX:this.currentPosition.x,width:3,height:3,offsetY:this.currentPosition.y};if(this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(r)),this.triggerElementDrawEvent(this.drawingObject,"Progress","Node",this.getShapeType(),!1),this.inAction&&b.equals(this.currentPosition,this.prevPosition)===!1){var a=it.toBounds([this.prevPosition,this.currentPosition]);i=this.commandHandler.checkBoundaryConstraints(void 0,void 0,a),i&&this.commandHandler.updateNodeDimension(this.drawingObject,a)}return i},e.prototype.mouseUp=function(t){this.checkPropertyValue();var i=it.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.checkBoundaryConstraints(void 0,void 0,i),this.drawingObject&&this.drawingObject instanceof M&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.triggerElementDrawEvent(this.drawingObject,"Completed","Node",this.getShapeType(),!1),this.drawingObject=null),n.prototype.mouseUp.call(this,t),this.inAction=!1},e.prototype.endAction=function(){n.prototype.endAction.call(this)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e})(xe),qe=(function(n){De(e,n);function e(t,i,r){var a=n.call(this,t,i)||this;return a.sourceObject=r,a.toolName="ConnectorDrawingTool",a}return e.prototype.mouseDown=function(t){return Xr(this,void 0,void 0,function(){return Yr(this,function(i){return n.prototype.mouseDown.call(this,t),this.inAction=!0,this.commandHandler.setFocus(),this.triggerElementDrawEvent(t.source,"Start","Connector",this.commandHandler.diagram.drawingObject.type,!0),[2]})})},e.prototype.mouseMove=function(t){if(this.commandHandler.enableServerDataBinding(!1),this.inAction){var i={sourcePoint:this.currentPosition,targetPoint:this.currentPosition};if(this.drawingObject||(this.drawingObject=this.commandHandler.drawObject(i)),t.source=this.drawingObject,this.triggerElementDrawEvent(t.source,"Progress","Connector",this.drawingObject.type,!1),t.actualObject&&(t.actualObject.parentId||t.actualObject.children)&&this.drawingObject.sourceID===""&&this.drawingObject.targetID===""&&this.setTarget(t),(t.target&&t.target instanceof M||t.actualObject&&t.sourceWrapper&&is(t.actualObject,t.sourceWrapper))&&(this.endPoint!=="ConnectorTargetEnd"||ii(t.target))){if(t.sourceWrapper&&t.actualObject&&!t.actualObject.isPhase&&!t.actualObject.isLane){var r=t.sourceWrapper.id.split("_")[0],a=t.sourceWrapper.id.split("_")[1],s=t.actualObject.ports.find(function(l){return l.id===a}),o=s&&Li(s)&&!ar(s);if(this.commandHandler&&o&&t.sourceWrapper instanceof Pt){if(this.endPoint="ConnectorTargetEnd",t.targetWrapper=t.sourceWrapper,t.sourceWrapper=null,!t.target||t.target&&t.target.id!==r){var h=this.commandHandler.diagram.nameTable[""+r];t.target=h||t.target}this.commandHandler.connect(this.endPoint,t),this.endPoint="ConnectorSourceEnd"}else this.commandHandler&&(this.commandHandler.connect(this.endPoint,t),this.endPoint="ConnectorTargetEnd")}}else this.drawingObject.targetID===""&&(this.endPoint="ConnectorTargetEnd")}return this.inAction||(this.commandHandler.updateSelector(),t.source&&!t.source.isLane&&t.sourceWrapper&&this.commandHandler.renderHighlighter(t,!0)),n.prototype.mouseMove.call(this,t),this.commandHandler.enableServerDataBinding(!0),!this.blocked},e.prototype.setTarget=function(t){t.target?t.sourceWrapper.id.includes(t.target.id)||t.target.parentId&&t.sourceWrapper.id.includes(t.target.parentId)&&(t.target=this.commandHandler.diagram.nameTable[t.target.parentId]):t.sourceWrapper.id.includes(t.actualObject.id)?t.target=t.actualObject:t.actualObject.parentId&&t.sourceWrapper.id.includes(t.actualObject.parentId)&&(t.target=this.commandHandler.diagram.nameTable[t.actualObject.parentId])},e.prototype.mouseUp=function(t){return Xr(this,void 0,void 0,function(){return Yr(this,function(i){return this.commandHandler.enableServerDataBinding(!1),this.checkPropertyValue(),this.drawingObject&&this.drawingObject instanceof B&&(this.commandHandler.addObjectToDiagram(this.drawingObject),this.triggerElementDrawEvent(this.drawingObject,"Completed","Connector",this.drawingObject.type,!1),this.drawingObject=null),this.inAction=!1,this.commandHandler&&(this.commandHandler.enableServerDataBinding(!0),n.prototype.mouseUp.call(this,t)),[2]})})},e.prototype.endAction=function(){n.prototype.endAction.call(this)},e.prototype.mouseLeave=function(t){this.inAction&&this.mouseUp(t)},e})(zr),fa=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseDown=function(t){n.prototype.mouseDown.call(this,t),this.commandHandler.clearSelection();var i={shape:{type:"Text"},offsetX:this.currentPosition.x,offsetY:this.currentPosition.y};t.source||(this.drawingNode=this.commandHandler.drawObject(i))},e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),this.drawingNode)this.drawingNode.style.strokeColor="black",this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent";else{var i={shape:{type:"Text"},offsetX:this.currentPosition.x,width:30,height:30,offsetY:this.currentPosition.y};this.drawingNode=this.commandHandler.drawObject(i),this.drawingNode.style.strokeDashArray="2 2",this.drawingNode.style.fill="transparent"}if(this.inAction&&b.equals(this.currentPosition,this.prevPosition)===!1){var r=it.toBounds([this.prevPosition,this.currentPosition]);this.commandHandler.updateNodeDimension(this.drawingNode,r)}return!this.blocked},e.prototype.mouseUp=function(t){this.checkPropertyValue(),this.drawingNode?(this.drawingNode.style.strokeColor="none",this.drawingNode.style.fill="none"):this.drawingNode=t.source,this.drawingNode&&this.drawingNode instanceof M&&this.commandHandler.addText(this.drawingNode,this.currentPosition),n.prototype.mouseUp.call(this,t),this.inAction=!1},e.prototype.endAction=function(){n.prototype.endAction.call(this)},e})(xe),wn=(function(n){De(e,n);function e(t,i){var r=n.call(this,t)||this;return r.zooming=i,r}return e.prototype.mouseDown=function(t){n.prototype.mouseDown.call(this,t),this.inAction=!0,this.commandHandler.setBlazorDiagramProps(!0)},e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),this.inAction){if(!this.zooming&&b.equals(this.currentPosition,this.prevPosition)===!1){var i=this.currentPosition.x-this.prevPosition.x,r=this.currentPosition.y-this.prevPosition.y;this.commandHandler.scroll(i,r,this.currentPosition)}else if(t.moveTouches&&t.moveTouches.length&&t.moveTouches.length>=2){var a=t.startTouches[0],s=t.startTouches[1],o=t.moveTouches[0],h=t.moveTouches[1],l=this.getDistance(o,h)/this.getDistance(a,s),d=t.position;l!==1&&this.commandHandler.zoom(l,0,0,d),this.updateTouch(a,o),this.updateTouch(s,h)}}return this.commandHandler.dataBinding(),!this.blocked},e.prototype.mouseUp=function(t){this.commandHandler.setBlazorDiagramProps(!1),this.checkPropertyValue(),this.commandHandler.updatePanState(!1),n.prototype.mouseUp.call(this,t),this.inAction=!1},e.prototype.endAction=function(){n.prototype.endAction.call(this)},e.prototype.getDistance=function(t,i){var r=i.pageX-t.pageX,a=i.pageY-t.pageY;return Math.sqrt(r*r+a*a)},e.prototype.updateTouch=function(t,i){t.pageX=i.pageX,t.pageY=i.pageY},e})(xe),zm=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseUp=function(t){this.checkPropertyValue(),this.commandHandler.initExpand(t),n.prototype.mouseUp.call(this,t)},e})(xe),al=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseUp=function(t){this.checkPropertyValue();var i="_blank",r="",a=window.innerHeight,s=window.innerWidth,o=window.screenTop,h=window.screenLeft;t.sourceWrapper.hyperlink.hyperlinkOpenState==="CurrentTab"?i="_self":t.sourceWrapper.hyperlink.hyperlinkOpenState==="NewWindow"&&(r="height="+a+",width="+s+",top="+o+",left="+h);var l=window.open(t.sourceWrapper.hyperlink.link,i,r);l.focus(),n.prototype.mouseUp.call(this,t)},e})(xe),mi=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseDown=function(t){if(n.prototype.mouseDown.call(this,t),this.inAction=!0,this.drawingObject){var r=void 0,a=this.drawingObject.shape;r=a.points[a.points.length-1],r={x:r.x,y:r.y},this.drawingObject.shape.points.push(r)}else{this.startPoint={x:this.startPosition.x,y:this.startPosition.y};var i={offsetX:this.currentPosition.x,offsetY:this.currentPosition.y,width:5,height:5,shape:{type:"Basic",shape:"Polygon",points:[{x:this.startPoint.x,y:this.startPoint.y},{x:this.currentPosition.x,y:this.currentPosition.y}]}};this.triggerElementDrawEvent(t.source,"Start","Node",this.getShapeType(),!0),this.drawingObject=this.commandHandler.drawObject(i)}},e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),this.inAction){var i=this.drawingObject.shape;if(i.points[i.points.length-1].x=this.currentPosition.x,i.points[i.points.length-1].y=this.currentPosition.y,this.drawingObject.wrapper.children[0].data=To(this.drawingObject.shape.points),this.triggerElementDrawEvent(this.drawingObject,"Progress","Node",this.getShapeType(),!1),this.inAction&&b.equals(this.currentPosition,this.prevPosition)===!1){var r=it.toBounds(this.drawingObject.shape.points);this.commandHandler.updateNodeDimension(this.drawingObject,r)}}return!0},e.prototype.mouseUp=function(t,i){this.checkPropertyValue(),n.prototype.mouseMove.call(this,t),this.inAction&&(this.inAction=!1,this.commandHandler.addObjectToDiagram(this.drawingObject),this.triggerElementDrawEvent(this.drawingObject,"Completed","Node",this.getShapeType(),!1)),this.endAction()},e.prototype.mouseWheel=function(t){n.prototype.mouseWheel.call(this,t),this.mouseMove(t)},e.prototype.endAction=function(){this.inAction=!1,this.drawingObject=null},e})(xe),si=(function(n){De(e,n);function e(t){var i=n.call(this,t,!0)||this;return i.connectorEndPoint="ConnectorSourceEnd",i}return e.prototype.mouseMove=function(t){n.prototype.mouseMove.call(this,t);var i=!1;if(this.inAction){var r=this.drawingObject;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition),r.targetPoint=this.currentPosition,this.triggerElementDrawEvent(this.drawingObject,"Progress","Connector",this.commandHandler.diagram.drawingObject.type,!1),this.commandHandler.updateConnectorPoints(r),t.source=this.drawingObject,t.target&&!t.target.isLane&&t.targetWrapper&&(i=this.canConnect(t.targetWrapper,t.target,this.connectorEndPoint,"In"),i&&this.commandHandler.renderHighlighter(t,this.connectorEndPoint==="ConnectorSourceEnd")),this.connectorEndPoint==="ConnectorSourceEnd"&&t.actualObject&&t.actualObject instanceof M&&t.sourceWrapper&&(t.source.sourceID===""||t.source.sourceID!==t.source.targetID)&&this.commandHandler.connect(this.connectorEndPoint,t),this.connectorEndPoint="ConnectorTargetEnd"}return this.inAction||(this.commandHandler.updateSelector(),t.source&&!t.source.isLane&&t.sourceWrapper&&(i=this.canConnect(t.sourceWrapper,t.source,this.connectorEndPoint,"Out"),i&&this.commandHandler.renderHighlighter(t,!0))),!0},e.prototype.mouseDown=function(t){if(n.prototype.mouseDown.call(this,t),this.inAction=!0,this.drawingObject){var r=this.drawingObject,a=void 0;a=new qi(r,"segments",{type:"Straight"},!0),a.point=this.currentPosition,r.segments[r.segments.length-1]=a}else{var i={id:"Connector",type:"Straight",sourcePoint:this.currentPosition,targetPoint:this.currentPosition};this.triggerElementDrawEvent(t.source,"Start","Connector",this.commandHandler.diagram.drawingObject.type,!0),this.inAction&&(this.drawingObject=this.commandHandler.drawObject(i))}},e.prototype.mouseWheel=function(t){n.prototype.mouseWheel.call(this,t),this.mouseMove(t)},e.prototype.mouseUp=function(t){if(this.checkPropertyValue(),n.prototype.mouseMove.call(this,t),this.inAction&&this.drawingObject){if(this.connectorEndPoint==="ConnectorTargetEnd"){var i=this.commandHandler.diagram.eventHandler,r=i.hoverElement;if(r){r=r instanceof M?r:r.parentObj;var a=i.getConnectorPadding(t),s=this.commandHandler.diagram.findElementUnderMouse(r,this.currentPosition,this.commandHandler.diagram,a),o=s&&s.bounds.containsPoint(this.currentPosition,a);o&&(t.actualObject=r,t.target=r,t.targetWrapper=s,this.drawingObject.sourceID!==t.target.id&&this.commandHandler.connect(this.connectorEndPoint,t))}}var h=this.drawingObject;h.segments[h.segments.length-1].point={x:0,y:0},this.commandHandler.addObjectToDiagram(this.drawingObject),this.triggerElementDrawEvent(this.drawingObject,"Completed","Connector",this.commandHandler.diagram.drawingObject.type,!1)}this.endAction()},e.prototype.endAction=function(){this.drawingObject=null,this.inAction=!1},e.prototype.canConnect=function(t,i,r,a){var s=!1,o=this.commandHandler.findTarget(t,i,r==="ConnectorSourceEnd",!0);return o instanceof Se?s=!!(a==="In"?this.connectorEndPoint==="ConnectorTargetEnd"&&Li(o):this.connectorEndPoint==="ConnectorSourceEnd"&&ar(o)):o instanceof M&&(s=!!(a==="In"?this.connectorEndPoint==="ConnectorTargetEnd"&&ii(o):this.connectorEndPoint==="ConnectorSourceEnd"&&Di(o))),s},e})(xe),km=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseDown=function(t){this.inAction=!0,this.undoElement=E(t.source),this.annotationId=t.sourceWrapper.id,n.prototype.mouseDown.call(this,t)},e.prototype.mouseMove=function(t){n.prototype.mouseMove.call(this,t);var i=this.currentPosition.x-this.prevPosition.x,r=this.currentPosition.y-this.prevPosition.y,a=t.source;if(a instanceof M){var s=xt();Rt(s,-a.rotateAngle,0,0);var o=st(s,{x:i,y:r});i=o.x,r=o.y}return this.inAction&&(this.commandHandler.labelDrag(t.source,t.sourceWrapper,i,r),this.commandHandler.updateSelector()),this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseUp=function(t){this.checkPropertyValue();var i=t.source;this.inAction=!1;var r={type:"AnnotationPropertyChanged",objectId:this.annotationId,undoObject:E(this.undoElement),category:"Internal",redoObject:E(i)};this.commandHandler.addHistoryEntry(r),n.prototype.mouseUp.call(this,t)},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e})(xe),Rm=(function(n){De(e,n);function e(t,i){var r=n.call(this,t,!0)||this;return r.corner=i,r}return e.prototype.mouseDown=function(t){this.inAction=!0;var i=t.source.nodes.length?t.source.nodes[0]:t.source.connectors[0];this.annotationId=t.source.wrapper.children[0].id,this.undoElement=E(i);var r=t.source.wrapper.children[0];this.initialBounds={x:r.offsetX,y:r.offsetY,width:r.actualSize.width,height:r.actualSize.height},n.prototype.mouseDown.call(this,t)},e.prototype.mouseMove=function(t){return n.prototype.mouseMove.call(this,t),this.inAction&&this.resizeObject(t),!this.blocked},e.prototype.mouseUp=function(t){this.checkPropertyValue();var i=t.source.nodes.length?t.source.nodes[0]:t.source.connectors[0];this.inAction=!1;var r={type:"AnnotationPropertyChanged",objectId:this.annotationId,redoObject:E(i),undoObject:E(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(r),n.prototype.mouseUp.call(this,t)},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e.prototype.resizeObject=function(t){var i;i=t.source.nodes.length?t.source.nodes[0]:t.source.connectors[0];var r=t.source.wrapper.children[0],a,s,o={x:r.offsetX,y:r.offsetY},h=r.rotateAngle;h+=i instanceof M?i.rotateAngle:0,h=(h+360)%360;var l=xt(),d=this.corner.slice(5),f=this.updateSize(r,this.startPosition,this.currentPosition,d,this.initialBounds,h),p=r.offsetX-r.actualSize.width*r.pivot.x,c=r.offsetY-r.actualSize.height*r.pivot.y,u=this.getPivot(d);if(r.flippedPoint){if(r.flip===G.Horizontal&&r.horizontalAlignment!=="Center"){if(u.x=1-u.x,h!==0){var g=(h%360+360)%360;h=g===0?0:360-g}}else if(r.flip===G.Vertical&&r.verticalAlignment!=="Center"&&(u.y=1-u.y,h!==0)){var g=(h%360+360)%360;h=g===0?0:360-g}r.flip===G.Both&&(r.horizontalAlignment!=="Center"&&(u.x=1-u.x),r.verticalAlignment!=="Center"&&(u.y=1-u.y))}Rt(l,h,o.x,o.y),u={x:p+r.actualSize.width*u.x,y:c+r.actualSize.height*u.y};var v=st(l,u);f.x=v.x,f.y=v.y,a=f.width,s=f.height,a=a<0?1:a,s=s<0?1:s,this.commandHandler.labelResize(i,t.source.annotation,a,s,f,t.source),this.commandHandler.updateSelector()},e})(xe),Hm=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseDown=function(t){this.inAction=!0,this.annotationId=t.source.wrapper.children[0].id;var i=t.source.nodes.length?t.source.nodes[0]:t.source.connectors[0];this.undoElement=E(i),n.prototype.mouseDown.call(this,t)},e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),t.source&&this.inAction){var i=t.source.nodes[0]?t.source.nodes[0]:t.source.connectors[0],r=void 0;r=t.source.annotation,this.commandHandler.labelRotate(i,r,this.currentPosition,t.source),this.commandHandler.updateSelector()}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseUp=function(t){this.checkPropertyValue(),this.inAction=!1;var i=t.source.nodes.length?t.source.nodes[0]:t.source.connectors[0],r={type:"AnnotationPropertyChanged",objectId:this.annotationId,redoObject:E(i),undoObject:E(this.undoElement),category:"Internal"};this.commandHandler.addHistoryEntry(r),n.prototype.mouseUp.call(this,t)},e.prototype.mouseLeave=function(t){this.mouseUp(t)},e})(xe),Bm=(function(n){De(e,n);function e(t){return n.call(this,t,!0)||this}return e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),this.inAction){var i=this.drawingObject.shape,r=this.currentPosition;if(r=this.commandHandler.snapConnectorEnd(this.currentPosition),i.points.push(r),this.drawingObject.wrapper.children[0].data=ao(this.drawingObject.shape.points),i.data=ao(i.points),this.triggerElementDrawEvent(t.source,"Progress","Connector",this.drawingObject.type,!1),this.inAction&&b.equals(this.currentPosition,this.prevPosition)===!1){var a=it.toBounds(this.drawingObject.shape.points);this.commandHandler.updateNodeDimension(this.drawingObject,a)}}return!0},e.prototype.mouseDown=function(t){n.prototype.mouseDown.call(this,t),this.inAction=!0,this.startPoint={x:this.startPosition.x,y:this.startPosition.y};var i={offsetX:this.currentPosition.x,offsetY:this.currentPosition.y,width:5,height:5,style:{strokeColor:"black",strokeWidth:1,fill:"transparent"},shape:{type:"Path",points:[{x:this.startPoint.x,y:this.startPoint.y},{x:this.currentPosition.x,y:this.currentPosition.y}]}};this.triggerElementDrawEvent(t.source,"Start","Connector",this.commandHandler.diagram.drawingObject.type,!0),this.drawingObject=this.commandHandler.drawObject(i)},e.prototype.mouseUp=function(t){this.checkPropertyValue();var i=10,r=.5;if(this.inAction){this.inAction=!1;var a=this.drawingObject.shape,s=a.points;this.commandHandler.addObjectToDiagram(this.drawingObject);var o=this.drawingObject.id,h=this.commandHandler.diagram.nameTable[""+o];this.commandHandler.diagram.remove(h),s=this.pointReduction(s,i);var l={};this.commandHandler.diagram.drawingObject.bezierSettings&&(l=this.commandHandler.diagram.drawingObject.bezierSettings),l.allowSegmentsReset===void 0&&(l.allowSegmentsReset=!1);var d={id:"newConnector"+K(),type:"Bezier",sourcePoint:{x:s[0].x,y:s[0].y},targetPoint:{x:s[s.length-1].x,y:s[s.length-1].y},segments:[],bezierSettings:l};this.drawingObject=this.commandHandler.drawObject(d),this.drawingObject=this.bezierCurveSmoothness(s,r,this.drawingObject,a),this.commandHandler.updateConnectorPoints(this.drawingObject),this.commandHandler.addObjectToDiagram(this.drawingObject),this.triggerElementDrawEvent(this.drawingObject,"Completed","Connector",this.commandHandler.diagram.drawingObject.type,!1),n.prototype.mouseUp.call(this,t)}},e.prototype.pointReduction=function(t,i){if(t===null||t.length<3)return t;var r=0,a=t.length-1,s=[];for(s.push(r),s.push(a);t[parseInt(r.toString(),10)]===t[parseInt(a.toString(),10)];)a--;this.reduction(t,r,a,i,s);var o=[];return s.sort(function(h,l){return h-l}),s.forEach(function(h){o.push(t[parseInt(h.toString(),10)])}),o},e.prototype.reduction=function(t,i,r,a,s){for(var o=0,h=0,l=i;l<r;l++){var d=this.perpendicularDistance(t[parseInt(i.toString(),10)],t[parseInt(r.toString(),10)],t[parseInt(l.toString(),10)]);d>o&&(o=d,h=l)}o>a&&h!==0&&(s.push(h),this.reduction(t,i,h,a,s),this.reduction(t,h,r,a,s))},e.prototype.perpendicularDistance=function(t,i,r){var a=Math.abs(.5*(t.x*i.y-i.x*t.y+(i.x*r.y-r.x*i.y)+(r.x*t.y-t.x*r.y))),s=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),o=a/s*2;return o},e.prototype.bezierCurveSmoothness=function(t,i,r,a){if(t.length<3)return r;for(var s=0;s<t.length-1;s++){var o=t[parseInt(s.toString(),10)].x,h=t[parseInt(s.toString(),10)].y,l=t[s+1].x,d=t[s+1].y,f=void 0,p=void 0;if(s===0){var c=t[parseInt(s.toString(),10)];f=c.x,p=c.y}else f=t[s-1].x,p=t[s-1].y;var u=void 0,g=void 0;if(s===t.length-2){var v=t[s+1];u=v.x,g=v.y}else u=t[s+2].x,g=t[s+2].y;var m=(f+o)/2,y=(p+h)/2,S=(o+l)/2,x=(h+d)/2,I=(l+u)/2,C=(d+g)/2,P={},A={},T={},z={};P.x=f,P.y=p,A.x=o,A.y=h,T.x=l,T.y=d,z.x=u,z.y=g;var L=b.findLength(P,A),R=b.findLength(A,T),O=b.findLength(T,z),N=L/(L+R),H=R/(R+O),F=m+(S-m)*N,Y=y+(x-y)*N,et=S+(I-S)*H,at=x+(C-x)*H,tt=F+(S-F)*i+o-F,nt=Y+(x-Y)*i+h-Y,wt=et+(S-et)*i+l-et,$=at+(x-at)*i+d-at,pt=new Me(a,"segments",{type:"Bezier"},!0),rt={x:tt,y:nt},mt={x:wt,y:$},ct={x:o,y:h},Dt={x:l,y:d};pt.type="Bezier",r.segments[parseInt(s.toString(),10)]=pt,s===0&&(rt={x:o,y:h}),s===t.length-2&&(mt={x:l,y:d}),r.segments[parseInt(s.toString(),10)].vector1={angle:At(ct,rt),distance:b.findLength(ct,rt)},r.segments[parseInt(s.toString(),10)].vector2={angle:At(Dt,mt),distance:b.findLength(Dt,mt)},r.segments[parseInt(s.toString(),10)].point=Dt}return r},e})(xe),Ye=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),_=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Om=function(n){if(n)switch(n.type){case"Bpmn":return Ym;case"UmlActivity":return Xm;case"UmlClassifier":return Vm;default:return $n}return $n},Wm=function(n){if(n)switch(n.type){case"Straight":return qi;case"Bezier":return Me;case"Orthogonal":return Te;default:return qi}},sl=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w(10)],e.prototype,"width",void 0),_([w(10)],e.prototype,"height",void 0),_([w("Arrow")],e.prototype,"shape",void 0),_([X({fill:"black",strokeColor:"black",strokeWidth:1},Qi)],e.prototype,"style",void 0),_([X({x:0,y:.5},b)],e.prototype,"pivot",void 0),_([w("")],e.prototype,"pathData",void 0),e})(j),qa=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w(0)],e.prototype,"angle",void 0),_([w(0)],e.prototype,"distance",void 0),e})(j),Nm=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w(za.All)],e.prototype,"controlPointsVisibility",void 0),_([w("FreeForm")],e.prototype,"segmentEditOrientation",void 0),_([w(Bn.Default)],e.prototype,"smoothness",void 0),_([w(!0)],e.prototype,"allowSegmentsReset",void 0),e})(j),$n=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w("None")],e.prototype,"type",void 0),e})(j),Xm=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w("Object")],e.prototype,"flow",void 0),_([w(30)],e.prototype,"exceptionFlowHeight",void 0),e})($n),Ym=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w("Sequence")],e.prototype,"flow",void 0),_([w("Normal")],e.prototype,"sequence",void 0),_([w("Default")],e.prototype,"message",void 0),_([w("Default")],e.prototype,"association",void 0),e})($n),Kd=(function(n){Ye(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.points=[],s}return _([w("Straight")],e.prototype,"type",void 0),_([w(!0)],e.prototype,"allowDrag",void 0),e})(j),qi=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"StraightSegment"},_([X({x:0,y:0},b)],e.prototype,"point",void 0),e})(Kd),Me=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BezierSegment"},e.prototype.getPoints=function(t,i){var r=[];if(r.length>0||i!=null){var a=r.length>0?r[r.length-1]:i,s=this.bezireToPoly(a,t);r.push.apply(r,s)}return r},e.prototype.bezireToPoly=function(t,i){var r=[];if(i){var a=i,s=t,o=a.bezierPoint1,h=a.bezierPoint2,l={x:a.points[1].x,y:a.points[1].y};this.flattenCubicBezier(r,s,o,h,l,10)}return r},e.prototype.flattenCubicBezier=function(t,i,r,a,s,o){var h=(b.findLength(i,r)+b.findLength(r,a)+b.findLength(a,s))/o,l;for(l=0;l<=h;l++){var d=l/h,f=(1-d)*(1-d)*(1-d)*i.x+3*d*(1-d)*(1-d)*r.x+3*d*d*(1-d)*a.x+d*d*d*s.x,p=(1-d)*(1-d)*(1-d)*i.y+3*d*(1-d)*(1-d)*r.y+3*d*d*(1-d)*a.y+d*d*d*s.y;t.push({x:f,y:p})}},_([w("Horizontal")],e.prototype,"orientation",void 0),_([X({x:0,y:0},b)],e.prototype,"point1",void 0),_([X({x:0,y:0},b)],e.prototype,"point2",void 0),_([X({angle:0,distance:0},qa)],e.prototype,"vector1",void 0),_([X({angle:0,distance:0},qa)],e.prototype,"vector2",void 0),e})(qi),Te=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"OrthogonalSegment"},_([w(null)],e.prototype,"length",void 0),_([w(null)],e.prototype,"direction",void 0),e})(Kd);(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"DiagramConnectorSegment"},_([w("Straight")],e.prototype,"type",void 0),_([w(!0)],e.prototype,"allowDrag",void 0),_([X({x:0,y:0},b)],e.prototype,"point",void 0),_([X({x:0,y:0},b)],e.prototype,"point1",void 0),_([X({x:0,y:0},b)],e.prototype,"point2",void 0),_([X({angle:0,distance:0},qa)],e.prototype,"vector1",void 0),_([X({angle:0,distance:0},qa)],e.prototype,"vector2",void 0),_([w(null)],e.prototype,"length",void 0),_([w(null)],e.prototype,"direction",void 0),e})(j);function ol(n,e,t){var i=n.center,r=45,a=r,s=180-r,o=s+2*r,h=360-r,l=At(e,i);return l>a&&l<s?"top":l>s&&l<o?"right":l>o&&l<h?"bottom":"left"}function pa(n){return!n.distance&&!n.angle}function Qa(n,e,t){var i=60,r={x:0,y:0};switch(t||(Math.abs(e.x-n.x)>Math.abs(e.y-n.y)?t=n.x<e.x?"right":"left":t=n.y<e.y?"bottom":"top"),t){case"bottom":case"top":i=Math.min(Math.abs(n.y-e.y)*.45,i),r={x:n.x,y:n.y+(t==="bottom"?i:-i)};break;case"right":case"left":i=Math.min(Math.abs(n.x-e.x)*.45,i),r={x:n.x+(t==="right"?i:-i),y:n.y};break}return r}function Um(n,e,t,i,r){var a=0,s=0,o=0,h=0,l=3,d=Number((r.distance(e,n)+r.distance(t,e)+r.distance(i,t))/l);if(d!==0)for(var f=0;f<=d;f++){var p=f/d,c=(1-p)*(1-p)*(1-p)*n.x+3*p*(1-p)*(1-p)*e.x+3*p*p*(1-p)*t.x+p*p*p*i.x,u=(1-p)*(1-p)*(1-p)*n.y+3*p*(1-p)*(1-p)*e.y+3*p*p*(1-p)*t.y+p*p*p*i.y;f===0?(a=o=c,s=h=u):(a=Math.min(c,a),s=Math.min(u,s),o=Math.max(c,o),h=Math.max(u,h))}return{x:a,y:s,width:o-a,height:h-s,left:a,top:s,right:a+(o-a),bottom:s+(h-s),center:{x:(a+(o-a))/2,y:(s+(h-s))/2}}}function Fm(n,e,t,i,r,a,s){var o={x:0,y:0},h=a/s,l=(1-h)*(1-h)*(1-h)*e.x+3*h*(1-h)*(1-h)*t.x+3*h*h*(1-h)*i.x+h*h*h*r.x;o.x=l;var d=(1-h)*(1-h)*(1-h)*e.y+3*h*(1-h)*(1-h)*t.y+3*h*h*(1-h)*i.y+h*h*h*r.y;return o.y=d,o}var hl=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w(!0)],e.prototype,"optional",void 0),_([w(void 0)],e.prototype,"lowerBounds",void 0),_([w(void 0)],e.prototype,"upperBounds",void 0),e})(j),jd=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w("OneToOne")],e.prototype,"type",void 0),_([X({},hl)],e.prototype,"target",void 0),_([X({},hl)],e.prototype,"source",void 0),e})(j),Vm=(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w("UmlClassifier")],e.prototype,"type",void 0),_([w("Aggregation")],e.prototype,"relationship",void 0),_([w("Default")],e.prototype,"associationType",void 0),_([X({},jd)],e.prototype,"multiplicity",void 0),e})($n);(function(n){Ye(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return _([w("None")],e.prototype,"type",void 0),_([w("Default")],e.prototype,"associationType",void 0),_([w("Aggregation")],e.prototype,"relationship",void 0),_([X({},jd)],e.prototype,"multiplicity",void 0),_([w("Sequence")],e.prototype,"bpmnFlow",void 0),_([w("Default")],e.prototype,"message",void 0),_([w("Normal")],e.prototype,"sequence",void 0),_([w("Default")],e.prototype,"association",void 0),_([w("Object")],e.prototype,"umlActivityFlow",void 0),_([w(30)],e.prototype,"exceptionFlowHeight",void 0),e})(j);var B=(function(n){Ye(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.parentId="",s.showDefaultTooltipForPalette=!0,s.bridges=[],s.status="None",s.outEdges=[],s.inEdges=[],s.shape&&s.shape.type==="UmlActivity"&&us(r,s),r&&r.shape&&r.shape.type!=="None"&&af(r,s),s}return e.prototype.setPortID=function(t,i){if(this.targetID&&this.sourceID)for(var r=t.nameTable[this.targetID],a=t.nameTable[this.sourceID],s=i?r&&r.ports:a&&a.ports,o=void 0,h=0;s&&h<s.length;h++)o=s[parseInt(h.toString(),10)],this.targetPortID===o.id&&i?(o.constraints&Ct.None||!(o.constraints&Ct.InConnect))&&(this.targetPortID=""):this.sourcePortID===o.id&&!i&&(o.constraints&Ct.None||!(o.constraints&Ct.OutConnect))&&(this.sourcePortID="")},e.prototype.init=function(t){this.id||(this.id=K()),this.sourcePortID&&this.setPortID(t),this.targetPortID&&this.setPortID(t,!0);var i,r=new Ht,a=new Pt;a.id=this.id+"_path";var s=new Pt,o=new Pt;a=this.getSegmentElement(this,a);var h=[];h=this.type==="Bezier"?this.intermediatePoints:this.getConnectorPoints(this.type),h=this.clipDecorators(this,h);var l=it.toBounds(h);switch(r.width=l.width,r.height=l.height,r.offsetX=l.x+r.pivot.x*l.width,r.offsetY=l.y+r.pivot.y*l.height,this.shape.type){case"Bpmn":var d=this.shape.flow;switch(d){case"Sequence":i=this.getBpmnSequenceFlow();break;case"Association":i=new Pt,i.visible=!1,this.getBpmnAssociationFlow();break;case"Message":i=this.getBpmnMessageFlow(),a=this.getSegmentElement(this,a),this.updateShapePosition(this,i);break}break;case"UmlActivity":var f=this.shape.flow;switch(f){case"Object":this.getUMLObjectFlow();break;case"Exception":this.getUMLExceptionFlow(a);break}break;case"UmlClassifier":this.getConnectorRelation();break}var p=this.intermediatePoints;if(this.type==="Bezier"){var c=this.segments[0],u=this.segments[this.segments.length-1];p=[b.isEmptyPoint(u.point2)?u.bezierPoint2:u.point2,b.isEmptyPoint(c.point1)?c.bezierPoint1:c.point1]}var g="getDescription",v=t[""+g];if(s=this.getDecoratorElement(h[0],p[1],this.sourceDecorator,!0,v),o=this.getDecoratorElement(h[h.length-1],p[p.length-2],this.targetDecorator,!1,v),s.id=this.id+"_srcDec",o.id=this.id+"_tarDec",a.style=this.style,a.style.fill="transparent",v!==void 0){var m=v(this,t);a.description=m||this.id}r.style.strokeColor="transparent",r.style.fill="transparent",r.style.strokeWidth=0,r.children=[a,s,o],r.id=this.id,i!==void 0&&r.children.push(i),r.offsetX=a.offsetX,r.offsetY=a.offsetY,r.width=a.width,r.height=a.height;for(var y=0;this.annotations,y<this.annotations.length;y++)r.children.push(this.getAnnotationElement(this.annotations[parseInt(y.toString(),10)],this.intermediatePoints,l,v,t.element.id,t.annotationTemplate));for(var y=0;this.fixedUserHandles,y<this.fixedUserHandles.length;y++)r.children.push(this.getFixedUserHandle(this.fixedUserHandles[parseInt(y.toString(),10)],this.intermediatePoints,l,t.fixedUserHandleTemplate,t.element.id));return this.initPorts(v,r,l),this.wrapper=r,r},e.prototype.initPorts=function(t,i,r){for(var a=0;this.ports,a<this.ports.length;a++)i.children.push(this.initPort(this.ports[parseInt(a.toString(),10)],this.intermediatePoints,r,t))},e.prototype.initPort=function(t,i,r,a){var s=new Pt;s.height=t.height,s.width=t.width,s.margin=t.margin,t.shape=t.shape||"Square";var o=t.shape==="Custom"?t.pathData:Xo(t.shape);s.data=o,s.horizontalAlignment=t.horizontalAlignment,s.verticalAlignment=t.verticalAlignment,s=this.initPortWrapper(t,i,r,s,this);var h,l=_t(a);return l&&(h=l(s,this)),s.description=h||s.id,s.elementActions=s.elementActions|le.ElementIsPort,s.isPathPort=!0,s},e.prototype.initPortWrapper=function(t,i,r,a,s){t.id=t.id||K();var o={x:0,y:0},h=v0(i,t),l=h.point;a.id=this.id+"_"+t.id;var d=t.style;a.style={fill:d.fill,strokeColor:d.strokeColor,gradient:null,opacity:d.opacity,strokeDashArray:d.strokeDashArray,strokeWidth:d.strokeWidth},r.width===0&&(r.width=this.style.strokeWidth),r.height===0&&(r.height=this.style.strokeWidth);var f={x:(l.x-r.x)/r.width,y:(l.y-r.y)/r.height};o.x=r.width*f.x,o.y=r.height*f.y;var p=cl(t,h.angle,i),c=p.hAlign,u=p.vAlign,g,v;return c==="left"?(g="Left",o.x+=t.displacement.x):c==="right"?(g="Right",o.x-=t.displacement.x):c==="center"&&(g="Center"),u==="top"?(v="Top",o.y+=t.displacement.y):u==="bottom"?(v="Bottom",o.y-=t.displacement.y):u==="center"&&(v="Center"),a.horizontalAlignment=g,a.verticalAlignment=v,s&&s.flipMode!=="Label"&&s.flipMode!=="None"?a=qn(a,this.flip,t):a=qn(a,"None",t),a.float=!0,a.connectionDirection=t.connectionDirection,a.setOffsetWithRespectToBounds(o.x,o.y,"Absolute"),a.relativeMode="Point",a.visible=!!(ci(t,zt.Visible)&&!ci(t,zt.Hover)&&!ci(t,zt.Connect)),a.elementActions=a.elementActions|le.ElementIsPort,a},e.prototype.getConnectorRelation=function(){var t=this.shape;t.relationship==="Association"?(this.sourceDecorator.shape="None",this.targetDecorator.shape="None"):t.relationship==="Inheritance"?(this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"):t.relationship==="Composition"?(this.sourceDecorator.shape="Diamond",this.targetDecorator.shape="None"):t.relationship==="Aggregation"?(this.sourceDecorator.shape="Diamond",this.targetDecorator.shape="None"):t.relationship==="Dependency"?(this.sourceDecorator.shape="None",this.targetDecorator.shape="OpenArrow"):t.relationship==="Realization"&&(this.sourceDecorator.shape="None",this.targetDecorator.shape="Arrow"),t.associationType==="BiDirectional"&&(this.sourceDecorator.shape="OpenArrow",this.targetDecorator.shape="OpenArrow"),t.associationType==="Directional"&&(this.sourceDecorator.shape="None",this.targetDecorator.shape="OpenArrow");var i="",r="",a="",s="";t.multiplicity.source&&(t.multiplicity.source.lowerBounds=t.multiplicity.source.lowerBounds,t.multiplicity.source.upperBounds=t.multiplicity.source.upperBounds),t.multiplicity.target&&(t.multiplicity.target.lowerBounds=t.multiplicity.target.lowerBounds,t.multiplicity.target.upperBounds=t.multiplicity.target.upperBounds);var o=t.multiplicity.source,h=t.multiplicity.target;s=o.upperBounds?o.lowerBounds+"..."+o.upperBounds:o.lowerBounds,i=h.upperBounds?h.lowerBounds+"..."+h.upperBounds:h.lowerBounds,t.multiplicity.type==="ManyToOne"&&(t.multiplicity.target.optional=!1,r=s||"*",a="1"),t.multiplicity.type==="OneToMany"&&(t.multiplicity.source.optional=!1,a=i||"*",r="1"),t.multiplicity.type==="ManyToMany"&&(r=s||"*",a=i||"*"),t.multiplicity.type==="OneToOne"&&(t.multiplicity.target.optional=!1,t.multiplicity.source.optional=!1,r="1",a="1"),this.annotations=[{id:this.id+"sourcelabel",content:r,offset:0,alignment:"Before",margin:{right:5,bottom:5}},{id:this.id+"targetlabel",content:a,offset:1,alignment:"Before",margin:{right:5,bottom:5}}]},e.prototype.getBpmnSequenceFlow=function(){var t=new Pt,i=new Pt;if(this.shape.sequence==="Normal"&&this.type!=="Bezier"&&(this.targetDecorator.shape="Arrow"),this.shape.sequence==="Default"){t=this.getSegmentElement(this,t);var r=this.intermediatePoints;i=cf(r,this),this.targetDecorator.shape="Arrow"}return this.shape.sequence==="Conditional"&&(this.targetDecorator.shape="Arrow",this.sourceDecorator.shape="Diamond",i.id=this.id+this.shape.type),i},e.prototype.getUMLObjectFlow=function(){if(this.annotations)for(var t=0;t<this.annotations.length;t++)this.annotations[parseInt(t.toString(),10)].content="["+this.annotations[parseInt(t.toString(),10)].content+"]"},e.prototype.getUMLExceptionFlow=function(t){this.type="Straight";var i=this.shape.exceptionFlowHeight/2,r={x:(this.targetPoint.x+this.sourcePoint.x)/2,y:(this.targetPoint.y+this.sourcePoint.y)/2},a=r.x-this.sourcePoint.x,s=r.y-this.sourcePoint.y,o=Math.sqrt(a*a+s*s),h=i/o,l={x:r.x-a*h,y:r.y-s*h},d={x:r.x+a*h,y:r.y+s*h},f=xt();Rt(f,315,r.x,r.y),this.segments=[];var p=new qi(this,"segments",{type:"Straight",point:st(f,d)},!0);this.segments.push(p),p=new qi(this,"segments",{type:"Straight",point:st(f,l)},!0),this.segments.push(p),t=this.getSegmentElement(this,t)},e.prototype.getBpmnAssociationFlow=function(){this.shape.association==="Default"&&(this.targetDecorator.shape="None",this.style.strokeDashArray="2 2"),this.shape.association==="Directional"&&(this.targetDecorator.shape="OpenArrow",this.style.strokeDashArray="2 2"),this.shape.association==="BiDirectional"&&(this.targetDecorator.shape="OpenArrow",this.sourceDecorator.shape="OpenArrow",this.style.strokeDashArray="2 2")},e.prototype.getFixedUserHandle=function(t,i,r,a,s){var o;if(t.pathData===""&&a)o=new we(this.id,s,void 0,a),o.isTemplate=!0,o.template=Ai(o,!0,t),t.id=t.id||K(),o.id=this.id+"_"+t.id;else{o=new Ht;var h=[];o.children=h,t.id=t.id||K(),o.id=this.id+"_"+t.id;var l=of(t,o);o.children.push(l)}return o.float=!0,o.visible=t.visibility,o.width=t.width,o.height=t.height,o.style.strokeWidth=t.handleStrokeWidth,o.style.fill=t.fill,o.style.strokeColor=t.handleStrokeColor,o.cornerRadius=t.cornerRadius,this.updateAnnotation(t,i,r,o),o.description=o.id,o},e.prototype.getBpmnMessageFlow=function(){var t=new Pt;return this.targetDecorator.shape="Arrow",this.targetDecorator.width=10,this.targetDecorator.height=10,this.sourceDecorator.shape="Circle",this.sourceDecorator.style.fill="white",this.targetDecorator.style.fill="white",(this.shape.message==="InitiatingMessage"||this.shape.message==="NonInitiatingMessage")&&(t.id=this.id+"_"+this.shape.message,t.width=25,t.height=15,t.data="M0,0 L19.8,12.8 L40,0 L0, 0 L0, 25.5 L40, 25.5 L 40, 0",t.horizontalAlignment="Center",t.verticalAlignment="Center",t.transform=Zi.Self,t.style.fill=this.shape.message==="NonInitiatingMessage"?"lightgrey":"white"),t},e.prototype.distance=function(t,i){return rs(t,i)},e.prototype.findPath=function(t,i){return gf(t,i)},e.prototype.getAnnotationElement=function(t,i,r,a,s,o){t.content=t.content||"",t.id=t.id||K();var h;if(s&&(t.template||t.annotationType==="Template"||o&&t.content==="")){var l=document.getElementById(s),d="ej2_instances",f=l[""+d][0];h=new we(this.id,s,t.id,o),t.template&&typeof t.template=="function"&&f.isReact&&(h.templateFn=Re(t.template),h.isTemplate=!0),t.height===void 0&&t.annotationType==="String"&&(t.template||t.content==="")&&(t.height=r.height),h=kf(h,t,o,f)}else{h=new Tt;var p=t.hyperlink.link?t.hyperlink:void 0;h.style=t.style,h.style.color=p?p.color||h.hyperlink.color:t.style.color,h.hyperlink.link=t.hyperlink.link||void 0,h.hyperlink.hyperlinkOpenState=t.hyperlink.hyperlinkOpenState||void 0,h.hyperlink.textDecoration=t.hyperlink.textDecoration||void 0,h.content=p?p.content||h.hyperlink.link:t.content}h.constraints=t.constraints,h.visible=t.visibility,h.annotationVisibility=h.visible?"Visible":"Collapsed",h.rotateAngle=t.rotateAngle,h.horizontalAlignment=t.horizontalAlignment,h.verticalAlignment=t.verticalAlignment,h.width=t.width,h.height=t.height,r.width!==void 0&&!t.template&&(h.width=(t.width||r.width)-t.margin.left-t.margin.right),h.margin=t.margin,h.id=this.id+"_"+t.id,r.width===0&&(r.width=this.style.strokeWidth),r.height===0&&(r.height=this.style.strokeWidth);var c,u=_t(a);return u&&(c=u(t,this)),h.description=c||h.id,this.updateAnnotation(t,i,r,h),h},e.prototype.updateAnnotation=function(t,i,r,a,s){var o={x:0,y:0};a instanceof Tt&&!s&&a.refreshTextElement(),a.width=t.width||r.width;var h=Ko(i,t),l=h.point;t instanceof Qt&&t.segmentAngle&&(a.rotateAngle=t.rotateAngle+h.angle,a.rotateAngle=(a.rotateAngle+360)%360),r.width===0&&(r.width=this.style.strokeWidth),r.height===0&&(r.height=this.style.strokeWidth);var d={x:(l.x-r.x)/r.width,y:(l.y-r.y)/r.height};o.x=r.width*d.x,o.y=r.height*d.y;var f=cl(t,h.angle,i),p=f.hAlign,c=f.vAlign,u,g;p==="left"?(u="Left",o.x+=t.displacement.x):p==="right"?(u="Right",o.x-=t.displacement.x):p==="center"&&(u="Center"),c==="top"?(g="Top",o.y+=t.displacement.y):c==="bottom"?(g="Bottom",o.y-=t.displacement.y):c==="center"&&(g="Center"),a.horizontalAlignment=u,a.verticalAlignment=g,a.setOffsetWithRespectToBounds(o.x,o.y,"Absolute"),a.relativeMode="Point"},e.prototype.getConnectorPoints=function(t,i,r,a){i=Nh(this,r,a);var s=i.slice(0);return s&&s.length>0&&(this.sourcePoint=s[0],this.targetPoint=s[s.length-1]),s},e.prototype.clipDecorator=function(t,i,r,a){var s={x:0,y:0},o={x:0,y:0},h={x:0,y:0},l=i.length;o=r?i[0]:i[l-1],h=r?i[1]:i[l-2];var d=b.distancePoints(o,h);d=d===0?1:d;var f=1,p=r?t.sourceWrapper:t.targetWrapper;p&&(f=p.style.strokeWidth,a&&a&k.DecoratorPropertyChange&&(f=1));var c=f-1;return s.x=Math.round(o.x+c*(h.x-o.x)/d),s.y=Math.round(o.y+c*(h.y-o.y)/d),(r&&t.sourceDecorator.shape!=="None"||!r&&t.targetDecorator.shape!=="None")&&(s=b.adjustPoint(s,h,!0,a&k.DecoratorPropertyChange?0:f/2)),s},e.prototype.clipDecorators=function(t,i,r){return t.sourceDecorator.shape!=="None"&&(i[0]=this.clipDecorator(t,i,!0,r)),t.targetDecorator.shape!=="None"&&(i[i.length-1]=this.clipDecorator(t,i,!1,r)),i},e.prototype.updateSegmentElement=function(t,i,r,a){var s=new it,o=this.getSegmentPath(t,i,a);if(t.type==="Bezier"){if(this.segments.length>0)for(var h=0;h<this.segments.length;h++){var l=this.segments[parseInt(h.toString(),10)],d=t.segments[parseInt(h.toString(),10)],f=b.isEmptyPoint(l.point1)?d.bezierPoint1:d.point1,p=b.isEmptyPoint(l.point2)?d.bezierPoint2:d.point2;s.uniteRect(Um(l.points[0],f,p,l.points[1],t))}}else s=it.toBounds(i);return r.width=s.width,r.height=s.height,r.offsetX=s.x+r.width/2,r.offsetY=s.y+r.height/2,r.data=o,t.wrapper&&(t.wrapper.offsetX=r.offsetX,t.wrapper.offsetY=r.offsetY,t.wrapper.width=s.width,t.wrapper.height=s.height),r},e.prototype.getSegmentElement=function(t,i,r,a,s){s===void 0&&(s=!0);var o=[];return s&&rh(t),o=this.getConnectorPoints(t.type,void 0,r),this.intermediatePoints=o,i.staticSize=!0,i=this.updateSegmentElement(t,o,i,a),i},e.prototype.getDecoratorElement=function(t,i,r,a,s){var o=new Pt;if(o.transform=Zi.Self,this.updateDecoratorElement(o,t,i,r),s!==void 0){var h=s(r,this);o.description=h||("Specifies the "+a?"source":"targetport element of the connector")}return o},e.prototype.bridgePath=function(t,i,r){var a=i;if(t.bridges.length>0){if(t.type==="Straight"&&t.segments.length<2)for(var s=0;s<t.bridges.length;s++){var o=t.bridges[parseInt(s.toString(),10)];o.rendered||(a+=" L"+o.startPoint.x+" "+o.startPoint.y,a+=o.path,o.rendered=!0)}else if(t.type==="Orthogonal"||t.type==="Straight"&&t.segments.length>1)for(var s=0;s<t.bridges.length;s++){var o=t.bridges[parseInt(s.toString(),10)];o.segmentPointIndex===r&&(o.rendered||o.segmentPointIndex===r&&(a+=" L"+o.startPoint.x+" "+o.startPoint.y,a+=o.path,o.rendered=!0))}}return a},e.prototype.updateDecoratorElement=function(t,i,r,a){t.offsetX=i.x,t.offsetY=i.y;var s=b.findAngle(i,r),o=jg(a.shape,a),h=new U(a.width,a.height);t.pivot.x=a.pivot.x,t.pivot.y=a.pivot.y,t.style=a.style,t.rotateAngle=s,t.data=o,t.canMeasurePath=!0,t.width=h.width,t.height=h.height},e.prototype.getSegmentPath=function(t,i,r){for(var a="",s,o,h,l=[],d=0;d<i.length;)l.push({x:i[parseInt(d.toString(),10)].x,y:i[parseInt(d.toString(),10)].y}),d++;for(var f=0;f<t.bridges.length;f++){var p=t.bridges[parseInt(f.toString(),10)];p.rendered=!1}if(l=this.clipDecorators(t,l,r),this.cornerRadius>0&&this.type!=="Bezier")for(var c=0;c<l.length-1;c++){s=l[parseInt(c.toString(),10)],c===0&&(a="M"+s.x+" "+s.y);var u=b.distancePoints(l[parseInt(c.toString(),10)],l[c+1]);u>0&&(c<l.length-2?u<this.cornerRadius*2?o=b.adjustPoint(l[parseInt(c.toString(),10)],l[c+1],!1,u/2):o=b.adjustPoint(l[parseInt(c.toString(),10)],l[c+1],!1,this.cornerRadius):o=l[c+1],c>0&&(u<this.cornerRadius*2?(h=b.adjustPoint(l[parseInt(c.toString(),10)],l[c+1],!0,u/2),c<l.length-2&&(o=null)):h=b.adjustPoint(l[parseInt(c.toString(),10)],l[c+1],!0,this.cornerRadius)),h&&(a+="Q"+s.x+" "+s.y+" "+h.x+" "+h.y),o&&(t.bridges.length>0&&(a=this.bridgePath(t,a,c),t.type==="Orthogonal"&&(a=this.bridgePath(t,a,c+1))),a+=" L"+o.x+" "+o.y))}else if(this.type==="Bezier"){var g=void 0,v=void 0;if(this.parentObj.element){var m=this.parentObj.element.ej2_instances[0].eventHandler.action;g=this.parentObj.element.ej2_instances[0].eventHandler.tool instanceof Lr,v=m.includes("PortDraw")||m.includes("Drag")}for(var y=void 0,S=this.segments,x=0;x<S.length;x++)l.length>2&&(S[parseInt(x.toString(),10)].bezierPoint1={x:0,y:0},S[parseInt(x.toString(),10)].bezierPoint2={x:0,y:0}),b.isEmptyPoint(S[parseInt(x.toString(),10)].point1)&&!S[parseInt(x.toString(),10)].vector1.angle&&!S[parseInt(x.toString(),10)].vector1.distance?((t.sourceID||this.sourcePortID)&&this.sourceWrapper&&!v&&!g&&(y=ol(this.sourceWrapper.bounds,l[parseInt(x.toString(),10)])),S[parseInt(x.toString(),10)].bezierPoint1=Qa(l[parseInt(x.toString(),10)],l[x+1],y)):S[parseInt(x.toString(),10)].vector1.angle||S[parseInt(x.toString(),10)].vector1.distance?S[parseInt(x.toString(),10)].bezierPoint1=b.transform(l[parseInt(x.toString(),10)],S[parseInt(x.toString(),10)].vector1.angle,S[parseInt(x.toString(),10)].vector1.distance):S[parseInt(x.toString(),10)].bezierPoint1={x:S[parseInt(x.toString(),10)].point1.x||S[parseInt(x.toString(),10)].bezierPoint1.x,y:S[parseInt(x.toString(),10)].point1.y||S[parseInt(x.toString(),10)].bezierPoint1.y},b.isEmptyPoint(S[parseInt(x.toString(),10)].point2)&&!S[parseInt(x.toString(),10)].vector2.angle&&!S[parseInt(x.toString(),10)].vector2.distance?((t.targetID||this.targetPortID)&&this.targetWrapper&&!v&&!g&&(y=ol(this.targetWrapper.bounds,l[x+1])),S[parseInt(x.toString(),10)].bezierPoint2=Qa(l[x+1],l[parseInt(x.toString(),10)],y)):S[parseInt(x.toString(),10)].vector2.angle||S[parseInt(x.toString(),10)].vector2.distance?S[parseInt(x.toString(),10)].bezierPoint2=b.transform(l[x+1],S[parseInt(x.toString(),10)].vector2.angle,S[parseInt(x.toString(),10)].vector2.distance):S[parseInt(x.toString(),10)].bezierPoint2={x:S[parseInt(x.toString(),10)].point2.x||S[parseInt(x.toString(),10)].bezierPoint2.x,y:S[parseInt(x.toString(),10)].point2.y||S[parseInt(x.toString(),10)].bezierPoint2.y};l.splice(1,0,{x:S[0].bezierPoint1.x,y:S[0].bezierPoint1.y}),l.splice(l.length-1,0,{x:S[S.length-1].bezierPoint2.x,y:S[S.length-1].bezierPoint2.y}),l=this.clipDecorators(t,l,r);for(var I=0;I<S.length;I++){I===0&&(a="M"+l[0].x+" "+l[0].y);var C=I===S.length-1?l[l.length-1].x+" "+l[l.length-1].y:S[parseInt(I.toString(),10)].points[S[parseInt(I.toString(),10)].points.length-1].x+" "+S[parseInt(I.toString(),10)].points[S[parseInt(I.toString(),10)].points.length-1].y;a+="C"+S[parseInt(I.toString(),10)].bezierPoint1.x+" "+S[parseInt(I.toString(),10)].bezierPoint1.y+" "+S[parseInt(I.toString(),10)].bezierPoint2.x+" "+S[parseInt(I.toString(),10)].bezierPoint2.y+" "+C}}else for(var P=0;P<l.length;P++)s=l[parseInt(P.toString(),10)],P===0&&(a="M"+s.x+" "+s.y),P>0&&(a=this.bridgePath(t,a,P),a+=" L"+s.x+" "+s.y);return a},e.prototype.updateShapeElement=function(t){var i;switch(t.shape.type){case"Bpmn":t.wrapper.children[3]instanceof Pt&&(i=t.wrapper.children[3]),t.shape.flow==="Message"&&this.updateShapePosition(t,i);break;case"UmlActivity":t.shape.flow==="Exception"&&this.getUMLExceptionFlow(t.wrapper.children[0]);break}},e.prototype.updateShapePosition=function(t,i){var r=.5,a=this.intermediatePoints,s=uf(a,i,r);i.offsetX=s.x,i.offsetY=s.y},e.prototype.scale=function(t,i,r,a,s){var o=0,h=0;if(this.wrapper&&this.wrapper.outerBounds){var l=Od(this),d=Math.abs((this.wrapper.bounds.width||this.style.strokeWidth||1)-2),f=Math.abs((this.wrapper.bounds.height||this.style.strokeWidth||1)-2);o=l.width-d,h=l.height-f,t=Math.abs((r-Math.max(o,h))/d),i=Math.abs((a-Math.max(o,h))/f),o=h=Math.min(o,h)}t=i=Math.min(t,i);var p=xt();s=s||this.wrapper,Rt(p,-s.rotateAngle,s.offsetX,s.offsetY),Or(p,t,i,s.offsetX,s.offsetY),Rt(p,s.rotateAngle,s.offsetX,s.offsetY);var c=mg(p,this.intermediatePoints);return this.sourcePoint=c[0],this.targetPoint=c[c.length-1],c=this.intermediatePoints=Nh(this),Dn(this,c),{x:o,y:h}},e.prototype.getClassName=function(){return"Connector"},_([os(Om)],e.prototype,"shape",void 0),_([w(yt.Default)],e.prototype,"constraints",void 0),_([w(10)],e.prototype,"bridgeSpace",void 0),_([Lt([],Qt)],e.prototype,"annotations",void 0),_([X({},b)],e.prototype,"sourcePoint",void 0),_([X({},b)],e.prototype,"targetPoint",void 0),_([Lt([],Xn)],e.prototype,"fixedUserHandles",void 0),_([jl(Wm)],e.prototype,"segments",void 0),_([w("")],e.prototype,"sourceID",void 0),_([w("")],e.prototype,"targetID",void 0),_([w(10)],e.prototype,"hitPadding",void 0),_([w(0)],e.prototype,"connectionPadding",void 0),_([w("Straight")],e.prototype,"type",void 0),_([w("Circle")],e.prototype,"segmentThumbShape",void 0),_([w(10)],e.prototype,"segmentThumbSize",void 0),_([w(0)],e.prototype,"cornerRadius",void 0),_([X({shape:"None"},sl)],e.prototype,"sourceDecorator",void 0),_([X({shape:"Arrow"},sl)],e.prototype,"targetDecorator",void 0),_([X({},Gr)],e.prototype,"tooltip",void 0),_([w("")],e.prototype,"sourcePortID",void 0),_([w("")],e.prototype,"targetPortID",void 0),_([w(0)],e.prototype,"sourcePadding",void 0),_([X({},Xa)],e.prototype,"previewSize",void 0),_([X({},Xa)],e.prototype,"dragSize",void 0),_([w(0)],e.prototype,"targetPadding",void 0),_([w(13)],e.prototype,"connectorSpacing",void 0),_([X({strokeWidth:1,strokeColor:"black"},hd)],e.prototype,"style",void 0),_([w(null)],e.prototype,"maxSegmentThumb",void 0),_([w(!1)],e.prototype,"allowNodeOverlap",void 0),_([X({},Nm)],e.prototype,"bezierSettings",void 0),_([Lt([],ke)],e.prototype,"ports",void 0),_([w(null)],e.prototype,"wrapper",void 0),e})(Nd),Gm=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),hr=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Zm=(function(n){Gm(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.offset=0,r.scale=1,r}return e.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.updateRulerGeometry(),this.renderComplete()},e.prototype.getModuleName=function(){return"Ruler"},e.prototype.destroy=function(){this.unWireEvents(),this.notify("destroy",{}),n.prototype.destroy.call(this),this.element.classList.remove("e-ruler")},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i){for(var r=0,a=Object.keys(t);r<a.length;r++){var s=a[r];switch(s){case"length":case"interval":case"segmentWidth":case"tickAlignment":case"markerColor":case"thickness":this.updateRuler();break}}},e.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},e.prototype.renderRulerSpace=function(){var t=this.getRulerGeometry(),i=document.getElementById(this.element.id+"_ruler_space");return i||(i=bt("div",{id:this.element.id+"_ruler_space",style:"height:"+t.height+"px;width:"+t.width+"px;cssFloat:left;"}),this.element.appendChild(i)),i},e.prototype.updateRuler=function(){var t=this.getRulerSize(),i=this.getRulerGeometry(),r=0,a=0,s=new U,o=this.getRulerSVG(i);if(o&&(r=this.length,s.height=t,a=this.offset,r&&r!==1/0)){var h=r+this.segmentWidth,l=a;this.updateSegments(l,h+Math.abs(l),o,t)}},e.prototype.updateSegments=function(t,i,r,a){for(var s=t,o={trans:0};s<i;){var h=this.getNewSegment(s,r);h&&(r.appendChild(h.segment),s=this.updateSegment(t,i,h,s,o,a))}},e.prototype.updateSegment=function(t,i,r,a,s,o){var h=this.updateSegmentWidth(this.scale);a===t?(this.startValue=Math.floor(t/h)*h/this.scale,this.startValue=this.startValue%1!==0?Number(this.startValue.toFixed(1)):this.startValue,r.label.textContent=this.startValue.toString(),this.defStartValue=a=this.startValue*this.scale,this.orientation==="Horizontal"?this.hRulerOffset=t-a:this.vRulerOffset=t-a):(this.startValue=a/this.scale,this.startValue=this.startValue%1!==0?Number(this.startValue.toFixed(1)):this.startValue,r.label.textContent=this.startValue.toString()),this.updateTickLabel(r,o);var l=this.orientation==="Horizontal"?s.trans+.5+",0.5":"0.5,"+(s.trans+.5);return r.segment.setAttribute("transform","translate("+l+")"),s.trans+=h,a+=h,a},e.prototype.updateTickLabel=function(t,i){var r=t.segment.lastChild.getBBox(),a=this.orientation==="Horizontal",s=this.tickAlignment==="RightOrBottom",o=a?2:0,h=a?s?i/2+11/2-11/2:i/2+11/2:r.height,l=s?-(r.width+2)+","+(i/2-r.height):-(r.width+2)+","+(i/2-r.height/2),d=a?{x:o,y:h}:{x:o,y:h,transform:"rotate(270)translate("+l+")"};Et(t.segment.lastChild,d)},e.prototype.getNewSegment=function(t,i){var r=this.createNewTicks(t,i),a=this.createTickLabel(i,r);return{segment:r,label:a}},e.prototype.createNewTicks=function(t,i){for(var r,a,s=this.updateSegmentWidth(this.scale),o={class:"e-ruler-segment"},h=Nt("g",o),l=0;l<this.interval;l++)a=s/this.interval,r=this.createTick(i,a,l+1,t),h.appendChild(r);return h},e.prototype.getLinePoint=function(t,i,r){var a=this.updateSegmentWidth(this.scale),s=this.getRulerSize();return i=i*(r-1),r=i%a===0?s:s*.3,r},e.prototype.createTick=function(t,i,r,a){var s,o=this.getLinePoint(t,i,r),h=this.getRulerSize(),l=this.orientation==="Horizontal",d=this.tickAlignment==="RightOrBottom",f=_t(this.arrangeTick),p={ruler:s,tickLength:o,tickInterval:this.segmentWidth/this.interval*(r-1)};f&&f(p),o=p.tickLength;var c=i*(r-1),u=l?c:d?h:0,g=l?c:d?h-o:h-(h-o),v=l?d?h:h-(h-o):c,m=l?d?h-o:0:c,y={x1:u,y1:v,x2:g,y2:m,"stroke-width":"1",stroke:"black"},S=Nt("line",y);return S.setAttribute("class","e-ruler-tick"),S},e.prototype.createTickLabel=function(t,i){var r;if(i){var a={class:"e-ruler-tick-label"};r=Nt("text",a),i.appendChild(r)}return r},e.prototype.updateSegmentWidth=function(t){if(this.segmentWidth!==100)return this.segmentWidth;var i=25,r=1,a,s=100,o=Math.pow(2,Math.round(Math.log(t)/Math.log(2)));for(a=s,a=s/o;a>100;)r/=10,a/=10;for(;a<25;)r*=10,a*=10;return a>=i&&a%i!==0&&(a=Math.round(a/i)*i),a*t/r},e.prototype.createMarkerLine=function(t,i,r){var a;return i&&(a=t.getElementById(i.id+"_marker"),a&&a.parentNode.removeChild(a),a=Nt("line",r)),a},e.prototype.drawRulerMarker=function(t,i,r){var a,s,o,h,l,d,f,p=this.orientation==="Horizontal",c=t.getElementsByTagName("svg");for(l=0;l<c.length;l++){c[parseInt(l.toString(),10)]&&(a=c[parseInt(l.toString(),10)]);break}if(a){s=this.getRulerSize(),d={id:t.id+"_marker",x1:0,y1:0,x2:p?0:s,y2:p?s:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},f=this.createMarkerLine(a,t,d),o=this.scale,h=this.offset-this.defStartValue;var u=p?i.x:i.y,g=u*o+r+h;f.setAttribute("transform","translate("+(p?g+.5+" 0.5":"0.5 "+(g+.5))+")"),a.appendChild(f)}},e.prototype.getRulerGeometry=function(){return new U(this.element?this.element.getBoundingClientRect().width:0,this.element?this.element.getBoundingClientRect().height:0)},e.prototype.getRulerSize=function(){return this.thickness},e.prototype.getRulerSVG=function(t){var i,r=this.getRulerSize(),a;if(this.element&&(i=document.getElementById(this.element.id+"_ruler_space"),i)){var s={id:this.element.id+"_Ruler_svg",width:this.orientation==="Horizontal"?t.width+200:r+"px",height:this.orientation==="Horizontal"?r:t.height+200+"px",style:"position:inherit;"};if(a=Nt("svg",s),i.childNodes.length>0)for(var o=i.childNodes.length-1;o>=0;o--)i.childNodes[parseInt(o.toString(),10)].parentNode.removeChild(i.childNodes[parseInt(o.toString(),10)]);i.appendChild(a)}return a},e.prototype.wireEvents=function(){},e.prototype.unWireEvents=function(){},hr([w(5)],e.prototype,"interval",void 0),hr([w(100)],e.prototype,"segmentWidth",void 0),hr([w("Horizontal")],e.prototype,"orientation",void 0),hr([w("RightOrBottom")],e.prototype,"tickAlignment",void 0),hr([w("red")],e.prototype,"markerColor",void 0),hr([w(25)],e.prototype,"thickness",void 0),hr([w(null)],e.prototype,"arrangeTick",void 0),hr([w(400)],e.prototype,"length",void 0),e})(Vr);function $m(n){var e=Mi(n),t={id:n.element.id+"_overlapRuler",style:"height:"+e.height+"px;width:"+e.width+"px;position:absolute;left:0;top:0",class:"e-ruler-overlap"},i=bt("div",t);n.element.insertBefore(i,n.element.firstChild)}function ll(n,e){var t=document.getElementById(n.element.id+(e?"_hRuler":"_vRuler")),i=Mi(n),r=tf(n),a=e?"margin-left:"+i.width+"px;":"margin-top:"+i.height+"px;";if(!t){var s="height:"+(e?i.height:r.height+100)+"px;overflow:hidden;width:"+(e?r.width+100:i.width)+"px;position:absolute;font-size:11px;"+a,o={id:n.element.id+(e?"_hRuler":"_vRuler"),style:s};t=bt("div",o)}n.element.insertBefore(t,n.element.firstChild);var h=e?n.rulerSettings.horizontalRuler:n.rulerSettings.verticalRuler,l=new Zm(h);l.orientation=e?"Horizontal":"Vertical",l.length=(e?r.width:r.height)+h.segmentWidth,l.appendTo("#"+n.element.id+(e?"_hRuler":"_vRuler")),e?n.hRuler=l:n.vRuler=l;var d=document.getElementById(n.element.id+(e?"_hRuler":"_vRuler"));e?n.hRuler.element=d:n.vRuler.element=d}function Ja(n){var e=-n.scroller.horizontalOffset,t=-n.scroller.verticalOffset;n&&n.rulerSettings.showRulers?(n.hRuler.length=0,n.vRuler.length=0,e!==void 0&&n.hRuler.element&&dl(n,n.hRuler,e,!0),t!==void 0&&n.vRuler.element&&dl(n,n.vRuler,t,!1)):vo(n)}function vo(n){be(n.element.id+"_hRuler"),be(n.element.id+"_vRuler"),be(n.element.id+"_overlapRuler")}function Mi(n){var e=0,t=0;return n.rulerSettings.showRulers&&(e=n.rulerSettings.horizontalRuler.thickness,t=n.rulerSettings.verticalRuler.thickness),new U(t,e)}function tf(n){var e=Mi(n),t=n.scroller.viewPortHeight,i=n.scroller.viewPortWidth;return i<n.element.clientWidth-e.width&&(i=n.element.clientWidth-e.width),t<n.element.clientHeight-e.height&&(t=n.element.clientHeight-e.height),n.hRuler&&n.hRuler.length&&(i=n.hRuler.length),n.vRuler&&n.vRuler.length&&(t=n.vRuler.length),new U(i,t)}function qm(){var n=document.getElementsByClassName("e-d-ruler-marker"),e,t;if(n&&n.length>0)for(t=n.length-1;t>=0;t--)e=n[parseInt(t.toString(),10)],e&&e.parentNode.removeChild(e)}function Qm(n,e){n.rulerSettings.showRulers&&(n.hRuler.drawRulerMarker(n.hRuler.element,e,n.scroller.horizontalOffset),n.vRuler.drawRulerMarker(n.vRuler.element,e,n.scroller.verticalOffset))}function dl(n,e,t,i){var r=Mi(n),a=tf(n),s=i?n.rulerSettings.horizontalRuler:n.rulerSettings.verticalRuler;_m(n,a,i),Jm(n,a,i),e.offset=t,e.scale=n.scroller.currentZoom,e.length=(i?a.width:a.height)+100,e.arrangeTick=_t(s.arrangeTick),e.dataBind();var o=i?n.hRuler.element:n.vRuler.element;i?o.style.marginLeft=r.width-e.hRulerOffset+"px":o.style.marginTop=r.height-e.vRulerOffset+"px"}function Jm(n,e,t){var i=document.getElementById(n.element.id+(t?"_hRuler_ruler_space":"_vRuler_ruler_space")),r=t?n.hRuler:n.vRuler;i&&n&&e&&(i.style.width=(t?e.width+r.segmentWidth*2:r.thickness)+"px",i.style.height=(t?r.thickness:e.height+r.segmentWidth*2)+"px")}function _m(n,e,t){var i=document.getElementById(n.element.id+(t?"_hRuler":"_vRuler")),r=t?n.hRuler:n.vRuler;i&&n&&e&&(i.style.width=(t?e.width+r.segmentWidth:r.thickness)+"px",i.style.height=(t?r.thickness:e.height+r.segmentWidth)+"px",i=document.getElementById(n.element.id+"_overlapRuler"),i&&(t?i.style.height=r.thickness+"px":i.style.width=r.thickness+"px"))}var Km=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),fe=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},_o=(function(n){Km(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UserHandle"},fe([w("")],e.prototype,"name",void 0),fe([w("")],e.prototype,"pathData",void 0),fe([w("")],e.prototype,"content",void 0),fe([w("")],e.prototype,"source",void 0),fe([w("#000000")],e.prototype,"backgroundColor",void 0),fe([w("Top")],e.prototype,"side",void 0),fe([w("")],e.prototype,"borderColor",void 0),fe([w(.5)],e.prototype,"borderWidth",void 0),fe([w(25)],e.prototype,"size",void 0),fe([w("white")],e.prototype,"pathColor",void 0),fe([w(10)],e.prototype,"displacement",void 0),fe([w(!0)],e.prototype,"visible",void 0),fe([w(0)],e.prototype,"offset",void 0),fe([X({},Ie)],e.prototype,"margin",void 0),fe([w("Center")],e.prototype,"horizontalAlignment",void 0),fe([w("Center")],e.prototype,"verticalAlignment",void 0),fe([w(!1)],e.prototype,"disableNodes",void 0),fe([w(!1)],e.prototype,"disableConnectors",void 0),fe([X({},Gr)],e.prototype,"tooltip",void 0),fe([w("")],e.prototype,"template",void 0),e})(j);function ef(n){return jm[n.toString()]}var jm={Action:"M 90 82.895 C 90 86.819 86.776 90 82.8 90 H 7.2 C 3.224 90 0 86.819 0 82.895 V 7.105 C 0 3.181 3.224 0 7.2 0 h 75.6 C 86.776 0 90 3.181 90 7.105 V 82.895 Z",Decision:"M10,19.707L0.293,10L10,0.293L19.707,10L10,19.707z",MergeNode:"M10,19.707L0.293,10L10,0.293L19.707,10L10,19.707z",InitialNode:"M10,19.5c-5.238,0-9.5-4.262-9.5-9.5S4.762,0.5,10,0.5s9.5,4.262,9.5,9.5S15.238,19.5,10,19.5z",ForkNode:"m0.75,0.75l636.00002,0l0,290l-636.00002,0l0,-290z",JoinNode:"m0.75,0.75l636.00002,0l0,290l-636.00002,0l0,-290z",TimeEvent:"M50.001,0.00286865 L25.001,25.0029 L0.000976562,0.00286865 L50.001,0.00286865 z M0.000976562,50.0029 L25.001,25.0029 L50.001,50.0029 L0.000976562,50.0029 z",AcceptingEvent:"M17.8336 32.164 L29.64 24 L17.32 16 L48.1664 16 L48.5 32 Z",SendSignal:"M48.164 31.8336 L56 23.832 L47.836 16 L16.168 16 L16.1668 31.8336 Z",ReceiveSignal:"M48.1664 31.8336 L39.836 24 L47.836 16 L16.168 16 L16.168 31.836 Z",StructuredNode:"M0,0 L50,0 L50,50 L0,50 z",Note:"M20 12 L4 12 L4 22 L22 22 L22 14 L20 14 L20 12 L22 14 Z"},cs=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Pi=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},t0=(function(n){cs(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Pi([w()],e.prototype,"key",void 0),Pi([w()],e.prototype,"keyModifiers",void 0),e})(j),rf=(function(n){cs(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Command"},Pi([w("")],e.prototype,"name",void 0),Pi([w()],e.prototype,"canExecute",void 0),Pi([w()],e.prototype,"execute",void 0),Pi([X({},t0)],e.prototype,"gesture",void 0),Pi([w("")],e.prototype,"parameter",void 0),e})(j),e0=(function(n){cs(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Pi([Lt([],rf)],e.prototype,"commands",void 0),e})(j),i0=(function(n){cs(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Pi([w()],e.prototype,"show",void 0),Pi([w()],e.prototype,"showCustomMenuOnly",void 0),Pi([w()],e.prototype,"items",void 0),e})(j),ln=(function(){function n(){}return n.prototype.renderShadow=function(e,t,i,r){i===void 0&&(i=null);var a={x:0,y:0},s=b.transform(a,e.shadow.angle,e.shadow.distance),o,h;r&&(h=r.getElementById(t.id+"_shadow")),h||(o=i?"path":"rect",h=document.createElementNS("http://www.w3.org/2000/svg",o),t.appendChild(h));var l={id:t.id+"_shadow",fill:e.shadow.color,stroke:e.shadow.color,opacity:e.shadow.opacity.toString(),transform:"rotate("+e.angle+","+(e.x+e.width*e.pivotX)+","+(e.y+e.height*e.pivotY)+")translate("+(e.x+s.x)+","+(e.y+s.y)+")",rx:e.cornerRadius||0,ry:e.cornerRadius||0,"stroke-dasharray":e.dashArray};if(r){var d=r.getElementById(t.id);d&&d.insertBefore(h,d.firstChild)}Et(h,l),i?i&&this.renderPath(h,e,i):Et(h,{width:e.width,height:e.height})},n.prototype.parseDashArray=function(e){var t=[];return t},n.prototype.drawRectangle=function(e,t,i,r,a,s,o,h,l){t.shadow&&!r&&this.renderShadow(t,e,void 0,s);var d;t.id===e.id?d=t.id+"_container":d=t.id;var f;s&&(f=s.getElementById(d)),(!f||a)&&(f=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.appendChild(f));var p;s&&!t.shadow&&(p=s.getElementById(t.id+"_groupElement_shadow"),p&&p.parentNode.removeChild(p)),s&&(p=s.getElementById(t.id+"_groupElement_shadow"),p&&(p.style.visibility=t.visible?"visible":"hidden"));var c;if(h)c={id:d,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),visibility:t.visible?"visible":"hidden",transform:"rotate("+t.angle+","+(t.x+t.width/2)+","+(t.y+t.height/2)+")",rx:t.cornerRadius||0,ry:t.cornerRadius||0,opacity:t.opacity};else{var u=t.x,g=t.y,v=t.width,m=t.height,y=t.visible,S=t.angle,x=t.pivotX,I=t.pivotY,C=t.cornerRadius,P=C===void 0?0:C,A=t.opacity,T=A===void 0?1:A,z=u+v*x,L=g+m*I;c={id:d,x:u+"",y:g+"",width:v+"",height:m+"",visibility:y?"visible":"hidden",transform:"rotate("+S+","+z+","+L+")",rx:P,ry:P,opacity:T}}o&&(c.role="img",c["aria-label"]=o);var R=t.class||"";l||(R.includes("e-diagram-resize-handle")||R.includes("e-diagram-endpoint-handle")||R.includes("e-diagram-bezier-control-handle"))&&(R+=" e-disabled"),t.class&&(c.class=R);var O="pointer-events";o||(c[""+O]="none"),Et(f,c),this.setSvgStyle(f,t,i)},n.prototype.updateSelectionRegion=function(e,t){var i;i=e.parentNode.getElementById(t.id);var r={id:t.id,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",class:"e-diagram-selected-region"};i||(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),e.appendChild(i)),this.setSvgStyle(i,t),Et(i,r)},n.prototype.createGElement=function(e,t){var i=Nt(e,t);return i},n.prototype.drawLine=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg","line");this.setSvgStyle(i,t);var r=t.x+t.width*t.pivotX,a=t.y+t.height*t.pivotY,s={id:t.id,x1:t.startPoint.x+t.x,y1:t.startPoint.y+t.y,x2:t.endPoint.x+t.x,y2:t.endPoint.y+t.y,stroke:t.stroke,"stroke-width":t.strokeWidth.toString(),opacity:t.opacity.toString(),transform:"rotate("+t.angle+" "+r+" "+a+")",visibility:t.visible?"visible":"hidden"};t.class&&(s.class=t.class),Et(i,s),e.appendChild(i)},n.prototype.drawCircle=function(e,t,i,r){var a=document.createElementNS("http://www.w3.org/2000/svg","circle");this.setSvgStyle(a,t);var s=t.class||"";i||(s+=" e-disabled");var o={id:t.id,cx:t.centerX,cy:t.centerY,r:t.radius,visibility:t.visible?"visible":"hidden",class:s};r&&(o.role="img",o["aria-label"]=r),a.style.display=t.visible?"block":"none",Et(a,o),e.appendChild(a)},n.prototype.drawPath=function(e,t,i,r,a,s,o){var h=[];h=Hr(t.data),h=ed(h),t.shadow&&this.renderShadow(t,e,h,a);var l;a&&!t.shadow&&(l=a.getElementById(t.id+"_groupElement_shadow"),l&&l.parentNode.removeChild(l)),a&&(l=a.getElementById(t.id+"_groupElement_shadow"),l&&(l.style.visibility=t.visible?"visible":"hidden"));var d;if(a&&(d=a.getElementById(t.id)),!d||r)if(d=document.createElementNS("http://www.w3.org/2000/svg","path"),e.parentElement&&e.parentElement.id==="diagram_nativeLayer"){var f=document.createElementNS("http://www.w3.org/2000/svg","g");f.id=t.id+"_groupElement",e.appendChild(f),f.appendChild(d)}else e.appendChild(d);this.renderPath(d,t,h);var p={};o?p={id:t.id,transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+t.x+","+t.y+"),scale("+o+")",visibility:t.visible?"visible":"hidden",opacity:t.opacity}:p={id:t.id,transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+t.x+","+t.y+")",visibility:t.visible?"visible":"hidden",opacity:t.opacity},s&&(p.role="img",p["aria-label"]=s),t.class&&(p.class=t.class),Et(d,p),this.setSvgStyle(d,t,i)},n.prototype.renderPath=function(e,t,i){var r,a,s,o,h,l,d,f,p=i,c="";for(h=0,l=0,f=0,d=p.length;f<d;++f){var u=p[parseInt(f.toString(),10)],g=u,v=g.command;switch("x1"in g&&(r=g.x1),"x2"in g&&(s=g.x2),"y1"in g&&(a=g.y1),"y2"in g&&(o=g.y2),"x"in g&&(h=g.x),"y"in g&&(l=g.y),v){case"M":c=c+"M"+h.toString()+","+l.toString()+" ";break;case"L":c=c+"L"+h.toString()+","+l.toString()+" ";break;case"C":c=c+"C"+r.toString()+","+a.toString()+","+s.toString()+","+o.toString()+",",c+=h.toString()+","+l.toString()+" ";break;case"Q":c=c+"Q"+r.toString()+","+a.toString()+","+h.toString()+","+l.toString()+" ";break;case"A":c=c+"A"+g.r1.toString()+","+g.r2.toString()+","+g.angle.toString()+",",c+=g.largeArc.toString()+","+g.sweep+","+h.toString()+","+l.toString()+" ";break;case"Z":case"z":c=c+"Z ";break}}e.setAttribute("d",c)},n.prototype.setSvgFontStyle=function(e,t){e.style.fontStyle=t.italic?"italic":"normal",e.style.fontWeight=t.bold?"bold":"normal",e.style.fontSize=t.fontSize.toString()+"px",e.style.fontFamily=t.fontFamily},n.prototype.drawText=function(e,t,i,r,a,s,o){if(t.content!==void 0){var h=o.groupElement,l=void 0,d=void 0,f=void 0,p=void 0,c=void 0,u=void 0,g=0,v=0,m=0,y=void 0,S=void 0;if(i&&(y=i.getElementById(t.id+"_text")),y){if(t.doWrap)for(;y.firstChild;)y.removeChild(y.firstChild)}else if(t.doWrap=!0,y=document.createElementNS("http://www.w3.org/2000/svg","text"),t.whiteSpace==="pre-wrap"&&y.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),h&&(S=document.getElementById(h.id+"_content_groupElement")),S&&h&&h.children&&h.children[0]instanceof li){var x=this.createGElement("g",{id:r+"_groupElement"});S.appendChild(x),x.appendChild(y)}else e.appendChild(y);var I=t.x+t.width*t.pivotX,C=t.y+t.height*t.pivotY,P=0;if(t.doWrap||t.textOverflow!=="Wrap"){for(;y.firstChild;)y.removeChild(y.firstChild);for(this.setSvgStyle(y,t,a),this.setSvgFontStyle(y,t),l=document.createTextNode(t.content),d=t.childNodes,f=t.wrapBounds,p=this.svgLabelAlign(t,f,d),f.width>t.width&&t.textOverflow!=="Wrap"&&t.textWrapping==="NoWrap"&&(d[0].text=nd(t.content,t)),m=0;m<d.length;m++)if(u=document.createElementNS("http://www.w3.org/2000/svg","tspan"),l=document.createTextNode(d[parseInt(m.toString(),10)].text),c=d[parseInt(m.toString(),10)],c.x=zf(c,d,m,t),t.textAlign==="justify"||t.textAlign==="left"?g=0:g=p.x+c.x-f.x,v=p.y+c.dy*m+t.fontSize*.8,(t.textOverflow==="Clip"||t.textOverflow==="Ellipsis")&&(t.textWrapping==="WrapWithOverflow"||t.textWrapping==="Wrap")&&h){var A=t.isHorizontalLane?h.actualSize.width:h.actualSize.height;if(v<A){if(t.textOverflow==="Ellipsis"&&d[m+1]){var T=d[m+1],z=p.y+T.dy*(m+1)+t.fontSize*.8;z>A&&(c.text=c.text.slice(0,c.text.length-3),c.text=c.text.concat("..."),l.data=c.text)}this.alignText(y,u,c,l,g,v,m,t,d),P+=c.dy}else break}else this.alignText(y,u,c,l,g,v,m,t,d)}P&&t.isHorizontalLane&&(I=t.parentOffsetX+t.pivotX,C=t.parentOffsetY+t.pivotY,t.y=t.parentOffsetY-P*t.pivotY+.5),t.textDecoration&&t.textDecoration==="LineThrough"&&(t.textDecoration=hs(t.textDecoration));var L={id:t.id+"_text",fill:t.color,visibility:t.visible?"visible":"hidden","text-decoration":t.textDecoration,transform:"rotate("+t.angle+","+I+","+C+")translate("+t.x+","+t.y+")",opacity:t.opacity};r&&(L.role="img",L["aria-label"]=r),Et(y,L)}},n.prototype.alignText=function(e,t,i,r,a,s,o,h,l){if(h.textAlign!=="justify")this.setText(e,t,i,r,a,s,h);else if(o!==l.length-1){var d=h.width,f="spacing";this.setText(e,t,i,r,a,s,h,d,f)}else this.setText(e,t,i,r,a,s,h)},n.prototype.setText=function(e,t,i,r,a,s,o,h,l){var d=a.toString(),f=s.toString(),p={x:d,y:f};o.textAlign==="justify"&&(p.textLength=(h||0).toString(),p.lengthAdjust=l||"spacing"),Et(t,p),e.setAttribute("fill",i.text),t.appendChild(r),e.appendChild(t)},n.prototype.drawImage=function(e,t,i,r){var a;i&&(a=i.getElementById(t.id+"image")),a||(a=document.createElementNS("http://www.w3.org/2000/svg","image"),e.appendChild(a));var s=new Image;s.src=t.source;var o=t.scale!=="None"?t.scale:"",h=t.alignment,l=h.charAt(0).toLowerCase()+h.slice(1);o!=="Stretch"&&(l+=" "+o.charAt(0).toLowerCase()+o.slice(1));var d={id:t.id+"image",x:t.x.toString(),y:t.y.toString(),transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")",width:t.width.toString(),visibility:t.visible?"visible":"hidden",height:t.height.toString(),preserveAspectRatio:l,opacity:t.opacity.toString()};Et(a,d),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s.src.toString())},n.prototype.drawHTMLContent=function(e,t,i,r,a){var s,o;if(t&&(s=t.querySelector("#"+e.id+"_html_element")),!s){if(o=t.querySelector("#"+e.id+"_html_element")||t.querySelector("#"+e.nodeId+"_html_element"),!o){var h={id:e.nodeId+"_html_element",class:"foreign-object"};o=bt("div",h)}var l={id:e.id+"_html_element",class:"foreign-object"};s=bt("div",l);var d=document.getElementById(e.diagramId).ej2_instances[0],f=!1;if(t.parentNode&&t.parentNode.parentNode&&t.parentNode.parentNode.parentNode&&t.parentNode.parentNode.parentNode.classList.contains("e-overview")&&(f=!0),f)d.isReact?d.renderReactTemplates(function(){s.appendChild(e.template.cloneNode(!0))}):s.appendChild(e.template.cloneNode(!0));else{if(typeof e.template=="string"){var p=document.createElement("div");p.innerHTML=e.template,e.template=p;var c=d.selectedItems.userHandles.filter(function(g){return g.name===e.id.split("_shape")[0]&&g.template!==""});c[0].template=e.template}e.isTemplate&&e.template?d instanceof Xe?s.appendChild(e.template):s.appendChild(e.template.cloneNode(!0)):e.template&&s.appendChild(e.template.cloneNode(!0))}a!==void 0&&t.childNodes.length>a&&t.insertBefore(s,t.childNodes[parseInt(a.toString(),10)]),o.appendChild(s),t.appendChild(o)}var u=se(e).topLeft;s.style.height=e.actualSize.height+"px",s.style.width=e.actualSize.width+"px",s.style.left=u.x+"px",s.style.top=u.y+"px",s.style.position="absolute",s.style.transform="rotate("+(e.rotateAngle+e.parentTransform)+"deg)",s.style.pointerEvents=r?"all":"none",s.style.visibility=e.visible?"visible":"hidden",s.style.opacity=e.style.opacity.toString()},n.prototype.drawNativeContent=function(e,t,i,r,a){var s,o;if(a&&(s=a.getElementById(e.id+"_native_element"),o=a.getElementById(e.id+"_clip")),!s){s=document.createElementNS("http://www.w3.org/2000/svg","g"),s.setAttribute("id",e.id+"_native_element"),s.appendChild(e.template.cloneNode(!0));var h=this.createGElement("g",{id:e.id+"_inner_native_element"});h.appendChild(s),t.appendChild(h)}o&&s.removeChild(o),s.style.visibility=e.visible?"visible":"hidden",s.style.opacity=e.style.opacity?e.style.opacity.toString():"1",this.setNativTransform(e,s,i,r),e.scale==="Slice"&&this.drawClipPath(e,s,i,r,a),Et(s,e.description?{role:"img","aria-label":e.description}:{})},n.prototype.setNativTransform=function(e,t,i,r){var a=e.contentSize.width!==0?e.contentSize.width:1,s=e.contentSize.height!==0?e.contentSize.height:1,o=e.templatePosition.x*r/a,h=e.templatePosition.y*i/s;t.setAttribute("transform","rotate("+e.parentTransform+","+e.offsetX+","+e.offsetY+") translate("+(e.offsetX-o-r*e.pivot.x)+","+(e.offsetY-h-i*e.pivot.y)+") scale("+r/a+","+i/s+")")},n.prototype.drawClipPath=function(e,t,i,r,a){var s=e.contentSize.width,o=e.contentSize.height,h=e.width/(r/s),l=e.height/(i/o),d=e.templatePosition.x+(e.width>=e.height?0:(s-h)/2),f=e.templatePosition.y+(e.height>=e.width?0:(o-l)/2),p=a.getElementById(e.id+"_clip");p=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),p.setAttribute("id",e.id+"_clip"),t.appendChild(p);var c=a.getElementById(e.id+"_clip_rect");c=document.createElementNS("http://www.w3.org/2000/svg","rect"),p.appendChild(c);var u={id:e.id+"_clip_rect",width:h.toString(),height:l.toString(),x:d.toString(),y:f.toString()};return Et(c,u),mo()?t.setAttribute("clip-path","url("+location.protocol+"//"+location.host+location.pathname+"#"+e.id+"_clip)"):t.setAttribute("clip-path","url(#"+e.id+"_clip)"),t},n.prototype.renderGradient=function(e,t,i){var r,a,s,o=gh(i),h=o.getElementById(i+"gradient_pattern");h||(h=Nt("defs",{id:i+"gradient_pattern"}),o.insertBefore(h,o.firstChild));var l,d;if(ff(t.id),e.gradient.type!=="None"){for(var f=0;f<e.gradient.stops.length;f++)r=r?Math.max(r,e.gradient.stops[parseInt(f.toString(),10)].offset):e.gradient.stops[parseInt(f.toString(),10)].offset,a=a?Math.min(a,e.gradient.stops[parseInt(f.toString(),10)].offset):e.gradient.stops[parseInt(f.toString(),10)].offset;e.gradient.type==="Linear"?(d=e.gradient,d.id=t.id+"_linear",s=this.createLinearGradient(d),h.appendChild(s)):(l=e.gradient,l.id=t.id+"_radial",s=this.createRadialGradient(l),h.appendChild(s));for(var f=0;f<e.gradient.stops.length;f++){var p=e.gradient.stops[parseInt(f.toString(),10)],c=a<0?(r+p.offset)/(2*r):p.offset/r,u=document.createElementNS("http://www.w3.org/2000/svg","stop");Et(u,{offset:c.toString(),style:"stop-color:"+p.color}),s.appendChild(u)}}return s},n.prototype.createLinearGradient=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),i={id:e.id,x1:e.x1+"%",y1:e.y1+"%",x2:e.x2+"%",y2:e.y2+"%"};return Et(t,i),t},n.prototype.createRadialGradient=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","radialGradient"),i={id:e.id,cx:e.cx+"%",cy:e.cy+"%",r:e.r+"%",fx:e.fx+"%",fy:e.fy+"%"};return Et(t,i),t},n.prototype.setSvgStyle=function(e,t,i){if(t.canApplyStyle||t.canApplyStyle===void 0){t.fill==="none"&&(t.fill="transparent"),t.stroke==="none"&&(t.stroke="transparent");var r=[],a=void 0;if(t.dashArray){var s=new nr;r=s.parseDashArray(t.dashArray)}if(t.gradient&&t.gradient.type!=="None"&&i){var o=this.renderGradient(t,e,i);mo()?a="url("+location.protocol+"//"+location.host+location.pathname+"#"+o.id+")":a="url(#"+o.id+")"}else a=t.fill;t.stroke&&e.setAttribute("stroke",t.stroke),t.strokeWidth!==void 0&&t.strokeWidth!==null&&e.setAttribute("stroke-width",t.strokeWidth.toString()),r&&e.setAttribute("stroke-dasharray",r.toString()||"none"),a&&e.setAttribute("fill",a)}},n.prototype.svgLabelAlign=function(e,t,i){var r=new U(t.width,i.length*(e.fontSize*1.2)),a={x:0,y:0},s=0,o=1.2,h=e.width*.5,l=e.height*.5,d=h,f=l;return e.textAlign==="left"||e.textAlign==="justify"?d=0:e.textAlign==="center"?t.width>e.width&&(e.textOverflow==="Ellipsis"||e.textOverflow==="Clip")&&e.textWrapping==="NoWrap"?d=0:d=e.width*.5:e.textAlign==="right"&&(d=e.width*1),a.x=s+d+(t?t.x:0),a.y=o+f-r.height/2,a},n})(),on=(function(){function n(e,t,i){this.renderer=null,this.isSvgMode=!0,this.touchMove=void 0,this.transform={x:0,y:0},this.diagramId=e,this.element=St(this.diagramId),this.svgRenderer=t,this.isSvgMode=i,this.renderer=i?new ln:new nr}return n.prototype.setCursor=function(e,t){e.style.cursor=t},n.prototype.setLayers=function(){this.iconSvgLayer=this.element.getElementsByClassName("e-ports-expand-layer")[0],this.adornerSvgLayer=this.element.getElementsByClassName("e-adorner-layer")[0],this.nativeSvgLayer=this.element.getElementsByClassName("e-native-layer")[0],this.diagramSvgLayer=this.element.getElementsByClassName("e-diagram-layer")[0]},n.prototype.getAdornerLayer=function(){var e=yo(this.diagramId);return e},n.prototype.getParentSvg=function(e,t,i){return this.diagramId&&e&&e.id?e.id.split("_icon_content").length>1||e.id.split("_nodeport").length>1||e.elementActions&le.ElementIsPort?this.iconSvgLayer:t&&t==="selector"?this.adornerSvgLayer:e instanceof li?this.nativeSvgLayer:this.diagramSvgLayer:i},n.prototype.getParentElement=function(e,t,i,r){var a=t;if(i&&this.diagramId&&e&&e.id){e.id.split("_icon_content").length>1?(a=i.getElementById(this.diagramId+"_diagramExpander"),t=null):e.id.split("_nodeport").length>1?a=i.getElementById(this.diagramId+"_diagramPorts"):e instanceof li?(a=i.getElementById(this.diagramId+"_nativeLayer"),t=null):e.elementActions&le.ElementIsPort?(a=i.getElementById(this.diagramId+"_diagramPorts"),t=null):a=i.getElementById(this.diagramId+"_diagramLayer");var s=this.getGroupElement(e,t||a,r);a=s.g,s.svg&&(i=s.svg)}return{g:a,svg:i}},n.prototype.getGroupElement=function(e,t,i){var r,a=this.getParentSvg(e),s;if(t&&a){if(a&&(r=a.getElementById(e.id+"_groupElement"),!r&&a!==this.nativeSvgLayer)){var o=this.nativeSvgLayer;r=o.getElementById(e.id+"_groupElement"),s=o}r||(r=this.svgRenderer.createGElement("g",{id:e.id+"_groupElement"}),i!==void 0&&t.childNodes.length>i?t.insertBefore(r,t.childNodes[parseInt(i.toString(),10)]):t.appendChild(r))}return{g:r,svg:s}},n.prototype.renderElement=function(e,t,i,r,a,s,o,h,l,d,f){e instanceof Je?(e.id=e.id?e.id:K(),this.renderContainer(e,t,i,r,a,s,o,h,l,d,f)):e instanceof wr?this.renderImageElement(e,t,r,a,o):e instanceof Pt?this.renderPathElement(e,t,r,a,o,l,f):e instanceof Tt?this.renderTextElement(e,t,r,a,o,d):e instanceof li?this.renderNativeElement(e,t,r,a,o):e instanceof we?this.renderHTMLElement(e,t,i,r,a,o,h):this.renderRect(e,t,r,a,l)},n.prototype.drawSelectionRectangle=function(e,t,i,r,a,s){e=(e+s.tx)*s.scale,t=(t+s.ty)*s.scale;var o={width:i*s.scale,height:r*s.scale,x:e+.5,y:t+.5,fill:"transparent",stroke:"gray",angle:0,pivotX:.5,pivotY:.5,strokeWidth:1,dashArray:"6 3",opacity:1,visible:!0,id:a.id+"_selected_region"},h=this.getAdornerLayer();this.svgRenderer.updateSelectionRegion(h,o)},n.prototype.renderHighlighter=function(e,t,i){var r=e.actualSize.width||2,a=e.actualSize.height||2,s=e.offsetX-r*e.pivot.x,o=e.offsetY-a*e.pivot.y;s=(s+i.tx)*i.scale,o=(o+i.ty)*i.scale;var h={width:r*i.scale,height:a*i.scale,x:s,y:o,fill:"transparent",stroke:"#8CC63F",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:4,dashArray:"",opacity:1,cornerRadius:0,visible:!0,id:t.id+"_highlighter",class:"e-diagram-highlighter"};this.svgRenderer.drawRectangle(t,h,this.diagramId,void 0,void 0,t)},n.prototype.renderSelectionRectangle=function(e,t,i,r){var a=e.actualSize.width||2,s=e.actualSize.height||2,o=e.offsetX-a*e.pivot.x,h=e.offsetY-s*e.pivot.y;o=(o+i.tx)*i.scale,h=(h+i.ty)*i.scale;var l={width:a*i.scale,height:s*i.scale,x:o,y:h,fill:"transparent",stroke:"#00cc00",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:r?2:1,dashArray:"",opacity:1,cornerRadius:0,visible:!0,id:e.id+"_highlighter",class:r?"e-diagram-first-selection-indicator e-diagram-selection-indicator":"e-diagram-selection-indicator"},d=this.getParentSvg(e,"selector");this.svgRenderer.drawRectangle(t,l,this.diagramId,void 0,void 0,d)},n.prototype.renderSelectionLine=function(e,t,i,r){var a=this.getBaseAttributes(e,i);a.data=e.absolutePath,a.id=a.id+"_highlighter";var s=e.description?e.description:e.id;this.isSvgMode||(a.x=e.flipOffset.x?e.flipOffset.x:a.x,a.y=e.flipOffset.y?e.flipOffset.y:a.y),i&&(a.x=a.x*i.scale,a.y=a.y*i.scale),a.stroke="#00cc00",a.strokeWidth=r?2:1,a.class=r?"e-diagram-first-selection-indicator e-diagram-selection-indicator":"e-diagram-selection-indicator";var o=this.getParentSvg(e,"selector");this.svgRenderer.drawPath(t,a,this.diagramId,void 0,o,s,i.scale)},n.prototype.renderStackHighlighter=function(e,t,i,r,a,s,o){var h=e.actualSize.width||2,l=e.offsetX-h*e.pivot.x,d=e.actualSize.height||2,f=e.offsetY-d*e.pivot.y;l=(l+i.tx)*i.scale;var p,c=e.bounds,u="";if(f=(f+i.ty)*i.scale,r)if(s){var g=h*i.scale;p="M 0 0 L "+(g+2)+" 0 Z";var v=-c.x,m=-c.y,y=[];v=e.actualSize.width/Number(c.width?c.width:1)*i.scale,m=e.actualSize.height/Number(c.height?c.height:1)*i.scale;var S="M7,4 L8,4 8,7 11,7 11,8 8,8 8,11 7,11 7,8 4,8 4,7 7,7 z M7.5,0.99999994C3.9160004,1 1,3.9160004 0.99999994,7.5 1,11.084 3.9160004,14 7.5,14 11.084,14 14,11.084 14,7.5 14,3.9160004 11.084,1 7.5,0.99999994 z M7.5,0 C11.636002,0 15,3.3639984 15,7.5 15,11.636002 11.636002,15 7.5,15 3.3640003,15 0,11.636002 0,7.5 0,3.3639984 3.3640003,0 7.5,0 z";y=Hr(S),y=La(y),u=Da(y,v+g+2,m-8,!1,c.x,c.y,0,0),a.y>=e.offsetY&&(f+=d)}else{o&&a.y>=e.offsetY&&(f+=d*i.scale);var g=h*i.scale;p="M -10 -10 L 0 0 Z M -10 10 L 0 0 Z M 0 0 L "+g+" 0 Z M "+g+" 0 L "+(g+10)+" 10 Z L "+(g+10)+" -10 Z"}else{var g=d*i.scale;p="M 10 -10 L 0 0 Z M -10 -10 L 0 0 Z M 0 0 L 0 "+g+" Z M 0  "+g+" L -10  "+(g+10)+" Z L 10  "+(g+10)+" Z",a.x>=e.offsetX&&(l+=h*i.scale)}var x={data:p+u,width:h*i.scale,height:d*i.scale,x:l,y:f,fill:"transparent",stroke:"#8CC63F",angle:e.rotateAngle,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:1,dashArray:"",opacity:1,visible:!0,id:t.id+"_stack_highlighter",class:"e-diagram-highlighter"};this.svgRenderer.drawPath(t,x,this.diagramId)},n.prototype.drawLine=function(e,t){this.svgRenderer.drawLine(e,t)},n.prototype.drawPath=function(e,t){this.svgRenderer.drawPath(e,t,this.diagramId)},n.prototype.renderResizeHandle=function(e,t,i,r,a,s,o,h,l,d,f){var p=e.offsetX-e.actualSize.width*e.pivot.x,c=e.offsetY-e.actualSize.height*e.pivot.y,u=e.actualSize.height,g=e.actualSize.width;if(!d&&i&gt.Rotate&&Za(this.rendererActions)&&!qh(this.rendererActions))this.renderPivotLine(e,t,s,a,o),this.renderRotateThumb(e,t,s,a,o);else if(this.touchMove){var v=document.getElementById("rotateThumb");v&&v.setAttribute("visibility","hidden")}this.renderBorder(e,t,s,h,l,d);var m=e.actualSize.width*r,y=e.actualSize.height*r;!l&&Za(this.rendererActions)&&!qh(this.rendererActions)&&(e.isTextAnnotation||(m>=40&&y>=40&&(a&Ae.ResizeNorthWest&&this.renderCircularHandle("resizeNorthWest",e,p,c,t,Kt(a,"ResizeNorthWest"),i&gt.ResizeNorthWest,s,void 0,o,{"aria-label":"Thumb to resize the selected object on top left side direction"},void 0,"e-diagram-resize-handle e-northwest",f),a&Ae.ResizeNorthEast&&this.renderCircularHandle("resizeNorthEast",e,p+g,c,t,Kt(a,"ResizeNorthEast"),i&gt.ResizeNorthEast,s,void 0,o,{"aria-label":"Thumb to resize the selected object on top right side direction"},void 0,"e-diagram-resize-handle e-northeast",f),a&Ae.ResizeSouthWest&&this.renderCircularHandle("resizeSouthWest",e,p,c+u,t,Kt(a,"ResizeSouthWest"),i&gt.ResizeSouthWest,s,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom left side direction"},void 0,"e-diagram-resize-handle e-southwest",f),a&Ae.ResizeSouthEast&&this.renderCircularHandle("resizeSouthEast",e,p+g,c+u,t,Kt(a,"ResizeSouthEast"),i&gt.ResizeSouthEast,s,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom right side direction"},void 0,"e-diagram-resize-handle e-southeast",f)),a&Ae.ResizeNorth&&this.renderCircularHandle("resizeNorth",e,p+g/2,c,t,Kt(a,"ResizeNorth"),i&gt.ResizeNorth,s,void 0,o,{"aria-label":"Thumb to resize the selected object on top side direction"},void 0,"e-diagram-resize-handle e-north",f),a&Ae.ResizeSouth&&this.renderCircularHandle("resizeSouth",e,p+g/2,c+u,t,Kt(a,"ResizeSouth"),i&gt.ResizeSouth,s,void 0,o,{"aria-label":"Thumb to resize the selected object on bottom side direction"},void 0,"e-diagram-resize-handle e-south",f),a&Ae.ResizeWest&&this.renderCircularHandle("resizeWest",e,p,c+u/2,t,Kt(a,"ResizeWest"),i&gt.ResizeWest,s,void 0,o,{"aria-label":"Thumb to resize the selected object on left side direction"},void 0,"e-diagram-resize-handle e-west",f),a&Ae.ResizeEast&&this.renderCircularHandle("resizeEast",e,p+g,c+u/2,t,Kt(a,"ResizeEast"),i&gt.ResizeEast,s,void 0,o,{"aria-label":"Thumb to resize the selected object on right side direction"},void 0,"e-diagram-resize-handle e-east",f)));var S=document.getElementById(this.diagramId+"_SelectorElement");if(e.flippedPoint&&S){var x=document.getElementById(e.id+"_groupElement"),I=x.getAttribute("transform");if(I.includes("scale")){var C=e.flippedPoint.x-e.corners.topLeft.x,P=e.flippedPoint.y-e.corners.topLeft.y;I="translate("+C+","+P+")"}I&&S.setAttribute("transform",I)}else S&&S.setAttribute("transform","")},n.prototype.renderEndPointHandle=function(e,t,i,r,a,s,o,h,l,d){var f=e.sourcePoint,p=e.targetPoint,c=e.wrapper,u,g;if(this.renderCircularHandle("connectorSourceThumb",c,f.x,f.y,t,Kt(r,"ConnectorSourceThumb"),i&gt.ConnectorSource,a,s,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-endpoint-handle e-sourceend",d),this.renderCircularHandle("connectorTargetThumb",c,p.x,p.y,t,Kt(r,"ConnectorTargetThumb"),i&gt.ConnectorTarget,a,o,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-endpoint-handle e-targetend",d),h)if(e.type==="Straight"&&e.segments.length>0)for(u=0;u<e.segments.length-1;u++){g=e.segments[parseInt(u.toString(),10)];var v="e-diagram-straight-segment-handle";this.renderCircularHandle("segementThumb_"+(u+1),c,g.point.x,g.point.y,t,!0,i&gt.ConnectorSource,a,s,null,null,u,v,d)}else if(e.type==="Bezier"&&e.segments.length>0)for(u=0;u<e.segments.length-1;u++){g=e.segments[parseInt(u.toString(),10)];var v="e-diagram-bezier-segment-handle";this.renderBezierHandle("segementThumb_"+(u+1),c,g.point.x,g.point.y,t,!0,e,a,s,null,u,v,d)}else if(e.maxSegmentThumb){var y=e.segments.length<=e.maxSegmentThumb?0:1,S=e.segments.length<=e.maxSegmentThumb?e.segments.length:e.segments.length-1;for(e.maxSegmentThumb>=3&&e.segments.length===3&&(y=1,S=e.segments.length-1),y=e.segments.length>e.maxSegmentThumb+2?2:y,S=e.segments.length>e.maxSegmentThumb+2?e.segments.length-2:S,e.segments.length===1&&e.segments[0].points.length<=2&&(y=1,S=e.segments.length),u=y;u<S;u++){var m=e.segments[parseInt(u.toString(),10)];this.renderOrthogonalThumbs("orthoThumb_"+(u+1),c,m,t,Kt(r,"ConnectorSourceThumb"),a,e)}}else for(u=0;u<e.segments.length;u++){var m=e.segments[parseInt(u.toString(),10)];this.renderOrthogonalThumbs("orthoThumb_"+(u+1),c,m,t,Kt(r,"ConnectorSourceThumb"),a,e)}if(e.type==="Bezier"&&l){var x=e.segments.length-1,I=e.bezierSettings!=null?e.bezierSettings.controlPointsVisibility:null;for(u=0;u<=x;u++){var C=e.segments[parseInt(u.toString(),10)],P=b.isEmptyPoint(C.point1)?C.bezierPoint1:C.point1;(I!=null&&u===0&&yr(I,"Source")||u!==0&&yr(I,"Intermediate"))&&(this.renderCircularHandle("bezierPoint_"+(u+1)+"_1",c,P.x,P.y,t,Kt(r,"ConnectorSourceThumb"),i&gt.ConnectorSource,a,void 0,void 0,{"aria-label":"Thumb to move the source point of the connector"},void 0,"e-diagram-bezier-control-handle e-source",d),Kt(r,"ConnectorSourceThumb")&&this.renderBezierLine("bezierLine_"+(u+1)+"_1",c,t,C.points[0],b.isEmptyPoint(C.point1)?C.bezierPoint1:C.point1,a)),P=b.isEmptyPoint(C.point2)?C.bezierPoint2:C.point2,(I!=null&&u===x&&yr(I,"Target")||u!==x&&yr(I,"Intermediate"))&&(this.renderCircularHandle("bezierPoint_"+(u+1)+"_2",c,P.x,P.y,t,Kt(r,"ConnectorTargetThumb"),i&gt.ConnectorTarget,a,void 0,void 0,{"aria-label":"Thumb to move the target point of the connector"},void 0,"e-diagram-bezier-control-handle e-target",d),Kt(r,"ConnectorTargetThumb")&&this.renderBezierLine("bezierLine_"+(u+1)+"_2",c,t,C.points[1],b.isEmptyPoint(C.point2)?C.bezierPoint2:C.point2,a))}}},n.prototype.renderOrthogonalThumbs=function(e,t,i,r,a,s,o){var h,l,d,f=0,p;if(o.maxSegmentThumb){var c=i.points.length<3?0:1,u=i.points.length<3?i.points.length-1:i.points.length-2;for(c=o.segments.length===1?c:0,u=o.segments.length===1?u:i.points.length-1,f=c;f<u;f++)d=b.distancePoints(i.points[parseInt(f.toString(),10)],i.points[f+1]),h=i.points[parseInt(f.toString(),10)].y.toFixed(2)===i.points[f+1].y.toFixed(2)?"horizontal":"vertical",l=!!(d>=50&&i.allowDrag),this.renderOrthogonalThumb(e+"_"+(f+1),t,(i.points[parseInt(f.toString(),10)].x+i.points[f+1].x)/2,(i.points[parseInt(f.toString(),10)].y+i.points[f+1].y)/2,r,l,h,s,o,p)}else for(f=0;f<i.points.length-1;f++)d=b.distancePoints(i.points[parseInt(f.toString(),10)],i.points[f+1]),h=i.points[parseInt(f.toString(),10)].y.toFixed(2)===i.points[f+1].y.toFixed(2)?"horizontal":"vertical",p=b.direction(i.points[parseInt(f.toString(),10)],i.points[f+1]),l=!!(d>=50&&i.allowDrag),this.renderOrthogonalThumb(e+"_"+(f+1),t,(i.points[parseInt(f.toString(),10)].x+i.points[f+1].x)/2,(i.points[parseInt(f.toString(),10)].y+i.points[f+1].y)/2,r,l,h,s,o,p)},n.prototype.renderOrthogonalThumb=function(e,t,i,r,a,s,o,h,l,d){var f,p=0,c=document.getElementById(this.diagramId),u="ej2_instances",g;c&&(g=c[""+u][0]);var v=l.constraints&yt.InheritSegmentThumbShape,m=v?g.segmentThumbShape:l.segmentThumbShape,y=l.constraints&yt.InheritSegmentThumbSize,S=y?g.segmentThumbSize:l.segmentThumbSize;if(o==="horizontal"?f=tv(m):f=Wh(m),m==="Arrow"||m==="DoubleArrow"||m==="OpenArrow")switch(d){case"Bottom":case"Right":p=180;break;default:p=0}else if(m==="Fletch"||m==="OpenFetch"||m==="IndentedArrow"||m==="OutdentedArrow")switch(d){case"Bottom":p=-90;break;case"Top":p=90;break;case"Right":p=180;break;default:p=0}var x={x:(i+h.tx)*h.scale-S/2,y:(r+h.ty)*h.scale-S/2,angle:p,fill:"#e2e2e2",stroke:"black",strokeWidth:1,dashArray:"",data:f,width:S,height:S,pivotX:.5,pivotY:.5,opacity:1,visible:s,id:e,class:"e-diagram-ortho-segment-handle"},I=nn(x.data),C=new U(x.width,x.height),P=new Pt;if(x.data=P.updatePath(x.data,I,C),this.touchMove){var A=document.getElementById(e);A?this.updateSegmentPosition(A,x):this.svgRenderer.drawPath(a,x,this.diagramId)}else this.svgRenderer.drawPath(a,x,this.diagramId)},n.prototype.renderPivotLine=function(e,t,i,r,a){var s=e,o="2,3",h=!!(r&Ae.Rotate);a&&(h=!1);var l=this.getBaseAttributes(s,i);l.fill="None",l.stroke="black",l.strokeWidth=1,l.dashArray=o,l.visible=h;var d=i.scale;l.x*=d,l.y*=d,l.width*=d,l.height*=d,l.id="pivotLine",l.class="e-diagram-pivot-line";var f={x:s.actualSize.width*s.pivot.x*d,y:-20},p={x:s.actualSize.width*s.pivot.x*d,y:0};l.startPoint=f,l.endPoint=p,this.svgRenderer.drawLine(t,l)},n.prototype.renderBezierLine=function(e,t,i,r,a,s){var o="3,3",h=this.getBaseAttributes(t,s);h.id=e,h.stroke="black",h.strokeWidth=1,h.dashArray=o,h.fill="None",h.class="e-diagram-bezier-control-line",h.x=0,h.y=0;var l=s.scale,d=(r.x+s.tx)*l,f=(r.y+s.ty)*l,p=(a.x+s.tx)*l,c=(a.y+s.ty)*l,u={x:d,y:f},g={x:p,y:c};h.startPoint=u,h.endPoint=g,this.svgRenderer.drawLine(i,h)},n.prototype.renderCircularHandle=function(e,t,i,r,a,s,o,h,l,d,f,p,c,u){var g=t,v={x:i,y:r};if(g.rotateAngle!==0||g.parentTransform!==0){var m=xt();Rt(m,g.rotateAngle+g.parentTransform,g.offsetX,g.offsetY),v=st(m,v)}var y=this.getBaseAttributes(g);if(y.stroke="black",y.strokeWidth=1,p!==void 0?(y.id="segmentEnd_"+p,y.fill="#e2e2e2"):y.fill=l?"#8CC63F":"white",y.cornerRadius=u/2,y.angle=t.rotateAngle,y.id=e,y.visible=s,y.class=c,y.width=u,y.height=u,y.x=(v.x+h.tx)*h.scale,y.y=(v.y+h.ty)*h.scale,y.x=y.x-y.width/2,y.y=y.y-y.height/2,l&&(y.class+=" e-connected"),d&&(y.visible=!1),this.touchMove){var S=document.getElementById(e);if(S)this.updateResizeHandle(S,y);else{var x=this.getParentSvg(t,"selector");this.svgRenderer.drawRectangle(a,y,this.diagramId,!0,!0,x,f,!0,o)}}else{var x=this.getParentSvg(t,"selector");this.svgRenderer.drawRectangle(a,y,this.diagramId,!0,!0,x,f,!0,o)}},n.prototype.updateResizeHandle=function(e,t){var i={id:t.id,x:t.x.toString(),y:t.y.toString(),width:t.width.toString(),height:t.height.toString(),visibility:t.visible?"visible":"hidden",transform:"rotate("+t.angle+","+(t.x+t.width/2)+","+(t.y+t.height/2)+")",rx:t.cornerRadius||0,ry:t.cornerRadius||0,opacity:t.opacity};Et(e,i)},n.prototype.renderBezierHandle=function(e,t,i,r,a,s,o,h,l,d,f,p,c){var u=document.getElementById(this.diagramId),g="ej2_instances",v;u&&(v=u[""+g][0]);var m=t,y={x:i,y:r};if(m.rotateAngle!==0||m.parentTransform!==0){var S=xt();Rt(S,m.rotateAngle+m.parentTransform,m.offsetX,m.offsetY),y=st(S,y)}var x=o.constraints&yt.InheritSegmentThumbShape,I=x?v.segmentThumbShape:o.segmentThumbShape,C=o.constraints&yt.InheritSegmentThumbSize,P=C?v.segmentThumbSize:o.segmentThumbSize,A=Wh(I),T=this.getBaseAttributes(m);T.stroke="black",T.strokeWidth=1,f!==void 0?(T.id="segmentEnd_"+f,T.fill="#e2e2e2"):T.fill=l?"#8CC63F":"white",T.angle=t.rotateAngle,T.id=e,T.visible=s,T.class=p,T.width=P,T.height=P,T.data=A,T.x=(y.x+h.tx)*h.scale,T.y=(y.y+h.ty)*h.scale,T.x=T.x-T.width/2,T.y=T.y-T.height/2,l&&(T.class+=" e-connected"),d&&(T.visible=!1);var z=nn(T.data),L=new U(T.width,T.height),R=new Pt;if(T.data=R.updatePath(T.data,z,L),this.touchMove){var O=document.getElementById(e);if(O)this.updateSegmentPosition(O,T);else{var N=this.getParentSvg(t,"selector");this.svgRenderer.drawPath(a,T,this.diagramId,!0,N)}}else{var N=this.getParentSvg(t,"selector");this.svgRenderer.drawPath(a,T,this.diagramId,!0,N)}},n.prototype.updateSegmentPosition=function(e,t){var i={id:t.id,transform:"rotate("+t.angle+","+(t.x+t.width*t.pivotX)+","+(t.y+t.height*t.pivotY)+")translate("+t.x+","+t.y+")",visibility:t.visible?"visible":"hidden",opacity:t.opacity};Et(e,i)},n.prototype.renderBorder=function(e,t,i,r,a,s){var o=e,h=this.getBaseAttributes(o,i);h.x*=i.scale,h.y*=i.scale,h.width*=i.scale,h.height*=i.scale,h.fill="transparent",h.stroke="#097F7F",h.strokeWidth=1.2,h.gradient=null,h.dashArray="6,3",h.class="e-diagram-selector",s&&(h.class+=" e-diagram-lane"),h.id="borderRect",h.id=this.rendererActions&fi.DrawSelectorBorder?"borderRect_symbol":"borderRect",r||(h.class+=" e-disabled"),a&&(h.class+=" e-thick-border"),h.cornerRadius=0;var l=this.getParentSvg(e,"selector");this.svgRenderer.drawRectangle(t,h,this.diagramId,void 0,!0,l)},n.prototype.renderUserHandler=function(e,t,i,r,a,s){for(var o=e.wrapper,h,l=0,d=e.userHandles;l<d.length;l++){var f=d[l];h=!0,(f.disableConnectors&&e.connectors.length>0||f.disableNodes&&e.nodes.length>0||a==="Drag"&&s)&&(h=!1);var p=document.getElementById(f.name+"_template_hiddenUserHandle");p&&(f.template=p.childNodes[0].cloneNode(!0));var c=eh(e,f,i);if(c.x=(c.x+i.tx)*i.scale,c.y=(c.y+i.ty)*i.scale,f.visible&&(f.visible=!!(e.constraints&Ae.UserHandle)),h)if(f.pathData){var u=f.pathData?f.pathData:f.content,g=this.getBaseAttributes(o);g.id=f.name+"_userhandle",g.fill=f.backgroundColor,g.stroke=f.borderColor,g.strokeWidth=f.borderWidth,g.centerX=c.x,g.centerY=c.y,g.radius=f.size*.5,g.class="e-diagram-userhandle-circle",g.angle=0,g.visible=f.visible,g.opacity=1,this.svgRenderer.drawCircle(t,g,1,{"aria-label":f.name+"user handle"});var v=5,m=[];m=Hr(u),m=La(m);var y=nn(u),S=(f.size-.45*f.size)/y.width,x=(f.size-.45*f.size)/y.height,I=Da(m,S,x,!0,y.x,y.y,0,0);y=nn(I);var C={x:c.x-y.width/2,y:c.y-y.height/2,angle:0,id:"",class:"e-diagram-userhandle-path",fill:f.pathColor,stroke:f.backgroundColor,strokeWidth:.5,dashArray:"",data:I,width:f.size-v,height:f.size-v,pivotX:0,pivotY:0,opacity:1,visible:f.visible};this.svgRenderer.drawPath(t,C,this.diagramId,void 0,void 0,{"aria-label":f.name+"user handle"})}else if(f.content){var P=new li(f.name,this.diagramId);P.content=f.content,P.offsetX=c.x,P.offsetY=c.y,P.id=f.name+"_shape",P.horizontalAlignment="Center",P.verticalAlignment="Center",P.visible=f.visible,P.setOffsetWithRespectToBounds(c.x,c.y,"Fraction"),P.relativeMode="Object",P.description=f.name||"User handle",P.measure(new U(f.size,f.size)),P.arrange(P.desiredSize),this.svgRenderer.drawNativeContent(P,t,f.size,f.size,this.adornerSvgLayer)}else if(f.source){var A=new wr,C=this.getBaseAttributes(A,i);C.width=f.size,C.height=f.size,C.x=c.x-f.size/2,C.y=c.y-f.size/2,C.sourceWidth=f.size,C.sourceHeight=f.size,C.alignment=A.imageAlign,C.source=f.source,C.scale=A.imageScale,C.visible=f.visible,C.description=f.name||"User handle",C.id=f.name+"_",this.renderer.drawImage(t,C,this.adornerSvgLayer,!1)}else{var T=new we(f.name,this.diagramId);T.offsetX=c.x,T.offsetY=c.y,T.id=f.name+"_shape",T.visible=f.visible,T.relativeMode="Object",T.template=f.template,T.measure(new U(f.size,f.size)),T.arrange(T.desiredSize),this.svgRenderer.drawHTMLContent(T,r,void 0,!0,void 0)}}},n.prototype.renderRotateThumb=function(e,t,i,r,a){new Pt;var s,o=new U;o.width=18,o.height=16;var h=e.offsetY-e.actualSize.height*e.pivot.y,l=e.offsetX-e.actualSize.width*e.pivot.x,d=!!(r&Ae.Rotate);a&&(d=!1);var f="M 16.856144362449648 10.238890446662904 L 18.000144362449646 3.437890446662903L 15.811144362449646 4.254890446662903 C 14.837144362449646 2.5608904466629028 13.329144362449647  1.2598904466629026 11.485144362449645 0.5588904466629026 C 9.375144362449646 - 0.24510955333709716 7.071144362449646  - 0.18010955333709716 5.010144362449646 0.7438904466629028 C 2.942144362449646 1.6678904466629028 1.365144362449646 3.341890446662903 0.558144362449646 5.452890446662903 C - 0.244855637550354 7.567890446662903 - 0.17985563755035394 9.866890446662904 0.7431443624496461 11.930890446662904 C 1.6681443624496461 13.994890446662904 3.343144362449646 15.575890446662903 5.457144362449647 16.380890446662903 C 6.426144362449647 16.7518904466629 7.450144362449647 16.9348904466629 8.470144362449647 16.9348904466629 C 9.815144362449647 16.9348904466629 11.155144362449647 16.6178904466629 12.367144362449647 15.986890446662901 L 11.351144362449647 14.024890446662901 C 9.767144362449647 14.8468904466629 7.906144362449647 14.953890446662902 6.237144362449647 14.3178904466629 C 4.677144362449647 13.7218904466629 3.444144362449647 12.5558904466629 2.758144362449647 11.028890446662901 C 2.078144362449646 9.501890446662903 2.031144362449646 7.802890446662903 2.622144362449646 6.243890446662903 C 3.216144362449646 4.6798904466629025 4.387144362449646 3.442890446662903 5.914144362449646 2.760890446662903 C 7.437144362449646 2.078890446662903 9.137144362449646 2.0298904466629026 10.700144362449645 2.6258904466629027 C 11.946144362449646 3.100890446662903 12.971144362449646 3.9538904466629026 13.686144362449646 5.049890446662903 L 11.540144362449645 5.850890446662903 L 16.856144362449648 10.238890446662904 Z",p=l+e.pivot.x*e.actualSize.width,c=h;if(p=(p+i.tx)*i.scale,c=(c+i.ty)*i.scale,s={x:p-o.width*.5,y:c-30-o.height*.5},e.rotateAngle!==0||e.parentTransform!==0){var u=xt();Rt(u,e.rotateAngle+e.parentTransform,(i.tx+e.offsetX)*i.scale,(i.ty+e.offsetY)*i.scale),s=st(u,s)}var g={x:s.x,y:s.y,angle:e.rotateAngle+e.parentTransform,fill:"#231f20",stroke:"black",strokeWidth:.5,dashArray:"",data:f,width:20,height:20,pivotX:0,pivotY:0,opacity:1,visible:d,id:e.id,class:"e-diagram-rotate-handle"};if(g.id="rotateThumb",this.touchMove){var v=document.getElementById("rotateThumb");v?this.updateSegmentPosition(v,g):this.svgRenderer.drawPath(t,g,this.diagramId,!0,void 0,{"aria-label":"Thumb to rotate the selected object"})}else this.svgRenderer.drawPath(t,g,this.diagramId,!0,void 0,{"aria-label":"Thumb to rotate the selected object"})},n.prototype.renderPathElement=function(e,t,i,r,a,s,o){var h=this.getBaseAttributes(e,i,s);if(h.data=e.absolutePath,h.data=e.absolutePath,e.isPathPort&&o){h.x=o[e.id]?o[e.id].cx:h.x,h.y=o[e.id]?o[e.id].cy:h.y,e.bounds.x=h.x,e.bounds.y=h.y;var l=document.getElementById(this.diagramId),d="ej2_instances",f=void 0;l&&(f=l[""+d][0],f.eventHandler.currentAction!=="PortDrag"&&(e.offsetX=h.x+e.width/2,e.offsetY=h.y+e.height/2))}var p=e.description?e.description:e.id;if(e.isExport){var c=e.absoluteBounds,u=Hr(h.data),g=this.findAndStoreArcValues(u);h.arc=g,h.data=bf(e,c,void 0,h)}this.renderer.drawPath(t,h,this.diagramId,void 0,r,p,void 0,this,e)},n.prototype.findAndStoreArcValues=function(e){var t=[];return e.forEach(function(i){if(i.command==="A"){var r={r1:i.r1/2,r2:i.r2/2};t.push(r)}}),t},n.prototype.renderSvgGridlines=function(e,t,i,r,a,s){var o=document.createElementNS("http://www.w3.org/2000/svg","pattern"),h=document.createElementNS("http://www.w3.org/2000/svg","defs");h.setAttribute("id",this.diagramId+"_grid_pattern_defn"),(e.constraints&pi.ShowHorizontalLines||e.constraints&pi.ShowVerticalLines)&&o.setAttribute("id",this.diagramId+"_pattern");var l=0,d=0,f=0,p=0,c=1,u=!1,g=e.gridType==="Lines",v=g?e.verticalGridlines.lineIntervals:e.verticalGridlines.dotIntervals,m=g?e.horizontalGridlines.lineIntervals:e.horizontalGridlines.dotIntervals;if(r.showRulers&&r.dynamicGrid&&a&&s)f=s.updateSegmentWidth(i.scale),p=a.updateSegmentWidth(i.scale),e.horizontalGridlines.scaledIntervals=[f/a.interval],e.verticalGridlines.scaledIntervals=[p/s.interval],u=!0;else{for(var y=0;y<v.length;y=y+1)l+=v[parseInt(y.toString(),10)];for(var y=0;y<m.length;y=y+1)d+=m[parseInt(y.toString(),10)];c=this.scaleSnapInterval(e,i.scale)}l=u?p:l*c,d=u?f:d*c;var S={id:this.diagramId+"_pattern",x:0,y:0,width:l,height:d,patternUnits:"userSpaceOnUse"};Et(o,S),this.horizontalSvgGridlines(o,l,d,c,e,r,s,u,g,m),this.verticalSvgGridlines(o,l,d,c,e,r,a,u,g,v),h.appendChild(o),t.appendChild(h)},n.prototype.horizontalSvgGridlines=function(e,t,i,r,a,s,o,h,l,d){var f=0,p=[],c;if(a.constraints&pi.ShowHorizontalLines){a.horizontalGridlines.lineDashArray&&(p=this.renderer.parseDashArray(a.horizontalGridlines.lineDashArray)),s.showRulers&&s.dynamicGrid&&o&&(d=this.updateLineIntervals(d,s,o,i,l)),d=Gs(d,l);for(var u=0;u<d.length;u=u+2){f=fl(d,l,u,f);var g=0;c=document.createElementNS("http://www.w3.org/2000/svg",l?"path":"circle");var v=void 0,m=l?f+d[parseInt(u.toString(),10)]/2:f;m=h?m:m*r,l?(p.toString()===""?v={"stroke-width":d[parseInt(u.toString(),10)],d:"M0,"+m+" L"+t+","+m+" Z",class:d[parseInt(u.toString(),10)]===1.25?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:a.horizontalGridlines.lineColor}:v={"stroke-width":d[parseInt(u.toString(),10)],stroke:a.horizontalGridlines.lineColor,d:"M0,"+m+" L"+t+","+m+" Z",class:d[parseInt(u.toString(),10)]===1.25?"e-diagram-thick-grid":"e-diagram-thin-grid",dashArray:p.toString()},Et(c,v),e.appendChild(c),f+=d[u+1]+d[parseInt(u.toString(),10)]):(this.renderDotGrid(u,e,a,g,m,r,!0),f+=d[parseInt(u.toString(),10)])}}},n.prototype.renderDotGrid=function(e,t,i,r,a,s,o){var h=o?i.verticalGridlines.dotIntervals:i.horizontalGridlines.dotIntervals;h=Gs(h,!1);for(var l,d,f,p,c=1;c<h.length;c=c+2)l=c===h.length-1?h[0]:h[c-1],d=document.createElementNS("http://www.w3.org/2000/svg","circle"),f=r,f=f*s,p={cx:o?f:a,cy:o?a:f,fill:i.horizontalGridlines.lineColor,r:l},Et(d,p),t.appendChild(d),r+=h[parseInt(c.toString(),10)]+h[c-1]},n.prototype.verticalSvgGridlines=function(e,t,i,r,a,s,o,h,l,d){var f=0,p=[],c;if(a.constraints&pi.ShowVerticalLines){a.verticalGridlines.lineDashArray&&(p=this.renderer.parseDashArray(a.verticalGridlines.lineDashArray)),s.showRulers&&s.dynamicGrid&&o&&(d=this.updateLineIntervals(d,s,o,t,l));var u=0;d=Gs(d,l);for(var g=0;g<d.length;g=g+2){f=fl(d,l,g,f);var v=l?f+d[parseInt(g.toString(),10)]/2:f;v=h?v:v*r,c=document.createElementNS("http://www.w3.org/2000/svg",l?"path":"circle");var m=void 0;l?(p.toString()===""?m={"stroke-width":d[parseInt(g.toString(),10)],d:"M"+v+",0 L"+v+","+i+" Z",class:d[parseInt(g.toString(),10)]===1.25?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:a.verticalGridlines.lineColor}:m={"stroke-width":d[parseInt(g.toString(),10)],class:d[parseInt(g.toString(),10)]===1.25?"e-diagram-thick-grid":"e-diagram-thin-grid",stroke:a.verticalGridlines.lineColor,d:"M"+v+",0 L"+v+","+i+" Z",dashArray:p.toString()},Et(c,m),e.appendChild(c),f+=d[g+1]+d[parseInt(g.toString(),10)]):(this.renderDotGrid(g,e,a,u,v,r,!1),f+=d[parseInt(g.toString(),10)])}}},n.prototype.updateGrid=function(e,t,i,r,a,s){var o=t.getElementById(this.diagramId+"_grid_rect"),h=!1;if(o){var l=t.getElementById(this.diagramId+"_pattern");l&&l.parentNode.removeChild(l);var d=0,f=0,p=1,c=e.gridType==="Lines",u=c?e.verticalGridlines.lineIntervals:e.verticalGridlines.dotIntervals,g=c?e.horizontalGridlines.lineIntervals:e.horizontalGridlines.dotIntervals;r.showRulers&&r.dynamicGrid&&s&&a?(d=s.updateSegmentWidth(i.scale),f=a.updateSegmentWidth(i.scale),h=!0,e.horizontalGridlines.scaledIntervals=[d/a.interval],e.verticalGridlines.scaledIntervals=[f/s.interval]):p=this.scaleSnapInterval(e,i.scale);for(var v=0,m=0;m<g.length;m=m+1)v+=g[parseInt(m.toString(),10)];for(var y=0,m=0;m<u.length;m=m+1)y+=u[parseInt(m.toString(),10)];var S={x:-i.tx*i.scale,y:-i.ty*i.scale};Et(o,S),y=h?f:y*p,v=h?d:v*p,S={id:this.diagramId+"_pattern",x:0,y:0,width:y,height:v,patternUnits:"userSpaceOnUse"},l=document.createElementNS("http://www.w3.org/2000/svg","pattern"),Et(l,S),this.horizontalSvgGridlines(l,y,v,p,e,r,s,h,c,g),this.verticalSvgGridlines(l,y,v,p,e,r,a,h,c,u);var x=t.getElementById(this.diagramId+"_grid_pattern_defn");x&&x.appendChild(l)}},n.prototype.updateLineIntervals=function(e,t,i,r,a){for(var s=[],o=r/i.interval,h=a?i.interval:i.interval+1,l=0;l<h*2;l++)l%2===0?s[parseInt(l.toString(),10)]=a?l===0?1.25:.25:0:s[parseInt(l.toString(),10)]=a?o-s[l-1]:o;return s},n.prototype.scaleSnapInterval=function(e,t){if(t>=2)for(;t>=2;)t/=2;else if(t<=.5)for(;t<=.5;)t*=2;var i;if(e.horizontalGridlines.scaledIntervals=e.horizontalGridlines.snapIntervals,e.verticalGridlines.scaledIntervals=e.verticalGridlines.snapIntervals,t!==1){var r=e.horizontalGridlines;for(r.scaledIntervals=[],i=0;i<r.snapIntervals.length;i++)r.scaledIntervals[parseInt(i.toString(),10)]=r.snapIntervals[parseInt(i.toString(),10)]*t;for(r=e.verticalGridlines,r.scaledIntervals=[],i=0;i<r.snapIntervals.length;i++)r.scaledIntervals[parseInt(i.toString(),10)]=r.snapIntervals[parseInt(i.toString(),10)]*t}return t},n.prototype.renderTextElement=function(e,t,i,r,a,s){var o=this.getBaseAttributes(e,i);s&&(o.x=s[e.id]?s[e.id].cx:o.x,o.y=s[e.id]?s[e.id].cy:o.y,e.bounds.x=o.x,e.bounds.y=o.y,e.isExport&&(o.x=o.x*Math.min(e.exportScaleValue.x||e.exportScaleValue.y),o.y=o.y*Math.min(e.exportScaleValue.x||e.exportScaleValue.y))),o.cornerRadius=0,o.whiteSpace=Do(e.style.whiteSpace,e.style.textWrapping),o.content=e.content,o.breakWord=hs(e.style.textWrapping),o.textAlign=rd(e.style.textAlign),o.color=e.style.color,o.italic=e.style.italic,o.bold=e.style.bold,o.fontSize=e.style.fontSize,o.fontFamily=e.style.fontFamily,o.textOverflow=e.style.textOverflow,o.textWrapping=e.style.textWrapping,o.textDecoration=e.style.textDecoration,o.doWrap=e.doWrap,o.wrapBounds=e.wrapBounds,o.childNodes=e.childNodes,o.isHorizontalLane=e.isLaneOrientation,o.id=e.id?e.id:K(),e.isLaneOrientation&&(o.parentOffsetX=this.groupElement.offsetX,o.parentOffsetY=this.groupElement.offsetY,o.parentWidth=this.groupElement.actualSize.width,o.parentHeight=this.groupElement.actualSize.height),o.dashArray="",o.strokeWidth=0,o.fill=e.style.fill;var h=e.description?e.description:e.content?e.content:e.id;(e.style.textWrapping==="Wrap"||e.style.textWrapping==="WrapWithOverflow")&&this.groupElement&&o.height>this.groupElement.actualSize.height&&(e.style.textOverflow==="Clip"||e.style.textOverflow==="Ellipsis")&&(o.y=o.y+(o.height-this.groupElement.actualSize.height)/2),this.renderer.drawRectangle(t,o,this.diagramId,void 0,void 0,r,void 0,void 0,void 0,this,e),this.renderer.drawText(t,o,r,h,this.diagramId,e.isExport&&Math.min(e.exportScaleValue.x||e.exportScaleValue.y),this,e),this.isSvgMode&&(e.doWrap=!1)},n.prototype.renderNativeElement=function(e,t,i,r,a){var s,o,h=this.getParentSvg(e,void 0,t)||r,l=this.getParentElement(e,t,h).g||t,d=this.getBaseAttributes(e,i);switch(d.fill="transparent",d.cornerRadius=e.cornerRadius,d.stroke="transparent",this.renderer.drawRectangle(t,d,this.diagramId,void 0,void 0,r),e.scale){case"None":s=e.contentSize.width,o=e.contentSize.height;break;case"Stretch":s=e.actualSize.width,o=e.actualSize.height;break;case"Meet":e.actualSize.width<=e.actualSize.height?s=o=e.actualSize.width:s=o=e.actualSize.height;break;case"Slice":e.actualSize.width>=e.actualSize.height?s=o=e.actualSize.width:s=o=e.actualSize.height;break}this.svgRenderer&&this.svgRenderer.drawNativeContent(e,l,o,s,h)},n.prototype.renderHTMLElement=function(e,t,i,r,a,s,o){var h=this.getBaseAttributes(e,r);h.fill="transparent",h.cornerRadius=e.cornerRadius,h.stroke="transparent",this.renderer.drawRectangle(t,h,this.diagramId,void 0,void 0,a),this.svgRenderer&&this.svgRenderer.drawHTMLContent(e,i.children[0],r,d0(i),o)},n.prototype.renderImageElement=function(e,t,i,r,a){var s=this.getBaseAttributes(e,i);s.cornerRadius=0,this.renderer.drawRectangle(t,s,this.diagramId,void 0,void 0,r);var o,h,l,d,f=e.contentSize.width,p=e.contentSize.height,c=s.width/f,u=s.height/p,g;if(e.stretch==="Stretch")g=Math.min(c,u),o=f*g,h=p*g;else switch(e.stretch){case"Meet":g=Math.min(c,u),o=f*g,h=p*g,s.x+=Math.abs(s.width-o)/2,s.y+=Math.abs(s.height-h)/2;break;case"Slice":g=Math.max(c,u),o=f*g,h=p*g,l=s.width/o*f,d=s.height/h*p;break;case"None":o=f,h=p;break}s.width=o,s.height=h,s.sourceWidth=l,s.sourceHeight=d,s.source=e.source,s.alignment=e.imageAlign,s.scale=e.imageScale,s.description=e.description?e.description:e.id,this.renderer.drawImage(t,s,r,a,this,e)},n.prototype.renderContainer=function(e,t,i,r,a,s,o,h,l,d,f){var p={svg:a,g:t},c=document.getElementById(this.diagramId),u="ej2_instances",g;if(c&&(g=c[""+u][0]),this.diagramId&&(a=this.getParentSvg(e)||a,this.isSvgMode)){var v=this.getParentElement(e,t,a,h).g||t;a=this.getParentSvg(this.hasNativeParent(e.children))||a;var m=this.getParentElement(this.hasNativeParent(e.children),v,a,h);p.svg=m.svg||a,p.g=m.g||v,s&&a&&(a.getElementById(p.g.id)||t.appendChild(p.g)),t=p.g}if(e&&e.id&&e.id.endsWith("_transaction_events")&&e.flip!==0&&(this.transactionBounds=e.bounds),this.renderRect(e,t,r,a),this.groupElement=e,e.hasChildren()){for(var y=void 0,S,x=0,I=e.children;x<I.length;x++){var C=I[x];this.groupElement=e,a=this.getParentSvg(this.hasNativeParent(e.children)||C)||a,this.isSvgMode&&(S=this.getParentElement(this.hasNativeParent(e.children)||C,t,a),y=S.g||t,S.svg&&(a=S.svg)),this.isSvgMode||C.relativeMode==="Object"&&(C.flip=e.flip,C.id&&(C.id.includes("_0_compensation")||C.id.includes("_0_adhoc"))&&e.children[0].flip&&(C.flip=e.children[0].flip));var P=y;this.renderElement(C,y||t,i,r,a,!0,o,h,l,d,f),e.children&&e.children[0]instanceof li&&(C instanceof Tt||C.elementActions&le.ElementIsPort)&&(P=document.getElementById(C.id+"_groupElement")),C instanceof Tt&&P&&this.renderFlipTextElement(e,P,C,C.flip,C.flipMode)}var A=void 0;g&&g.selectedItems&&g.selectedItems.nodes&&g.selectedItems.nodes.length>0&&(A=g.selectedItems.nodes[0]);var T=void 0,z=!1,L,R=e.id.includes("group_container")?e.id.split("group_container")[0]:e.id;g&&g.selectedItems&&(L=g.getObject(R)),A=L,A&&A.flipMode&&(z=!0);var O="";if(A&&(O=A.children?A.id+"group_container":A.id+"_content_groupElement"),(g instanceof Xe&&g.nameTable[""+R]&&g.nameTable[""+R].propName!=="connectors"||g instanceof mr)&&(z&&A||g instanceof mr)){if(e.children&&e.children[0]instanceof li)g instanceof mr?T=document.querySelector(".e-overview g[id="+(R+"_content_inner_native_element")+"]"):T=document.getElementById(A.id+"_content_inner_native_element");else if(e.children&&e.children[0]instanceof we){if(g instanceof mr){var N=document.querySelector("#"+g.id+"_htmlLayer_div");T=N.querySelector("#"+R+"_content_html_element")}else T=document.getElementById(A.id+"_content_html_element");T||(T=document.getElementById(O))}else T=document.getElementById(O);T&&this.renderFlipElement(e,T,e.flip)}}},n.prototype.renderFlipTextElement=function(e,t,i,r,a,s){var o={},h=1,l=1,d=0,f=0,p=0,c=0;if(r!==G.None){var u=e.rotateAngle;e.rotateAngle===0&&e.id.includes("group_container")&&(u=e.parentTransform);var g=i.getAbsolutePosition(i.desiredSize);if(!g){var v=i.desiredSize;g={x:.5*v.width,y:.5*v.height}}if(g&&i.content!==""){if(a==="All"||a==="LabelAndLabelText"){if((r===G.Horizontal||r===G.Both)&&(d=e.bounds.center.x,p=-e.bounds.center.x,h=-1),(r===G.Vertical||r===G.Both)&&(f=e.bounds.center.y,c=-e.bounds.center.y,l=-1),r===G.Horizontal||r===G.Vertical){var m=Math.sin(u*Math.PI/180);if(g.y!==void 0&&!isNaN(g.y)){var y=g.y/i.desiredSize.height;isNaN(y)||(p+=-e.desiredSize.height*m*(-2*y+1))}if(g.x!==void 0&&!isNaN(g.x)){var S=g.x/i.desiredSize.width;isNaN(S)||(c+=e.desiredSize.width*m*(-2*S+1))}}o={transform:"translate("+d+","+f+") scale("+h+","+l+") translate("+p+","+c+")"}}else if(a==="LabelText"||a==="PortAndLabelText")(r===G.Horizontal||r===G.Both)&&(d=i.offsetX,p=-i.offsetX,h=-1),(r===G.Vertical||r===G.Both)&&(f=i.offsetY,c=-i.offsetY,l=-1),o={transform:"translate("+d+","+f+") scale("+h+","+l+") translate("+p+","+c+")"};else if(a==="PortAndLabel"||a==="Label"){var x=0,I=0,C=this.flipLabel(e,i,g,r);x=C.x-i.offsetX,I=C.y-i.offsetY,o={transform:"translate("+x+","+I+")"}}}}else o={transform:"translate(0,0)"};return s?o:(this.setFlipAttributes(e,t,o,h,l,!1),{})},n.prototype.renderFlipElement=function(e,t,i,r){var a={},s=1,o=1,h=0,l=0,d=0,f=0;i!==G.None?((i===G.Horizontal||i===G.Both)&&(h=e.bounds.center.x,d=-e.bounds.center.x,s=-1),(i===G.Vertical||i===G.Both)&&(l=e.bounds.center.y,f=-e.bounds.center.y,o=-1),a={transform:"translate("+h+","+l+") scale("+s+","+o+") translate("+d+","+f+")"}):a={transform:"translate(0,0)"};var p=e&&e.children&&e.children.length&&e.children[0]instanceof we;return r?a:(this.setFlipAttributes(e,t,a,s,o,p),{})},n.prototype.setFlipAttributes=function(e,t,i,r,a,s){if(i)if(s){var o=t.id.split("_preview"),h=document.getElementById(o[0]+"_html_div")||ti(this.diagramId).children[0];t=h.querySelector("#"+e.id+"_content_html_element");var l=e.flip===G.None||e.flip===G.Both?1:-1;t&&(t.style.transform="scale("+r+","+a+")rotate("+(l*e.rotateAngle+e.parentTransform)+"deg)")}else Et(t,i)},n.prototype.flipLabel=function(e,t,i,r){if(r!==G.None){var a={x:e.offsetX-e.desiredSize.width/2,y:e.offsetY-e.desiredSize.height/2},s=.5,o=.5;t.horizontalAlignment==="Left"||t.horizontalAlignment==="Auto"?s=0:t.horizontalAlignment==="Right"&&(s=1),t.verticalAlignment==="Top"||t.verticalAlignment==="Auto"?o=0:t.verticalAlignment==="Bottom"&&(o=1);var h=i.x/t.desiredSize.width,l=i.y/t.desiredSize.height,d=a.x+e.desiredSize.width*h,f=a.y+e.desiredSize.height*l,p=(s-.5)*t.desiredSize.width,c=(o-.5)*t.desiredSize.height,u=r===G.Horizontal||r===G.Both,g=r===G.Vertical||r===G.Both;u&&(d=a.x+e.desiredSize.width*(1-h),f-=g?0:c),g&&(f=a.y+e.desiredSize.height*(1-l),d-=u?0:p),u&&!g?d+=p:g&&!u?f+=c:u&&g&&(d+=p,f+=c);var v={x:d,y:f};return ye(e.rotateAngle+e.parentTransform,e.offsetX,e.offsetY,v)}},n.prototype.hasNativeParent=function(e,t){if(e&&e.length>0&&(t||!0)){var i=e[0];if(i instanceof li)return i;i.children&&i.children.length&&this.hasNativeParent(i.children,t++||0)}},n.prototype.renderRect=function(e,t,i,r,a){var s=this.getBaseAttributes(e,i,a);s.cornerRadius=e.cornerRadius||0,e.isExport&&(s.cornerRadius*=e.exportScaleValue.x);var o=e.description?e.description:e.id;this.renderer.drawRectangle(t,s,this.diagramId,e.isExport,void 0,r,o,void 0,void 0,this,e)},n.prototype.drawRect=function(e,t){t.cornerRadius=0,this.svgRenderer.drawRectangle(e,t,this.diagramId)},n.prototype.getBaseAttributes=function(e,t,i){var r={width:e.actualSize.width,height:e.actualSize.height,x:e.offsetX-e.actualSize.width*e.pivot.x,y:e.offsetY-e.actualSize.height*e.pivot.y,fill:e.style.fill,stroke:e.style.strokeColor,angle:e.rotateAngle+e.parentTransform,pivotX:e.pivot.x,pivotY:e.pivot.y,strokeWidth:e.style.strokeWidth,dashArray:e.style.strokeDashArray||"",opacity:e.style.opacity,shadow:e.shadow,gradient:e.style.gradient,visible:e.visible,id:e.id,description:e.description,canApplyStyle:e.canApplyStyle,shapeType:e.shapeType};return e.rotationReference==="Page"&&(r.angle=e.rotateAngle),i&&(r.x=r.x-.5,r.y=r.y-.5),e.isExport&&(r.width*=e.exportScaleValue.x,r.height*=e.exportScaleValue.y,r.x*=e.exportScaleValue.x,r.y*=e.exportScaleValue.y,r.strokeWidth*=e.exportScaleValue.x),e.flip?(r.flip=e.flip,(e.flip===G.Horizontal||e.flip===G.Vertical)&&(e instanceof wr||e.isRectElement)&&!this.isSvgMode&&(r.isImage=!0)):r.flip=G.None,e.flipMode&&(r.flipMode=e.flipMode),t&&(r.x+=t.tx,r.y+=t.ty),r},n.renderSvgBackGroundImage=function(e,t,i,r,a,s){if(e.source){var o=gh(t.id),h=o.getElementById(t.id+"_image");if(!h){var l=ky(t.id);h=document.createElementNS("http://www.w3.org/2000/svg","image"),h.setAttribute("id",t.id+"_image"),l.appendChild(h)}var d=new Image;d.src=e.source,h.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d.src.toString());var f=e.scale!=="None"?e.scale:"",p=e.align,c=p.charAt(0).toLowerCase()+p.slice(1);f&&(c+=" "+f.charAt(0).toLowerCase()+f.slice(1));var u={id:t.id+"_image",x:i,y:r,width:a,height:s,preserveAspectRatio:c};Et(h,u)}},n.prototype.transformLayers=function(e,t){var i=e.tx*e.scale,r=e.ty*e.scale,a="domTable";if(i!==this.transform.x||r!==this.transform.y||i===0||r===0){if(t){window[""+a][this.diagramId+"_diagramLayer"]||(window[""+a][this.diagramId+"_diagramLayer"]=this.diagramSvgLayer.getElementById(this.diagramId+"_diagramLayer"));var s=window[""+a][this.diagramId+"_diagramLayer"];s.setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")")}var o=Ry(this.diagramId);o.setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+")"),window[""+a][this.diagramId+"_diagramPorts"]||(window[""+a][this.diagramId+"_diagramPorts"]=this.iconSvgLayer.getElementById(this.diagramId+"_diagramPorts"));var h=window[""+a][this.diagramId+"_diagramPorts"];h.setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),window[""+a][this.diagramId+"_diagramExpander"]||(window[""+a][this.diagramId+"_diagramExpander"]=this.iconSvgLayer.getElementById(this.diagramId+"_diagramExpander"));var l=window[""+a][this.diagramId+"_diagramExpander"];l.setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")"),window[""+a][this.diagramId+"_nativeLayer"]||(window[""+a][this.diagramId+"_nativeLayer"]=this.nativeSvgLayer.getElementById(this.diagramId+"_nativeLayer"));var d=window[""+a][this.diagramId+"_nativeLayer"];d.setAttribute("transform","translate("+e.tx*e.scale+","+e.ty*e.scale+"),scale("+e.scale+")");var f=ti(this.diagramId).children[0];return f.style.transform="translate("+e.tx*e.scale+"px,"+e.ty*e.scale+"px)scale("+e.scale+")",this.transform={x:e.tx*e.scale,y:e.ty*e.scale},!0}return!1},n.prototype.updateNode=function(e,t,i,r,a,s,o){this.renderElement(e,t,i,r,this.getParentSvg(e),void 0,void 0,a,null,s,o)},n})(),r0=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),ca=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},mr=(function(n){r0(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.mode="Canvas",r.id="overview",r.actionName="",r.startPoint=null,r.currentPoint=null,r.prevPoint=null,r.scale=null,r.inAction=!1,r.viewPortRatio=1,r.horizontalOffset=0,r.verticalOffset=0,r.model={},r.event=!0,r.overviewid=88123,r.prevTransform="",r.model={width:r.width,height:r.height},r}return e.prototype.onPropertyChanged=function(t,i){for(var r=0,a=Object.keys(t);r<a.length;r++){var s=a[r];switch(s){case"sourceID":this.setParent(t.sourceID);break;case"width":case"height":this.renderCanvas(),this.setParent(this.sourceID);break}}},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){if(this.element.id===""){var t=document.getElementsByClassName("e-overview").length;this.element.id="overview_"+this.overviewid+"_"+t}this.id=this.element.id?this.element.id:this.id,this.element.style.background="transparent",this.unWireEvents(),this.wireEvents(),this.element.classList.add("e-overview")},e.prototype.render=function(){this.diagramRenderer=new on(this.element.id,new ln,!1),this.renderCanvas(),this.setParent(this.sourceID),this.renderComplete()},e.prototype.getSizeValue=function(t){var i;return t.toString().indexOf("px")>0||t.toString().indexOf("%")>0?i=t.toString():i=t.toString()+"px",i},e.prototype.renderCanvas=function(t){var i=document.getElementById(this.element.id+"_canvas");i||(i=bt("div",{}),this.element.appendChild(i));var r={id:this.element.id+"_canvas",class:"drawing",style:"position:relative; height:"+this.getSizeValue(this.model.height)+"; width:"+this.getSizeValue(this.model.width)+";style:-ms-touch-action: none;touch-action: none;"};bi(i,r),this.element.setAttribute("tabindex",String(-1)),this.element.style.overflow="hidden",this.element.style.height=String(this.model.height),this.element.style.width=String(this.model.width),this.canvas=i},e.prototype.setParent=function(t){var i=document.getElementById(t),r="ej2_instances";if(this.parent){var a=this.parent;this.parent=null,a.setOverview(null,this.element.id),this.removeDocument(this)}this.parent=this.getDiagram(i,r),this.parent&&this.parent.setOverview(this)},e.prototype.getDiagram=function(t,i){for(var r,a=t[""+i].length,s=0;s<a;s++)if(Hn(t[""+i][parseInt(s.toString(),10)].element,"e-diagram")){r=t[""+i][parseInt(s.toString(),10)];break}return r},e.prototype.unWireEvents=function(){var t=vt.touchStartEvent,i=vt.touchMoveEvent,r=vt.isPointer?"pointerleave":"mouseleave",a=vt.touchEndEvent;J.remove(this.element,t,this.mouseDown),J.remove(this.element,i,this.mouseMove),J.remove(this.element,a,this.mouseUp),J.remove(this.element,r,this.documentMouseUp),J.remove(window,"resize",this.windowResize);var s=document.getElementById(this.sourceID+"content");s&&J.remove(s,"scroll",this.scrolled)},e.prototype.wireEvents=function(){var t=vt.touchStartEvent,i=vt.touchEndEvent,r=vt.touchMoveEvent,a=vt.isPointer?"pointerleave":"mouseleave";J.add(this.element,t,this.mouseDown,this),J.add(this.element,r,this.mouseMove,this),J.add(this.element,i,this.mouseUp,this),J.add(this.element,a,this.documentMouseUp,this),J.add(window,"resize",this.windowResize,this);var s=document.getElementById(this.sourceID+"content");s&&J.add(s,"scroll",this.scrolled,this)},e.prototype.initializeOverviewLayers=function(){this.htmlLayer=document.getElementById(this.element.id+"_htmlLayer"),this.overviewLayer=document.getElementById(this.element.id+"_overviewlayer"),this.diagramCanvas=document.getElementById(this.element.id+"_diagramLayer"),this.nativeLayer=Lf(this.element.id),this.context2d=this.diagramCanvas.getContext("2d")},e.prototype.renderDocument=function(t){t.canvas=this.canvas;var i=document.getElementById(this.canvas.id+"_svg");i&&i.parentNode.removeChild(i);var r={id:this.canvas.id+"_svg",version:"1.1",class:"overview_svg"},a=Nt("svg",r);this.svg=a,t.svg=a,t.canvas.appendChild(a);var s=document.getElementById(this.element.id),o=s,h=o.clientWidth||o.offsetWidth,l=o.clientHeight||o.offsetHeight,d=o.getBoundingClientRect(),f=window.screenX<0?window.screenX*-1:window.screenX,p=window.screenY<0?window.screenY*-1:window.screenY;if(h===0){var c=Math.floor(window.innerWidth-f-Math.floor(d.left));h=c>0?c:Math.floor(window.innerWidth)}if(l===0){var u=Math.floor(window.innerHeight-p-Math.floor(d.top));l=u>0?u:Math.floor(window.innerHeight)}h>0&&(a.setAttribute("width",String(h)),this.model.height=l),l>0&&(a.setAttribute("height",String(l)),this.model.width=h),t.diagramLayerDiv||(t.diagramLayerDiv=bt("div",{}),t.diagramLayer=nr.createCanvas(this.element.id+"_diagramLayer",this.model.width,this.model.height),t.diagramLayer.style.position="absolute",t.diagramLayer.style.left="0px",t.diagramLayer.style.top="0px",t.diagramLayerDiv.appendChild(t.diagramLayer),t.canvas.appendChild(t.diagramLayerDiv));var g={id:this.element.id+"_diagramLayer_div",style:"width:"+this.model.width+"px; height:"+this.model.height+"px;position:absolute;top:0px;left:0px"};bi(t.diagramLayerDiv,g),this.renderHtmlLayer(t.canvas),this.renderNativeLayer(t.canvas,t),this.addOverviewRectPanel(t)},e.prototype.removeDocument=function(t){var i=document.getElementById(this.canvas.id+"_svg");this.canvas.removeChild(i);var r=document.getElementById(this.element.id+"_htmlLayer");this.canvas.removeChild(r);var a=document.getElementById(this.element.id+"_diagramLayer_div");this.canvas.removeChild(a),t.diagramLayerDiv=null,t.diagramLayer=null;var s="domTable";window[""+s][this.id+"html_layer"]=null},e.prototype.renderHtmlLayer=function(t){var i=bt("div",{id:this.element.id+"_htmlLayer",class:"e-html-layer",style:"pointer-events:none;position:absolute;top:0px;left:0px;"}),r={id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;"},a=bt("div",r);return i.appendChild(a),t.appendChild(i),i},e.prototype.renderNativeLayer=function(t,i){if(!document.getElementById(this.element.id+"_nativeLayer_svg")){var r=this.parent.createSvg(this.element.id+"_nativeLayer_svg",this.model.width,this.model.height),a=Nt("g",{id:this.element.id+"_nativeLayer"});r.appendChild(a),i.diagramLayerDiv.appendChild(r),Et(r,{class:"e-native-layer"})}},e.prototype.addOverviewRectPanel=function(t){var i=document.getElementById(this.canvas.id+"_overviewsvg");i&&i.parentNode.removeChild(i);var r={id:this.canvas.id+"_overviewsvg",class:"overviewsvg",version:"1.1",style:"position:absolute;left:0px;top:0px; aria-label:Specifies overview",width:this.model.width,height:this.model.height};i=Nt("svg",r),t.canvas.appendChild(i);var a=Nt("g",{id:this.element.id+"_overviewlayer",style:"pointer-events:none"});i.appendChild(a);var s=Nt("rect",{fill:"transparent",width:"100%",height:"100%",class:"overviewbackrect",id:this.canvas.id+"overviewbackrect"});s.style.pointerEvents="none",a.appendChild(s);var o=Nt("g",{id:this.canvas.id+"overviewhandle",style:"pointer-events:all"});a.appendChild(o);var h=Nt("rect",{id:this.canvas.id+"overviewrect",fill:"transparent"});o.appendChild(h),this.renderOverviewCorner("left",o),this.renderOverviewCorner("right",o),this.renderOverviewCorner("top",o),this.renderOverviewCorner("bottom",o),this.renderOverviewCorner("topleft",o),this.renderOverviewCorner("topright",o),this.renderOverviewCorner("bottomleft",o),this.renderOverviewCorner("bottomright",o)},e.prototype.renderOverviewCorner=function(t,i){this.svg;var r;t==="top"||t==="bottom"||t==="right"||t==="left"?r="rect":r="circle";var a=Nt(r,{id:this.canvas.id+"visible"+t,class:"overview-resizer"});i.appendChild(a);var s=Nt(r,{id:this.canvas.id+t,class:"overviewresizer",fill:"transparent"});i.appendChild(s)},e.prototype.updateOverviewRectangle=function(){var t=this.currentPoint.x-this.prevPoint.x,i=this.currentPoint.y-this.prevPoint.y,r=new U;r.width=0,r.height=0;var a=0,s=0,o,h;switch(this.resizeDirection){case"left":r.width-=t,r.height-=t/this.viewPortRatio,a=t,s=t/this.viewPortRatio,s/=2;break;case"right":r.width+=t,r.height+=t/this.viewPortRatio,s=t/this.viewPortRatio,s/=-2;break;case"top":r.height-=i,r.width-=i*this.viewPortRatio,s=i,a=i*this.viewPortRatio,a/=2;break;case"bottom":r.height+=i,r.width+=i*this.viewPortRatio,a=i*this.viewPortRatio,a/=-2;break;case"topleft":Math.abs(i)>Math.abs(t)?t=i*this.viewPortRatio:i=t/this.viewPortRatio,r.width-=t,r.height-=i,a=t,s=i;break;case"topright":Math.abs(i)>Math.abs(t)?t=-i*this.viewPortRatio:i=-(t/this.viewPortRatio),s=i,r.width+=t,r.height-=i;break;case"bottomleft":Math.abs(i)>Math.abs(t)?t=-i*this.viewPortRatio:i=-t/this.viewPortRatio,a=t,r.width-=t,r.height+=i;break;case"bottomright":Math.abs(i)>Math.abs(t)?t=i*this.viewPortRatio:i=t/this.viewPortRatio,r.width+=t,r.height+=i;break}this.updateHelper(a,s,r,o,h)},e.prototype.updateHelper=function(t,i,r,a,s){var o,h,l,d=this.element.id+"_canvas_overviewsvg",f=document.getElementById(d),p=f,c=p.getElementById("helper");if(r)l=c.getBBox(),o=l.x+t,h=l.y+i,a=l.width+r.width,s=l.height+r.height;else{var u;this.currentPoint.x>this.startPoint.x?u=this.currentPoint.x-this.prevPoint.x:u=this.prevPoint.x-this.currentPoint.x;var g;this.currentPoint.y>this.startPoint.y?g=this.currentPoint.y-this.prevPoint.y:g=this.prevPoint.y-this.currentPoint.y,Math.abs(g)>Math.abs(u)?u=this.viewPortRatio*g:g=u/this.viewPortRatio,l=c.getBBox(),o=this.startPoint.x>this.currentPoint.x?l.x-u:l.x,h=this.startPoint.y>this.currentPoint.y?l.y-g:l.y,a=l.width+u,s=l.height+g}Et(this.helper,{id:this.helper.id,x:o,y:h,width:Math.max(0,a),height:Math.max(0,s)})},e.prototype.updateOverviewrect=function(t,i,r,a){var s=document.getElementById(this.canvas.id+"overviewrect"),o={x:t,y:i,width:Math.max(1,r),height:Math.max(1,a)};bi(s,o),this.updateOverviewCorner("top",t+8,i+1,Math.max(0,r-16),2),this.updateOverviewCorner("bottom",t+8,i+a+3,Math.max(0,r-16),2),this.updateOverviewCorner("left",t-2,i+11,2,Math.max(0,a-16)),this.updateOverviewCorner("right",t+r,i+11,2,Math.max(0,a-16)),this.updateOverviewCorner("topleft",t,i+3,5,5),this.updateOverviewCorner("topright",t+r,i+3,5,5),this.updateOverviewCorner("bottomleft",t,i+a+3,5,5),this.updateOverviewCorner("bottomright",t+r,i+a+3,5,5)},e.prototype.updateOverviewCorner=function(t,i,r,a,s){var o,h,l="visible"+t,d=document.getElementById(this.canvas.id+l);t==="top"||t==="bottom"||t==="right"||t==="left"?(o={x:i,y:r,width:a,height:s,fill:"#ED1C24"},h={x:i-2,y:r-2,width:a===2?4:a,height:s===2?4:s}):(o={cx:i,cy:r,r:4,fill:"#ED1C24"},h={cx:i,cy:r,r:6,fill:"transparent"}),bi(d,o);var f=document.getElementById(this.canvas.id+t);bi(f,h)},e.prototype.translateOverviewRectangle=function(){Number(this.model.width),Number(this.model.height);var t=this.currentPoint.x-this.prevPoint.x,i=this.currentPoint.y-this.prevPoint.y,r=this.element.getElementsByClassName("overviewsvg")[0],a=r.getElementById(this.canvas.id+"overviewrect"),s=a.getBBox(),o=s.x+t,h=s.y+i,l=s.width,d=s.height;this.updateOverviewrect(o,h,l,d),this.updateParentView(this.parent.scroller.currentZoom,o,h,l,d,null)},e.prototype.renderOverviewRect=function(t,i,r,a){var s=Number(this.model.width),o=Number(this.model.height),h=r/s*this.contentWidth,l=a/o*this.contentHeight,d=Math.max(this.parent.scroller.viewPortWidth/h,this.parent.scroller.viewPortHeight/l);if(d>=.25&&d<=30){var f={x:0,y:0};this.updateParentView(d,t,i,r,a,f);var p=this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom,!0);if(this.helper){var c=this.element.getElementsByTagName("rect")[10],u=c.getBBox();p.x=u.x,p.y=u.y}this.actionName==="pan"?this.updateOverviewrect(-p.x,-p.y,p.width,p.height):this.updateOverviewrect(p.x,p.y,p.width,p.height)}},e.prototype.scrollOverviewRect=function(t,i,r,a){if(!this.actionName||a){var s=Number(this.model.width),o=Number(this.model.height),h=Math.min(this.contentWidth/s,this.contentHeight/o),l=new it,d=l.x=t/r/h,f=l.y=i/r/h,p=0;this.parent.rulerSettings.showRulers&&(p=25);var c=document.getElementById(this.parent.element.id+"content"),u=0,g=0;c&&(u=c.offsetWidth-c.clientWidth,g=c.offsetHeight-c.clientHeight);var v=l.width=(this.parent.scroller.viewPortWidth-p-u)/r/h,m=l.height=(this.parent.scroller.viewPortHeight-p-g)/r/h;if(a){var y=new it;return y.x=d,y.y=f,y.width=v,y.height=m,y}this.updateOverviewrect(-d,-f,v,m)}return null},e.prototype.updateParentView=function(t,i,r,a,s,o){var h=Number(this.model.width),l=Number(this.model.height),d=this.contentWidth/h,f=this.contentHeight/l,p=i*d*t,c=r*f*t,u,g;this.parent.scroller.getPageBounds(),(t!==1||this.actionName==="pan")&&(u=-p-this.parent.scroller.horizontalOffset,g=-c-this.parent.scroller.verticalOffset),this.parent.setBlazorDiagramProps(!0),this.parent.realActions|=Vt.OverViewAction;var v=!0;this.actionName==="scale"||this.actionName==="draw"?this.parent.scroller.zoom(t/this.parent.scroller.currentZoom,u,g,o):this.parent.pan(u,g,o,v)},e.prototype.updateHtmlLayer=function(t){var i=ti(t.element.id),r=this.parent.scroller.getPageBounds(!0),a=r.width,s=r.height,o=Math.max(a,this.parent.scroller.viewPortWidth),h=Math.max(s,this.parent.scroller.viewPortHeight/this.parent.scroller.currentZoom),l=Math.min(Number(this.model.width)/o,Number(this.model.height)/h);i.style.transform="scale("+l+") translate("+this.parent.scroller.transform.tx+"px,"+this.parent.scroller.transform.ty+"px)"},e.prototype.updateView=function(t){var i=this.parent.scroller.getPageBounds(),r=i.width,a=i.height,s=Number(this.model.width),o=Number(this.model.height),h=Math.max(r,this.parent.scroller.viewPortWidth),l=Math.max(a,this.parent.scroller.viewPortHeight);this.contentWidth=h=Math.max(h,s/o*l),this.contentHeight=l=Math.max(l,o/s*h);var d=Math.min(s/h,o/l),f=-i.x,p=-i.y,c="scale("+d+") translate("+f+"px, "+p+"px)";(c!==this.prevTransform||!this.htmlLayer.style.transform)&&(this.htmlLayer.style.transform=c,this.htmlLayer.style.webkitTransform=c,this.prevTransform=c),this.overviewLayer.setAttribute("transform","translate("+-i.x*d+","+-i.y*d+")"),this.horizontalOffset=i.x*d,this.verticalOffset=i.y*d;var u=Number(this.model.width)/this.contentWidth,g=Number(this.model.height)/this.contentHeight;u=Math.min(u,g);var v=this.parent.scroller.transform,m=v.tx,y=v.ty;this.nativeLayer.setAttribute("transform","translate("+m*u+","+y*g+"),scale("+u+")"),this.context2d.setTransform(u,0,0,u,0,0),this.context2d.fillStyle="red",this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom)},e.prototype.scrolled=function(t){if(this.event){var i=this.scrollOverviewRect(this.parent.scroller.horizontalOffset,this.parent.scroller.verticalOffset,this.parent.scroller.currentZoom,!0);this.updateOverviewrect(-i.x,-i.y,i.width,i.height),this.updateView(this)}},e.prototype.updateCursor=function(t){if(Hn(t.target,"overviewresizer"))switch(t.target.id){case this.canvas.id+"left":this.canvas.style.cursor="w-resize";break;case this.canvas.id+"right":this.canvas.style.cursor="e-resize";break;case this.canvas.id+"top":this.canvas.style.cursor="n-resize";break;case this.canvas.id+"bottom":this.canvas.style.cursor="s-resize";break;case this.canvas.id+"topleft":this.canvas.style.cursor="nw-resize";break;case this.canvas.id+"topright":this.canvas.style.cursor="ne-resize";break;case this.canvas.id+"bottomleft":this.canvas.style.cursor="sw-resize";break;case this.canvas.id+"bottomright":this.canvas.style.cursor="se-resize";break}else this.canvas.style.cursor="default"},e.prototype.mouseMove=function(t){if(this.event=!1,this.updateCursor(t),this.currentPoint=this.mousePosition(t),this.actionName)switch(this.actionName){case"draw":!this.inAction&&(this.startPoint.x!==this.currentPoint.x||this.startPoint.y!==this.currentPoint.y)&&(this.initHelper(),this.inAction=!0),this.inAction&&this.updateHelper();break;case"scale":this.inAction||(this.initHelper(),this.inAction=!0),this.updateOverviewRectangle();break;case"pan":(this.startPoint.x!==this.currentPoint.x||this.startPoint.y===this.currentPoint.y||this.inAction)&&(this.inAction=!0,this.translateOverviewRectangle());break}this.prevPoint=this.currentPoint},e.prototype.documentMouseUp=function(t){this.inAction=!1,this.actionName="",this.helper&&(this.helper.parentNode.removeChild(this.helper),this.helper=null),this.event=!0,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="all"},e.prototype.windowResize=function(t){var i=this;return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){var r=document.getElementById(i.element.id),a=r.getBoundingClientRect();i.model.width=a.width>0?a.width:i.model.width,i.model.height=a.height>0?a.height:i.model.height,i.renderCanvas(),i.setParent(i.sourceID)},10),!1},e.prototype.mouseDown=function(t){if(t.target.id===this.canvas.id+"_overviewsvg"&&(this.actionName="draw"),t.target.id===this.canvas.id+"overviewrect"&&(this.actionName="pan"),Hn(t.target,"overviewresizer"))switch(this.actionName="scale",t.target.id){case this.canvas.id+"left":this.resizeDirection="left";break;case this.canvas.id+"right":this.resizeDirection="right";break;case this.canvas.id+"top":this.resizeDirection="top";break;case this.canvas.id+"bottom":this.resizeDirection="bottom";break;case this.canvas.id+"topleft":this.resizeDirection="topleft";break;case this.canvas.id+"topright":this.resizeDirection="topright";break;case this.canvas.id+"bottomleft":this.resizeDirection="bottomleft";break;case this.canvas.id+"bottomright":this.resizeDirection="bottomright";break}this.startPoint=this.prevPoint=this.mousePosition(t),this.viewPortRatio=this.parent.scroller.viewPortWidth/this.parent.scroller.viewPortHeight;var i=document.getElementById(this.canvas.id+"overviewhandle");i.style.pointerEvents="none"},e.prototype.mouseUp=function(t){if(this.currentPoint=this.mousePosition(t),this.actionName){if(this.startPoint.x!==this.currentPoint.x||this.startPoint.y!==this.currentPoint.y){if(this.actionName!=="pan"){if(this.helper){var i=this.element.getElementsByTagName("rect")[10].getBBox();this.resizeDirection=this.resizeDirection||"";var r=i.x,a=i.y,s=i.width,o=i.height;this.resizeDirection==="topleft"||this.resizeDirection==="topright"||this.resizeDirection==="bottomleft"||this.resizeDirection,this.renderOverviewRect(r,a,s,o)}}}else if(t.target.id===this.canvas.id+"_overviewsvg"||t.target.id==="helper"){var h=this.element.id+"_canvas_overviewsvg",l=document.getElementById(h),d=l,f=d.getElementById(this.canvas.id+"overviewrect"),i=f.getBBox(),s=i.width,o=i.height;this.inAction=!0,this.actionName="pan",this.renderOverviewRect(this.currentPoint.x-s/2,this.currentPoint.y-o/2,s,o),this.inAction=!1}}this.helper&&(this.helper.parentNode.removeChild(this.helper),this.helper=null),this.actionName="",this.startPoint=null,this.currentPoint=null,this.prevPoint=null,this.helper=null,this.viewPortRatio=1,this.resizeDirection="",this.inAction=!1,this.event=!0,document.getElementById(this.canvas.id+"overviewhandle").style.pointerEvents="all"},e.prototype.initHelper=function(){var t=this.element.id+"_canvas_overviewsvg",i=document.getElementById(t),r=i,a=this.startPoint.x,s=this.startPoint.y,o=1,h=1;if(this.actionName==="scale"){var l=r.getElementById(this.canvas.id+"overviewrect"),d=l.getBBox();a=d.x,s=d.y,o=d.width,h=d.height}var f=Nt("rect",{id:"helper",x:a,y:s,width:o,height:h,fill:"transparent",stroke:"gray","stroke-dasharray":"2 2","shape-rendering":"crispEdges"}),p=r.getElementById(this.element.id+"_overviewlayer");p.appendChild(f),this.helper=f},e.prototype.mousePosition=function(t){var i,r,a;if(t.type.indexOf("touch")!==-1){i=t;var s=i.changedTouches[0].clientX,o=i.changedTouches[0].clientY;r=s-this.element.offsetLeft,a=o-this.element.offsetTop}else r=t.clientX,a=t.clientY;var h=this.element.getBoundingClientRect();return r=r-h.left,a=a-h.top,{x:r+this.horizontalOffset,y:a+this.verticalOffset}},e.prototype.destroy=function(){if(this.unWireEvents(),this.notify("destroy",{}),n.prototype.destroy.call(this),document.getElementById(this.element.id)){this.element.classList.remove("e-overview");var t=document.getElementById(this.element.id+"_canvas");t&&this.element.removeChild(t)}this.parent.views.splice(this.parent.views.indexOf(this.element.id),1),this.diagramLayerDiv=null,this.canvas=null,this.parent=null},e.prototype.getModuleName=function(){return"Overview"},ca([w("100%")],e.prototype,"width",void 0),ca([w("100%")],e.prototype,"height",void 0),ca([w("")],e.prototype,"sourceID",void 0),ca([ot()],e.prototype,"created",void 0),e})(Vr);function n0(n,e){for(var t=[],i=0;i<e.length;i++){var r=e[parseInt(i.toString(),10)];n.containsRect(r.wrapper.bounds)&&t.push(r)}return t}function a0(n,e){for(var t=0;t<n.length;t++)if(n[parseInt(t.toString(),10)].id===e)return!0;return!1}function s0(n){var e;return n&&(n.type?e="Connector":n.shape&&!n.type&&(e="Node")),e}function nf(n,e){e instanceof M&&(n.shape.header||(e.shape.hasHeader=!1))}function fl(n,e,t,i){return i=e?i:n[t-1]!==void 0?n[t-1]+i:0,i}function Gs(n,e){var t=[];if(e)t=n;else{for(var i=0;i<n.length;i++)t.push(n[parseInt(i.toString(),10)]);t.push(n[t.length-2]),t.push(n[t.length-2])}return t}function o0(n){for(var e=0;e<n.ports.length;e++)n.ports[parseInt(e.toString(),10)].inEdges=[],n.ports[parseInt(e.toString(),10)].outEdges=[];return n}function us(n,e){if(e instanceof M){var t=n.shape.shape;switch(t){case"JoinNode":n.width||(e.width=20),n.height||(e.height=90),(!n.style||!n.style.fill)&&(e.style.fill="black");break;case"ForkNode":n.width||(e.width=90),n.height||(e.height=20),(!n.style||!n.style.fill)&&(e.style.fill="black");break;case"InitialNode":(!n.style||!n.style.fill)&&(e.style.fill="black");break;case"FinalNode":(!n.style||!n.style.fill)&&(e.style.fill="black");break}}else{var i=n.shape.flow;switch(i){case"Object":(!n.style||!n.style.strokeDashArray)&&(e.style.strokeDashArray="8 4"),(!n.style||!n.style.strokeWidth)&&(e.style.strokeWidth=2),(!n.targetDecorator||!n.targetDecorator.shape)&&(e.targetDecorator.shape="OpenArrow");break;case"Control":(!n.style||!n.style.strokeWidth)&&(e.style.strokeWidth=2),(!n.targetDecorator||!n.targetDecorator.shape)&&(e.targetDecorator.shape="OpenArrow"),(!n.sourceDecorator||!n.sourceDecorator.shape)&&(e.sourceDecorator.shape="None");break}}}function af(n,e){switch(n.shape.type){case"Bpmn":var t=n.shape.flow;switch(t){case"Sequence":(n.shape.sequence==="Normal"&&n.type!=="Bezier"||n.shape.sequence==="Default"||n.shape.sequence==="Conditional")&&(e.targetDecorator&&e.targetDecorator.style&&(e.targetDecorator.style.fill=n.targetDecorator&&n.targetDecorator.style&&n.targetDecorator.style.fill||"black"),n.shape.sequence==="Conditional"&&e.sourceDecorator&&(e.sourceDecorator.style&&(e.sourceDecorator.style.fill=n.sourceDecorator&&n.sourceDecorator.style&&n.sourceDecorator.style.fill||"white"),e.sourceDecorator.width=n.sourceDecorator&&n.sourceDecorator.width||20,e.sourceDecorator.height=n.sourceDecorator&&n.sourceDecorator.width||10));break;case"Association":(n.shape.association==="Default"||n.shape.association==="Directional"||n.shape.association==="BiDirectional")&&(e.targetDecorator&&e.targetDecorator.style&&(e.targetDecorator.style.fill=n.targetDecorator&&n.targetDecorator.style&&n.targetDecorator.style.fill||"black"),n.shape.association==="BiDirectional"&&e.sourceDecorator&&e.sourceDecorator.style&&(e.sourceDecorator.style.fill=n.sourceDecorator&&n.sourceDecorator.style&&n.sourceDecorator.style.fill||"white",e.sourceDecorator.width=n.sourceDecorator&&n.sourceDecorator.width||5,e.sourceDecorator.height=n.sourceDecorator&&n.sourceDecorator.height||10));break;case"Message":e.style&&!e.style.strokeDashArray&&(e.style.strokeDashArray=n.style&&n.style.strokeDashArray||"4 4");break}break;case"UmlActivity":var i=n.shape.flow;i==="Exception"&&(n.shape.association==="Directional"||n.shape.association==="BiDirectional")&&(e.style.strokeDashArray=n.style&&n.style.strokeDashArray||"2 2");break;case"UmlClassifier":var r=!1;n.shape.relationship==="Association"?r=!0:n.shape.relationship==="Inheritance"?(e.targetDecorator&&e.targetDecorator.style&&(e.targetDecorator.style.fill=n.targetDecorator&&n.targetDecorator.style&&n.targetDecorator.style.fill||"white"),e.style&&(r=!0)):n.shape.relationship==="Composition"?(e.sourceDecorator&&e.sourceDecorator.style&&(e.sourceDecorator.style.fill=n.sourceDecorator&&n.sourceDecorator.style&&n.sourceDecorator.style.fill||"black"),r=!0):n.shape.relationship==="Aggregation"||n.shape.relationship===void 0?(e.sourceDecorator&&e.sourceDecorator.style&&(e.sourceDecorator.style.fill=n.sourceDecorator&&n.sourceDecorator.style&&n.sourceDecorator.style.fill||"white"),r=!0):n.shape.relationship==="Dependency"?(e.sourceDecorator&&e.sourceDecorator.style&&(e.sourceDecorator.style.fill=n.sourceDecorator&&n.sourceDecorator.style&&n.sourceDecorator.style.fill||"white"),r=!0,e.style.strokeDashArray="4 4"):n.shape.relationship==="Realization"&&(e.targetDecorator&&e.targetDecorator.style&&(e.targetDecorator.style.fill=n.targetDecorator&&n.targetDecorator.style&&n.targetDecorator.style.fill||"white"),r=!0,e.style.strokeDashArray="4 4"),r&&(e.style.strokeWidth=n.style&&n.style.strokeWidth||2);break}}function h0(n,e,t){var i,r=b.findLength(e,n),a=b.findLength(t,n);r>a?i=t:i=e;var s=b.findAngle(e,t),o=b.findAngle(i,n),h=b.findLength(i,n),l=o+(s-o)*2;return{x:i.x+h*Math.cos(l*Math.PI/180),y:i.y+h*Math.sin(l*Math.PI/180)}}function l0(n){var e=[];if(n.type==="Bezier")for(var t=0,i=0;i<n.segments.length;i++)for(var r=1.5,a=n.segments[parseInt(i.toString(),10)],s=b.isEmptyPoint(a.point1)?a.bezierPoint1:a.point1,o=b.isEmptyPoint(a.point2)?a.bezierPoint2:a.point2,h=Number((n.distance(s,a.points[0])+n.distance(o,s)+n.distance(a.points[1],o))/r),l=0;l<h-1;l=l+10)e[parseInt(t.toString(),10)]=Fm(n,a.points[0],b.isEmptyPoint(a.point1)?a.bezierPoint1:a.point1,b.isEmptyPoint(a.point2)?a.bezierPoint2:a.point2,a.points[1],l,h),t++;return e}function d0(n){var e=n.parentElement;do{if(Hn(e,"e-diagram"))return!0;e=e.parentElement}while(e);return!1}function en(n,e,t){var i=!1;if(n&&n.children&&n.children.length>0)for(var r=void 0,a=0;a<n.children.length;a++)return r=t[n.children[parseInt(a.toString(),10)]],r.shape.type===e?!0:en(r,e,t);return i}function Ti(n,e,t,i,r){if(t&&(n instanceof B||n&&(n.shape&&n.shape.type!=="SwimLane"||n.shape===void 0)))for(var a=void 0,s=0,o=Object.keys(t);s<o.length;s++){var h=o[s];if(a=t[""+h],h==="shape"&&a.type&&(n.shape={type:a.type}),a)if(Array.isArray(a)&&a.length&&a.length>0&&r!=="annotations"&&r!=="ports")if(n[""+h].length>0)for(var l=0;l<=n[""+h].length;l++)Ti(n[""+h],e?e[""+h]:void 0,t[""+h],h==="annotations"||h==="ports"?n:void 0,h);else Ti(n[""+h],e?e[""+h]:void 0,t[""+h],h==="annotations"||h==="ports"?n:void 0,h);else if(a instanceof Object&&e&&r!=="annotations"&&r!=="ports")Ti(n[""+h],e[""+h],t[""+h]);else if(r!=="annotations"&&r!=="ports"&&e&&!e[""+h]||!e&&n&&(n[""+h]||n[""+h]!==void 0))n[""+h]=t[""+h];else{var d=void 0;(r==="annotations"||r==="ports")&&(r==="annotations"?(n[""+h]&&Ti(n[""+h],e[""+h],t[""+h]),n[""+h]||(Fe(i)===B?(d=new Qt(i,"annotations",t[""+h]),i.annotations.push(d)):(d=new ae(i,"annotations",t[""+h]),i.annotations.push(d)))):n[""+h]?Ti(n[""+h],e[""+h],t[""+h]):(d=new Se(i,"ports",t[""+h]),i.ports.push(d)))}}}function f0(n,e){for(var t=n.type==="Bezier"?l0(n):n.intermediatePoints,i=0;i<t.length-1;i++){var r=t[parseInt(i.toString(),10)],a=t[i+1],s=it.toBounds([r,a]);if(s.Inflate(n.hitPadding),s.containsPoint(e)){var o=h0(e,r,a),h={x1:r.x,x2:a.x,y1:r.y,y2:a.y},l={x1:e.x,x2:o.x,y1:e.y,y2:o.y},d=ea(h,l);if(d.enabled){var f=b.findLength(e,d.intersectPt);if(Math.abs(f)<n.hitPadding)return!0}else{var p=it.toBounds([e,e]);if(p.Inflate(3),p.containsPoint(r)||p.containsPoint(a))return!0}if(b.equals(e,o))return!0}}if(n.annotations.length>0||n.ports.length>0)for(var c=n.wrapper.children,i=3;i<c.length;i++){var u=c[parseInt(i.toString(),10)];if(u.bounds.containsPoint(e))return!0}return!1}function ea(n,e){var t={x:0,y:0},i=n,r=e,a=(r.y2-r.y1)*(i.x2-i.x1)-(r.x2-r.x1)*(i.y2-i.y1),s=(r.x2-r.x1)*(i.y1-r.y1)-(r.y2-r.y1)*(i.x1-r.x1),o=(i.x2-i.x1)*(i.y1-r.y1)-(i.y2-i.y1)*(i.x1-r.x1);if(a===0||(n.x1===e.x1||n.y1===e.y1)&&(n.x2===e.x2||n.y2===e.y2)&&(s===0||o===0)&&a>0)return{enabled:!1,intersectPt:t};var h=s/a,l=o/a;return h>=0&&h<=1&&l>=0&&l<=1?(t.x=i.x1+h*(i.x2-i.x1),t.y=i.y1+h*(i.y2-i.y1),{enabled:!0,intersectPt:t}):{enabled:!1,intersectPt:t}}function p0(n,e,t,i){var r={x:0,y:0},a=pl(n.x,n.y,e.x,e.y),s=pl(t.x,t.y,i.x,i.y),o=ea(a,s);return o.enabled?o.intersectPt:r}function pl(n,e,t,i){return{x1:Number(n)||0,y1:Number(e)||0,x2:Number(t)||0,y2:Number(i)||0}}function sf(n,e,t){var i=[];t=t||0;var r={x:e.topLeft.x-t,y:e.topLeft.y},a={x:e.topRight.x+t,y:e.topRight.y},s={x:e.bottomRight.x,y:e.bottomRight.y-t},o={x:e.bottomLeft.x,y:e.bottomLeft.y+t};return i.push(r),i.push(a),i.push(s),i.push(o),i}function c0(n,e,t,i){var r=t instanceof M?t.constraints&W.InheritTooltip:t instanceof B?t.constraints&yt.InheritTooltip:t.constraints&Ct.InheritTooltip,a=t instanceof M?t.constraints&W.Tooltip:t instanceof B?t.constraints&yt.Tooltip:t.constraints&Ct.ToolTip,s=(!r&&a?t.tooltip.relativeMode:n.tooltip.relativeMode)==="Mouse",o=u0(t,e,n,s),h=Mi(n);return{x:o.x+h.width,y:o.y+h.height}}function u0(n,e,t,i){var r={},a=document.getElementById(t.element.id),s;if(n instanceof M||n instanceof B)s=n.wrapper.bounds;else{var o=t.findObjectsUnderMouse(e),h=t.findObjectUnderMouse(o,"Select",!1),l=t.findElementUnderMouse(h,e,t);s=l.bounds}var d=a.getBoundingClientRect();switch(t.tooltipObject.position){case"BottomCenter":r=lr(e,s.bottomCenter,t,i,d.width/2,d.height);break;case"BottomLeft":case"LeftBottom":r=lr(e,s.bottomLeft,t,i,0,d.height);break;case"BottomRight":case"RightBottom":r=lr(e,s.bottomRight,t,i,d.width,d.height);break;case"LeftCenter":r=lr(e,s.middleLeft,t,i,0,d.height/2);break;case"LeftTop":case"TopLeft":r=lr(e,s.topLeft,t,i,0,0);break;case"RightCenter":r=lr(e,s.middleRight,t,i,d.width,d.height/2);break;case"RightTop":case"TopRight":r=lr(e,s.topRight,t,i,d.width,0);break;case"TopCenter":r=lr(e,s.topCenter,t,i,d.width/2,0);break}return r}function lr(n,e,t,i,r,a){var s={},o=t.scroller.transform.scale,h=t.scroller.horizontalOffset,l=t.scroller.verticalOffset;return h=t.modifyClientOffset(h,!0),l=t.modifyClientOffset(l,!0),s.x=(i?n.x:e.x)*o+h-r,s.y=(i?n.y:e.y)*o+l-a,s}function of(n,e){var t=new Pt;return t.data=n.pathData,t.height=n.height>10?n.height-(n.padding.bottom+n.padding.top):n.height,t.width=n.width>10?n.width-(n.padding.left+n.padding.right):n.width,t.visible=n.visibility,t.id=e.id+"_shape",t.inversedAlignment=!1,t.horizontalAlignment="Center",t.verticalAlignment="Center",t.style={fill:n.iconStrokeColor,strokeColor:n.iconStrokeColor,strokeWidth:n.iconStrokeWidth},t.setOffsetWithRespectToBounds(.5,.5,"Fraction"),t.relativeMode="Object",t.description=e.description||"",t}function g0(n,e){var t=0,i=0,r;for(t=0;t<n.length;t++)for(i=t+1;i<n.length;i++){var a=ze(n[parseInt(t.toString(),10)].wrapper),s=ze(n[parseInt(i.toString(),10)].wrapper);e==="Top"||e==="Bottom"||e==="BottomToTop"||e==="Middle"?a.center.y>s.center.y&&(r=n[parseInt(t.toString(),10)],n[parseInt(t.toString(),10)]=n[parseInt(i.toString(),10)],n[parseInt(i.toString(),10)]=r):a.center.x>s.center.x&&(r=n[parseInt(t.toString(),10)],n[parseInt(t.toString(),10)]=n[parseInt(i.toString(),10)],n[parseInt(i.toString(),10)]=r)}return n}function Ko(n,e,t){var i=_a(n,e),r=b.findAngle(n[i.index],n[i.index+1]),a=S0(e),s=b.transform(i.point,r+45,a);return i.point=s,i.angle=r,i}function v0(n,e,t){var i=m0(n,e),r=b.findAngle(n[i.index],n[i.index+1]),a=y0(e),s=b.transform(i.point,r+45,a);return i.point=s,i.angle=r,i}function m0(n,e){for(var t=0,i=e.offset,r,a,s=[],o,h,l=0;l<n.length-1;l++)t+=b.distancePoints(n[parseInt(l.toString(),10)],n[l+1]),s.push(t);for(var d=i*t,f=0;f<s.length;f++){if(s[parseInt(f.toString(),10)]>=d)return a=b.findAngle(n[parseInt(f.toString(),10)],n[f+1]),r=b.transform(n[parseInt(f.toString(),10)],a,d-(o||0)),h=f,{point:r,index:h};o=s[parseInt(f.toString(),10)]}return{point:r,index:h}}function y0(n){var e=0,t=0;switch(n.alignment){case"Center":t=0;break;case"Before":t=-0;break;case"After":t=0/2+e;break}return t}function _a(n,e){for(var t=0,i=e.offset,r,a,s=[],o,h,l=0;l<n.length-1;l++)t+=b.distancePoints(n[parseInt(l.toString(),10)],n[l+1]),s.push(t);for(var d=i*t,f=0;f<s.length;f++){if(s[parseInt(f.toString(),10)]>=d)return a=b.findAngle(n[parseInt(f.toString(),10)],n[f+1]),r=b.transform(n[parseInt(f.toString(),10)],a,d-(o||0)),h=f,{point:r,index:h};o=s[parseInt(f.toString(),10)]}return{point:r,index:h}}function S0(n){var e;n instanceof Xn?e=0:e=n.content===void 0?10:0;var t=0;switch(n.alignment){case"Center":t=0;break;case"Before":t=-(0/2+e);break;case"After":t=0/2+e;break}return t}function cl(n,e,t){e%=360;var i=45,r=135,a=225,s=315,o,h;switch(n.alignment){case"Before":e>=i&&e<=r?(h="right",o=n.offset===.5?"center":"top"):e>=a&&e<=s?(h="left",o=n.offset===.5?"center":"bottom"):e>i&&e<a?(o="top",h=n.offset===.5?"center":"right"):(o="bottom",h=n.offset===.5?"center":"left");break;case"After":e>=i&&e<=r?(h="left",o=n.offset===.5?"center":"top"):e>=a&&e<=s?(h="right",o=n.offset===.5?"center":"bottom"):e>i&&e<a?(o="bottom",h=n.offset===.5?"center":"right"):(o="top",h=n.offset===.5?"center":"left");break;case"Center":h=V(n.horizontalAlignment)?"center":n.horizontalAlignment.toLowerCase(),o=V(n.verticalAlignment)?"center":n.verticalAlignment.toLowerCase();break}if(n.offset===0||n.offset===1){var l=w0(t[0],t[1]);switch(l){case"left":h=n.offset===0?"right":"left";break;case"right":h=n.offset===0?"left":"right";break;case"bottom":o=n.offset===0?"top":"bottom";break;case"top":o=n.offset===0?"bottom":"top";break}}return{hAlign:h,vAlign:o}}function w0(n,e){return Math.abs(e.x-n.x)>Math.abs(e.y-n.y)?n.x<e.x?"right":"left":n.y<e.y?"bottom":"top"}function jo(n,e){if(n instanceof M&&n.children)for(var t=0;t<n.children.length;t++)e.nameTable[n.children[parseInt(t.toString(),10)]].children&&jo(n,e),e.removeFromAQuad(e.nameTable[n.children[parseInt(t.toString(),10)]]),e.removeObjectsFromLayer(e.nameTable[n.children[parseInt(t.toString(),10)]]),delete e.nameTable[n.children[parseInt(t.toString(),10)]]}function Ka(n,e){if(n&&n.children&&n.children.length>0)for(var t=0;t<n.children.length;t++){var i=n.children[parseInt(t.toString(),10)];i instanceof Ht&&Ka(i,e)}return e.indexOf(n.id)===-1&&e.push(n.id),e}function hf(n){for(var e=[],t,i,r,a,s="childTable",o=0;o<n.length;o++)if(t=n[parseInt(o.toString(),10)],t.shape.type==="SwimLane"){i=t.wrapper.children[0],r=i[""+s];for(var h=0,l=Object.keys(r);h<l.length;h++){var d=l[h];a=r[""+d],e=Ka(a,e)}}return e}function lf(n,e){var t=e.nodes;if(t)for(var i=0;i<t.length;i++)n.indexOf(t[parseInt(i.toString(),10)].id)!==-1&&(t.splice(i,1),i--)}function I0(n){var e=hf(n.nodes),t=E(n,n.getCustomProperty);return t.isScrollOffsetInverted=n.isScrollOffsetInverted,t.selectedItems.nodes=[],t.selectedItems.connectors=[],t.selectedItems.wrapper=null,n.serializationSettings.preventDefaults&&(t=th(t,n)),n.nodes.forEach(function(i){if(i.shape.type==="SwimLane"){var r=n.commandHandler.findProcesses(i);r.forEach(function(a){t.nodes.forEach(function(s){if(s.id===a){var o=s.wrapper;s.offsetX=o.offsetX,s.offsetY=o.offsetY}})}),r.length>0&&(e=e.filter(function(a){return!r.includes(a)}))}}),lf(e,t),JSON.stringify(t)}function th(n,e,t,i){t=C0(e,t);var r=[];r=r.concat(Object.keys(n));for(var a=0,s=r;a<s.length;a++){var o=s[a];e instanceof M&&(i=o==="shape"),n[""+o]instanceof Array?x0(n,t,e,o):n[""+o]instanceof Object&&t&&t[""+o]?o!=="wrapper"&&(n[""+o]=th(n[""+o],e[""+o],t[""+o],i)):(t&&n[""+o]===t[""+o]||n[""+o]===void 0)&&!(i&&o==="type")&&!(e instanceof Br&&o==="orientation")&&!(e instanceof ae&&o==="content")&&delete n[""+o],(JSON.stringify(n[""+o])==="[]"||JSON.stringify(n[""+o])==="{}"||n[""+o]===void 0)&&delete n[""+o]}return t=void 0,r=void 0,n}function x0(n,e,t,i){if(n[""+i].length===0)delete n[""+i];else if(n[i].every(function(s){return typeof s=="number"})){var r=void 0,a=!0;for(r=0;r<n[""+i].length;r++)a&&n[""+i][parseInt(r.toString(),10)]===e[""+i][parseInt(r.toString(),10)]?a=!0:a=!1;a&&delete n[""+i]}else{var r=void 0;if(n[""+i]&&i!=="layers")for(r=n[""+i].length-1;r>=0;r--)(i==="nodes"||i==="connectors")&&(n[""+i][parseInt(r.toString(),10)].wrapper=null),i!=="dataManager"&&(n[""+i][parseInt(r.toString(),10)]=th(n[""+i][parseInt(r.toString(),10)],t[""+i][parseInt(r.toString(),10)],e[""+i]!==void 0?e[""+i][parseInt(r.toString(),10)]:[]),(JSON.stringify(n[""+i][parseInt(r.toString(),10)])==="[]"||JSON.stringify(n[""+i][parseInt(r.toString(),10)])==="{}"||n[""+i][parseInt(r.toString(),10)]===void 0)&&n[""+i].splice(r,1))}n=void 0}function C0(n,e){var t=[],i,r="getClassName";if(n[r]){var a=new Xe;switch(n[r]()){case"Diagram":i=a;break;case"Node":i=new M(a,"",t);break;case"Path":i=new Sf(a,"",t);break;case"Native":i=new Jn(a,"",t);break;case"Html":i=new wf(a,"",t);break;case"Image":i=new If(a,"",t);break;case"Text":i=new Ur(a,"",t);break;case"BasicShape":i=new Pa(a,"",t);break;case"FlowShape":i=new xf(a,"",t);break;case"BpmnShape":i=new fh(a,"",t);break;case"UmlActivityShape":i=new Cf(a,"",t);break;case"UmlClassifierShape":i=new Pf(a,"",t);break;case"SwimLane":i=new Br(a,"",t),n.header&&(i.header=new ia(a,"",t),i.header.style.fill="");break;case"ShapeAnnotation":i=new ae(a,"",t);break;case"PointPort":i=new Se(a,"",t);break;case"BpmnGateway":i=new oh(a,"",t);break;case"BpmnDataObject":i=new hh(a,"",t);break;case"BpmnEvent":i=new lh(a,"",t);break;case"BpmnSubEvent":i=new Ir(a,"",t);break;case"BpmnActivity":i=new dh(a,"",t);break;case"BpmnAnnotation":i=new _n(a,"",t);break;case"MethodArguments":i=new ph(a,"",t);break;case"UmlClassAttribute":i=new fn(a,"",t);break;case"UmlClassMethod":i=new Kn(a,"",t);break;case"UmlClass":i=new vs(a,"",t);break;case"UmlInterface":i=new ch(a,"",t);break;case"UmlEnumerationMember":i=new ms(a,"",t);break;case"UmlEnumeration":i=new uh(a,"",t);break;case"Lane":i=new Fr(a,"",t);break;case"Phase":i=new ys(a,"",t);break;case"ChildContainer":i=new my;break;case"Connector":i=new B(a,"",t);break;case"StraightSegment":i=new qi(a,"",t);break;case"BezierSegment":i=new Me(a,"",t);break;case"OrthogonalSegment":i=new Te(a,"",t);break;case"PathAnnotation":i=new Qt(a,"",t);break;case"Stop":i=new od(a,"",t);break;case"Point":e?i=e:i=new b(a,"",t);break;case"UserHandle":i=new _o(a,"",t);break;case"Command":i=new rf(a,"",t);break}}else i=e;return parent=void 0,e=void 0,i}function P0(n,e){e.enableServerDataBinding(!1);var t=e.blazorActions;e.blazorActions=e.addConstraints(t,jt.ClearObject),e.clear(),e.blazorActions=e.removeConstraints(t,jt.ClearObject),e.protectPropertyChange(!0);for(var i=e.dataSourceSettings.doBinding,r=e.setNodeTemplate,a=e.getDescription,s=e.getCustomProperty,o={},h=0,l=e.commandManager.commands;h<l.length;h++){var d=l[h];o[d.name]={execute:d.execute,canExecute:d.canExecute}}var f=e.rulerSettings.horizontalRuler.arrangeTick,p=e.rulerSettings.verticalRuler.arrangeTick,c=e.layout.getLayoutInfo,u=e.layout.getBranch,g=e.getNodeDefaults,v=e.getConnectorDefaults,m;n instanceof Object?m=n:m=JSON.parse(n),m=A0(m),e.contextMenuSettings=m.contextMenuSettings||{},e.constraints=m.constraints||lt.Default,e.tool=m.tool||Gt.Default,e.bridgeDirection=m.bridgeDirection||"Top",e.pageSettings=m.pageSettings||{},e.drawingObject=m.drawingObject||void 0,e.tooltip=m.tooltip||{},e.addInfo=m.addInfo||void 0,e.getDescription=a,e.scrollSettings=m.scrollSettings||{},m.isScrollOffsetInverted&&gl(e),e.commandManager=m.commandManager||{},m.layers&&m.layers.length>0&&T0(m),e.layers=m.layers||[],e.rulerSettings.horizontalRuler.arrangeTick=f,e.rulerSettings.verticalRuler.arrangeTick=p;for(var y=0,S=e.commandManager.commands;y<S.length;y++){var x=S[y];o[x.name]&&(x.execute=o[x.name].execute,x.canExecute=o[x.name].canExecute)}if(e.backgroundColor=m.backgroundColor||"transparent",e.basicElements=m.basicElements||[],m.connectors)for(var I=0;I<m.connectors.length;I++)m.connectors[I].type==="Bezier"&&m.connectors[I].segments&&m.connectors[I].segments.length>0&&m.connectors[I].bezierSettings&&m.connectors[I].bezierSettings.allowSegmentsReset&&(m.connectors[I].segments=[]);if(e.connectors=m.connectors||[],e.dataSourceSettings=m.dataSourceSettings||{},e.dataSourceSettings.doBinding=i,e.height=m.height||"100%",e.setNodeTemplate=r,e.getConnectorDefaults=v,e.getNodeDefaults=g,e.getCustomProperty=s,e.mode=m.mode||"SVG",m.nodes)for(var I=0;I<m.nodes.length;I++)m.nodes[I].shape&&m.nodes[I].shape.type==="SwimLane"&&(m.nodes[I].wrapper==null&&(m.nodes[I].wrapper={actualSize:{width:m.nodes[I].width,height:m.nodes[I].height},offsetX:m.nodes[I].offsetX,offsetY:m.nodes[I].offsetY}),po(m.nodes[I],void 0,void 0,void 0,void 0,!0));e.nodes=m.nodes||[],ul(e.nodes),ul(e.connectors),e.rulerSettings=m.rulerSettings||{},e.snapSettings=m.snapSettings||{},e.width=m.width||"100%",e.layout=m.layout||{},m.layout&&m.layout.type!=="None"&&(e.canLayout=!1),e.layout.getLayoutInfo=_t(c),e.layout.getBranch=_t(u),e.diagramActions=0,e.isLoading=!0,e.protectPropertyChange(!1);var C;e.deserializing=!0;for(var I=0;I<e.views.length;I++)C=e.views[e.views[I]],e.blazorActions=e.addConstraints(t,jt.ClearObject),C.refresh(),C instanceof mr&&C.onPropertyChanged({sourceID:C.sourceID},{}),e.blazorActions=e.removeConstraints(t,jt.ClearObject),C instanceof Xe&&e.element.classList.add("e-diagram");e.deserializing=!1;var P={name:"loaded",diagram:e};return e.triggerEvent(Z.loaded,P),m.selectedItems&&(m.selectedItems.nodes=[],m.selectedItems.connectors=[],m.selectedItems.selectedObjects=[]),e.selectedItems=m.selectedItems,e.enableServerDataBinding(!0),e.canLayout=!0,e.swimlaneChildTable={},e.swimlaneZIndexTable={},e.nodes.forEach(function(A){if(A.shape.type==="SwimLane"){var T=e.commandHandler.findProcesses(A);T.forEach(function(z){var L=e.nameTable[z];if(L&&e.nameTable[L.processId]){var R=e.nameTable[L.processId].wrapper;R.children.push(L.wrapper)}})}}),m.isScrollOffsetInverted&&(e.protectPropertyChange(!0),gl(e),e.protectPropertyChange(!1)),m}function ul(n){for(var e=n.filter(function(a){return typeof a.flip=="string"}),t=0,i=e;t<i.length;t++){var r=i[t];switch(r.flip){case"Horizontal":r.flip=G.Horizontal;break;case"Vertical":r.flip=G.Vertical;break;case"Both":r.flip=G.Both;break;case"None":r.flip=G.None;break}}}function T0(n){var e,t,i,r=[];for(e=0;e<n.layers.length;e++){for(t=0;t<n.layers[e].objects.length;t++)if(n.nodes)for(i=0;i<n.nodes.length;i++)n.layers[e].objects[t]===n.nodes[i].id&&r.push(n.layers[e].objects[t]);for(t=0;t<n.layers[e].objects.length;t++)if(n.connectors)for(i=0;i<n.connectors.length;i++)n.layers[e].objects[t]===n.connectors[i].id&&r.push(n.layers[e].objects[t]);n.layers[e].objects=r,r=[]}}function A0(n){if(n&&(n.version===void 0||n.version<17.1)&&n.nodes)for(var e=n.nodes,t=0,i=e;t<i.length;t++){var r=i[t];if(r&&r.ports&&r.ports.length>0)for(var a=0,s=r.ports;a<s.length;a++){var o=s[a];o&&o.constraints&&o.constraints===Ct.None&&(o.constraints=Ct.Default)}}return n}function gl(n){n.scrollSettings&&n.scrollSettings.horizontalOffset&&(n.scrollSettings.horizontalOffset=-n.scrollSettings.horizontalOffset),n.scrollSettings&&n.scrollSettings.verticalOffset&&(n.scrollSettings.verticalOffset=-n.scrollSettings.verticalOffset)}function ua(n,e){var t=e.style,i=e;e.canApplyStyle=!0;for(var r=0,a=Object.keys(n);r<a.length;r++){var s=a[r];switch(s){case"fill":t.fill=n.fill,t instanceof hd&&(t.fill="transparent");break;case"textOverflow":t.textOverflow=n.textOverflow;break;case"opacity":t.opacity=n.opacity;break;case"strokeColor":t.strokeColor=n.strokeColor;break;case"strokeDashArray":t.strokeDashArray=n.strokeDashArray;break;case"strokeWidth":t.strokeWidth=n.strokeWidth;break;case"bold":t.bold=n.bold;break;case"color":t.color=n.color;break;case"textWrapping":t.textWrapping=n.textWrapping;break;case"fontFamily":t.fontFamily=n.fontFamily;break;case"fontSize":t.fontSize=n.fontSize;break;case"italic":t.italic=n.italic;break;case"textAlign":t.textAlign=n.textAlign;break;case"whiteSpace":t.whiteSpace=n.whiteSpace;break;case"textDecoration":t.textDecoration=n.textDecoration;break;case"gradient":if(t.gradient){b0(n.gradient,t.gradient);break}}}e instanceof Tt&&i.refreshTextElement()}function b0(n,e){for(var t=0,i=Object.keys(n);t<i.length;t++){var r=i[t];switch(r){case"type":e.type=n.type;break;case"x1":e.x1=n.x1;break;case"x2":e.x2=n.x2;break;case"y1":e.y1=n.y1;break;case"y2":e.y2=n.y2;break;case"cx":e.cx=n.cx;break;case"cy":e.cy=n.cy;break;case"fx":e.fx=n.fx;break;case"fy":e.fy=n.fy;break;case"r":e.r=n.r;break;case"stops":e.stops=n.stops;break}}}function E0(n,e,t){for(var i=e,r=i.hyperlink,a=0,s=Object.keys(n);a<s.length;a++){var o=s[a];switch(o){case"color":i.style.color=r.color=n.color;break;case"content":i.content=r.content=n.content||r.link;break;case"link":var h=t.style;i.style.color=n.link?r.color:h.color,i.style.textDecoration=n.link?r.textDecoration:t.style.textDecoration,i.content=n.link?r.content||n.link:t.content,r.link=n.link;break;case"textDecoration":i.style.textDecoration=r.textDecoration=n.textDecoration;break;case"hyperlinkOpenState":r.hyperlinkOpenState=n.hyperlinkOpenState;break}}}function dr(n,e,t){n.width=e.width,n.height=e.height,n.minHeight=e.minHeight,n.maxHeight=e.maxHeight,n.minWidth=e.minWidth,n.maxWidth=e.maxWidth,n.horizontalAlignment=e.wrapper.children[0].horizontalAlignment,n.verticalAlignment=e.wrapper.children[0].verticalAlignment,n.relativeMode=e.wrapper.children[0].relativeMode,n.visible=e.wrapper.children[0].visible,e.shape instanceof Ur&&(n.margin=e.shape.margin),n.id=e.wrapper.children[0].id,n.style=e.style;for(var i=0,r=t.views;i<r.length;i++){var a=r[i];be(e.id+"_groupElement",a),be(e.id+"_content_groupElement",a),be(e.id+"_html_element",a)}e.wrapper.children.splice(0,1),e.wrapper.children.splice(0,0,n)}function D0(n,e,t,i){var r=new Be;switch(n.shape.type){case"Path":var a=new Pt;a.data=e.shape.data,r=a,dr(r,e,i);break;case"Image":var s=new wr;s.source=e.shape.source,s.imageAlign=e.shape.align,s.imageScale=e.shape.scale,r=s,dr(r,e,i);break;case"Text":var o=new Tt;r=o,dr(r,e,i);break;case"Basic":var h=e.shape.shape==="Rectangle"?new Be:new Pt;e.shape.shape==="Polygon"?h.data=To(e.shape.points):h.data=ka(e.shape.shape),e.shape.shape==="Rectangle"&&(h.cornerRadius=e.shape.cornerRadius),r=h,dr(r,e,i);break;case"Flow":var l=new Pt,d=e.shape.shape;l.data=Yo(d),r=l,dr(r,e,i);break;case"Native":var f=new li(n.id,i.element.id);f.content=e.shape.content,f.scale=e.shape.scale,r=f,dr(r,e,i);break;case"HTML":var p=new we(e.id,i.element.id);p.content=e.shape.content,r=p,dr(r,e,i)}n.shape.type===void 0||n.shape.type===t.shape.type?L0(n,e,i,t):(r.width=e.wrapper.children[0].width,r.height=e.wrapper.children[0].height,e.shape instanceof Ur&&(r.margin=e.shape.margin),r.style=e.style,e.wrapper.children[0]=r)}function L0(n,e,t,i){if(Object.keys(n.shape).length>0){if(e.shape.type==="Path"&&n.shape.data!==void 0)e.wrapper.children[0].data=n.shape.data;else if(e.shape.type==="Text"&&n.shape.content!==void 0)e.wrapper.children[0].content=n.shape.content;else if(e.shape.type==="Image"&&n.shape.source!==void 0)e.wrapper.children[0].source=n.shape.source;else if(e.shape.type==="Native"){for(var r=void 0,a=0;a<t.views.length;a++)r=St(e.wrapper.children[0].id+"_native_element",t.views[parseInt(a.toString(),10)]),n.shape.content!==void 0&&r&&(r.removeChild(r.children[0]),e.wrapper.children[0].content=n.shape.content,r.appendChild(Ai(e.wrapper.children[0],!1)));e.wrapper.children[0].scale=n.shape.scale?n.shape.scale:e.wrapper.children[0].scale}else if(e.shape.type==="HTML")for(var s=void 0,a=0;a<t.views.length;a++)s=St(e.wrapper.children[0].id+"_html_element",t.views[parseInt(a.toString(),10)]),s&&(s.removeChild(s.children[0]),e.wrapper.children[0].content=n.shape.content,s.appendChild(Ai(e.wrapper.children[0],!0)));else if(e.shape.type==="Flow"&&n.shape.shape!==void 0){e.shape.shape=n.shape.shape;var o=e.shape.shape,h=Yo(o.toString());e.wrapper.children[0].data=h}else if(e.shape.type==="UmlActivity"&&n.shape.shape!==void 0)M0(e,n);else if(n.shape.cornerRadius!==void 0)e.children&&e.children.length>0?e.wrapper.cornerRadius=n.shape.cornerRadius:e.wrapper.children[0].cornerRadius=n.shape.cornerRadius;else if(e.shape.type==="Basic"&&i&&i.shape.shape==="Rectangle"){var l=new Pt,d=ka(e.shape.shape);l.data=d;var f=l;dr(f,e,t)}else if(n.shape.shape!==void 0){e.shape.shape=n.shape.shape;var o=e.shape.shape,p=ka(o.toString());e.wrapper.children[0].data=p}}e.wrapper.children[0].canMeasurePath=!0}function M0(n,e){n.shape.shape=e.shape.shape;var t=n.shape.shape,i=ef(t.toString());n.shape.shape==="InitialNode"||n.shape.shape==="ForkNode"||n.shape.shape==="JoinNode"?n.wrapper.children[0].style.fill="black":n.shape.shape==="FinalNode"&&n instanceof M&&(n.wrapper=df(n)),i&&(n.wrapper.children[0].data=i)}function df(n){var e=new Ht;e.style.fill="transparent";var t="M 25 50 C 11.21 50 0 38.79 0 25 C 0 11.21 11.21 0 25 0 C 38.78 0 50 11.21 50 25 C 50 38.79 38.78 50 25 50",i=new Pt;i.data=t,i.id=n.id+"_0_finalNode",i.horizontalAlignment="Center",i.verticalAlignment="Center",i.relativeMode="Object",i.style.strokeColor=n.style.strokeColor,i.style.strokeWidth=n.style.strokeWidth;var r=new Pt;return r.data=t,r.id=n.id+"_1_finalNode",r.horizontalAlignment="Center",r.verticalAlignment="Center",r.relativeMode="Object",r.style.fill=n.style.fill,r.style.strokeColor=n.style.strokeColor,r.style.strokeWidth=n.style.strokeWidth,e.children=[i,r],e.children[0].width=n.width,e.children[0].height=n.height,e.children[1].height=n.height/1.5,e.children[1].width=n.width/1.5,e.style.strokeWidth=0,e.style.strokeColor="transparent",e}function z0(n,e,t){var i=t.shape.shape,r=ef(i);switch(n.data=r,e=n,i){case"StructuredNode":if(t.annotations)for(var a=0;a<t.annotations.length;a++)t.annotations[parseInt(a.toString(),10)].content="<<"+t.annotations[parseInt(a.toString(),10)].content+">>";e=n;break;case"FinalNode":e=df(t);break}return e}function ff(n){be(n+"_linear"),be(n+"_radial")}function Zs(n,e){var t=n.indexOf(e);t>=0&&n.splice(t,1)}function Dn(n,e,t){var i;n.intermediatePoints=e,n.updateSegmentElement(n,e,n.wrapper.children[0],t);var r=n.sourceDecorator;if(n.type==="Bezier"){var a=n.segments[0],s=n.segments[n.segments.length-1];i=[b.isEmptyPoint(s.point2)?s.bezierPoint2:s.point2,b.isEmptyPoint(a.point1)?a.bezierPoint1:a.point1]}else i=n.intermediatePoints;e=n.clipDecorators(n,e,t);var o=n.wrapper.children[0];o.canMeasurePath=!0,o=n.wrapper.children[1],n.updateDecoratorElement(o,e[0],i[1],r);var h=n.targetDecorator;o=n.wrapper.children[2],n.updateDecoratorElement(o,e[e.length-1],i[i.length-2],h),n.updateShapeElement(n)}function eh(n,e,t){var i=n.wrapper;i.bounds;var r=e.offset,a=e.size/t.scale,s=e.margin,o,h=i.offsetX-i.actualSize.width*i.pivot.x,l=i.offsetY-i.actualSize.height*i.pivot.y;if(o={x:0,y:0},n.nodes.length>0){switch(e.side){case"Top":o.x+=h+r*i.actualSize.width,o.y+=l-a;break;case"Bottom":o.x+=h+r*i.actualSize.width,o.y+=l+i.actualSize.height+a;break;case"Left":o.x+=h-a,o.y+=l+r*i.actualSize.height;break;case"Right":o.x+=h+i.actualSize.width+a,o.y+=l+r*i.actualSize.height;break}o.x+=(s.left-s.right)/t.scale+a/2*(e.horizontalAlignment==="Center"?0:e.horizontalAlignment==="Right"?-1:1),o.y+=(s.top-s.bottom)/t.scale+a/2*(e.verticalAlignment==="Center"?0:e.verticalAlignment==="Top"?-1:1)}else if(n.connectors.length>0){var d=n.connectors[0],f={offset:r},p=_a(d.intermediatePoints,f),c=p.index;o=p.point;var u=Ko(d.intermediatePoints,f),g=u.angle,v=xt();Rt(v,-g,d.intermediatePoints[parseInt(c.toString(),10)].x,d.intermediatePoints[parseInt(c.toString(),10)].y),o=st(v,o),o.x+=s.left-s.right+a/2*(e.horizontalAlignment==="Center"?0:e.horizontalAlignment==="Right"?-1:1),o.y+=s.top-s.bottom+a/2*(e.verticalAlignment==="Center"?0:e.verticalAlignment==="Top"?-1:1),v=xt(),Rt(v,g,d.intermediatePoints[parseInt(c.toString(),10)].x,d.intermediatePoints[parseInt(c.toString(),10)].y),o=st(v,o)}if(i.rotateAngle!==0||i.parentTransform!==0){var v=xt();Rt(v,i.rotateAngle+i.parentTransform,i.offsetX,i.offsetY),o=st(v,o)}return o}function hi(n,e,t,i){if(i.annotation){if(Wi(i.annotation))return!0}else if(Ae[""+e]&n&&gt[""+e]&t)return!0;return!1}function Kt(n,e){return!!(Ae[""+e]&n)}function yr(n,e){return!!(za[""+e]&n)}function ci(n,e){return n.visibility&e}function vl(n,e){var t;if(n.shape.type==="Text")t=n.shape;else{var i=e.split("_");e=i[i.length-1];for(var r=0;r<n.annotations.length;r++)e===n.annotations[parseInt(r.toString(),10)].id&&(t=n.annotations[parseInt(r.toString(),10)])}return t}function k0(n,e){var t;if(e){var i=e.split("_");e=i[i.length-1]}if(n){n=n;for(var r=0;r<n.ports.length;r++)if(e===n.ports[parseInt(r.toString(),10)].id)return n.ports[parseInt(r.toString(),10)]}return t}function hn(n,e){var t={},i=0;if(n.ports){var r=n.ports;for(i=0;i<r.length;i++)e?r[parseInt(i.toString(),10)].constraints&Ct.InConnect&&(t=r[parseInt(i.toString(),10)]):r[parseInt(i.toString(),10)].constraints&Ct.OutConnect&&(t=r[parseInt(i.toString(),10)])}return t}function ja(n,e,t){for(var i=t?n.annotations:n.ports,r=0;r<i.length;r++)if(i[parseInt(r.toString(),10)].id===e)return r.toString();return"-1"}function R0(n,e,t){for(var i=n.ports,r=0;r<i.length;r++)if(i[parseInt(r.toString(),10)].id===e)return r.toString();return"-1"}function ml(n,e){var t;for(t=0;t<n.length;t++)if(e===n[parseInt(t.toString(),10)].id)return!0;return!1}function pf(n,e,t,i){if(n.width!==void 0&&n.height!==void 0&&(n.width*=e,n.height*=t),n instanceof Je){var r=xt(),a=i.width||i.actualSize.width,s=i.height||i.actualSize.height;if(a!==void 0&&s!==void 0){var o=i.offsetX-a*i.pivot.x,h=i.offsetY-s*i.pivot.y,l={x:o+a*i.pivot.x,y:h+s*i.pivot.y};l=ye(i.rotateAngle,i.offsetX,i.offsetY,l),Rt(r,-i.rotateAngle,l.x,l.y),Or(r,e,t,l.x,l.y),Rt(r,i.rotateAngle,l.x,l.y);for(var d=0,f=n.children;d<f.length;d++){var p=f[d];if(p.width!==void 0&&p.height!==void 0){var c=st(r,{x:p.offsetX,y:p.offsetY});p.offsetX=c.x,p.offsetY=c.y,pf(p,e,t,i)}}}}}function ih(n,e,t,i,r,a){for(var s=n.children,o,h=!1,l=!1,d=1.5,f=0;f<s.length;f++)if(o=i[s[parseInt(f.toString(),10)]],o){if(o.children)ih(o,e,t,i,r,a);else if(o.offsetX-=e,o.offsetY-=t,!r){i[o.id]=o;var p=o.initContainer();p.children||(p.children=[]);var c=o.init(a);p.children.push(c),p.measure(new U(o.width,o.height)),p.arrange(p.desiredSize),p.bounds.x===0&&(h=!0),p.bounds.y===0&&(l=!0)}}(h||l)&&n.children.forEach(function(u){var g=i[""+u];g&&g.wrapper&&g.wrapper.children&&g.wrapper.children.length>0&&(h&&(g.wrapper.children[0].bounds.x+=d,g.wrapper.children[0].offsetX+=d),l&&(g.wrapper.children[0].bounds.y+=d,g.wrapper.children[0].offsetY+=d))})}function H0(n,e){var t,i;return n instanceof M&&n.shape.type!=="Native"&&n.shape.type!=="HTML"||n instanceof B?t=1:n instanceof M&&n.shape.type!=="HTML"?t=2:t=3,e instanceof M&&e.shape.type!=="Native"&&e.shape.type!=="HTML"||e instanceof B?i=1:e instanceof M&&e.shape.type!=="HTML"?i=2:i=3,t!==i?t-i:n.zIndex-e.zIndex}function B0(n){return n.sort(H0)}function O0(n,e,t){if(t.length===0)t.push(n);else if(t.length===1)t[0][""+e]>n[""+e]?t.splice(0,0,n):t.push(n);else if(t.length>1){for(var i=0,r=t.length-1,a=Math.floor((i+r)/2);a!==i;)if(t[parseInt(a.toString(),10)][""+e]<n[""+e])i=a,a=Math.floor((i+r)/2);else if(t[parseInt(a.toString(),10)][""+e]>n[""+e])r=a,a=Math.floor((i+r)/2);else break;t[parseInt(r.toString(),10)][""+e]<n[""+e]?t.push(n):t[parseInt(i.toString(),10)][""+e]>n[""+e]?t.splice(i,0,n):t[parseInt(i.toString(),10)][""+e]<n[""+e]&&t[parseInt(r.toString(),10)][""+e]>n[""+e]&&t.splice(r,0,n)}}function W0(n){var e=document.getElementById(n.diagramId),t=e.ej2_instances,i=t?t[0]:null,r=n.nodeId,a=i.nodes;a===void 0&&(a=N0(i));for(var s="length",o=0;a&&o<a[""+s];o++)if(a[parseInt(o.toString(),10)].id===r)return n.annotationId?yl(a[parseInt(o.toString(),10)],n):a[parseInt(o.toString(),10)];for(var h=i.connectors,o=0;h&&o<h[""+s];o++)if(h[parseInt(o.toString(),10)].id===r)return n.annotationId?yl(h[parseInt(o.toString(),10)],n):h[parseInt(o.toString(),10)];var l=i.enterObject||{};return l.id===r||l.children?l.children&&en(l,"HTML",i.enterTable)?i.enterTable[""+r]||null:l:null}function yl(n,e){var t=n.annotations,i="length",r;for(r=0;t&&r<t[""+i];r++)if(e.annotationId&&t[parseInt(r.toString(),10)].id===e.annotationId)return t[parseInt(r.toString(),10)];return n}function N0(n){for(var e=[],t=0;t<n.palettes.length;t++)for(var i=n.palettes[parseInt(t.toString(),10)].symbols,r=0;r<i.length;r++)i[parseInt(r.toString(),10)]instanceof M&&e.push(i[parseInt(r.toString(),10)]);return e}function ts(n,e,t,i,r,a,s,o){var h={x:0,y:0},l=xt();switch(Rt(l,r,a,s),o.x){case 0:switch(o.y){case 0:h=st(l,{x:n,y:e});break;case .5:h=st(l,{x:n,y:e+i/2});break;case 1:h=st(l,{x:n,y:e+i});break}break;case .5:switch(o.y){case 0:h=st(l,{x:n+t/2,y:e});break;case .5:h=st(l,{x:n+t/2,y:e+i/2});break;case 1:h=st(l,{x:n+t/2,y:e+i});break}break;case 1:switch(o.y){case 0:h=st(l,{x:n+t,y:e});break;case .5:h=st(l,{x:n+t,y:e+i/2});break;case 1:h=st(l,{x:n+t,y:e+i});break}break}return{x:h.x,y:h.y}}var Fe=function(n){return n&&(n.sourceID!==void 0||n.sourcePoint!==void 0||n.targetID!==void 0||n.targetPoint!==void 0||n.type!==void 0?n=B:n=M),n},rh=function(n,e,t,i,r,a){if(!(n.sourceID&&n.targetID))if(!e&&!t&&(e=a===G.Horizontal||a===G.Both,t=a===G.Vertical||a===G.Both),n.wrapper){var s={x:n.sourcePoint.x,y:n.sourcePoint.y},o={x:n.targetPoint.x,y:n.targetPoint.y},h=void 0,l=void 0,d=0;if(r&&n.parentId){var f=i.nameTable[n.parentId],p=f.wrapper;p&&(h=i.groupBounds,l={x:h.center.x,y:h.center.y},d=f.rotateAngle||0)}if(!r)e&&(n.sourcePoint.x=o.x,n.targetPoint.x=s.x),t&&(n.sourcePoint.y=o.y,n.targetPoint.y=s.y),i&&!r&&(n.sourceID="",n.targetID="",i.updateConnectorProperties(n));else if(r&&l)if(d!==0){var c=xt(),u=xt(),g=xt(),v=xt(),m=xt();c=xt(),c[4]=-l.x,c[5]=-l.y,u=xt();var y=-d*Math.PI/180;u[0]=Math.cos(y),u[1]=Math.sin(y),u[2]=-Math.sin(y),u[3]=Math.cos(y),g=xt(),e&&(g[0]=-1),t&&(g[3]=-1),v=xt();var S=d*Math.PI/180;v[0]=Math.cos(S),v[1]=Math.sin(S),v[2]=-Math.sin(S),v[3]=Math.cos(S),m=xt(),m[4]=l.x,m[5]=l.y;var x=function(I,C,P,A){var T={x:I.x,y:I.y},z=I.x-C.x,L=I.y-C.y,R=-d*Math.PI/180,O=z*Math.cos(R)-L*Math.sin(R),N=z*Math.sin(R)+L*Math.cos(R),H=O,F=N;P&&(H=-O),A&&(F=-N);var Y=d*Math.PI/180,et=H*Math.cos(Y)-F*Math.sin(Y),at=H*Math.sin(Y)+F*Math.cos(Y);return T.x=C.x+et,T.y=C.y+at,T};!n.sourceID&&!n.targetID?(n.sourcePoint=x(s,l,e,t),n.targetPoint=x(o,l,e,t)):n.sourceID&&!n.targetID?n.targetPoint=x(o,l,e,t):!n.sourceID&&n.targetID&&(n.sourcePoint=x(s,l,e,t))}else!n.sourceID&&!n.targetID?(e&&(n.sourcePoint.x=2*l.x-s.x,n.targetPoint.x=2*l.x-o.x),t&&(n.sourcePoint.y=2*l.y-s.y,n.targetPoint.y=2*l.y-o.y)):n.sourceID&&!n.targetID?(e&&(n.targetPoint.x=2*l.x-o.x),t&&(n.targetPoint.y=2*l.y-o.y)):!n.sourceID&&n.targetID&&(e&&(n.sourcePoint.x=2*l.x-s.x),t&&(n.sourcePoint.y=2*l.y-s.y));i&&(i.connectorFlipInProgress=!0,i.updateConnectorProperties(n),i.connectorFlipInProgress=!1)}else{var s={x:n.sourcePoint.x,y:n.sourcePoint.y},o={x:n.targetPoint.x,y:n.targetPoint.y};n.flip===G.Horizontal?(n.sourcePoint.x=o.x,n.targetPoint.x=s.x):n.flip===G.Vertical?(n.sourcePoint.y=o.y,n.targetPoint.y=s.y):n.flip===G.Both&&(n.sourcePoint=o,n.targetPoint=s)}},qn=function(n,e,t){var i=t.offset.x,r=t.offset.y;return e===G.Horizontal?(i=1-t.offset.x,r=t.offset.y):e===G.Vertical?(i=t.offset.x,r=1-t.offset.y):e===G.Both&&(i=1-t.offset.x,r=1-t.offset.y),n.setOffsetWithRespectToBounds(i,r,"Fraction"),n},Ca=function(n,e,t,i,r,a,s,o){if(n.hasChildren())for(var h=0,l=n.children;h<l.length;h++){var d=l[h],f=void 0;if(d instanceof Ht){f=i.nameTable[d.id],f&&(a&&(f.flip^=G.Horizontal),s&&(f.flip^=G.Vertical));var p=i.nameTable[d.id];if(p&&p instanceof B&&(a||s||r)){rh(p,a,s,i,!0,r),a&&(p.wrapper.flip^=G.Horizontal),s&&(p.wrapper.flip^=G.Vertical);continue}}var c=n.rotateAngle*(Math.PI/180),u=d.offsetX-e,g=d.offsetY-t,v=u*Math.cos(c)+g*Math.sin(c),m=-u*Math.sin(c)+g*Math.cos(c);(a||r===G.Horizontal||r===G.Both)&&(v=-v),(s||r===G.Vertical||r===G.Both)&&(m=-m);var y=v*Math.cos(c)-m*Math.sin(c),S=v*Math.sin(c)+m*Math.cos(c),x=e+y,I=t+S;if(d instanceof Tt||d.elementActions&le.ElementIsPort||(d.offsetX=x,d.offsetY=I,f&&(f.offsetX=x,f.offsetY=I),d.flipOffset.x=x-d.desiredSize.width/2,d.flipOffset.y=I-d.desiredSize.height/2),o||(d instanceof Ht||d instanceof Je)&&(a&&(d.flip^=G.Horizontal),s&&(d.flip^=G.Vertical),!d.id.includes("group_container")&&!d.id.endsWith("_transaction_events")&&d.children&&(a&&(d.children[0].flip^=G.Horizontal),s&&(d.children[0].flip^=G.Vertical)),Ca(d,e,t,i,r,a,s,o)),d.measure(new U(d.bounds.width,d.bounds.height)),d.arrange(d.desiredSize),!i.groupBounds){var C=i.nameTable[d.id];C&&i.updateConnectorEdges(C)}}},X0=function(n,e){if((!n.children||n.children.length===0)&&n instanceof M){var t=(n.rotateAngle%360+360)%360;n.rotateAngle=t===0?0:360-t,e.nodePropertyChange(n,{},{rotateAngle:n.rotateAngle},void 0,!0)}else{for(var i=[],r=0,a=n.children;r<a.length;r++){var s=a[r],o=e.nameTable[""+s];i[""+s]=o.rotateAngle}var h=(n.rotateAngle%360+360)%360;n.rotateAngle=h===0?0:360-h,e.nodePropertyChange(n,{},{rotateAngle:n.rotateAngle},void 0,!0);for(var l=0,d=n.children;l<d.length;l++){var f=d[l],s=e.nameTable[""+f];if(s instanceof M){var p=i[s.id];if(s){var c=(p%360+360)%360;s.rotateAngle=c===0?0:360-c,e.nodePropertyChange(s,{},{rotateAngle:s.rotateAngle},void 0,!0)}}}}},es=function(n){var e=n.selectedItems.nodes,t=n.selectedItems.connectors,i="isProtectedOnChange",r=n.allowServerDataBinding,a=n[i];n.protectPropertyChange(!0),n.allowServerDataBinding=!1,n.selectedItems.nodes=[],n.selectedItems.connectors=[],n.allowServerDataBinding=r,n.protectPropertyChange(a);for(var s=E(n.selectedItems),o=0;o<e.length;o++)n.selectedItems.nodes.push(n.nameTable[e[o].id]);for(var o=0;o<t.length;o++)n.selectedItems.connectors.push(n.nameTable[t[o].id]);return s},cf=function(n,e){for(var t=new Pt,i,r=0;r<n.length-1;r++){i=gf(n[r],n[r+1]),t.data=i[0],t.id=e.id+"_"+e.shape.sequence;var a=uf(n);t.offsetX=a.x,t.offsetY=a.y,t.rotateAngle=45,t.transform=Zi.Self;break}return t},uf=function(n,e,t){for(var i=10,r,a,s=0,o=0;o<n.length-1;o++)s+=rs(n[parseInt(o.toString(),10)],n[o+1]);var h;t?h=s*t:h=s/2>30?i:s/2;for(var l=0,d=0;d<n.length-1;d++){var f=rs(n[parseInt(d.toString(),10)],n[d+1]);if(l+f>=h){var p=h-l;r=At(n[d],n[d+1]),a=b.transform(n[d],r,p);break}l+=f}return a},is=function(n,e){if(n instanceof M||n instanceof B){for(var t=0;t<n.ports.length;t++)if(n.ports[t].id===e.id.split("_").splice(1).join("_"))return!0}return!1},gf=function(n,e){var t={x:n.x,y:n.y},i=rs(n,e);i=Math.min(10,i/2);var r=At(n,e),a=b.transform({x:t.x,y:t.y},r,i),s=b.transform({x:a.x,y:a.y},r,-11),o=b.transform({x:s.x,y:s.y},r,22),h="M"+s.x+" "+s.y+" L"+o.x+" "+o.y;return[h,a]},rs=function(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))};function mo(){return(navigator.platform.indexOf("Mac")>=0||navigator.platform.indexOf("iPad")>=0||navigator.platform.indexOf("iPhone")>=0||navigator.platform.indexOf("MacIntel")>=0)&&(vt.info.name==="safari"||vt.info.name==="webkit")}function Y0(n){return n.indexOf("shape")!==-1||n.indexOf("pathData")!==-1||n.indexOf("width")!==-1||n.indexOf("height")!==-1}function U0(n,e,t){var i=Sl(n,e,t,"width"),r=Sl(n,e,t,"height");return new U(i,r)}function Sl(n,e,t,i){var r=0;return e.previewSize[""+i]!==void 0?r=e.previewSize[""+i]:n.symbolPreview[""+i]!==void 0?r=n.symbolPreview[""+i]:r=e[""+i]||t.actualSize[""+i],r}function Qn(n,e,t){return n&&n.parentId&&(n=e.nameTable[n.parentId],n.parentId?t=Qn(n,e,t):t=n.id),t}function kn(n,e){return n.selectedItems.connectors.length>1&&n.selectedItems.nodes.length===0&&e.rotateAngle!==0}function F0(n){if(n.arrowType&&n.arrowType.trim()!=="")switch(n.arrowType){case"single-line-arrow":return{targetDecorator:"Arrow",strokeWidth:1};case"double-line-arrow":return{targetDecorator:"Arrow",strokeWidth:2};case"dotted-arrow":return{targetDecorator:"Arrow",strokeDashArray:"2,2"};case"single-line":return{targetDecorator:"None",strokeWidth:1};case"double-line":return{targetDecorator:"None",strokeWidth:2};case"dotted":return{targetDecorator:"None",strokeDashArray:"2,2"};case"wiggly-arrow":return{targetDecorator:"None",strokeWidth:1,opacity:0};default:return{targetDecorator:"Arrow",strokeWidth:1}}return{targetDecorator:"Arrow",strokeWidth:1}}function V0(n,e,t){switch(e+=n.margin.left-n.margin.right,t+=n.margin.top-n.margin.bottom,n.horizontalAlignment){case"Auto":case"Left":e=n.inversedAlignment?e:e-n.desiredSize.width;break;case"Stretch":case"Center":e-=n.desiredSize.width*n.pivot.x;break;case"Right":e=n.inversedAlignment?e-n.desiredSize.width:e;break}switch(n.verticalAlignment){case"Auto":case"Top":t=n.inversedAlignment?t:t-n.desiredSize.height;break;case"Stretch":case"Center":t-=n.desiredSize.height*n.pivot.y;break;case"Bottom":t=n.inversedAlignment?t-n.desiredSize.height:t;break}return{x:e,y:t}}function G0(n,e){var t=e.position.x,i=e.position.y;e.flip===G.Horizontal?t=1-t:(e.flip===G.Vertical||(t=1-t),i=1-i);var r=t*n.width,a=i*n.height,s=n.offsetY-n.height*e.pivot.y+n.padding.top,o=n.offsetX-n.width*e.pivot.x+n.padding.left,h={horizontalAlignment:e.horizontalAlignment,verticalAlignment:e.verticalAlignment,margin:e.margin,desiredSize:e.desiredSize,inversedAlignment:e.inversedAlignment,pivot:e.pivot};(e.flip===G.Horizontal||e.flip===G.Both)&&(h.horizontalAlignment=h.horizontalAlignment==="Left"||e.horizontalAlignment==="Auto"?"Right":h.horizontalAlignment==="Right"?"Left":h.horizontalAlignment),(e.flip===G.Vertical||e.flip===G.Both)&&(h.verticalAlignment=h.verticalAlignment==="Top"||e.verticalAlignment==="Auto"?"Bottom":h.verticalAlignment==="Bottom"?"Top":h.verticalAlignment);var l=o+=r,d=s+=a,f=V0(h,l,d),p={x:f.x+e.desiredSize.width/2,y:f.y+e.desiredSize.height/2},c=e.rotateAngle;if(c!==0||e.parentTransform!==0){var u={x:f.x,y:f.y},g=ad(u,e);g=ye(e.rotateAngle,p.x,p.y,g),g=ye(n.rotateAngle+n.parentTransform,n.offsetX,n.offsetY,g);var v={offsetX:g.x,offsetY:g.y,pivot:e.pivot,actualSize:e.actualSize},m=se(v);f=m.topLeft;var y=xt();Rt(y,c+e.parentTransform,g.x,g.y),f=st(y,f)}return f}function nh(n){return!!(n&&n.flip!==G.None&&(n.flipMode==="Label"||n.flipMode==="PortAndLabel"||n.flipMode==="LabelAndLabelText"||n.flipMode==="All"))}function wl(n,e,t){return t===void 0&&(t=0),n.left-t<=e.x&&n.right+t>=e.x&&n.top-t<=e.y&&n.bottom+t>=e.y}var Z0=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Ue=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Il=(function(n){Z0(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Ue([w("None")],e.prototype,"shape",void 0),Ue([w("white")],e.prototype,"fill",void 0),Ue([w("Auto")],e.prototype,"horizontalAlignment",void 0),Ue([w("Auto")],e.prototype,"verticalAlignment",void 0),Ue([w(10)],e.prototype,"width",void 0),Ue([w(10)],e.prototype,"height",void 0),Ue([X({x:.5,y:1},b)],e.prototype,"offset",void 0),Ue([w("#1a1a1a")],e.prototype,"borderColor",void 0),Ue([w(1)],e.prototype,"borderWidth",void 0),Ue([X({},Ie)],e.prototype,"margin",void 0),Ue([w("")],e.prototype,"pathData",void 0),Ue([w("")],e.prototype,"content",void 0),Ue([w(0)],e.prototype,"cornerRadius",void 0),Ue([X({left:2,right:2,top:2,bottom:2},Ie)],e.prototype,"padding",void 0),Ue([w("#1a1a1a")],e.prototype,"iconColor",void 0),e})(j),$0=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),ah=(function(n){$0(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.orientation="Vertical",t.measureChildren=void 0,t.considerPadding=!0,t}return e.prototype.measure=function(t){var i=this.orientation==="Horizontal"?this.updateHorizontalStack:this.updateVerticalStack;return this.desiredSize=this.measureStackPanel(t,i),this.desiredSize},e.prototype.arrange=function(t){var i=this.orientation==="Horizontal"?this.arrangeHorizontalStack:this.arrangeVerticalStack;return this.actualSize=this.arrangeStackPanel(t,i),this.updateBounds(),this.actualSize},e.prototype.measureStackPanel=function(t,i){var r=void 0;if(this.children!==void 0&&this.children.length>0)for(var a=0,s=this.children;a<s.length;a++){var o=s[a];o.parentTransform=this.rotateAngle+this.parentTransform,this.measureChildren?o.measure(o.desiredSize):o.measure(t);var h=o.desiredSize.clone();this.applyChildMargin(o,h),o.rotateAngle!==0&&(h=oo(h,o.rotateAngle)),r===void 0?r=h:o.preventContainer||i(h,r)}return r=n.prototype.validateDesiredSize.call(this,r,t),this.stretchChildren(r),this.considerPadding&&this.applyPadding(r),r},e.prototype.arrangeStackPanel=function(t,i){if(this.children!==void 0&&this.children.length>0){var r=void 0,a=void 0;r=this.offsetX-t.width*this.pivot.x+this.padding.left,a=this.offsetY-t.height*this.pivot.y+this.padding.top;for(var s=0,o=this.children;s<o.length;s++){var h=o[s],l=h.desiredSize.clone(),d=l;this.orientation==="Vertical"?a+=h.margin.top:r+=h.margin.left,h.rotateAngle!==0&&(d=oo(l,h.rotateAngle));var f=i(r,a,h,this,t,d);n.prototype.findChildOffsetFromCenter.call(this,h,f),h.arrange(l,!0),this.orientation==="Vertical"?a+=d.height+h.margin.bottom:r+=d.width+h.margin.right}}return t},e.prototype.updateHorizontalStack=function(t,i){i.height=Math.max(t.height,i.height),i.width+=t.width},e.prototype.updateVerticalStack=function(t,i){i.width=Math.max(t.width,i.width),i.height+=t.height},e.prototype.arrangeHorizontalStack=function(t,i,r,a,s,o){var h=0;if(r.verticalAlignment==="Top")h=i+r.margin.top+o.height/2;else if(r.verticalAlignment==="Bottom"){var l=a.offsetY+s.height*(1-a.pivot.y);h=l-a.padding.bottom-r.margin.bottom-o.height/2}else h=a.offsetY-s.height*a.pivot.y+s.height/2,r.margin.top&&(h=i+r.margin.top+o.height/2);return{x:t+o.width/2,y:h}},e.prototype.arrangeVerticalStack=function(t,i,r,a,s,o){var h=0;if(r.horizontalAlignment==="Left")h=t+r.margin.left+o.width/2;else if(r.horizontalAlignment==="Right"){var l=a.offsetX+s.width*(1-a.pivot.x);h=l-a.padding.right-r.margin.right-o.width/2}else h=a.offsetX-s.width*a.pivot.x+s.width/2,r.margin.left&&(h=t+r.margin.left+o.width/2);return{x:h,y:i+o.height/2}},e.prototype.stretchChildren=function(t){if(this.children!==void 0&&this.children.length>0)for(var i=0,r=this.children;i<r.length;i++){var a=r[i];this.orientation==="Vertical"?a.horizontalAlignment==="Stretch"&&(a.desiredSize.width=t.width-(a.margin.left+a.margin.right)):a.verticalAlignment==="Stretch"&&(a.desiredSize.height=t.height-(a.margin.top+a.margin.bottom))}},e.prototype.applyChildMargin=function(t,i){i.height+=t.margin.top+t.margin.bottom,i.width+=t.margin.left+t.margin.right},e})(Je);function q0(n,e,t){var i,r="NoWrap";e.shape.classifier==="Class"?i=e.shape.classShape:e.shape.classifier==="Enumeration"?i=e.shape.enumerationShape:e.shape.classifier==="Interface"&&(i=e.shape.interfaceShape),e.container={type:"Stack",orientation:"Vertical"},e.constraints=(W.Default|W.HideThumbs)&~(W.Rotate|W.Resize),e.style={fill:e.style.fill,strokeColor:e.style.strokeColor,strokeWidth:1.5},e.children=[],e.maxWidth&&(r="Wrap");var a=new M(t,"nodes",{id:e.id+"_umlClass_header",offsetX:e.offsetX,offsetY:e.offsetY,annotations:[{id:"name",content:i.name,offset:{x:.5,y:.65},margin:{left:10,right:10},style:{bold:!0,fontSize:14,color:i.style.color,fill:i.style.fill,textWrapping:r}},{content:"<<"+e.shape.classifier+">>",margin:{left:10,right:10},id:"class",style:{fontSize:i.style.fontSize,color:i.style.color,fill:i.style.fill,textWrapping:r},offset:{x:.5,y:.3},constraints:He.ReadOnly}],constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize),verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:e.style.fill,strokeColor:e.style.strokeColor==="black"?"#ffffff00":e.style.strokeColor}},!0);return t.initObject(a),t.nodes.push(a),t.UpdateBlazorDiagramModel(a,"Node"),e.children.push(a.id),Q0(e,t,i,r),K0(e,t,i,r),e.offsetX=e.offsetX,e.offsetY=e.offsetY,e.style.fill=e.style.fill,e.borderColor=e.borderColor,t.initObject(e),n}function Q0(n,e,t,i){if(n.shape.classifier==="Enumeration"){var r=t.members;if(r&&r.length){rn(n,e);for(var a="",s=0;s<r.length;s++){var o=r[parseInt(s.toString(),10)];if(o.name!==""&&(a+=o.name),s!==r.length){var h=dn(n,o),l=new M(e,"nodes",{id:K()+"_umlMember",annotations:[{id:"name",content:a,offset:{x:0,y:.5},style:{bold:!0,fontSize:h.fontSize,color:h.color,fill:h.fill,textWrapping:i,italic:h.italic,fontFamily:h.fontFamily,whiteSpace:h.whiteSpace,textAlign:h.textAlign,textDecoration:h.textDecoration,textOverflow:h.textOverflow},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:n.style.fill,strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor,textWrapping:i},constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize),minHeight:25},!0);e.initObject(l),e.nodes.push(l),e.UpdateBlazorDiagramModel(l,"Node"),n.children.push(l.id),a="",o.isSeparator&&s!==r.length-1&&rn(n,e,o.separatorStyle),o.isSeparator&&s===r.length-1&&(o.isSeparator=!1)}}}}else{var d=t.attributes;if(d.length){var f="";rn(n,e);for(var s=0;s<d.length;s++){var p=void 0,c=d[parseInt(s.toString(),10)];if(c.scope&&c.scope==="Public"?p=" +":c.scope&&c.scope==="Private"?p="-":c.scope&&c.scope==="Protected"?p="#":p="~",c.name!==""&&p&&(f+=p+" "+c.name+" : "+c.type),s!==d.length){var h=dn(n,c),l=new M(e,"nodes",{id:K()+"_umlProperty",style:{fill:n.style.fill,strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor},annotations:[{id:"name",content:f,offset:{x:0,y:.5},style:{bold:!0,fontSize:h.fontSize,color:h.color,fill:h.fill,textWrapping:i,italic:h.italic,fontFamily:h.fontFamily,whiteSpace:h.whiteSpace,textAlign:h.textAlign,textDecoration:h.textDecoration,textOverflow:h.textOverflow},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize),minHeight:25},!0);e.initObject(l),e.nodes.push(l),e.UpdateBlazorDiagramModel(l,"Node"),n.children.push(l.id),f="",c.isSeparator&&s!==d.length-1&&rn(n,e,c.separatorStyle),c.isSeparator&&s===d.length-1&&(c.isSeparator=!1)}}}}}function J0(n,e,t,i){if(n.shape.classifier==="Enumeration"){var r=t.members,a="";if(r.length===1){var s=r.length;sh(n,e,s)}for(var o=0,h=0;h<r.length-1;h++)r[parseInt(h.toString(),10)].isSeparator===!0&&o++;for(var l=r.length+o+1,h=0;h<r.length;h++){var d=r[r.length-1];if(d.name!==""&&(a+=d.name),h!==r.length){var f=dn(n,d),p=new M(e,"nodes",{id:K()+"_umlMember",annotations:[{id:"name",content:a,offset:{x:0,y:.5},style:{bold:!0,fontSize:f.fontSize,color:f.color,fill:f.fill,textWrapping:i,italic:f.italic,fontFamily:f.fontFamily,whiteSpace:f.whiteSpace,textAlign:f.textAlign,textDecoration:f.textDecoration,textOverflow:f.textOverflow},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{fill:n.style.fill,strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor,textWrapping:i},constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize),minHeight:25},!0);p.parentId=n.id,p.umlIndex=l,e.add(p),a=""}break}}}function _0(n,e,t,i){if(t.attributes&&t.attributes.length){var r=t.attributes,a="",s=void 0;if(r.length===1){var o=r.length;sh(n,e,o)}for(var h=0,l=0;l<r.length-1;l++)r[parseInt(l.toString(),10)].isSeparator===!0&&h++;for(var d=r.length+h+1,l=0;l<r.length;l++){var f=r[r.length-1];if(f.scope&&f.scope==="Public"?s=" +":f.scope&&f.scope==="Private"?s="-":f.scope&&f.scope==="Protected"?s="#":s="~",f.name!==""&&s&&(a+=s+" "+f.name+" : "+f.type),l!==r.length){var p=dn(n,f),c=new M(e,"nodes",{id:K()+"_umlProperty",style:{fill:n.style.fill,strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor},annotations:[{id:"name",content:a,offset:{x:0,y:.5},style:{bold:!0,fontSize:p.fontSize,color:p.color,fill:p.fill,textWrapping:i,italic:p.italic,fontFamily:p.fontFamily,whiteSpace:p.whiteSpace,textAlign:p.textAlign,textDecoration:p.textDecoration,textOverflow:p.textOverflow},margin:{left:14,right:5},horizontalAlignment:"Left"}],verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize),minHeight:25},!0);c.parentId=n.id,c.umlIndex=d,e.add(c),a=""}break}}}function K0(n,e,t,i){if(t.methods&&t.methods.length){var r=t.methods;rn(n,e);for(var a="",s="",o=void 0,h=0;h<r.length;h++){var l=r[parseInt(h.toString(),10)];if(l.scope&&l.scope==="Public"?o=" +":l.scope&&l.scope==="Private"?o="-":l.scope&&l.scope==="Protected"?o="#":o="~",l.parameters)for(var d=0;d<l.parameters.length;d++)l.parameters[parseInt(d.toString(),10)].type?a+=l.parameters[parseInt(d.toString(),10)].name+":"+l.parameters[parseInt(d.toString(),10)].type:a+=l.parameters[parseInt(d.toString(),10)].name,d!==l.parameters.length-1&&(a+=",");if(l.name!==""&&(o&&(s+=o+" "+l.name+"("+a+") : "+l.type),a=""),h!==r.length){var f=dn(n,l),p=new M(e,"nodes",{id:K()+"_umlMethods",verticalAlignment:"Stretch",horizontalAlignment:"Stretch",annotations:[{id:"name",content:s,offset:{x:0,y:.5},style:{bold:!0,fontSize:f.fontSize,color:f.color,fill:f.fill,textWrapping:i,italic:f.italic,fontFamily:f.fontFamily,whiteSpace:f.whiteSpace,textAlign:f.textAlign,textDecoration:f.textDecoration,textOverflow:f.textOverflow},margin:{left:14,right:5},horizontalAlignment:"Left"}],style:{fill:n.style.fill,strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor},minHeight:25,constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize)},!0);e.initObject(p),e.nodes.push(p),e.UpdateBlazorDiagramModel(p,"Node"),n.children.push(p.id),s="",l.isSeparator&&h!==r.length-1&&rn(n,e,l.separatorStyle),l.isSeparator&&h===r.length-1&&(l.isSeparator=!1)}}}}function j0(n,e,t,i){if(t.methods&&t.methods.length){var r=t.methods,a="",s="",o=void 0,h=1,l=void 0,d=0,f=0,p=n.shape,c=p.classifier==="Class";p.classifier;var u=c?p.classShape:p.interfaceShape;r.length===1?u.attributes.length>0?(d=u.attributes.filter(function(x){return x.isSeparator}).length,h=2+u.attributes.length+d,l=h+1,sh(n,e,h)):l=h+1:(d=u.attributes.filter(function(x){return x.isSeparator}).length,f=u.methods.filter(function(x){return x.isSeparator}).length,h=2+u.attributes.length+d+u.methods.length+f,l=h+1);for(var g=0;g<r.length;g++){var v=r[r.length-1];if(v.scope&&v.scope==="Public"?o=" +":v.scope&&v.scope==="Private"?o="-":v.scope&&v.scope==="Protected"?o="#":o="~",v.parameters)for(var m=0;m<v.parameters.length;m++)v.parameters[parseInt(m.toString(),10)].type?a+=v.parameters[parseInt(m.toString(),10)].name+":"+v.parameters[parseInt(m.toString(),10)].type:a+=v.parameters[parseInt(m.toString(),10)].name,m!==v.parameters.length-1&&(a+=",");if(v.name!==""&&o&&(s+=o+" "+v.name+"("+a+") : "+v.type),g!==r.length){var y=dn(n,v),S=new M(e,"nodes",{id:K()+"_umlMethods",verticalAlignment:"Stretch",horizontalAlignment:"Stretch",annotations:[{id:"name",content:s,offset:{x:0,y:.5},style:{bold:!0,fontSize:y.fontSize,color:y.color,fill:y.fill,textWrapping:i,italic:y.italic,fontFamily:y.fontFamily,whiteSpace:y.whiteSpace,textAlign:y.textAlign,textDecoration:y.textDecoration,textOverflow:y.textOverflow},margin:{left:14,right:5},horizontalAlignment:"Left"}],style:{fill:n.style.fill,strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor},minHeight:25,constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize)},!0);S.parentId=n.id,S.umlIndex=l,e.add(S),s=""}break}}}function rn(n,e,t){var i=new M(e,"nodes",{id:K()+"_path",height:1,constraints:W.Default&~W.Select,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor,fill:t?t.fill:"white"}},!0);e.initObject(i),e.nodes.push(i),n.children.push(i.id)}function sh(n,e,t){var i=new M(e,"nodes",{id:K()+"_path",height:1,constraints:W.Default&~W.Select,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",style:{strokeColor:n.style.strokeColor==="black"?"#ffffff00":n.style.strokeColor,fill:"white"}},!0);i.parentId=n.id,i.umlIndex=t,e.add(i)}function dn(n,e){var t={},i=e.style;return t.fill=i.fill!=="transparent"?i.fill:n.style.fill,t.color=i.color,t.fontFamily=i.fontFamily!=="Arial"?i.fontFamily:n.style.fontFamily,t.italic=i.italic,t.bold=i.bold,t.whiteSpace=i.whiteSpace,t.textAlign=i.textAlign,t.textWrapping=i.textWrapping,t.textDecoration=i.textDecoration,t.textOverflow=i.textOverflow,t.fontSize=i.fontSize!==12?i.fontSize:n.style.fontSize,t.strokeColor=i.strokeColor!=="black"?i.strokeColor:n.style.strokeColor,t.strokeWidth=i.strokeWidth!==1?i.strokeWidth:n.style.strokeWidth,t}var ty=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),er=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},ey=(function(n){ty(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return er([w("Horizontal")],e.prototype,"orientation",void 0),er([w("Center")],e.prototype,"type",void 0),er([w(void 0)],e.prototype,"offset",void 0),er([w(!1)],e.prototype,"enableRouting",void 0),er([w([])],e.prototype,"children",void 0),er([w("")],e.prototype,"assistants",void 0),er([w("")],e.prototype,"level",void 0),er([w("")],e.prototype,"hasSubTree",void 0),er([w("")],e.prototype,"rows",void 0),e})(j);function iy(n,e,t){return n=ry(n,e,t),n}function xl(n,e){n.style.fill=e.style.fill,n.style.strokeColor=e.style.strokeColor,n.style.strokeWidth=e.style.strokeWidth,n.style.strokeDashArray=e.style.strokeDashArray,n.style.opacity=e.style.opacity,n.style.gradient=e.style.gradient,(e.constraints&W.Shadow)!==0&&e.visible&&(n.shadow=e.shadow)}function ry(n,e,t){var i=new Ht;xl(i,e),i.id=e.id+"_container";var r=ny(e,n);if(e.width=r.width,e.height=r.height,n.id=e.id+"_content",n.width=r.width,n.height=r.height,xl(n,e),i.children=[n],e.shape.header&&e.shape.hasHeader){var a=sy(t,e);i.children.push(a)}var s=e.shape;if(e.shape.children&&e.shape.children.length>0)for(var o=0;o<s.children.length;o++){var h=t.nameTable[s.children[parseInt(o.toString(),10)]];if(h&&(!h.parentId||h.parentId===e.id)){h.parentId=e.id,h.margin.left||(h.margin.left=10),h.margin.top||(h.margin.top=10),e.shape.header&&e.shape.hasHeader&&!t.isLoading&&!(t.diagramActions&k.UndoRedo)&&(h.margin.top+=e.shape.header.height);var l=e.offsetX-e.width*e.pivot.x+(h.margin.left+h.width*h.pivot.x),d=e.offsetY-e.height*e.pivot.y+(h.margin.top+h.height*h.pivot.y);(h.offsetX!==l||h.offsetY!==d)&&(h.offsetX=l,h.offsetY=d),i.children.push(h.wrapper),vf(t,h)}}return i.width=e.width,i.height=e.height,i}function ny(n,e){var t=new U(n.width,n.height);return e instanceof Pt||(t.width=t.width||50,t.height=t.height||50),e.actualSize.width&&e.actualSize.height?e.actualSize:(n.maxWidth!==void 0&&(t.width=Math.min(t.width,n.maxWidth)),n.maxHeight!==void 0&&(t.height=Math.min(t.height,n.maxHeight)),n.minWidth!==void 0&&(t.width=Math.max(t.width,n.minWidth)),n.minHeight!==void 0&&(t.height=Math.max(t.height,n.minHeight)),t)}function ay(n,e,t,i,r){if(i.children[0].width=n.width,i.children[0].height=n.height,t.shape.header&&t.shape.hasHeader){var a=r.nameTable[t.id+t.shape.header.id];a.wrapper.children[0].width=n.width,a.wrapper.measure(new U(a.wrapper.bounds.width,a.wrapper.bounds.height)),a.wrapper.arrange(a.wrapper.desiredSize)}}function sy(n,e){var t=e.shape;t.header.id=t.header.id||K();var i={id:e.id+t.header.id,annotations:[E(t.header.annotation)],style:t.header.style,offsetX:e.offsetX,offsetY:e.offsetY,height:t.header.height,width:e.width},r=oy(n,e,i,!0);return r}function oy(n,e,t,i){var r=new M(n,"nodes",t,!0);if(r.parentId=e.id,r.isHeader=i,r.constraints&=~(W.InConnect|W.OutConnect),r.constraints|=W.HideThumbs,n.initObject(r),n.nodes.push(r),r.wrapper.children.length>0){for(var a=0;a<r.wrapper.children.length;a++){var s=r.wrapper.children[parseInt(a.toString(),10)];s instanceof Be&&(s.isCalculateDesiredSize=!1),s instanceof Tt&&(s.canConsiderBounds=!1)}r.wrapper.measure(new U(void 0,void 0)),r.wrapper.arrange(r.wrapper.desiredSize)}return r.wrapper.measure(new U(void 0,void 0)),r.wrapper.arrange(r.wrapper.desiredSize),r.wrapper}function vf(n,e){var t=e,i=n.getIndex(t,t.id),r=n.layers.indexOf(n.commandHandler.getObjectLayer(e.id)),a=n.layers[parseInt(r.toString(),10)];n.nodes.splice(Number(i),1),delete a.zIndexTable[t.zIndex],t.zIndex=a.objectZIndex+1,n.nodes.push(t),a.zIndexTable[t.zIndex]=t.id}function mf(n,e,t){var i=t.nameTable[n.id].shape;if(t.currentSymbol&&n.shape.type==="Container"){e.parentId=n.id;return}i.children=i.children||[];var r=E(e),a=t.nameTable[e.id].wrapper,s=t.nameTable[n.id].wrapper;a.margin.top=a.offsetY-a.actualSize.height/2-(n.offsetY-n.actualSize.height/2),a.margin.left=a.offsetX-a.actualSize.width/2-(n.offsetX-n.actualSize.width/2),t.nameTable[e.id].parentId=n.id,i.children.push(e.id),s.children[0].children.push(t.nameTable[e.id].wrapper);var o=Rn(n,e.id,t);ns(o,e,t,!1),a.margin.left<0&&(a.margin.left=10),(a.margin.top<0||i.hasHeader&&a.margin.top<i.header.height)&&(a.margin.top=10,i.hasHeader&&(a.margin.top+=i.header.height)),s.measure(new U(void 0,void 0)),s.arrange(s.desiredSize);var h=E(e),l={type:"PositionChanged",undoObject:{nodes:[r]},redoObject:{nodes:[h]},category:"Internal"};if(t.addHistoryEntry(l),t.mode==="SVG"){e.zIndex<n.zIndex&&(t.moveSvgNode(e.id),vf(t,e));var d=St(n.id+"_groupElement");d.appendChild(St(e.id+"_groupElement"))}}function Rn(n,e,t){var i=n.shape.children,r;if(i&&i.length)for(var a=0;a<i.length;a++){var s=i[parseInt(a.toString(),10)];e!==s&&(r?r=t.nameTable[""+s].wrapper.bounds.uniteRect(r):r=t.nameTable[""+s].wrapper.bounds)}return r||t.nameTable[""+e].wrapper.bounds}function ns(n,e,t,i){var r,a,s=t.nameTable[e.parentId],o={x:.5,y:.5},h=s.wrapper.actualSize,l=0;s.shape.hasHeader&&(l=s.shape.header.height),s.wrapper.bounds.left+e.margin.left+e.width>s.wrapper.bounds.right?(o.x=0,r=(e.wrapper.margin.left+e.wrapper.bounds.width)/h.width):e.margin.left<0&&(o.x=1,r=(e.wrapper.bounds.x+e.wrapper.bounds.width)/s.wrapper.bounds.x),s.wrapper.bounds.top+e.margin.top+e.height>s.wrapper.bounds.bottom?(o.y=0,a=(e.wrapper.margin.top+e.wrapper.bounds.height)/h.height):e.margin.top<l&&!i&&(o.y=1,a=(e.wrapper.bounds.y+e.wrapper.bounds.height)/s.wrapper.bounds.y),(r>0||a>0)&&s.constraints&W.Resize&&t.commandHandler.scale(t.nameTable[e.parentId],r||1,a||1,o)}function hy(n,e,t,i){var r=e.nameTable[n.parentId],a=0;r.shape.hasHeader&&(a=r.shape.header.height);var s={top:n.margin.top+i-a>=0?n.margin.top+i:n.margin.top,left:n.margin.left+t>=0?n.margin.left+t:n.margin.left};(s.top!==n.margin.top||s.left!==n.margin.left)&&e.nodePropertyChange(n,{},{margin:s});var o=Rn(r,n.id,e);ns(o,n,e,!0),r.wrapper.measure(new U(void 0,void 0)),r.wrapper.arrange(r.wrapper.desiredSize),e.updateSelector(),as(r,e)}function ly(n,e){for(var t=e.nameTable[n.parentId].wrapper.children[0].children,i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].id===n.wrapper.id&&(t[parseInt(i.toString(),10)].offsetX===n.wrapper.offsetX||t[parseInt(i.toString(),10)].offsetY===n.wrapper.offsetY)){t[parseInt(i.toString(),10)]=n.wrapper;break}}function as(n,e){var t=n.shape.children;if(t)for(var i=0,r=t;i<r.length;i++){var a=r[i],s=e.nameTable[""+a];s&&(e.updateConnectorEdges(s),s.wrapper.measure(new U(s.wrapper.width,s.wrapper.height)),s.wrapper.arrange(s.wrapper.desiredSize),s.shape.children&&s.shape.children.length&&as(s,e))}else return}function dy(n,e){var t=e.nameTable[n.parentId];if(n.shape.type==="Container"){if(n.shape.children&&n.shape.children.length>0)for(var i=n.shape.children,r=i.length-1;r>=0;r--)e.remove(e.nameTable[i[parseInt(r.toString(),10)]]);n.shape.hasHeader&&e.remove(e.nameTable[n.id+n.shape.header.id])}if(t){e.removeDependentConnector(n);var i=t.shape.children;if(gs(t.wrapper,n.id,e,!0),i){var a=i.indexOf(n.id);i.splice(a,1)}}}function gs(n,e,t,i){for(var r=0,a=n.children;r<a.length;r++){var s=a[r];if(s.id===e){if(n.children.splice(n.children.indexOf(s),1),!i){var o=document.getElementById(s.id+"_groupElement"),h=document.getElementById(t.element.id+"_diagramLayer"),l=o.parentElement;l.removeChild(o),h.appendChild(o)}}else s.children&&gs(s,e,t,i)}}function yf(n,e,t){var i=n.id,r=t.nameTable[""+i],a=E(r);r||(t.add(n),r=t.nameTable[""+i]),n.parentId=e;var s=t.nameTable[""+e],o=s.shape;if(o.children||(o.children=[]),r&&s){r.parentId=e,(r.margin.top<=0||s.shape.hasHeader&&r.margin.top<s.shape.header.height)&&(r.margin.top=10,s.shape.hasHeader&&(r.margin.top+=s.shape.header.height)),r.margin.left<=0&&(r.margin.left=10);var h=s.offsetX-s.width*s.pivot.x+(r.margin.left+r.width*r.pivot.x),l=s.offsetY-s.height*s.pivot.y+(r.margin.top+r.height*r.pivot.y);(r.offsetX!==h||r.offsetY!==l)&&(r.offsetX=h,r.offsetY=l);var d=o.children;if(d.indexOf(i)<0&&d.push(i),s.wrapper.children.push(r.wrapper),s.wrapper.measure(new U),s.wrapper.arrange(s.wrapper.desiredSize),t.refreshDiagramLayer(),!(t.diagramActions&k.UndoRedo)&&(!t.historyManager.currentEntry||t.historyManager.currentEntry.type!=="CollectionChanged")){var f=E(r),p={type:"PositionChanged",undoObject:{nodes:[a]},redoObject:{nodes:[f]},category:"Internal"};t.addHistoryEntry(p)}if(t.mode==="SVG"){var c=St(e+"_groupElement");c.appendChild(St(n.id+"_groupElement"))}}}function fy(n,e){var t=n.id,i=e.nameTable[n.parentId];if(i){var r=i.shape.children;gs(i.wrapper,t,e,!0);var a=r.indexOf(t);r.splice(a,1),n.parentId="",e.refreshDiagramLayer(),e.updateSelector()}}var kt=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),D=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},py=function(n){if(n)switch(n.type){case"Basic":return Pa;case"Flow":return xf;case"Path":return Sf;case"Image":return If;case"Text":return Ur;case"Bpmn":return fh;case"Native":return Jn;case"HTML":return wf;case"UmlActivity":return Cf;case"UmlClassifier":return Pf;case"SwimLane":return Br;case"Container":return n.header||(n.hasHeader=!1),Sr;default:return Pa}return Pa},ri=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return D([w("Basic")],e.prototype,"type",void 0),e})(j),Sf=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Path"},D([w("Path")],e.prototype,"type",void 0),D([w("")],e.prototype,"data",void 0),e})(ri),Jn=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Native"},D([w("Native")],e.prototype,"type",void 0),D([w("")],e.prototype,"content",void 0),D([w("Stretch")],e.prototype,"scale",void 0),e})(ri),wf=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Html"},D([w("HTML")],e.prototype,"type",void 0),D([w("")],e.prototype,"content",void 0),e})(ri),If=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Image"},D([w("Image")],e.prototype,"type",void 0),D([w("")],e.prototype,"source",void 0),D([w("None")],e.prototype,"scale",void 0),D([w("None")],e.prototype,"align",void 0),e})(ri),Ur=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Text"},D([w("Text")],e.prototype,"type",void 0),D([w("")],e.prototype,"content",void 0),D([X({},Ie)],e.prototype,"margin",void 0),e})(ri),Pa=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BasicShape"},D([w("Basic")],e.prototype,"type",void 0),D([w("Rectangle")],e.prototype,"shape",void 0),D([w(0)],e.prototype,"cornerRadius",void 0),D([Lt([],b)],e.prototype,"points",void 0),e})(ri),xf=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"FlowShape"},D([w("Flow")],e.prototype,"type",void 0),D([w("Terminator")],e.prototype,"shape",void 0),e})(ri),oh=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BpmnGateway"},D([w("None")],e.prototype,"type",void 0),e})(j),hh=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BpmnDataObject"},D([w("None")],e.prototype,"type",void 0),D([w(!1)],e.prototype,"collection",void 0),e})(j),cy=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return D([w("None")],e.prototype,"type",void 0),D([w("None")],e.prototype,"loop",void 0),D([w(!1)],e.prototype,"call",void 0),D([w(!1)],e.prototype,"compensation",void 0),e})(j),lh=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BpmnEvent"},D([w("Start")],e.prototype,"event",void 0),D([w("None")],e.prototype,"trigger",void 0),e})(j),Ir=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BpmnSubEvent"},D([w("None")],e.prototype,"trigger",void 0),D([w("Start")],e.prototype,"event",void 0),D([w("")],e.prototype,"id",void 0),D([X({},b)],e.prototype,"offset",void 0),D([Lt([],ae)],e.prototype,"annotations",void 0),D([Lt([],Se)],e.prototype,"ports",void 0),D([w()],e.prototype,"width",void 0),D([w()],e.prototype,"height",void 0),D([X({},Ie)],e.prototype,"margin",void 0),D([w("Center")],e.prototype,"horizontalAlignment",void 0),D([w("Center")],e.prototype,"verticalAlignment",void 0),D([w(!0)],e.prototype,"visible",void 0),e})(j),uy=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return D([X({id:"success",event:"End",offset:{x:1,y:.5}},Ir)],e.prototype,"success",void 0),D([X({id:"failure",event:"Intermediate",trigger:"Error",offset:{x:.25,y:1}},Ir)],e.prototype,"failure",void 0),D([X({id:"cancel",event:"Intermediate",trigger:"Cancel",offset:{x:.75,y:1}},Ir)],e.prototype,"cancel",void 0),e})(j),gy=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return D([w("None")],e.prototype,"type",void 0),D([w(!1)],e.prototype,"adhoc",void 0),D([w("Default")],e.prototype,"boundary",void 0),D([w(!1)],e.prototype,"compensation",void 0),D([w("None")],e.prototype,"loop",void 0),D([w(!0)],e.prototype,"collapsed",void 0),D([Lt([],Ir)],e.prototype,"events",void 0),D([X({},uy)],e.prototype,"transaction",void 0),D([w(void 0)],e.prototype,"processes",void 0),e})(j),dh=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BpmnActivity"},D([w("Task")],e.prototype,"activity",void 0),D([X({},cy)],e.prototype,"task",void 0),D([X({},gy)],e.prototype,"subProcess",void 0),e})(j),_n=(function(n){kt(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return e.prototype.getClassName=function(){return"BpmnAnnotation"},D([w("")],e.prototype,"text",void 0),D([w("")],e.prototype,"id",void 0),D([w(0)],e.prototype,"angle",void 0),D([w()],e.prototype,"height",void 0),D([w()],e.prototype,"width",void 0),D([w(0)],e.prototype,"length",void 0),e})(j),vy=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return D([w("")],e.prototype,"textAnnotationTarget",void 0),D([w("Auto")],e.prototype,"textAnnotationDirection",void 0),e})(j),fh=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"BpmnShape"},D([w("Bpmn")],e.prototype,"type",void 0),D([w("Event")],e.prototype,"shape",void 0),D([X({},lh)],e.prototype,"event",void 0),D([X({},oh)],e.prototype,"gateway",void 0),D([X({},hh)],e.prototype,"dataObject",void 0),D([X({},dh)],e.prototype,"activity",void 0),D([X({},_n)],e.prototype,"annotation",void 0),D([Lt([],_n)],e.prototype,"annotations",void 0),D([X({},vy)],e.prototype,"textAnnotation",void 0),e})(ri),Cf=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlActivityShape"},D([w("UmlActivity")],e.prototype,"type",void 0),D([w("Action")],e.prototype,"shape",void 0),e})(ri),ph=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"MethodArguments"},D([w("")],e.prototype,"name",void 0),D([w("")],e.prototype,"type",void 0),D([X({},cn)],e.prototype,"style",void 0),e})(j),fn=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlClassAttribute"},D([w("Public")],e.prototype,"scope",void 0),D([w(!1)],e.prototype,"isSeparator",void 0),D([X({fill:"#F9F9F9",strokeColor:"#CCCCCC"},Qi)],e.prototype,"separatorStyle",void 0),e})(ph),Kn=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlClassMethod"},D([Lt([],ph)],e.prototype,"parameters",void 0),e})(fn),vs=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlClass"},D([w("")],e.prototype,"name",void 0),D([Lt([],fn)],e.prototype,"attributes",void 0),D([Lt([],Kn)],e.prototype,"methods",void 0),D([X({},cn)],e.prototype,"style",void 0),e})(j),ch=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlInterface"},D([w(!1)],e.prototype,"isSeparator",void 0),D([X({fill:"#F9F9F9",strokeColor:"#CCCCCC"},Qi)],e.prototype,"separatorStyle",void 0),e})(vs),ms=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlEnumerationMember"},D([w("")],e.prototype,"name",void 0),D([w("")],e.prototype,"value",void 0),D([w(!1)],e.prototype,"isSeparator",void 0),D([X({fill:"#F9F9F9",strokeColor:"#CCCCCC"},Qi)],e.prototype,"separatorStyle",void 0),D([X({},cn)],e.prototype,"style",void 0),e})(j),uh=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlEnumeration"},D([w("")],e.prototype,"name",void 0),D([Lt([],ms)],e.prototype,"members",void 0),D([X({},cn)],e.prototype,"style",void 0),e})(j),Pf=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"UmlClassifierShape"},D([w("UmlClassifier")],e.prototype,"type",void 0),D([X({},vs)],e.prototype,"classShape",void 0),D([X({},ch)],e.prototype,"interfaceShape",void 0),D([X({},uh)],e.prototype,"enumerationShape",void 0),D([w("Class")],e.prototype,"classifier",void 0),e})(ri);(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"DiagramShape"},D([w("Basic")],e.prototype,"type",void 0),D([w("Rectangle")],e.prototype,"basicShape",void 0),D([w("Terminator")],e.prototype,"flowShape",void 0),D([w("Event")],e.prototype,"bpmnShape",void 0),D([w("Action")],e.prototype,"umlActivityShape",void 0),D([w("")],e.prototype,"data",void 0),D([w("")],e.prototype,"content",void 0),D([w("")],e.prototype,"textContent",void 0),D([w("Stretch")],e.prototype,"scale",void 0),D([w("")],e.prototype,"source",void 0),D([w("None")],e.prototype,"align",void 0),D([X({},Ie)],e.prototype,"margin",void 0),D([w(0)],e.prototype,"cornerRadius",void 0),D([Lt([],b)],e.prototype,"points",void 0),D([X({},hh)],e.prototype,"dataObject",void 0),D([X({},lh)],e.prototype,"event",void 0),D([X({},oh)],e.prototype,"gateway",void 0),D([Lt([],_n)],e.prototype,"annotations",void 0),D([X({},dh)],e.prototype,"activity",void 0),D([X({},_n)],e.prototype,"annotation",void 0),D([X({},uh)],e.prototype,"enumerationShape",void 0),D([w("Class")],e.prototype,"classifier",void 0),D([X({},vs)],e.prototype,"classShape",void 0),D([X({},ch)],e.prototype,"interfaceShape",void 0),e})(j);var M=(function(n){kt(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;s.isCanvasUpdate=!1,s.status="None",s.parentId="",s.showDefaultTooltipForPalette=!0,s.processId="",s.umlIndex=-1,s.outEdges=[],s.inEdges=[],s.isHeader=!1,s.isLane=!1,s.isPhase=!1,s.laneGrids=[];var o;return s.children&&s.children.length>0&&(o=r,(!o.style||!o.style.fill)&&(s.style.fill="transparent"),(!o.style||!o.style.strokeColor)&&(s.style.strokeColor="transparent")),s.shape&&s.shape.type==="UmlActivity"&&us(r,s),s.shape&&(s.shape.type==="SwimLane"||s.shape.type==="Container")&&nf(r,s),s.ports&&s.ports.length&&o0(s),s}return Object.defineProperty(e.prototype,"actualSize",{get:function(){return this.wrapper!==null?this.wrapper.actualSize:new U(this.width||0,this.height||0)},enumerable:!0,configurable:!0}),e.prototype.init=function(t){var i;this.shape.type!=="SwimLane"?i=new Be:i=new Fn;var r,a="changedProperties",s="oldProperties";switch(this.shape[""+a]={},this.shape[""+s]={},this.shape.type){case"Path":if(this.type==="Freehand"){var o=new Pt;o.data=ao(this.shape.points),i=o}else{var h=new Pt;h.data=this.shape.data,i=h}break;case"Image":var l=new wr;l.source=this.shape.source,l.imageAlign=this.shape.align,l.imageScale=this.shape.scale,i=l;break;case"Text":var d=new Tt;d.content=this.shape.content,i=d,r=this.style,i.style=r;break;case"Basic":if(this.shape.shape==="Rectangle"){var f=new Be;i=f,i.cornerRadius=this.shape.cornerRadius}else if(this.shape.shape==="Polygon"){var o=new Pt;o.data=To(this.shape.points),i=o}else{var f=new Pt,p=ka(this.shape.shape);f.data=p,i=f}break;case"Flow":var c=new Pt,u=Yo(this.shape.shape);c.data=u,i=c;break;case"UmlActivity":var g=new Pt;i=z0(g,i,this);break;case"Bpmn":if(t.bpmnModule){this.shape.activity&&this.shape.activity.activity==="SubProcess"&&this.shape.activity.subProcess.collapsed===!1&&(this.flip=G.None,this.wrapper.flip=G.None),i=t.bpmnModule.initBPMNContent(i,this,t),this.wrapper.elementActions=this.wrapper.elementActions|le.ElementIsGroup;var v=this.shape.activity.subProcess;if(v.processes&&v.processes.length)for(var m=this.shape.activity.subProcess.processes,y=0,S=m;y<S.length;y++){var x=S[y];t.nameTable[""+x]&&(!t.nameTable[""+x].processId||t.nameTable[""+x].processId===this.id)&&(t.nameTable[""+x].processId=this.id,v.collapsed&&t.updateElementVisibility(t.nameTable[""+x].wrapper,t.nameTable[""+x],!v.collapsed),i.children.push(t.nameTable[""+x].wrapper))}}else console.warn('[WARNING] :: Module "BpmnDiagrams" is not available in Diagram component! You either misspelled the module name or forgot to load it.');break;case"Native":t.initNodeTemplate=!0;var I=new li(this.id,t.element.id,t.nodeTemplate);!this.shape.content&&!t.nodeTemplate||this.shape.content&&(typeof this.shape.content=="string"||!t.isReact)?I.content=this.shape.content:t.nodeTemplate&&(I.isTemplate=!0,I.template=I.content=Ai(I,!1,this)),this.shape.content&&typeof this.shape.content=="function"&&t.isReact&&(I.isTemplate=!0,I.templateFn=Re(this.shape.content),I.template=I.content=Ai(I,!1,this)),I.scale=this.shape.scale,i=I,t.initNodeTemplate=!1;break;case"HTML":t.initNodeTemplate=!0;var C=new we(this.id,t.element.id,void 0,t.nodeTemplate);this.shape.content&&(typeof this.shape.content=="string"||!t.isReact)?C.content=this.shape.content:t.nodeTemplate&&(C.isTemplate=!0,C.template=C.content=Ai(C,!0,this)),this.shape.content&&typeof this.shape.content=="function"&&t.isReact&&(C.isTemplate=!0,C.templateFn=Re(this.shape.content),C.template=C.content=Ai(C,!0,this)),i=C,t.initNodeTemplate=!1;break;case"UmlClassifier":i=q0(i,this,t);break;case"Container":this.constraints|=W.ReadOnly|W.AllowDrop,this.flip=G.None,this.wrapper.flip=G.None,i=iy(i,this,t);break;case"SwimLane":this.annotations=[],this.ports=[],this.flip=G.None,this.wrapper.flip=G.None,i.cellStyle.fill="none",i.cellStyle.strokeColor="none",this.container={type:"Grid",orientation:this.shape.orientation},i.id=this.id,i.pivot=this.pivot,this.container.orientation=this.shape.orientation,this.constraints|=W.HideThumbs,_v(i,t,this);break}return i.id=this.id+"_content",i.relativeMode="Object",this.shape.type==="Basic"&&this.shape.shape==="Rectangle"?i.shapeType="Rectangle":i.shapeType="Others",this.width!==void 0&&(i.width=this.width),i.horizontalAlignment="Stretch",this.height!==void 0&&(i.height=this.height),this.minHeight!==void 0&&(i.minHeight=this.minHeight),this.maxHeight!==void 0&&(i.maxHeight=this.maxHeight),this.minWidth!==void 0&&(i.minWidth=this.minWidth),this.maxWidth!==void 0&&(i.maxWidth=this.maxWidth),this.shape.shape==="Rectangle"&&!this.shape.cornerRadius&&(i.isRectElement=!0),i.verticalAlignment="Stretch",this.shape instanceof Ur&&(i.margin=this.shape.margin),Ia(this)&&this.type!=="Freehand"&&(this.shape.type!=="Bpmn"||this.shape.shape==="TextAnnotation")&&(this.constraints&W.Shadow)!==0&&this.visible&&(i.shadow=this.shadow),(this.shape.type!=="Bpmn"||this.shape.shape==="Message"||this.shape.shape==="DataSource")&&(this.shape.type!=="UmlActivity"||this.shape.shape!=="FinalNode")&&this.shape.type!=="Text"&&(i.style=this.style,this.oldGradientValue=this.style.gradient?E(this.style.gradient):null),(!(this.wrapper.elementActions&le.ElementIsGroup)&&this.flip===G.Horizontal||this.flip===G.Vertical)&&(i.flip=this.flip,i.flipMode=this.flipMode),i},e.prototype.initContainer=function(){this.id||(this.id=K());var t;if(!this.container||this.shape instanceof Br||this.shape.type==="Container")t=this.children?new Je:new Ht;else switch(this.container.type){case"Canvas":t=new Ht;break;case"Stack":t=new ah;break;case"Grid":t=new Fn,t.setDefinitions(this.rows,this.columns);break}return t.id=this.id,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t.visible=this.visible,t.horizontalAlignment=this.horizontalAlignment,t.verticalAlignment=this.verticalAlignment,this.container&&this.shape.type!=="SwimLane"&&(t.width=this.width,t.height=this.height,this.container.type==="Stack"&&(t.orientation=this.container.orientation)),t.style.fill=this.backgroundColor,t.style.strokeColor=this.borderColor,t.style.strokeWidth=this.borderWidth,t.rotateAngle=this.rotateAngle,t.minHeight=this.minHeight,t.minWidth=this.minWidth,t.maxHeight=this.maxHeight,t.maxWidth=this.maxWidth,t.pivot=this.pivot,t.margin=this.margin,t.flip=this.flip,t.flipMode=this.flipMode,this.wrapper=t,t},e.prototype.initPorts=function(t,i){for(var r=0;this.ports,r<this.ports.length;r++)this.initPort(t,i,this.ports[parseInt(r.toString(),10)])},e.prototype.initPort=function(t,i,r){var a=this.wrapper,s;s=this.initPortWrapper(r,this);var o,h=_t(t);h&&(o=h(s,this)),s.description=o||s.id,s.inversedAlignment=a.inversedAlignment,s.elementActions=s.elementActions|le.ElementIsPort,i.children.push(s)},e.prototype.getIconOffet=function(t,i){var r,a;return t.orientation==="BottomToTop"?(r=i.offset.x,a=1-i.offset.y):t.orientation==="LeftToRight"?(r=i.offset.y,a=i.offset.x):t.orientation==="RightToLeft"?(r=1-i.offset.y,a=i.offset.x):(r=i.offset.x,a=i.offset.y),{x:r,y:a}},e.prototype.initIcons=function(t,i,r,a){var s=this.wrapper,o,h=this.isExpanded?this.expandIcon:this.collapseIcon;if(h.shape!=="None"){var l=new Ht;l.float=!0;var d=[];l.id=this.id+"_icon_content",l.children=d,l.height=h.height,l.width=h.width,l.style.strokeColor="transparent",l.margin=h.margin,l.horizontalAlignment="Center",l.verticalAlignment="Center",l.visible=this.visible,l.cornerRadius=h.cornerRadius,o=this.getIconOffet(i,h),l.setOffsetWithRespectToBounds(o.x,o.y,"Fraction"),l.relativeMode="Point",this.initIconSymbol(h,l,t,a);var f=void 0,p=_t(t);p&&(f=p(h,this)),l.description=f||l.id,l.inversedAlignment=s.inversedAlignment,r.children.push(l)}},e.prototype.initFixedUserHandles=function(t,i,r){var a;if(t.pathData===""&&i)a=new we(this.id,r,void 0,i),a.isTemplate=!0,a.template=Ai(a,!0,t),t.id=t.id||K(),a.id=this.id+"_"+t.id;else{var s=this.wrapper;a=new Ht;var o=[];a.children=o,t.id=t.id||K(),a.id=this.id+"_"+t.id;var h=of(t,a);a.children.push(h),a.inversedAlignment=s.inversedAlignment}a.float=!0,a.height=t.height,a.width=t.width,a.style.strokeColor=t.handleStrokeColor,a.style.fill=t.fill,a.style.strokeWidth=t.handleStrokeWidth,a.margin=t.margin,a.visible=t.visibility,a.cornerRadius=t.cornerRadius,a.horizontalAlignment="Center",a.verticalAlignment="Center";var l=this.getfixedUserHandleOffet(t);return a.setOffsetWithRespectToBounds(l.x,l.y,"Fraction"),a.relativeMode="Point",a.description=a.id,a},e.prototype.getfixedUserHandleOffet=function(t){var i=t.offset.x,r=t.offset.y;return{x:i,y:r}},e.prototype.initAnnotations=function(t,i,r,a,s){for(var o,h=0;this.annotations,h<this.annotations.length;h++){o=this.initAnnotationWrapper(this.annotations[parseInt(h.toString(),10)],r,a,h,s);var l=void 0,d=_t(t);d&&(l=d(o,this)),o.description=l||o.id,o.inversedAlignment=i.inversedAlignment,i.children.push(o)}},e.prototype.initPortWrapper=function(t,i){t.id=t.id||K();var r=new Pt;r.height=t.height,r.width=t.width,r.connectionDirection=t.connectionDirection,t.shape=t.shape||"Square";var a=t.shape==="Custom"?t.pathData:Xo(t.shape);r.id=this.id+"_"+t.id,r.margin=t.margin,r.data=a,i&&i.shape.type==="Bpmn"&&(r.flip=this.flip);var s=t.style;return r.style={fill:s.fill,strokeColor:s.strokeColor,gradient:null,opacity:s.opacity,strokeDashArray:s.strokeDashArray,strokeWidth:s.strokeWidth},r.horizontalAlignment=t.horizontalAlignment,r.verticalAlignment=t.verticalAlignment,this.flipMode!=="None"&&this.flipMode!=="Label"&&this.flipMode!=="LabelText"&&this.flipMode!=="LabelAndLabelText"?r=qn(r,this.flip,t):r=qn(r,G.None,t),(this.width!==void 0||this.height!==void 0)&&(r.float=!0),r.relativeMode="Point",r.visible=!!(ci(t,zt.Visible)&&!ci(t,zt.Hover)&&!ci(t,zt.Connect)),r.elementActions=r.elementActions|le.ElementIsPort,r},e.prototype.initAnnotationWrapper=function(t,i,r,a,s){t.content=t.content||"",t.id=t.id||a+"annotation"||K();var o=t,h;if(i&&(t.template||t.annotationType==="Template"||s&&t.content==="")){h=new we(this.id,i,t.id,s);var l=document.getElementById(i),d="ej2_instances",f=l[""+d][0];t.template&&typeof t.template=="function"&&f.isReact&&(h.templateFn=Re(t.template),h.isTemplate=!0),h=kf(h,t,s,f)}else{h=new Tt,h.canMeasure=!r;var p=t.style,c=t.hyperlink.link?t.hyperlink:void 0;h.style={fill:p.fill,strokeColor:p.strokeColor,strokeWidth:p.strokeWidth,bold:p.bold,textWrapping:p.textWrapping,color:c?c.color||h.hyperlink.color:p.color,whiteSpace:p.whiteSpace,fontFamily:p.fontFamily,fontSize:p.fontSize,italic:p.italic,gradient:null,opacity:p.opacity,strokeDashArray:p.strokeDashArray,textAlign:p.textAlign,textOverflow:t.style.textOverflow,textDecoration:c?c.textDecoration||h.hyperlink.textDecoration:p.textDecoration},h.hyperlink.link=t.hyperlink.link||void 0,h.hyperlink.hyperlinkOpenState=t.hyperlink.hyperlinkOpenState||void 0,h.hyperlink.content=t.hyperlink.content||void 0,h.hyperlink.textDecoration=t.hyperlink.textDecoration||void 0,h.content=c?c.content||h.hyperlink.link:t.content}return h.constraints=t.constraints,h.height=t.height,h.width=t.width,h.visible=t.visibility,h.annotationVisibility=h.visible?"Visible":"Collapsed",h.rotateAngle=t.rotateAngle,h.rotationReference=t.rotationReference,h.id=this.id+"_"+t.id,this.width!==void 0&&!t.template&&t.width===void 0&&(t.style.textWrapping==="Wrap"||t.style.textWrapping==="WrapWithOverflow")&&(h.width=this.width),h.margin=t.margin,h.horizontalAlignment=t.horizontalAlignment,h.verticalAlignment=t.verticalAlignment,h.setOffsetWithRespectToBounds(o.offset.x,o.offset.y,"Fraction"),(this.width!==void 0||this.height!==void 0)&&(h.float=!0),h.relativeMode="Point",h},e.prototype.initIconContainer=function(t,i){var r=new Be;return r.id=i.id+"_rect",r.height=t.height,r.width=t.width,r.visible=i.visible,r.margin=t.margin,r.cornerRadius=t.cornerRadius,r.style={fill:t.fill,strokeColor:t.borderColor,strokeWidth:t.borderWidth},r.setOffsetWithRespectToBounds(.5,.5,"Fraction"),r.horizontalAlignment="Center",r.verticalAlignment="Center",r.relativeMode="Object",r.description=r.description||"Click here to expand or collapse",r},e.prototype.initIconSymbol=function(t,i,r,a){var s;if(i.children.push(this.initIconContainer(t,i)),t.shape==="Template")s=new li(this.id,a),s.content=t.content,s.height=10,s.width=10;else{s=new Pt,s.data=ev(t);var o=nn(s.data);s.height=o.height<10?o.height:10-(t.padding.bottom+t.padding.top),s.width=o.width<10?o.width:10-(t.padding.left+t.padding.right)}s.id=i.id+"_shape",s.horizontalAlignment="Center",s.verticalAlignment="Center",s.visible=i.visible,s.visible=i.visible,s.style={fill:"black",strokeColor:t.iconColor,strokeWidth:t.borderWidth},s.setOffsetWithRespectToBounds(.5,.5,"Fraction"),s.relativeMode="Object",s.description=i.description||"Click here to expand or collapse",i.children.push(s)},e.prototype.getClassName=function(){return"Node"},D([Lt([],ae)],e.prototype,"annotations",void 0),D([w(0)],e.prototype,"offsetX",void 0),D([X({},ey)],e.prototype,"layoutInfo",void 0),D([w(0)],e.prototype,"offsetY",void 0),D([Lt([],Se)],e.prototype,"ports",void 0),D([w(!0)],e.prototype,"isExpanded",void 0),D([Lt([],Go)],e.prototype,"fixedUserHandles",void 0),D([X({},Il)],e.prototype,"expandIcon",void 0),D([X({},Il)],e.prototype,"collapseIcon",void 0),D([X({x:.5,y:.5},b)],e.prototype,"pivot",void 0),D([w()],e.prototype,"width",void 0),D([w()],e.prototype,"height",void 0),D([w()],e.prototype,"minWidth",void 0),D([w()],e.prototype,"minHeight",void 0),D([w()],e.prototype,"maxWidth",void 0),D([w()],e.prototype,"maxHeight",void 0),D([w(0)],e.prototype,"rotateAngle",void 0),D([X({fill:"white"},cn)],e.prototype,"style",void 0),D([w("transparent")],e.prototype,"backgroundColor",void 0),D([w("none")],e.prototype,"borderColor",void 0),D([w(0)],e.prototype,"borderWidth",void 0),D([w()],e.prototype,"data",void 0),D([os(py)],e.prototype,"shape",void 0),D([X({},Xa)],e.prototype,"previewSize",void 0),D([X({},Xa)],e.prototype,"dragSize",void 0),D([w(null)],e.prototype,"wrapper",void 0),D([w(W.Default)],e.prototype,"constraints",void 0),D([X({},Tg)],e.prototype,"shadow",void 0),D([w()],e.prototype,"children",void 0),D([X({left:0,right:0,top:0,bottom:0},Ie)],e.prototype,"padding",void 0),D([w(null)],e.prototype,"container",void 0),D([w("Left")],e.prototype,"horizontalAlignment",void 0),D([w("Top")],e.prototype,"verticalAlignment",void 0),D([w()],e.prototype,"rows",void 0),D([w()],e.prototype,"columns",void 0),D([w()],e.prototype,"rowIndex",void 0),D([w()],e.prototype,"columnIndex",void 0),D([w()],e.prototype,"rowSpan",void 0),D([w()],e.prototype,"columnSpan",void 0),D([w("")],e.prototype,"branch",void 0),e})(Nd),ia=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return D([w("")],e.prototype,"id",void 0),D([X({},ae)],e.prototype,"annotation",void 0),D([X({fill:"#FFFFFF",strokeColor:"#CCCCCC"},Qi)],e.prototype,"style",void 0),D([w(50)],e.prototype,"height",void 0),D([w(50)],e.prototype,"width",void 0),e})(j),Fr=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Lane"},D([w("")],e.prototype,"id",void 0),D([X({fill:"#F9F9F9",strokeColor:"#CCCCCC"},Qi)],e.prototype,"style",void 0),D([Lt([],M)],e.prototype,"children",void 0),D([w(100)],e.prototype,"height",void 0),D([w(100)],e.prototype,"width",void 0),D([X({style:{fill:"#E7F4FF",strokeColor:"#CCCCCC"},annotation:{content:"Function"}},ia)],e.prototype,"header",void 0),D([w(!0)],e.prototype,"canMove",void 0),D([w()],e.prototype,"addInfo",void 0),e})(j),ys=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getClassName=function(){return"Phase"},D([w("")],e.prototype,"id",void 0),D([X({fill:"#FFFFFF",strokeColor:"#CCCCCC"},Qi)],e.prototype,"style",void 0),D([X({annotation:{content:"Phase"}},ia)],e.prototype,"header",void 0),D([w(100)],e.prototype,"offset",void 0),D([w()],e.prototype,"addInfo",void 0),e})(j),Br=(function(n){kt(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.padding=20,t.hasHeader=!0,t}return e.prototype.getClassName=function(){return"SwimLane"},D([w("SwimLane")],e.prototype,"type",void 0),D([w(20)],e.prototype,"phaseSize",void 0),D([Lt([],ys)],e.prototype,"phases",void 0),D([w("Horizontal")],e.prototype,"orientation",void 0),D([Lt([],Fr)],e.prototype,"lanes",void 0),D([X({style:{fill:"#E7F4FF",strokeColor:"#CCCCCC"},annotation:{content:"Function"}},ia)],e.prototype,"header",void 0),D([w(!1)],e.prototype,"isLane",void 0),D([w(!1)],e.prototype,"isPhase",void 0),e})(ri),Sr=(function(n){kt(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.hasHeader=!0,t}return e.prototype.getClassName=function(){return"Container"},D([w("Container")],e.prototype,"type",void 0),D([X({},ia)],e.prototype,"header",void 0),D([w()],e.prototype,"children",void 0),e})(ri),my=(function(){function n(){}return n.prototype.getClassName=function(){return"ChildContainer"},D([w("Canvas")],n.prototype,"type",void 0),D([w("Vertical")],n.prototype,"orientation",void 0),n})(),It=(function(n){kt(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t){var i=new Je;if(i.measureChildren=!1,i.children=[],this.annotation){var r=this.nodes.length>0?t.nameTable[this.nodes[0].id].wrapper:t.nameTable[this.connectors[0].id].wrapper,a=t.getWrapper(r,this.annotation.id);i.children.push(a)}else if(this.nodes||this.connectors){for(var s=0;s<this.nodes.length;s++){var o=t.nameTable[this.nodes[parseInt(s.toString(),10)].id],a=o.wrapper;i.children.push(a)}for(var h=0;h<this.connectors.length;h++){var l=t.nameTable[this.connectors[parseInt(h.toString(),10)].id],a=l.wrapper;i.children.push(a)}}var d="isProtectedOnChange",f=t[""+d];return t.protectPropertyChange(!1),this.wrapper=i,t.protectPropertyChange(f),i},D([w(null)],e.prototype,"wrapper",void 0),D([w(14)],e.prototype,"handleSize",void 0),D([Lt([],M)],e.prototype,"nodes",void 0),D([Lt([],B)],e.prototype,"connectors",void 0),D([w()],e.prototype,"width",void 0),D([w()],e.prototype,"height",void 0),D([w(0)],e.prototype,"rotateAngle",void 0),D([w(0)],e.prototype,"offsetX",void 0),D([w(0)],e.prototype,"offsetY",void 0),D([X({x:.5,y:.5},b)],e.prototype,"pivot",void 0),D([w("CompleteIntersect")],e.prototype,"rubberBandSelectionMode",void 0),D([Lt([],_o)],e.prototype,"userHandles",void 0),D([w(Ae.All)],e.prototype,"constraints",void 0),D([w()],e.prototype,"setTooltipTemplate",void 0),D([Lt([],M)],e.prototype,"selectedObjects",void 0),D([w(!1)],e.prototype,"canToggleSelection",void 0),e})(j);function yy(n,e){var t;for(e&&document.getElementById(e).classList.contains(n)?t=document.getElementById(e).getElementsByClassName(n):t=document.getElementsByClassName(n);t.length>0;)t[0].parentNode.removeChild(t[0])}function Sy(n){var e=[],t,i,r="measureElement";window[""+r].style.visibility="visible";var a=window[""+r].children[2],s=Tf(a)[0];s.setAttributeNS(null,"d",n.data);var o=n.absoluteBounds,h=bf(n,o);s.setAttributeNS(null,"d",h);var l=s.getTotalLength(),d=Xe.prototype.getPathData(h);if(d.length===0){for(i=0;i<=l;i+=10)t=s.getPointAtLength(i),e.push({x:t.x,y:t.y});Xe.prototype.setPathData(h,e)}else e=d;return window[""+r].style.visibility="hidden",e}function Tf(n){var e,t=[];if(vt.info.name==="msie"||vt.info.name==="edge")for(var i=0;i<n.childNodes.length;i++)e=n.childNodes[parseInt(i.toString(),10)],e.nodeType===1&&t.push(e);else t=n.children;return t}function wy(n,e){for(var t=[],i=n.offsetX-n.actualSize.width*n.pivot.x,r=n.offsetY-n.actualSize.height*n.pivot.y,a=0,s=e;a<s.length;a++){var o=s[a],h=void 0,l=i+o.x,d=r+o.y,f=i+n.actualSize.width-o.x,p=r+n.actualSize.height-o.y;switch(n.flip){case G.Both:h={x:f,y:p};break;case G.Horizontal:h={x:f,y:d};break;case G.Vertical:h={x:l,y:p};break;default:h={x:l,y:d};break}var c=void 0,u=n.rotateAngle+n.parentTransform;u&&(c=xt(),Rt(c,u,n.offsetX,n.offsetY)),c&&(h=st(c,h)),t.push(h)}return t}var Ta={};function Iy(){Ta={}}function nn(n){if(n){if(Ta[""+n])return Ta[""+n];var e="measureElement";window[""+e].style.visibility="visible";var t=window[""+e].children[2],i=Tf(t)[0];i.setAttribute("d",n);var r=i.getBBox(),a=new it(r.x,r.y,r.width,r.height);return window[""+e].style.visibility="hidden",Ta[""+n]=a,a}return new it(0,0,0,0)}function xy(n,e){var t={fill:n.style.fill,stroke:n.style.strokeColor,angle:n.rotateAngle+n.parentTransform,pivotX:n.pivot.x,pivotY:n.pivot.y,strokeWidth:n.style.strokeWidth,dashArray:n.style.strokeDashArray,opacity:n.style.opacity,shadow:n.shadow,gradient:n.style.gradient,visible:n.visible,id:n.id,description:n.description,width:e||n.actualSize.width,height:n.actualSize.height,x:n.offsetX-n.actualSize.width*n.pivot.x+.5,y:n.offsetY-n.actualSize.height*n.pivot.y+.5};return t.fontSize=n.style.fontSize,t.fontFamily=n.style.fontFamily,t.textOverflow=n.style.textOverflow,t.textDecoration=n.style.textDecoration,t.doWrap=n.doWrap,t.whiteSpace=Do(n.style.whiteSpace,n.style.textWrapping),t.content=n.content,t.textWrapping=n.style.textWrapping,t.breakWord=hs(n.style.textWrapping),t.textAlign=rd(n.style.textAlign),t.color=n.style.color,t.italic=n.style.italic,t.bold=n.style.bold,t.dashArray="",t.strokeWidth=0,t.fill="",t}function Cy(n,e,t){var i=[],r=0,a,s,o=n.content;if(n.whiteSpace!=="nowrap"&&n.whiteSpace!=="pre")if(n.breakWord==="breakall")for(a="",a+=o[0],r=0;r<o.length;r++)if(s=gr(a,n),s>=n.width&&a.length>0)i[i.length]={text:a,x:0,dy:0,width:s},a="";else{a=a+(o[r+1]||""),a.indexOf(`
`)>-1&&(i[i.length]={text:a,x:0,dy:0,width:gr(a,n)},a="");var h=gr(a,n);Math.ceil(h)+2>=n.width&&a.length>0&&(i[i.length]={text:a,x:0,dy:0,width:h},a=""),r===o.length-1&&a.length>0&&(i[i.length]={text:a,x:0,dy:0,width:h},a="")}else i=Py(n,e,t);else i[i.length]={text:o,x:0,dy:0,width:gr(o,n)};return i}function Py(n,e,t){var i=[],r="",a=0,s=0,o=n.whiteSpace!=="nowrap",h=n.content,l=h.split(`
`),d,f,p,c;for(a=0;a<l.length;a++)for(d=n.textWrapping!=="NoWrap"?l[parseInt(a.toString(),10)].split(" "):[l[parseInt(a.toString(),10)]],s=0;s<d.length;s++){r+=((s!==0||d.length===1)&&o&&r.length>0?" ":"")+d[parseInt(s.toString(),10)],d[s+1]?f=r+" "+d[s+1]:f=r;var u=gr(f,n);Math.floor(u)>(t||n.width)-2&&r.length>0?(i[i.length]={text:r,x:0,dy:0,width:f===r?u:r===c?p:gr(r,n)},r=""):s===d.length-1&&(i[i.length]={text:r,x:0,dy:0,width:u},r=""),c=f,p=u}return i}function Ty(n,e){var t={x:0,width:0},i=0,r,a;for(i=0;i<e.length;i++)r=e[parseInt(i.toString(),10)].width,a=r,n.textAlign==="left"||n.textAlign==="justify"?r=0:n.textAlign==="center"?r>n.width&&(n.textOverflow==="Ellipsis"||n.textOverflow==="Clip")?r=0:r=-r/2:n.textAlign==="right"?r=-r:r=e.length>1?0:-r/2,e[parseInt(i.toString(),10)].dy=n.fontSize*1.2,e[parseInt(i.toString(),10)].x=r,t.x=Math.min(t.x,r),t.width=Math.max(t.width,a);return t}function Af(n,e,t,i,r){var a=new U,s=bt("span",{style:"position:absolute; display:inline-block; line-height:normal; left:0px; top:0px"});return n.bold&&(s.style.fontWeight="bold"),n.italic&&(s.style.fontStyle="italic"),r!==void 0&&(s.style.maxWidth=r.toString()+"px"),s.style.fontFamily=n.fontFamily,s.style.fontSize=n.fontSize+"px",s.style.color=n.color,s.textContent=e,s.style.whiteSpace=Do(n.whiteSpace,n.textWrapping),r!==void 0?s.style.wordBreak="break-word":s.style.wordBreak=hs(n.textWrapping),document.body.appendChild(s),a.width=s.offsetWidth,a.height=s.offsetHeight,document.body.removeChild(s),a}function Ay(n,e,t,i,r){var a=new U(0,0),s,o,h=xy(n,i);return n.childNodes=s=Cy(h,r,n.isLaneOrientation?i:void 0),n.wrapBounds=o=Ty(h,s),a.width=o.width,n.wrapBounds.width>=i&&h.textOverflow!=="Wrap"&&(a.width=i),a.height=s.length*n.style.fontSize*1.2,a}function by(n,e,t,i){var r="measureElement";window[""+r].style.visibility="visible";var a=window[""+r].children[1];a.setAttribute("src",n);var s=a.getBoundingClientRect(),o=s.width,h=s.height;e=new U(o,h),window[""+r].style.visibility="hidden";var l=document.createElement("img");return l.setAttribute("src",n),bi(l,{id:t+"sf-imageNode"}),l.style.display="none",document.body.appendChild(l),l.onload=function(d){var f=d.currentTarget;i&&i(t,{width:f.width,height:f.height})},e}function Ey(n){var e="measureElement",t=window[e].children[2];t.appendChild(n);var i=n.getBoundingClientRect(),r=t.getBoundingClientRect(),a=i;return a.x=i.left-r.left,a.y=i.top-r.top,t.removeChild(n),a}function Dy(n){var e="measureElement";window[e].style.visibility="visible";var t=window[e].children[2];t.appendChild(n);var i=t.getBoundingClientRect();return t.removeChild(n),window[e].style.visibility="hidden",i}function bf(n,e,t,i){var r=0,a=0,s=0,o=0,h=!1,l="",d=[],f=e;return(r!==f.x||a!==f.y)&&(s=r-Number(f.x),o=a-Number(f.y)),(n.actualSize.width!==f.width||n.actualSize.height!==f.height||i)&&(s=(i&&i.width||n.actualSize.width)/Number(f.width?f.width:1),o=(i&&i.height||n.actualSize.height)/Number(f.height?f.height:1),h=!0),d=Hr(n.data),d=La(d),l=Da(d,s,o,h,f.x,f.y,r,a),h=!1,l}function Ef(n){var e=St(n),t=e.getElementsByClassName("e-diagram-layer"),i=t[0];return i}function St(n,e){var t,i;return e&&(i=document.getElementById(e)),vt.info.name==="msie"||vt.info.name==="edge"?t=i?i.querySelector("#"+n):document.getElementById(n):t=i?i.querySelector("#"+CSS.escape(n)):document.getElementById(n),t}function Ly(n,e,t){var i,r,a="";t==="native"?(r=Lf(n),a="_content_groupElement"):t==="html"?(r=ti(n).childNodes[0],a="_html_element"):(r=My(n),a="_groupElement");var s=e+a,o=document.getElementById(s);return o&&r.contains(o)?Array.prototype.indexOf.call(r.childNodes,o):i}function Vi(n){var e=null,t=St(n),i=t.getElementsByClassName("e-adorner-layer");return e=i[0],e}function Ln(n){var e=null,t=Vi(n);return e=t.getElementById(n+"_SelectorElement"),e}function yo(n){var e=null,t=Vi(n);return e=t.getElementById(n+"_diagramAdorner"),e}function $s(n){var e=null,t=St(n),i=t.getElementsByClassName("e-userHandle-layer");return e=i[0],e}function My(n){var e=Ef(n),t=e.getElementById(n+"_diagramLayer");return t}function zy(n){var e=null,t=St(n),i=t.getElementsByClassName("e-ports-expand-layer");return e=i[0],e}function Df(n){var e,t=St(n),i=t.getElementsByClassName("e-native-layer");return e=i[0],e}function Mr(n){var e=null,t=St(n),i=t.getElementsByClassName("e-grid-layer");return e=i[0],e}function gh(n){var e=St(n),t=e.getElementsByClassName("e-background-layer");return t[0].parentNode}function ky(n){var e=null,t=St(n),i=t.getElementsByClassName("e-background-image-layer");return e=i[0],e}function Cl(n){var e=null,t=St(n),i=t.getElementsByClassName("e-background-layer");return e=i[0],e}function Ry(n){var e="domTable",t=null;if(window[e][n+"_gridline"])t=window[e][n+"_gridline"];else{var i=Mr(n);t=i.getElementById(n+"_gridline"),window[e][n+"_gridline"]=t}return t}function Lf(n){var e=null,t=Df(n);return e=t.getElementById(n+"_nativeLayer"),e}function ti(n){var e=null,t="domTable";if(window[t][n+"html_layer"])e=window[t][n+"html_layer"];else{var i=St(n),r=i.getElementsByClassName("e-html-layer");e=r[0],window[t][n+"html_layer"]=e}return e}function bt(n,e){var t=td(n);return bi(t,e),t}function Nt(n,e){var t=document.createElementNS("http://www.w3.org/2000/svg",n);return Et(t,e),t}function Pl(n,e,t){for(var i=n;i&&!Hn(i,e);)i=i.parentNode;return i}function Hn(n,e){var t=typeof n.className=="object"?n.className.animVal:n.className;return(" "+t+" ").indexOf(" "+e+" ")>-1}function Hy(){var n=bt("div",{style:"visibility:hidden; width: 100px"});document.body.appendChild(n);var e=n.getBoundingClientRect().width;n.style.overflow="scroll";var t=bt("div",{style:"width:100%"});n.appendChild(t);var i=t.getBoundingClientRect().width;return n.parentNode.removeChild(n),e-i}function Tl(n,e,t){n=[];for(var i=0,r=t.length;i<r;i++)n.push({pageX:t[parseInt(i.toString(),10)].clientX,pageY:t[parseInt(i.toString(),10)].clientY,pointerId:null});return n}function be(n,e){var t=St(n,e);t&&t.parentNode.removeChild(t)}function Ai(n,e,t){var i;if(e){var r={style:"height: 100%; width: 100%"};i=bt("div",r)}else i=document.createElementNS("http://www.w3.org/2000/svg","g");var a=document.getElementById(n.diagramId),s="ej2_instances",o=a[s][0],h;(!o.initNodeTemplate||!(o instanceof Xe))&&(h=W0(n));var l="",d={},f;!h&&o.initNodeTemplate?(d=d=o.tempTable&&o.tempTable[n.nodeId]||d,f="nodeTemplate"):h instanceof M?(d=h,f="nodeTemplate"):(d=h,f="annotationTemplate");var p;if((typeof n.content=="string"||typeof n.content=="function")&&!n.isTemplate){var c=document.getElementById(n.content);if(c)i.appendChild(c);else{var u=void 0;u=Re(n.content);for(var g=0,v=u(d,o,f,l);g<v.length;g++)p=v[g],i.appendChild(p)}}else if(n.isTemplate){var u=void 0;if(o.isReact)u=n.getNodeTemplate()(E(t),o,f+"_"+(f==="nodeTemplate"?t.id:n.nodeId+t.id),void 0,void 0,!1,i);else if(o.isVue||o.isVue3){var m=n.getNodeTemplate();m?u=n.getNodeTemplate()(E(t),o,f+"_"+(f==="nodeTemplate"?t.id:n.nodeId+t.id),void 0,void 0,!1,i):(f==="nodeTemplate"?u=Re(o.nodeTemplate):u=Re(o.annotationTemplate),u=u(E(t),o,f+"_"+(f==="nodeTemplate"?t.id:n.nodeId+t.id),void 0,void 0,!1,i))}else u=n.getNodeTemplate()(E(t),o,f+"_"+(f==="nodeTemplate"?t.id:n.nodeId+t.id),void 0,void 0,!1);if(u)for(var y=0;y<u.length;y++)i.appendChild(u[parseInt(y.toString(),10)])}else n.content&&n.content.outerHTML&&i.appendChild(n.content);return n.isTemplate?i:i.cloneNode(!0)}function Et(n,e){for(var t=Object.keys(e),i=0;i<t.length;i++)n&&t[parseInt(i.toString(),10)]!=="style"?n.setAttribute(t[parseInt(i.toString(),10)],e[t[parseInt(i.toString(),10)]]):Ui(n,e[t[parseInt(i.toString(),10)]])}function Ui(n,e){for(var t=e.split(";"),i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)].split(":");r.length===2&&(n.style[r[0].trim()]=r[1].trim())}}function bi(n,e){for(var t=Object.keys(e),i=0;i<t.length;i++)t[parseInt(i.toString(),10)]!=="style"?n.setAttribute(t[parseInt(i.toString(),10)],e[t[parseInt(i.toString(),10)]]):Ui(n,e[t[parseInt(i.toString(),10)]])}function Mf(){var n="measureElement";if(window[""+n])window[""+n].usageCount+=1;else{var e=bt("div",{id:"measureElement",style:"visibility:hidden ; height: 0px ; width: 0px; overflow: hidden;"}),t=bt("span",{style:"display:inline-block ; line-height: normal"});e.appendChild(t);var i=bt("img",{alt:"measureElementImage",src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"});e.appendChild(i);var r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),e.appendChild(r);var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",""),r.appendChild(a),document.createTextNode("");var s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),r.appendChild(s),window[""+n]=e,window[""+n].usageCount=1,document.body.appendChild(e);var o="measureElementCount";window[""+o]?window[""+o]++:window[""+o]=1}}function zf(n,e,t,i){return e.length>=1&&n.x===0&&(i.textOverflow==="Clip"||i.textOverflow==="Ellipsis")&&(i.textWrapping==="Wrap"||i.textWrapping==="WrapWithOverflow")&&(n.x=e[t-1]?e[t-1].x:-(n.width/2)),n.x}function kf(n,e,t,i){return t&&!e.template||e.template&&typeof e.template=="function"&&i.isReact?(n.isTemplate=!0,n.template=n.content=Ai(n,!0,e)):n.content=e.template,n}function By(n,e,t,i){var r,a,s,o,h,l=document.getElementById(i),d="ej2_instances",f=l[d][0];if(n&&e){r=Eo(n);for(var p=0,c=t.userHandles;p<c.length;p++)if(a=c[p],r){for(s=r(E(a),f,"userHandleTemplate_"+a.name,void 0,void 0,!1),o=0;o<s.length;o++){var u={style:"height: 100%; width: 100%; pointer-events: all",id:a.name+"_template_hiddenUserHandle"};h=bt("div",u),h.appendChild(s[o])}e[0].appendChild(h)}}}var nr=(function(){function n(){}return n.getContext=function(e){return e.getContext("2d")},n.setCanvasSize=function(e,t,i){e&&(e.setAttribute("width",t.toString()),e.setAttribute("height",i.toString()))},n.prototype.renderGradient=function(e,t,i,r){var a,s,o;if(e.gradient.type!=="None"){for(var h=0;h<e.gradient.stops.length;h++)a=a?Math.max(a,e.gradient.stops[parseInt(h.toString(),10)].offset):e.gradient.stops[parseInt(h.toString(),10)].offset,s=s?Math.min(s,e.gradient.stops[parseInt(h.toString(),10)].offset):e.gradient.stops[parseInt(h.toString(),10)].offset;if(e.gradient.type==="Linear"){var l=e.gradient,d=l.x1,f=l.x2,p=l.y1,c=l.y2;if(l.controlParent instanceof Xe&&l.controlParent.mode==="SVG"&&(d=e.width?d*e.width/100:d,f=e.width?f*e.width/100:f,p=e.height?p*e.height/100:p,c=e.height?c*e.height/100:c,d!==f&&p!==c)){var u=f-d,g=c-p,v=Math.atan2(g,u),m=v*(180/Math.PI)%360;m=m<0?m+360:m;var y=90-m,S=y*(Math.PI/180),x=u*Math.sin(v)+g*Math.cos(v);f=d+x*Math.cos(S),c=p+x*Math.sin(S)}o=t.createLinearGradient(i+d,r+p,i+f,r+c)}else{var I=e.gradient;o=t.createRadialGradient(i+I.fx,r+I.fy,0,i+I.cx,r+I.cy,I.r)}for(var h=0;h<e.gradient.stops.length;h++){var C=e.gradient.stops[parseInt(h.toString(),10)],P=s<0?(a+C.offset)/(2*a):C.offset/a;o.addColorStop(P,C.color)}t.fillStyle=o}return t},n.prototype.renderShadow=function(e,t,i){i===void 0&&(i=null);var r=n.getContext(t);r.save(),r.beginPath(),r.strokeStyle=r.fillStyle=e.shadow.color,r.globalAlpha=e.shadow.opacity;var a={x:0,y:0},s=b.transform(a,e.shadow.angle,e.shadow.distance),o=e.x+s.x,h=e.y+s.y,l=o+e.width*e.pivotX,d=h+e.height*e.pivotY;this.rotateContext(t,e.angle,l,d),i?(r.translate(o,h),this.renderPath(t,e,i),r.translate(-o,-h)):(r.rect(o,h,e.width,e.height),r.fillRect(o,h,e.width,e.height)),r.fill(),r.stroke(),r.closePath(),r.restore()},n.createCanvas=function(e,t,i){var r=bt("canvas",{id:e});return this.setCanvasSize(r,t,i),r},n.prototype.setStyle=function(e,t){var i=n.getContext(e);t.fill==="none"&&(t.fill="transparent"),t.stroke==="none"&&(t.stroke="transparent"),i.strokeStyle=t.stroke,i.lineWidth=t.strokeWidth,t.strokeWidth===0&&(i.strokeStyle="transparent"),i.globalAlpha=t.opacity;var r=[];t.dashArray&&(r=this.parseDashArray(t.dashArray)),i.setLineDash(r),t.gradient&&t.gradient.type!=="None"?t.shapeType==="Rectangle"?this.renderGradient(t,i,t.x,t.y):this.renderGradient(t,i,0,0):i.fillStyle=t.fill},n.prototype.rotateContext=function(e,t,i,r){var a=n.getContext(e);a.translate(i,r),a.rotate(t*Math.PI/180),a.translate(-i,-r)},n.prototype.setFontStyle=function(e,t){var i=n.getContext(e),r="";t.italic&&(r+="italic "),t.bold&&(r+="bold "),r+=t.fontSize+"px ",r+=t.fontFamily,i.font=r},n.prototype.parseDashArray=function(e){for(var t=[],i=e.indexOf(" ")!==-1?" ":",",r=e.split(i),a=0,s=r;a<s.length;a++){var o=s[a];t.push(Number(o))}return t},n.prototype.drawRoundedRect=function(e,t){var i=n.getContext(e);i.beginPath();var r=t.x,a=t.y,s=t.width,o=t.height,h=r+s/2,l=a+o/2;i.beginPath(),this.setStyle(e,t),i.moveTo(r,l),i.quadraticCurveTo(r,a,h,a),i.quadraticCurveTo(r+s,a,r+s,l),i.quadraticCurveTo(r+s,a+o,h,a+o),i.quadraticCurveTo(r,a+o,r,l),i.fill(),i.stroke()},n.prototype.drawRectangle=function(e,t,i,r,a,s,o,h,l,d,f){if(t.visible===!0)if(t.cornerRadius)!r&&(t.width<30||t.height<30)?this.drawRoundedRect(e,t):(t.data=ug(t.cornerRadius,t.height,t.width),this.drawPath(e,t,i,a,s,o,void 0,d,f));else{var p=n.getContext(e);t.shadow&&this.renderShadow(t,e),p.save(),p.beginPath(),t.cornerRadius;var c=t.x+t.width*t.pivotX,u=t.y+t.height*t.pivotY;if(t.textWrapping&&t.wrapBounds)this.applyFlipAndRotate(p,t,e,c,u,d,f);else{var g=t.isImage?-t.angle:t.angle;this.rotateContext(e,g,c,u)}this.setStyle(e,t),p.rect(t.x,t.y,t.width,t.height),p.fillRect(t.x,t.y,t.width,t.height),p.fill(),p.stroke(),p.closePath(),p.restore()}},n.prototype.drawPath=function(e,t,i,r,a,s,o,h,l){var d=[];d=Hr(t.data),d=ed(d),t.shadow&&this.renderShadow(t,e,d);var f=n.getContext(e);f.save(),f.beginPath();var p=t.y+t.height*t.pivotY,c=t.x+t.width*t.pivotX;this.applyFlipAndRotate(f,t,e,c,p,h,l),f.translate(t.x,t.y);var u=t.x,g=t.y;t.shapeType==="Rectangle"&&(t.x=0,t.y=0),this.setStyle(e,t),t.x=u,t.y=g,this.renderPath(e,t,d),f.fill(),f.translate(-t.x,-t.y),f.stroke(),f.restore()},n.prototype.renderPath=function(e,t,i){if(t.visible===!0){var r=0,a=n.getContext(e),s=void 0,o=void 0,h=void 0,l=void 0,d=void 0,f=void 0,p=void 0,c=void 0,u,g=void 0,v=i;for(p=0,c=0,g=0,u=v.length;g<u;++g){var m=v[parseInt(g.toString(),10)],y=m,S=y.command;switch("x1"in y&&(h=y.x1),"x2"in y&&(d=y.x2),"y1"in y&&(l=y.y1),"y2"in y&&(f=y.y2),"x"in y&&(p=y.x),"y"in y&&(c=y.y),S){case"M":a.moveTo(p,c),y.x=p,y.y=c;break;case"L":a.lineTo(p,c),y.x=p,y.y=c;break;case"C":a.bezierCurveTo(h,l,d,f,p,c),y.x=p,y.y=c,y.x1=h,y.y1=l,y.x2=d,y.y2=f;break;case"Q":a.quadraticCurveTo(h,l,p,c),y.x=p,y.y=c,y.x1=h,y.y1=l;break;case"A":var x={x:s,y:o},I=void 0,C=void 0;t.arc&&t.arc.length>0?(y.r1===0?I=t.arc[parseInt(r.toString(),10)].r1:I=y.r1,y.r2===0?C=t.arc[parseInt(r.toString(),10)].r2:C=y.r2,r++):(I=y.r1,C=y.r2);var P=y.angle*(Math.PI/180),A=y.largeArc,T=y.sweep,z={x:p,y:c},L={x:Math.cos(P)*(x.x-z.x)/2+Math.sin(P)*(x.y-z.y)/2,y:-Math.sin(P)*(x.x-z.x)/2+Math.cos(P)*(x.y-z.y)/2},R=Math.pow(L.x,2)/Math.pow(I,2)+Math.pow(L.y,2)/Math.pow(C,2);R>1&&(I*=Math.sqrt(R),C*=Math.sqrt(R));var O=Math.pow(C,2)*Math.pow(L.x,2),N=(A===T?-1:1)*Math.sqrt((Math.pow(I,2)*Math.pow(C,2)-Math.pow(I,2)*Math.pow(L.y,2)-O)/(Math.pow(I,2)*Math.pow(L.y,2)+Math.pow(C,2)*Math.pow(L.x,2)));isNaN(N)&&(N=0);var H={x:N*I*L.y/C,y:N*-C*L.x/I},F={x:(x.x+z.x)/2+Math.cos(P)*H.x-Math.sin(P)*H.y,y:(x.y+z.y)/2+Math.sin(P)*H.x+Math.cos(P)*H.y},Y=this.a([1,0],[(L.x-H.x)/I,(L.y-H.y)/C]),et=[(L.x-H.x)/I,(L.y-H.y)/C],at=[(-L.x-H.x)/I,(-L.y-H.y)/C],tt=this.a(et,at);this.r(et,at)<=-1&&(tt=Math.PI),this.r(et,at)>=1&&(tt=0);var nt=T?1:-1,wt=Y+nt*(tt/2);if(F.x+I*Math.cos(wt),F.y+C*Math.sin(wt),y.centp=F,y.xAxisRotation=P,y.rx=I,y.ry=C,y.a1=Y,y.ad=tt,y.sweep=T,a!=null){var $=I>C?I:C,pt=I>C?1:I/C,rt=I>C?C/I:1;a.save(),a.translate(F.x,F.y),a.rotate(P),a.scale(pt,rt),a.arc(0,0,$,Y,Y+tt,!T),a.scale(1/pt,1/rt),a.rotate(-P),a.translate(-F.x,-F.y),a.restore()}break;case"Z":case"z":a.closePath(),p=s,c=o;break}s=p,o=c}}},n.prototype.drawText=function(e,t,i,r,a,s,o,h){if(t.content&&t.visible===!0){var l=o.groupElement,d=n.getContext(e);d.save(),this.setStyle(e,t),s&&(t.fontSize*=s);var f=t.x+t.width*t.pivotX,p=t.y+t.height*t.pivotY;this.applyFlipAndRotate(d,t,e,f,p,o,h),this.setFontStyle(e,t);var c=0,u=[];u=t.childNodes;var g=t.wrapBounds;if(d.fillStyle=t.color,g){var v=this.labelAlign(t,g,u);for(c=0;c<u.length;c++){var m=u[parseInt(c.toString(),10)];m.x=zf(m,u,c,t);var y=v.x+(s?m.x*s:m.x)-g.x,S=v.y+(s?m.dy*s:m.dy)*c+t.fontSize*.8;if(g.width>t.width&&t.textOverflow!=="Wrap"&&t.textWrapping==="NoWrap"&&(m.text=nd(m.text,t)),(t.textOverflow==="Clip"||t.textOverflow==="Ellipsis")&&t.textWrapping==="Wrap"){if(S<l.actualSize.height+l.bounds.y){if(t.textOverflow==="Ellipsis"&&u[c+1]){var x=u[c+1],I=v.y+x.dy*(c+1)+t.fontSize*.8;I>l.actualSize.height+l.bounds.y&&(m.text=m.text.slice(0,m.text.length-3),m.text=m.text.concat("..."))}d.fillText(m.text,y,S)}}else d.fillText(m.text,y,S);if(t.textDecoration==="Underline"||t.textDecoration==="Overline"||t.textDecoration==="LineThrough"){var C=y,P=void 0,A=d.measureText(m.text).width,T=y+A,z=void 0;switch(t.textDecoration){case"Underline":P=S+2,z=S+2;break;case"Overline":P=v.y+m.dy*c,z=v.y+m.dy*c;break;case"LineThrough":P=(S+v.y+m.dy*c)/2+2,z=(S+v.y+m.dy*c)/2+2}d.beginPath(),d.moveTo(C,P),d.lineTo(T,z),d.strokeStyle=t.color,d.lineWidth=t.fontSize*.08,d.globalAlpha=t.opacity,d.stroke()}}}d.restore()}},n.prototype.applyFlipAndRotate=function(e,t,i,r,a,s,o){if(t.flip!==G.None&&s&&o&&!(o.elementActions&le.ElementIsPort)){var h=s.groupElement,l=o,d=void 0;if(o instanceof Tt&&o.position?d=s.renderFlipTextElement(h,i,l,t.flip,t.flipMode,!0):(o instanceof Pt||o instanceof wr||o instanceof Tt&&!o.position||o instanceof Be)&&(d=s.renderFlipElement(h,i,t.flip,!0)),d=this.setElementTransform(o,s)||d,d&&d.transform)for(var f=/(translate|scale|rotate)\(([^)]+)\)/g,p=void 0;(p=f.exec(d.transform))!==null;){var c=p[1],u=p[2].split(",").map(function(S){return parseFloat(S.trim())});switch(c){case"translate":{var g=u[0]||0,v=u[1]||0;e.translate(g,v);break}case"scale":{var m=u[0]||1,y=u[1]||m;e.scale(m,y);break}}}}this.rotateContext(i,t.angle,r,a)},n.prototype.setElementTransform=function(e,t){for(var i=["_cancel_1_event","_cancel_0_event","_cancel_2_trigger","_success_0_event","_success_1_event","_success_2_trigger","_failure_0_event","_failure_1_event","_failure_2_trigger"],r=0,a=i;r<a.length;r++){var s=a[r];if(e.id.endsWith(s)){var o=t.transactionBounds,h=0,l=0,d=1,f=1,p=0,c=0;return(e.flip===1||e.flip===3)&&(h=o.center.x,d=-1,p=-h),(e.flip===2||e.flip===3)&&(l=o.center.y,f=-1,c=-l),{transform:"translate("+h+","+l+") scale("+d+","+f+") translate("+p+","+c+")"}}}return null},n.prototype.loadImage=function(e,t,i,r,a){var s=new Image;s.src=t.source,this.image(e,s,t.x,t.y,t.width,t.height,t)},n.prototype.drawImage=function(e,t,i,r,a,s){var o=this;if(t.visible){var h=n.getContext(e);h.save();var l=t.x+t.width*t.pivotX,d=t.y+t.height*t.pivotY,f=new Image;f.src=t.source,this.setStyle(e,t);var p=h.canvas.id.split("_");p[p.length-1],this.applyFlipAndRotate(h,t,e,l,d,a,s),r?f.onload=function(){o.loadImage(h,t,e,l,d)}:this.loadImage(h,t,e,l,d),h.restore()}},n.prototype.image=function(e,t,i,r,a,s,o){e.beginPath();var h=t.width,l=t.height,d=a,f=s,p=0,c=0;if(o&&o.alignment!=="None"){var u=o.alignment.toLowerCase().substr(1,3),g=o.alignment.toLowerCase().substr(5,3);if(o.scale==="Slice"){var v=function(){p=d,c=l*d/h},m=function(){p=h*f/l,c=f};d>f?(v(),f>c&&m()):d===f?h>l?m():v():(m(),d>p&&v());var y=this.getSliceOffset(u,p,d,h),S=this.getSliceOffset(g,c,f,l),x=h-y,I=l-S,C=p-y*(p/h),P=c-S*(c/l),A=bt("canvas",{width:a.toString(),height:s.toString()}),T=A.getContext("2d");T.drawImage(t,y,S,x,I,0,0,C,P),e.drawImage(A,i,r,a,s)}else if(o.scale==="Meet"){var z=l/h,L=f/d;p=L>z?d:f/z,c=L>z?d*z:f,i+=this.getMeetOffset(u,p,d),r+=this.getMeetOffset(g,c,f),e.drawImage(t,0,0,h,l,i,r,p,c)}else e.drawImage(t,i,r,a,s)}else e.drawImage(t,i,r,a,s);e.closePath()},n.prototype.getSliceOffset=function(e,t,i,r){switch(e){case"min":return 0;case"mid":return(t-i)/2*r/t;case"max":return(t-i)*r/t;default:return 0}},n.prototype.getMeetOffset=function(e,t,i){var r=Math.max(t,i),a=Math.min(t,i);switch(e){case"min":return 0;case"mid":return(r-a)/2;case"max":return r-a;default:return 0}},n.prototype.m=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},n.prototype.r=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(this.m(e)*this.m(t))},n.prototype.a=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(this.r(e,t))},n.prototype.labelAlign=function(e,t,i){var r=new U(t.width,i.length*(e.fontSize*1.2)),a={x:0,y:0},s=e.x,o=e.y,h=e.width*.5,l=e.height*.5,d=h,f=l;return e.textAlign==="left"?d=0:e.textAlign==="center"?t.width>e.width&&(e.textOverflow==="Ellipsis"||e.textOverflow==="Clip")&&e.textWrapping==="NoWrap"?d=0:d=e.width*.5:e.textAlign==="right"&&(d=e.width*1),a.x=s+d+(t?t.x:0),a.y=o+f-r.height/2,a},n})(),Ss=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Ot=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Oy=(function(n){Ss(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Ot([w("")],e.prototype,"source",void 0),Ot([w("transparent")],e.prototype,"color",void 0),Ot([w("None")],e.prototype,"scale",void 0),Ot([w("None")],e.prototype,"align",void 0),e})(j),Wy=(function(n){Ss(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Ot([w("Page")],e.prototype,"mode",void 0),Ot([w("PageSettings")],e.prototype,"region",void 0),Ot([X({top:25,bottom:25,left:25,right:25},Ie)],e.prototype,"margin",void 0),Ot([w(!1)],e.prototype,"canZoomIn",void 0),Ot([w(void 0)],e.prototype,"customBounds",void 0),Ot([w(!1)],e.prototype,"canFit",void 0),e})(j),Ny=(function(n){Ss(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Ot([w(null)],e.prototype,"width",void 0),Ot([w(null)],e.prototype,"height",void 0),Ot([X({},Ie)],e.prototype,"margin",void 0),Ot([w("Landscape")],e.prototype,"orientation",void 0),Ot([w("Infinity")],e.prototype,"boundaryConstraints",void 0),Ot([X({},Oy)],e.prototype,"background",void 0),Ot([w(!1)],e.prototype,"multiplePage",void 0),Ot([w(!1)],e.prototype,"showPageBreaks",void 0),Ot([X({},Wy)],e.prototype,"fitOptions",void 0),e})(j),Xy=(function(n){Ss(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Ot([w(0)],e.prototype,"horizontalOffset",void 0),Ot([w(0)],e.prototype,"verticalOffset",void 0),Ot([w(1)],e.prototype,"currentZoom",void 0),Ot([w(0)],e.prototype,"viewPortWidth",void 0),Ot([w(0)],e.prototype,"viewPortHeight",void 0),Ot([w(.2)],e.prototype,"minZoom",void 0),Ot([w(30)],e.prototype,"maxZoom",void 0),Ot([w("Diagram")],e.prototype,"scrollLimit",void 0),Ot([w()],e.prototype,"scrollableArea",void 0),Ot([w(!1)],e.prototype,"canAutoScroll",void 0),Ot([w(100)],e.prototype,"autoScrollFrequency",void 0),Ot([X({left:15,right:15,top:15,bottom:15},Ie)],e.prototype,"autoScrollBorder",void 0),Ot([X({left:0,right:0,top:0,bottom:0},Ie)],e.prototype,"padding",void 0),Ot([w(.2)],e.prototype,"zoomFactor",void 0),e})(j),Yy=(function(){function n(){this.services={}}return n.prototype.register=function(e,t){this.services[""+e]=t},n.prototype.getService=function(e){return this.services[""+e]},n})(),Rf=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),di=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Al=(function(n){Rf(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return di([w("lightgray")],e.prototype,"lineColor",void 0),di([w("")],e.prototype,"lineDashArray",void 0),di([w([1.25,18.75,.25,19.75,.25,19.75,.25,19.75,.25,19.75])],e.prototype,"lineIntervals",void 0),di([w([1,19,.5,19.5,.5,19.5,.5,19.5,.5,19.5])],e.prototype,"dotIntervals",void 0),di([w([20])],e.prototype,"snapIntervals",void 0),e})(j),Uy=(function(n){Rf(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return di([X({},Al)],e.prototype,"horizontalGridlines",void 0),di([X({},Al)],e.prototype,"verticalGridlines",void 0),di([w(pi.All)],e.prototype,"constraints",void 0),di([w(5)],e.prototype,"snapAngle",void 0),di([w("Lines")],e.prototype,"gridType",void 0),di([w(5)],e.prototype,"snapObjectDistance",void 0),di([w("#07EDE1")],e.prototype,"snapLineColor",void 0),e})(j),Hf=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),xi=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},bl=(function(n){Hf(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return xi([w(5)],e.prototype,"interval",void 0),xi([w(100)],e.prototype,"segmentWidth",void 0),xi([w("Horizontal")],e.prototype,"orientation",void 0),xi([w("RightOrBottom")],e.prototype,"tickAlignment",void 0),xi([w("red")],e.prototype,"markerColor",void 0),xi([w(25)],e.prototype,"thickness",void 0),xi([w(null)],e.prototype,"arrangeTick",void 0),e})(j),Fy=(function(n){Hf(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return xi([w(!1)],e.prototype,"showRulers",void 0),xi([w(!0)],e.prototype,"dynamicGrid",void 0),xi([X({orientation:"Horizontal"},bl)],e.prototype,"horizontalRuler",void 0),xi([X({orientation:"Vertical"},bl)],e.prototype,"verticalRuler",void 0),e})(j),Vy=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),El=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Gy=(function(n){Vy(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return El([w("")],e.prototype,"property",void 0),El([w("")],e.prototype,"field",void 0),e})(j),vh=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),te=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Bf=(function(n){vh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return te([w("")],e.prototype,"read",void 0),te([w("")],e.prototype,"create",void 0),te([w("")],e.prototype,"update",void 0),te([w("")],e.prototype,"destroy",void 0),te([w()],e.prototype,"customFields",void 0),e})(j),Zy=(function(n){vh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return te([w("")],e.prototype,"id",void 0),te([w("")],e.prototype,"sourceID",void 0),te([w("")],e.prototype,"targetID",void 0),te([w(null)],e.prototype,"sourcePointX",void 0),te([w(null)],e.prototype,"sourcePointY",void 0),te([w(null)],e.prototype,"targetPointX",void 0),te([w(null)],e.prototype,"targetPointY",void 0),te([w(null)],e.prototype,"dataManager",void 0),te([X({},Bf)],e.prototype,"crudAction",void 0),e})(j),$y=(function(n){vh(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return te([w("")],e.prototype,"id",void 0),te([w(null)],e.prototype,"dataManager",void 0),te([w(null)],e.prototype,"dataSource",void 0),te([w("")],e.prototype,"root",void 0),te([w("")],e.prototype,"parentId",void 0),te([w()],e.prototype,"doBinding",void 0),te([Lt([],Gy)],e.prototype,"dataMapSettings",void 0),te([X({},Bf)],e.prototype,"crudAction",void 0),te([X({},Zy)],e.prototype,"connectionDataSource",void 0),e})(j),Of=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Zt=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},qy=(function(n){Of(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Zt([w("LeftInFlow")],e.prototype,"yesBranchDirection",void 0),Zt([w("RightInFlow")],e.prototype,"noBranchDirection",void 0),Zt([w(["Yes","True"])],e.prototype,"yesBranchValues",void 0),Zt([w(["No","False"])],e.prototype,"noBranchValues",void 0),e})(j),Qy=(function(n){Of(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Zt([w("")],e.prototype,"fixedNode",void 0),Zt([w(30)],e.prototype,"horizontalSpacing",void 0),Zt([w("SamePoint")],e.prototype,"connectionPointOrigin",void 0),Zt([w("Nonlinear")],e.prototype,"arrangement",void 0),Zt([w(30)],e.prototype,"verticalSpacing",void 0),Zt([w(30)],e.prototype,"maxIteration",void 0),Zt([w(40)],e.prototype,"springFactor",void 0),Zt([w(50)],e.prototype,"springLength",void 0),Zt([X({left:50,top:50,right:0,bottom:0},Ie)],e.prototype,"margin",void 0),Zt([w("Auto")],e.prototype,"horizontalAlignment",void 0),Zt([w("Auto")],e.prototype,"verticalAlignment",void 0),Zt([w("TopToBottom")],e.prototype,"orientation",void 0),Zt([w("Auto")],e.prototype,"connectionDirection",void 0),Zt([w("Default")],e.prototype,"connectorSegments",void 0),Zt([w("None")],e.prototype,"type",void 0),Zt([w()],e.prototype,"getLayoutInfo",void 0),Zt([w()],e.prototype,"layoutInfo",void 0),Zt([w()],e.prototype,"getBranch",void 0),Zt([w()],e.prototype,"bounds",void 0),Zt([w(!0)],e.prototype,"enableAnimation",void 0),Zt([w(!1)],e.prototype,"enableRouting",void 0),Zt([w("")],e.prototype,"root",void 0),Zt([X({},qy)],e.prototype,"flowchartLayoutSettings",void 0),e})(j),Jy=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),_y=(function(n){Jy(e,n);function e(t,i){var r=n.call(this,t,!0)||this;return r.oldValue=null,r.endPoint=i,r}return e.prototype.mouseDown=function(t){var i,r=!0;if(t.source&&t.source.connectors&&(i=t.source.connectors[0]),t.info&&t.actualObject&&(r=t.info.ctrlKey&&t.actualObject.type!=="Orthogonal"),i&&r){this.inAction=!0,this.undoElement=E(t.source),n.prototype.mouseDown.call(this,t);var a=i.constraints&yt.InheritSegmentThumbSize,s=a?this.commandHandler.diagram.segmentThumbSize:i.segmentThumbSize,o=s>20&&i.type!=="Straight"?s/2:10;o=o/this.commandHandler.diagram.scrollSettings.currentZoom;for(var h=0;h<i.segments.length;h++){var l=i.segments[parseInt(h.toString(),10)];if(this.endPoint==="OrthoThumb")for(var d=0;d<l.points.length-1;d++){var f={x:0,y:0};f.x=(l.points[parseInt(d.toString(),10)].x+l.points[d+1].x)/2,f.y=(l.points[parseInt(d.toString(),10)].y+l.points[d+1].y)/2,$t(this.currentPosition,f,o)&&(this.selectedSegment=l,this.segmentIndex=d)}else $t(this.currentPosition,l.point,o)&&(this.selectedSegment=l)}}},e.prototype.mouseMove=function(t){if(n.prototype.mouseMove.call(this,t),this.currentPosition=t.position,this.currentPosition&&this.prevPosition){var i=this.currentPosition.y-this.prevPosition.y,r=this.currentPosition.x-this.prevPosition.x;this.currentPosition=this.commandHandler.snapConnectorEnd(this.currentPosition);var a=void 0,s=void 0,o=!1;t.source&&t.source.connectors&&(a=t.source.connectors[0]),b.equals(this.startPosition,this.prevPosition)&&(o=!0),this.oldValue===null&&(this.oldValue=E(this.selectedSegment));var h={source:a,state:"Start",oldValue:this.oldValue,newValue:this.oldValue,segment:this.selectedSegment,cancel:!1};if(h={source:a,state:"Start",oldValue:this.oldValue,newValue:this.oldValue,segment:this.selectedSegment,cancel:!1},o&&this.commandHandler.triggerEvent(Z.segmentChange,h),h.cancel&&this.commandHandler.diagram.resetTool(),this.inAction&&this.selectedSegment!==void 0&&this.endPoint!==void 0&&(r!==0||i!==0)&&!h.cancel){if(this.endPoint==="OrthoThumb")this.blocked=!this.dragOrthogonalSegment(a,this.selectedSegment,this.currentPosition,this.segmentIndex),this.oldValue.length===null&&this.oldValue.direction===null&&(this.oldValue=E(this.selectedSegment)),s=E(this.selectedSegment);else{var l=this.currentPosition.x-this.selectedSegment.point.x,d=this.currentPosition.y-this.selectedSegment.point.y,f=a.segments.indexOf(this.selectedSegment);this.blocked=!this.commandHandler.dragControlPoint(a,l,d,!1,f),s=E(this.selectedSegment)}this.commandHandler.updateSelector(),this.currentPosition=t.position;var p={source:a,state:"Progress",oldValue:this.oldValue,newValue:s,segment:this.selectedSegment,cancel:!1};this.commandHandler.triggerEvent(Z.segmentChange,p)}}return this.prevPosition=this.currentPosition,!this.blocked},e.prototype.mouseUp=function(t){var i,r;if(t.source&&t.source.connectors&&(i=t.source.connectors[0],r={segments:i.segments}),t&&t.source&&t.info&&t.info.ctrlKey&&t.info.shiftKey&&i.type==="Straight")this.addOrRemoveSegment(i,this.currentPosition);else if(this.endPoint==="OrthoThumb"&&this.selectedSegment){var a=i.segments.indexOf(this.selectedSegment),s=i.segments[a-1],o=i.segments[a+1];if(a===i.segments.length-2&&this.updateLastSegment(i,this.selectedSegment))i.segments.splice(i.segments.length-2,1);else if(s&&Math.abs(s.length)<5&&s.length>0)a!==1&&this.removePrevSegment(i,a);else if(o){var h=b.distancePoints(o.points[0],o.points[1]),l=o.length||o.length===0?o.length:h;Math.abs(l)<=5&&this.removeNextSegment(i,a)}this.commandHandler.updateEndPoint(i,r),i.selectedSegmentIndex=0}if(this.undoElement){var d=E(t.source),f={type:"SegmentChanged",redoObject:d,undoObject:this.undoElement,category:"Internal"};this.commandHandler.addHistoryEntry(f)}if(i.isBezierEditing&&(i.isBezierEditing=!1),this.prevPosition!==this.startPosition){var p={source:i,state:"Completed",oldValue:this.oldValue,newValue:E(this.selectedSegment),cancel:!1,segment:this.selectedSegment};this.commandHandler.triggerEvent(Z.segmentChange,p)}n.prototype.mouseUp.call(this,t)},e.prototype.removePrevSegment=function(t,i){var r=t.segments[i-2],a=t.segments[i+1];if(a){var s=a.length||a.length===0?a.length:b.distancePoints(a.points[0],a.points[1]);if(!(s<=5)){var o=t.segments.slice(i-1,i+1),h={element:t,removeSegments:o,type:"Removal",cancel:!1};if(this.commandHandler.triggerEvent(Z.segmentCollectionChange,h),!h.cancel){var l=t.segments[i+1];t.segments.splice(i-1,2);var d=this.selectedSegment;d.direction==="Left"||d.direction==="Right"?(r.points[r.points.length-1].x=l.points[0].x,l.points[0].y=r.points[r.points.length-1].y):(r.points[r.points.length-1].y=l.points[0].y,l.points[0].x=r.points[r.points.length-1].x),(d.length||d.length===0)&&this.findSegmentDirection(r),this.findSegmentDirection(l)}}}},e.prototype.findSegmentDirection=function(t){t.direction&&(t.length||t.length===0)&&(t.length=b.distancePoints(t.points[0],t.points[t.points.length-1]),t.direction=b.direction(t.points[0],t.points[t.points.length-1]))},e.prototype.removeNextSegment=function(t,i){var r=this.selectedSegment,a=t.segments[i-1],s=t.segments[i+2],o=t.segments[i+1],h,l;if(o.length||o.length===0?(h=t.segments.slice(i,2),l={element:t,removeSegments:h,type:"Removal",cancel:!1},l={element:t,removeSegments:h,type:"Removal",cancel:!1},this.commandHandler.triggerEvent(Z.segmentCollectionChange,l),l.cancel||(t.segments.splice(i,2),r.direction==="Top"||r.direction==="Bottom"?(s.points[0].y=r.points[0].y,a.points[a.points.length-1].x=s.points[0].x):(s.points[0].x=r.points[0].x,a.points[a.points.length-1].y=s.points[0].y))):(h=t.segments.slice(i+1,1),l={element:t,removeSegments:h,type:"Removal",cancel:!1},this.commandHandler.triggerEvent(Z.segmentCollectionChange,l),l.cancel||(t.segments.splice(i+1,1),r.direction==="Top"||r.direction==="Bottom"?a.points[a.points.length-1].x=o.points[o.points.length-1].x:a.points[a.points.length-1].y=o.points[o.points.length-1].y,this.findSegmentDirection(a),r.length=r.direction=null)),a&&s&&!l.cancel&&(a.length=b.distancePoints(a.points[0],s.points[0]),a.direction=b.direction(a.points[0],s.points[0]),s.length||s.length===0)){s.length=b.distancePoints(a.points[a.points.length-1],s.points[s.points.length-1]);var d=a.points,f=s.points;s.direction=b.direction(d[d.length-1],f[f.length-1])}},e.prototype.addOrRemoveSegment=function(t,i,r){for(var a,s,o=[],h={segments:t.segments},l=0;l<t.segments.length;l++){var d=t.segments[parseInt(l.toString(),10)];if($t(i,d.point,t.hitPadding)){s=l,a=!0,o.push(d);var f={element:t,removeSegments:o,type:"Removal",cancel:!1};r&&r.triggerEvent(Z.segmentCollectionChange,f)}}if(this.commandHandler||(this.commandHandler=r),a&&s!==void 0){if(t.segments&&t.segments[parseInt(s.toString(),10)]&&t.segments[parseInt(s.toString(),10)].type==="Straight"){var d=t.segments[parseInt(s.toString(),10)],p=t.segments[s+1];p&&(t.segments.splice(s,1),p.points[0]=d.points[0])}}else{this.commandHandler.enableServerDataBinding(!1);var c=this.findIndex(t,i);if(t.segments&&t.segments[parseInt(c.toString(),10)]&&t.segments[parseInt(c.toString(),10)].type==="Straight"){var d=t.segments[parseInt(c.toString(),10)],u=new qi(t,"segments",{type:"Straight",point:i},!0);u.points[0]=d.points[0],u.points[1]=i,d.points[0]=i,t.segments.splice(c,0,u),a=!0,o.push(d);var f={element:t,addSegments:o,type:"Addition",cancel:!1};this.commandHandler.triggerEvent(Z.segmentCollectionChange,f)}this.commandHandler.enableServerDataBinding(!0)}a&&this.commandHandler.updateEndPoint(t,h)},e.prototype.findIndex=function(t,i){for(var r=[],a=0;a<t.segments.length;a++){var s=t.segments[parseInt(a.toString(),10)],o=it.toBounds([s.points[0],s.points[1]]);o.Inflate(t.hitPadding),o.containsPoint(i)&&r.push(s)}if(r.length===1)return t.segments.indexOf(r[0]);for(var h=void 0,l=void 0,d=void 0,f=void 0,p=void 0,c=void 0,a=0;a<r.length;a++)f=r[parseInt(a.toString(),10)],p=(i.y-f.points[0].y)/(f.points[1].y-i.y),c=(i.x-f.points[0].x)/(f.points[1].x-i.x),h=Math.abs(p-c),a===0&&(l=h,d=0),h<l&&(l=h,d=a);return t.segments.indexOf(r[parseInt(d.toString(),10)])},e.prototype.dragOrthogonalSegment=function(t,i,r,a){var s={x:0,y:0},o={segments:t.segments};s.x=(i.points[parseInt(a.toString(),10)].x+i.points[a+1].x)/2,s.y=(i.points[parseInt(a.toString(),10)].y+i.points[a+1].y)/2;var h=r.y-s.y,l=r.x-s.x,d=t.segments.indexOf(i),f=!1;return t.allowNodeOverlap&&(t.selectedSegmentIndex=d||a),d!==-1&&(d===0&&t.segments.length===1&&i.points.length===2?(d=this.addSegments(t,i,l,h,d),f=!0):d===t.segments.length-1&&(i.direction===null||i.length===null)?(d=this.addTerminalSegment(t,i,l,h,a),f=!0):d===0&&(d=this.insertFirstSegment(t,i,l,h,d),f=!0),d&&(f&&(this.selectedSegment=i=t.segments[parseInt(d.toString(),10)],this.segmentIndex=0),this.updateAdjacentSegments(t,d,l,h),this.commandHandler.updateEndPoint(t,o))),!0},e.prototype.addSegments=function(t,i,r,a,s){var o,h=[],l=b.distancePoints(i.points[0],i.points[1]),d=b.direction(i.points[0],i.points[1]);h.push(new Te(t,"segments",{type:"Orthogonal",direction:d,length:l/4},!0));var f=i.points[0].y===i.points[1].y?a>0?"Bottom":"Top":r>0?"Right":"Left",p=i.points[0].x===i.points[1].x?a:r;h.push(new Te(t,"segments",{type:"Orthogonal",direction:f,length:p},!0)),h.push(new Te(t,"segments",{type:"Orthogonal",direction:d,length:l/2},!0));var c={element:t,addSegments:h,type:"Addition",cancel:!1};return this.commandHandler.triggerEvent(Z.segmentCollectionChange,c),c.cancel||(t.segments=h.concat(t.segments),o=s+2),o},e.prototype.insertFirstSegment=function(t,i,r,a,s){var o,h,l=[],d,f,p;if(t.sourcePortID&&i.length&&t.segments[0].points.length>2)for(var c=void 0,u=0;u<i.points.length-1;u++){var g=b.distancePoints(i.points[parseInt(u.toString(),10)],i.points[u+1]),v=b.direction(i.points[parseInt(u.toString(),10)],i.points[u+1]);p=new Te(t,"segments",{type:"Orthogonal",direction:v,length:g},!0),p.length===0&&(c&&(c.direction==="Top"||c.direction==="Bottom")?p.direction=r>0?"Right":"Left":p.direction=a>0?"Bottom":"Top"),c=p,l.push(p)}else d={type:"Orthogonal",direction:i.direction,length:i.length/3},l.push(new Te(t,"segments",d,!0)),i.direction==="Bottom"||i.direction==="Top"?(h=Math.abs(r),o=r>0?"Right":"Left"):(h=Math.abs(a),o=a>0?"Bottom":"Top"),p=new Te(t,"segments",{type:"Orthogonal",direction:o,length:h},!0),l.push(p);var m={element:t,addSegments:l,type:"Addition",cancel:!1};if(this.commandHandler.triggerEvent(Z.segmentCollectionChange,m),!m.cancel){if(t.sourcePortID&&i.length&&t.segments[0].points.length>2)t.segments.splice(0,1),f=1;else{var y=t.segments[1];y&&y.length&&(y.length=o!==y.direction?y.length+h:y.length-h),f=2,i.length=2*i.length/3}t.segments=l.concat(t.segments)}return f},e.prototype.updateAdjacentSegments=function(t,i,r,a){var s=t.segments[parseInt(i.toString(),10)],o=s.points[s.points.length-1],h=s.points[0],l=!0;if(s.type==="Orthogonal"){s.points[0]=h,s.points[s.points.length-1]=o;var d=t.segments[i-1];if(d&&(l=this.updatePreviousSegment(r,a,t,i)),t.segments.length-1>i&&l){var f=t.segments[i+1];this.updateNextSegment(t,s,f,r,a)}}},e.prototype.addTerminalSegment=function(t,i,r,a,s){var o=t.segments.indexOf(i),h,l,d,f,p=[],c=t.segments.pop(),u=t.segments[t.segments.length-1];h=u&&u.type==="Orthogonal"?u:null;for(var g=0;g<i.points.length-2;g++)d=b.distancePoints(i.points[parseInt(g.toString(),10)],i.points[g+1]),f=b.direction(i.points[parseInt(g.toString(),10)],i.points[g+1]),l=new Te(t,"segments",{type:"Orthogonal",length:d,direction:f},!0),p.push(l),h=l;var v=s;if((i.points.length===2||v===i.points.length-2)&&(h&&(h.length+=5),v!==void 0)){d=2*b.distancePoints(i.points[i.points.length-2],i.points[i.points.length-1])/3,f=b.direction(i.points[i.points.length-2],i.points[i.points.length-1]);var m=new Te(t,"segments",{type:"Orthogonal",length:d,direction:f});p.push(m)}var y=new Te(t,"segments",{type:"Orthogonal"},!0);p.push(y);var S={cancel:!1},x={element:t,addSegments:p,type:"Addition",cancel:S.cancel};return this.commandHandler.triggerEvent(Z.segmentCollectionChange,x),x.cancel?t.segments.push(c):(t.segments=t.segments.concat(p),o=o+s),this.commandHandler.updateEndPoint(t),o},e.prototype.updatePortSegment=function(t,i,r,a,s){if(r===1&&t.points.length===2&&t.length<0){var o=i.sourceWrapper.corners,h=i.segments[parseInt(r.toString(),10)],l=i.segments[r+1],d=void 0,f=[];d=new Te(i,"segments",{type:"Orthogonal",length:13,direction:t.direction}),f.push(d);var p=void 0;h.direction==="Left"?p=h.points[0].x-(o.middleLeft.x-20):h.direction==="Right"?p=o.middleRight.x+20-h.points[0].x:h.direction==="Bottom"?p=o.bottomCenter.y+20-h.points[0].y:p=h.points[0].y-(o.topCenter.y-20),d=new Te(i,"segments",{type:"Orthogonal",length:p,direction:h.direction}),f.push(d),h.length=h.length-p,l&&l.length&&l.direction&&(l.direction===t.direction?l.length-=13:l.direction===de(t.direction)&&(l.length+=13)),i.segments=f.concat(i.segments),this.selectedSegment=i.segments[3]}},e.prototype.updatePreviousSegment=function(t,i,r,a){var s=r.segments[parseInt(a.toString(),10)],o=r.segments[a-1];o.points[o.points.length-1]=s.points[0];var h=!(r.sourceID&&r.sourcePortID===""),l=!0;return o.type==="Orthogonal"&&(o.direction==="Bottom"?o.length+=i:o.direction==="Top"?o.length-=i:o.direction==="Right"?o.length+=t:o.length-=t,r.sourcePortID!==""&&o.length<0&&!r.allowNodeOverlap?this.updatePortSegment(o,r,a,t,i):r.sourceID&&r.sourcePortID===""&&o.length<0&&a===1&&(l=!1,this.updateFirstSegment(r,s)),h&&this.changeSegmentDirection(o,r)),l},e.prototype.changeSegmentDirection=function(t,i){i.maxSegmentThumb||t.length<0&&(t.direction=de(t.direction),t.length*=-1)},e.prototype.updateNextSegment=function(t,i,r,a,s){r.points[0]=i.points[i.points.length-1],r&&r.type==="Orthogonal"&&(r.length||r.length===0)&&(r.direction==="Left"||r.direction==="Right"?a!==0&&(r.length=r.direction==="Right"?r.length-a:r.length+a,(r.length||r.length===0)&&this.changeSegmentDirection(r,t)):s!==0&&(r.length=r.direction==="Bottom"?r.length-s:r.length+s,(r.length||r.length===0)&&this.changeSegmentDirection(r,t)))},e.prototype.updateFirstSegment=function(t,i){var r=t.segments.indexOf(i),a=!1,s=t.segments[parseInt(r.toString(),10)],o=t.segments[r-1],h,l={segments:t.segments};if(o.length<0&&t.sourceID){var d=t.sourceWrapper.corners,f=[],p=void 0,c=!1;this.changeSegmentDirection(s,t);var u=t.segments[r+1],g=t.segments[r+2];switch(u&&this.changeSegmentDirection(u,t),g&&this.changeSegmentDirection(g,t),o.direction){case"Top":case"Bottom":h=s.length>0&&s.direction==="Left"?d.middleLeft:d.middleRight,s.length>d.width/2?Math.abs(o.length)<d.height/2&&(o.length=b.distancePoints(d.center,o.points[o.points.length-1]),s.points[0].x=h.x,s.length=b.distancePoints(s.points[0],s.points[s.points.length-1]),s.length-=20,a=!0):(u&&u.direction&&u.length&&(u.points[0].y=h.y,u.points[0].x=u.points[u.points.length-1].x=s.direction==="Right"?h.x+20:h.x-20),a=!0,c=!0);break;case"Left":case"Right":h=s.length>0&&s.direction==="Top"?d.topCenter:d.bottomCenter,s.length>d.height/2?Math.abs(o.length)<d.width/2&&(o.length=b.distancePoints(d.center,o.points[o.points.length-1]),s.points[0].y=h.y,s.length=b.distancePoints(s.points[0],s.points[s.points.length-1]),s.length-=20,a=!0):(u&&u.direction&&u.length&&(u.points[0].x=h.x,u.points[0].y=u.points[u.points.length-1].y=s.direction==="Bottom"?h.y+20:h.y-20),a=!0,c=!0);break}this.changeSegmentDirection(o,t),this.changeSegmentDirection(s,t),a&&(p={type:"Orthogonal",direction:s.direction,length:20},f.push(new Te(t,"segments",p,!0)),c&&(u&&u.direction&&u.length&&(u.length=b.distancePoints(u.points[0],u.points[u.points.length-1])),g&&g.direction&&g.length&&(g.length=b.distancePoints(u.points[u.points.length-1],g.points[g.points.length-1])),t.segments.splice(r-1,2)),t.segments=f.concat(t.segments)),this.selectedSegment=c?t.segments[r-1]:t.segments[r+1],this.commandHandler.updateEndPoint(t,l)}},e.prototype.updateLastSegment=function(t,i){if(t.targetID&&t.targetPortID===""){var r=void 0,a=void 0,s=void 0,o=void 0,h=t.targetWrapper.corners,l=i.points[0],d=i.points[i.points.length-1];i.direction==="Right"||i.direction==="Left"?(r={x:l.x,y:l.y},a={x:i.direction==="Left"?d.x-h.width/2:d.x+h.width/2,y:d.y},s={x:h.center.x,y:h.center.y-h.height},o={x:h.center.x,y:h.center.y+h.height}):(r={x:l.x,y:l.y},a={x:d.x,y:i.direction==="Bottom"?d.y+h.height/2:d.y-h.height/2},s={x:h.center.x-h.width,y:h.center.y},o={x:h.center.x+h.width,y:h.center.y});var f={x1:r.x,y1:r.y,x2:a.x,y2:a.y},p={x1:s.x,y1:s.y,x2:o.x,y2:o.y};return ea(f,p).enabled}return!1},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"ConnectorEditingTool"},e})(xe),Ky=(function(){function n(e,t){this.currentAction="None",this.previousAction="None",this.previousTarget=null,this.touchArgs=void 0,this.focus=!1,this.isBlocked=!1,this.isMouseDown=!1,this.inAction=!1,this.doingAutoScroll=!1,this.diagram=null,this.objectFinder=null,this.tool=null,this.eventArgs=null,this.previousElement=null,this.isKeyUp=!0,this.keyCount=0,this.isNudgeKey=!1,this.commandObj={},this.keyArgs={},this.diagram=e,this.objectFinder=new jy,this.commandHandler=t}return Object.defineProperty(n.prototype,"action",{get:function(){return this.currentAction},set:function(e){e!==this.currentAction&&(this.currentAction==="PortDraw"&&!this.inAction&&(this.diagram.tool&=~Gt.DrawOnce,this.diagram.currentDrawingObject&&(this.diagram.currentDrawingObject=null),this.tool&&(this.tool.drawingObject&&(this.tool.drawingObject=null),this.tool.mouseUp({position:this.currentPosition})),this.tool=null),e==="Rotate"||e==="LabelRotate"?this.diagram.diagramCanvas.classList.add("e-diagram-rotate"):(this.currentAction==="Rotate"||this.currentAction==="LabelRotate")&&this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),this.currentAction=e,this.currentAction!=="None"&&this.currentAction!=="Select"&&!(this.diagram.diagramActions&k.TextEdit)&&!(this.currentPosition&&this.commandHandler.isUserHandle(this.currentPosition))&&this.currentAction!=="FixedUserHandle"?this.diagram.diagramActions=this.diagram.diagramActions|k.ToolAction:this.diagram.diagramActions=this.diagram.diagramActions&~k.ToolAction,this.diagram.setCursor(this.diagram.getCursor(e,this.inAction)))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"blocked",{get:function(){return this.isBlocked},set:function(e){this.isBlocked=e,this.blocked?this.diagram.setCursor("not-allowed"):this.diagram.setCursor(this.diagram.getCursor(this.action,this.inAction))},enumerable:!0,configurable:!0}),n.prototype.getMousePosition=function(e){var t,i,r;e.type.indexOf("touch")!==-1?(t=e,i=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY):(i=e.clientX,r=e.clientY),i=this.diagram.modifyClientOffset(i),r=this.diagram.modifyClientOffset(r);var a=new U;a=Mi(this.diagram);var s=this.diagram.element.getBoundingClientRect();return this.diagram.modifyBounds(s),i=i+this.diagram.diagramCanvas.scrollLeft-s.left-a.width,r=r+this.diagram.diagramCanvas.scrollTop-s.top-a.height,i/=this.diagram.scroller.transform.scale,r/=this.diagram.scroller.transform.scale,i-=this.diagram.scroller.transform.tx,r-=this.diagram.scroller.transform.ty,{x:i,y:r}},n.prototype.windowResize=function(e){var t=this;return this.resizeTo&&clearTimeout(this.resizeTo),this.resizeTo=setTimeout(function(){t.updateViewPortSize(t.diagram.element)},300),!1},n.prototype.updateViewPortSize=function(e){var t=document.getElementById(e.id);if(t){var i=t.getBoundingClientRect();this.diagram.modifyBounds(i),this.diagram.scroller.setViewPortSize(i.width,i.height);var r=new U;r=Mi(this.diagram);var a=this.diagram.getSizeValue(this.diagram.width,r.width),s=this.diagram.getSizeValue(this.diagram.height,r.height);if(this.diagram.diagramCanvas.style.width=a,this.diagram.diagramCanvas.style.height=s,this.diagram.scroller.setSize(),this.diagram.transformLayers(),this.diagram.rulerSettings.showRulers&&Ja(this.diagram),this.diagram.views.length>1)for(var o=0,h=this.diagram.views;o<h.length;o++){var l=h[o],d=this.diagram.views[""+l];d instanceof mr&&d.onPropertyChanged({sourceID:d.sourceID},{})}}},n.prototype.canHideResizers=function(){return(this.tool instanceof oi||this.tool instanceof Vs)&&this.isMouseDown},n.prototype.updateCursor=function(){if(this.diagram.selectedItems.nodes.length===1||this.diagram.selectedItems.connectors.length===1){var e=[];e=e.concat(this.diagram.selectedItems.nodes,this.diagram.selectedItems.connectors),this.blocked=this.eventArgs&&this.eventArgs.source&&!Qe(this.eventArgs.source)?!1:this.isMouseDown&&e.length===1&&this.tool instanceof Qr&&!Qe(e[0])}},n.prototype.isForeignObject=function(e,t){var i=e;if(i&&i.tagName.toLowerCase()!=="img")for(;i.parentNode!==null;){if(typeof i.className=="string"&&(!t&&i.className.indexOf("foreign-object")!==-1||t&&i.className.indexOf("e-diagram-text-edit")!==-1))return i;i=i.parentNode}return null},n.prototype.isMetaKey=function(e){return e.type==="mousewheel"?e.ctrlKey:navigator.platform.match("Mac")?e.metaKey:e.ctrlKey},n.prototype.renderUmlHighLighter=function(e){this.diagram.commandHandler.removeStackHighlighter();var t=this.diagram.selectedItems.nodes[0];if(t&&t.container&&t.container.type==="Stack"&&t.shape.type==="UmlClassifier"){var i=t.wrapper.bounds;if(!i.containsPoint(this.currentPosition)){var r=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x-20,y:this.currentPosition.y}),a=this.diagram.findObjectUnderMouse(r,this.action,this.inAction);if(a&&a.parentId&&a.parentId===t.id){var s=this.diagram.nameTable[a.parentId].container.orientation==="Vertical";Qd(a.wrapper,s,e.position,this.diagram,!0)}}}},n.prototype.isDeleteKey=function(e,t){return navigator.platform.match("Mac")&&e==="Backspace"&&t==="delete"},n.prototype.isMouseOnScrollBar=function(e){var t=e.offsetX,i=e.offsetY,r=this.diagram.diagramCanvas,a=r.offsetHeight,s=r.offsetWidth,o,h,l,d,f;return!!(a<r.scrollHeight&&(o={x:s-17,y:0},h={x:s,y:0},l={x:s-17,y:a},d={x:s,y:a},f=it.toBounds([o,h,l,d]),this.diagram.scroller.verticalOffset!==0&&(f.x=f.x-this.diagram.scroller.horizontalOffset,f.y=f.y-this.diagram.scroller.verticalOffset),f.containsPoint({x:t,y:i}))||s<r.scrollWidth&&(o={x:0,y:a-17},h={x:s,y:a-17},l={x:0,y:a},d={x:s,y:a},f=it.toBounds([o,h,l,d]),this.diagram.scroller.horizontalOffset!==0&&(f.x=f.x-this.diagram.scroller.horizontalOffset,f.y=f.y-this.diagram.scroller.verticalOffset),f.containsPoint({x:t,y:i})))},n.prototype.updateVirtualization=function(){var e=this,t=50,i=setInterval(function(r){e.diagram.removeVirtualObjects(i)},t);setTimeout(function(){e.diagram.deleteVirtualObject=!0},t)},n.prototype.checkPreviousAction=function(){if(this.action!==this.previousAction&&this.diagram.selectedItems.userHandles.length)for(var e=0;e<this.diagram.selectedItems.userHandles.length;e++)this.previousAction&&this.diagram.selectedItems.userHandles[parseInt(e.toString(),10)]&&(this.checkUserHandleEvent(Z.onUserHandleMouseLeave),this.previousAction="None");this.action!==this.previousAction&&(this.checkFixedUserHandleEvent(Z.onFixedUserHandleMouseLeave,this.targetItem,this.previousTarget),this.previousTarget=null,this.targetItem=null)},n.prototype.checkUserHandleEvent=function(e){if(this.diagram.selectedItems&&this.diagram.selectedItems.userHandles.length>0)for(var t=e===Z.onUserHandleMouseLeave?this.previousAction:this.action,i={element:void 0},r=0;r<this.diagram.selectedItems.userHandles.length;r++)(t===this.diagram.selectedItems.userHandles[parseInt(r.toString(),10)].name||e===Z.onUserHandleMouseUp&&t==="Select")&&(i.element=this.diagram.selectedItems.userHandles[parseInt(r.toString(),10)],this.userHandle(e,r,i,null))},n.prototype.userHandle=function(e,t,i,r){if(e===Z.onUserHandleMouseEnter||e===Z.onFixedUserHandleMouseEnter){if(this.previousAction=this.action,i.element.tooltip&&i.element.tooltip.openOn==="Auto"&&i.element.tooltip.content!==""){Oh(this.diagram,i.element);var a=void 0;i.element.pathData?e===Z.onUserHandleMouseEnter?a=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_userhandle"):e===Z.onFixedUserHandleMouseEnter&&(a=document.getElementById(r.id+"_"+r.fixedUserHandles[parseInt(t.toString(),10)].id+"_groupElement")):i.element.source?a=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_image"):i.element.content?a=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_shape_native_element"):a=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_shape_html_element"),i.element.tooltip.openOn==="Auto"&&i.element!==this.isUserHandleHover&&(this.isUserHandleHover=i.element,this.diagram.tooltipObject.open(a))}this.diagram.triggerEvent(e,i)}if(e===Z.onUserHandleMouseDown?(this.userHandleObject=this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name,this.diagram.triggerEvent(e,i)):e===Z.onFixedUserHandleMouseDown&&this.diagram.triggerEvent(e,i),e===Z.onUserHandleMouseUp){var s=void 0;i.element.pathData?s=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_userhandle"):i.element.source?s=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_image"):i.element.content?s=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_shape_native_element"):s=document.getElementById(this.diagram.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_shape_html_element"),this.commandHandler.isUserHandle(this.currentPosition)&&s&&s.id&&s.id.split(this.userHandleObject).length>1&&this.diagram.triggerEvent(e,i)}else e===Z.onFixedUserHandleMouseUp&&this.diagram.triggerEvent(e,i);(e===Z.onUserHandleMouseLeave||e===Z.onFixedUserHandleMouseLeave)&&(this.diagram.tooltipObject&&this.diagram.tooltipObject.openOn!=="Custom"&&(this.isUserHandleHover=null,this.diagram.tooltipObject.close()),this.diagram.triggerEvent(e,i))},n.prototype.checkFixedUserHandleEvent=function(e,t,i){if(t&&t.fixedUserHandles.length>0)for(var r={element:void 0},a=void 0,s=void 0,o=0;o<t.fixedUserHandles.length;o++)a=t.fixedUserHandles[parseInt(o.toString(),10)].id,i&&i.id&&i.id.indexOf(a)>-1&&(s=a,this.previousTarget=i,this.targetItem=t),s===t.fixedUserHandles[parseInt(o.toString(),10)].id&&(r.element=t.fixedUserHandles[parseInt(o.toString(),10)],this.userHandle(e,o,r,t))},n.prototype.mouseDown=function(e){var t=this;if(e.type==="touchstart"&&(this.timeOutTapHold=setTimeout(function(){(t.action==="Select"||t.action==="Drag")&&t.mouseMove(e,void 0)},500)),!(this.inAction===!0&&(this.tool instanceof da||this.tool instanceof qe)||this.inAction===!0&&e.buttons&&(e.buttons&e.buttons-1)!==0)){this.focus=!0;var i=e.touches,r=!!document.getElementsByClassName("e-dragclone")[0];if(this.isMouseOnScrollBar(e)&&!r){this.isScrolling=!0,e.preventDefault();return}if(this.checkFixedUserHandleEvent(Z.onFixedUserHandleMouseDown,this.targetItem,this.previousTarget),this.checkUserHandleEvent(Z.onUserHandleMouseDown),!this.checkEditBoxAsTarget(e)&&mn(this.diagram)||vr(this.diagram)&&!xa(this.diagram))if(this.diagram.restrictedDeltaValue={x:0,y:0},(this.action==="Select"||this.action==="Drag")&&this.diagram.updatePortVisibility(this.hoverElement,zt.Hover,!0),this.tool&&(this.tool instanceof mi||this.tool instanceof si)&&(e.button===2||e.buttons===2))this.diagram,this.currentPosition,e.buttons,this.eventArgs.actualObject,e.button===0||e.button,this.inAction=!1,this.tool.mouseUp(this.eventArgs);else if(this.tool&&this.inAction===!0&&this.isMouseDown===!0&&(this.tool instanceof mi||this.tool instanceof si))this.isMouseDown=!0,this.eventArgs={},this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.eventArgs.position=this.currentPosition,this.tool.mouseDown(this.eventArgs);else{this.isMouseDown=!0,this.currentPosition=this.prevPosition=this.getMousePosition(e),this.eventArgs={},this.diagram.textEditing&&!this.isMouseOnScrollBar(e)&&(this.diagram.endEdit(),this.diagram.textEditing=!1,this.diagram.mode==="Canvas"&&this.diagram.scroller.currentZoom!==1&&this.diagram.refreshDiagramLayer());var a=this.getTargetElement();this.action=this.diagram.findActionToBeDone(a.obj,a.sourceElement,this.currentPosition,a.target);var s=this.isMetaKey(e);if(s&&e.shiftKey&&this.diagram.connectorEditingToolModule?this.action="SegmentEnd":(s||e.shiftKey)&&(Yn(this.diagram)||Un(this.diagram))&&(this.action="Select"),this.diagram.constraints&lt.AutomaticPortCreation&&e.ctrlKey&&this.eventArgs.actualObject&&this.createPortAutomaticallyAndActivateTool(!0),this.tool=this.diagram.getTool(this.action),this.tool||(this.action="Select",this.tool=this.diagram.getTool(this.action)),this.getMouseEventArgs(this.currentPosition,this.eventArgs),s||e.shiftKey){var o=s&&e.shiftKey?{ctrlKey:s,shiftKey:e.shiftKey}:{ctrlKey:!0};this.eventArgs.info=o}this.eventArgs.position=this.currentPosition;var h=this.diagram.selectedItems.nodes;if(this.tool&&this.tool.mouseDown(this.eventArgs),this.diagram.selectedItems.canToggleSelection&&h&&this.diagram.selectedItems.nodes&&this.tool instanceof oi)for(var l=0;l<h.length;l++)h[parseInt(l.toString(),10)].id!==this.diagram.selectedItems.nodes[parseInt(l.toString(),10)].id&&(this.isSwimlaneSelected=!0);this.initialEventArgs={source:this.eventArgs.source,sourceWrapper:this.eventArgs.sourceWrapper},this.initialEventArgs.position=this.currentPosition,this.initialEventArgs.info=this.eventArgs.info,this.inAction=!1,e.type==="touchstart"&&(i&&i.length>=2&&(this.touchStartList=Tl(this.touchStartList,e,i)),i||e.preventDefault())}!this.isForeignObject(e.target)&&!this.isForeignObject(e.target,!0)&&!i&&e.preventDefault()}},n.prototype.deletePortAutomatically=function(){if(this.hoverElement instanceof Se||this.hoverElement instanceof ke)for(var e=this.hoverElement,t=this.diagram.nameTable[e.parentObj.id],i=0;i<t.ports.length;i++)t.ports[parseInt(i.toString(),10)].id===e.id&&e.inEdges.length===0&&e.outEdges.length===0&&this.diagram.removePorts(t,[e])},n.prototype.createPortAutomaticallyAndActivateTool=function(e){var t=this.findObjectsUnderMouse(this.currentPosition);if(this.hoverElement){if(this.hoverElement instanceof M){var i=this.hoverElement,r=i.wrapper.bounds,a=(this.currentPosition.x-r.x)/r.width,s=(this.currentPosition.y-r.y)/r.height,o=void 0;if(i.ports&&i.ports.length>0?(o=E(i.ports[0]),o.id="port"+K(),o.offset={x:a,y:s},o.constraints|=Ct.Draw):o={id:"port"+K(),offset:{x:a,y:s},visibility:zt.Visible,constraints:Ct.Default|Ct.Draw},e){this.diagram.addPorts(i,[o]);var h=Jd(this.diagram,i.ports[i.ports.length-1]);this.action=h==="PortDraw"?h:this.action}else if(this.eventArgs.source instanceof B&&this.eventArgs.target instanceof M){var l=this.eventArgs.target;if(l.id===i.id){this.diagram.addPorts(i,[o]);var d=this.eventArgs.source;d.targetID=i.id,d.targetPortID=o.id}}else this.eventArgs.source instanceof B&&t[0]instanceof B&&this.addAutomaticPortCreationForConnector(t,this.eventArgs)}else if(this.hoverElement instanceof B){var f=this.hoverElement,p=this.findConnectorOffset(f.intermediatePoints),o=void 0;if(f.ports&&f.ports.length>0?(o=E(f.ports[0]),o.id="port"+K(),o.offset=p,o.constraints|=Ct.Draw):o={id:"port"+K(),offset:p,visibility:zt.Visible,constraints:Ct.Default|Ct.Draw},e)this.diagram.addPorts(f,[o]),this.diagram.drawingObject={sourcePortID:o.id,sourceID:f.id,type:"Orthogonal"},this.action="PortDraw";else if(this.eventArgs.source instanceof B&&this.eventArgs.target instanceof B){var c=this.eventArgs.target,d=this.eventArgs.source;d.id!==f.id&&c.id===f.id&&(this.diagram.addPorts(f,[o]),d.targetID=f.id,d.targetPortID=o.id)}else this.eventArgs.source instanceof B&&t[0]instanceof B&&this.addAutomaticPortCreationForConnector(t,this.eventArgs)}else if(this.hoverElement instanceof Se||this.hoverElement instanceof ke){var o=this.hoverElement;o.inEdges.length===0&&o.outEdges.length===0&&(this.action="PortDraw")}}},n.prototype.addAutomaticPortCreationForConnector=function(e,t){var i=e[0],r=this.findConnectorOffset(i.intermediatePoints),a={id:"port"+K(),offset:r,visibility:zt.Visible,constraints:Ct.Default|Ct.Draw};this.diagram.addPorts(i,[a]);var s=t.source;s.targetID=i.id,s.targetPortID=a.id},n.prototype.findConnectorOffset=function(e){for(var t=0,i=[],r=0;r<e.length-1;r++){var a=e[r+1].x-e[parseInt(r.toString(),10)].x,s=e[r+1].y-e[parseInt(r.toString(),10)].y,o=Math.hypot(a,s);i.push(o),t+=o}for(var h=0,l=1/0,d=0,f=0;d<e.length-1;d++){var p=e[parseInt(d.toString(),10)],c=e[d+1],u=this.getProjectionOnSegment(this.currentPosition,p,c),g=Math.hypot(this.currentPosition.x-u.x,this.currentPosition.y-u.y);g<l&&(l=g,h=f+Math.hypot(u.x-p.x,u.y-p.y)),f+=i[parseInt(d.toString(),10)]}return h/t},n.prototype.getProjectionOnSegment=function(e,t,i){var r=i.x-t.x,a=i.y-t.y,s=r*r+a*a;if(s===0)return t;var o=((e.x-t.x)*r+(e.y-t.y)*a)/s;return o=Math.max(0,Math.min(1,o)),{x:t.x+o*r,y:t.y+o*a}},n.prototype.mouseMoveExtend=function(e,t){(this.tool instanceof mi||this.tool instanceof si)&&this.tool.mouseMove(this.eventArgs),this.diagram.scrollSettings.canAutoScroll?this.checkAutoScroll(e):this.blocked||this.tool instanceof mi||this.tool instanceof si||this.tool.mouseMove(this.eventArgs),this.eventArgs.target&&(this.hoverElement=this.eventArgs.target);var i=!((this.eventArgs.target instanceof M||this.eventArgs.target instanceof B)&&(t instanceof M||t instanceof B));this.tool instanceof zr&&this.diagram.updatePortVisibility(this.hoverElement instanceof M||this.hoverElement instanceof B?this.hoverElement:this.hoverNode,zt.Connect|zt.Hover,i),this.hoverElement instanceof M&&this.hoverNode instanceof M&&this.hoverNode&&this.hoverNode.id!==this.hoverElement.id&&this.diagram.updatePortVisibility(this.hoverNode,zt.Connect|zt.Hover,!0),this.hoverElement instanceof B&&this.hoverElement.ports.length>0&&this.diagram.updatePortVisibility(this.hoverElement,zt.Connect|zt.Hover,!0),this.previousElement instanceof M&&this.hoverElement&&this.previousElement.id!==this.hoverElement.id&&this.diagram.updatePortVisibility(this.previousElement,zt.Connect|zt.Hover,!0),this.previousElement=this.hoverElement,this.diagram.tooltip.content!==""&&(this.hoverElement=null),this.hoverNode=i?null:t},n.prototype.checkAction=function(e){if(this.action==="LabelSelect"&&this.eventArgs.sourceWrapper&&(this.eventArgs.sourceWrapper instanceof Tt||this.eventArgs.sourceWrapper instanceof we)){var t=this.commandHandler.findTarget(this.eventArgs.sourceWrapper,this.eventArgs.source);!Ut(this.diagram,t,!1,this.eventArgs.sourceWrapper)&&Qe(t)&&(this.action="LabelDrag",this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs))}else Qe(e)&&Wr(e)&&this.initialEventArgs&&this.initialEventArgs.source&&this.action==="Select"&&(!Ut(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof It&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),(!(e instanceof B)||e instanceof B&&!($t(this.currentPosition,e.sourcePoint,e.hitPadding)||$t(this.currentPosition,e.targetPoint,e.hitPadding)))&&(this.action="Drag"),this.tool=this.getTool(this.action),this.tool.mouseDown(this.initialEventArgs))},n.prototype.isSwimlaneElements=function(e){return!(e&&(e.isLane||e.isPhase||e.isHeader))},n.prototype.canShowTouchTooltip=function(e){return e.type==="touchstart"&&this.diagram.tool&Gt.SingleSelect&&this.diagram.tool&Gt.ZoomPan?(this.isMouseDown=!1,!0):!1},n.prototype.mouseMove=function(e,t){if(this.focus=!0,e.type==="touchmove"&&(this.touchArgs={target:e.target,type:"touchmove"}),this.isScrolling){e.preventDefault();return}if(mn(this.diagram)||vr(this.diagram)&&!xa(this.diagram)){this.currentPosition=this.getMousePosition(e);var i=this.diagram.findObjectsUnderMouse(this.currentPosition),r=this.diagram.findObjectUnderMouse(i,this.action,this.inAction);Qm(this.diagram,this.currentPosition);var a=!1,s=void 0;if(e.type==="touchmove"&&(t=e.touches,t&&t.length>1&&(this.touchMoveList=Tl(this.touchMoveList,e,t),this.action!=="PinchZoom"&&(a=!0))),b.equals(this.currentPosition,this.prevPosition)===!1||this.inAction||this.canShowTouchTooltip(e)){if(this.isMouseDown===!1||a){this.eventArgs={};var o=null,h=void 0;if(r!==null){if(o=this.diagram.findElementUnderMouse(r,this.currentPosition,this.diagram),o&&(h=this.commandHandler.findTarget(o,r)),(h instanceof ae||h instanceof Qt)&&(h.tooltip&&h.tooltip.content!==""||(h=r)),h!==this.hoverElement){var l=this.getContent();this.hoverElement&&this.hoverElement.tooltip.openOn==="Auto"&&l!==""&&this.elementLeave(),this.diagram.updatePortVisibility(this.hoverElement,zt.Hover,!0),r instanceof M&&(this.hoverNode=r);var d=!0;!this.isSwimlaneElements(r)&&this.hoverElement&&this.isSwimlaneElements(this.hoverElement)&&(d=!1),this.hoverElement=d?r:this.hoverElement;var f=null,p=void 0;f=this.diagram.findElementUnderMouse(r,this.currentPosition,this.diagram),f instanceof Pt&&(p=this.commandHandler.findTarget(f,r),(p instanceof Se||p instanceof ke)&&this.hoverElement.constraints&Ct.ToolTip&&(this.hoverElement=p));var c=void 0;f instanceof Tt&&(c=this.commandHandler.findTarget(f,r),(c instanceof ae||c instanceof Qt)&&c.constraints&He.Tooltip&&(this.hoverElement=c)),d?this.elementEnter(this.currentPosition,!1):this.hoverElement=r}else this.hoverElement&&this.hoverElement===h&&this.hoverElement.tooltip.content&&this.diagram.tooltipObject!==void 0&&this.hoverElement.tooltip.relativeMode==="Mouse"&&this.setTooltipOffset(this.currentPosition);o&&(s=this.commandHandler.findTarget(o,r))}this.action=this.diagram.findActionToBeDone(r,o,this.currentPosition,s),this.checkFixedUserHandleEvent(Z.onFixedUserHandleMouseEnter,r,o),this.checkUserHandleEvent(Z.onUserHandleMouseEnter),this.checkPreviousAction(),this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.tool=this.getTool(this.action),this.mouseEvents(),this.tool&&this.tool instanceof qe||this.tool instanceof si||this.tool instanceof mi?this.tool.mouseMove(this.eventArgs):t&&this.tool instanceof wn&&this.tool.mouseDown(this.eventArgs),this.updateCursor(),this.renderUmlHighLighter(this.eventArgs);var u=!1;!(this.hoverElement&&!(this.tool instanceof wn)&&r instanceof M&&this.isSwimlaneElements(r)&&(this.diagram.selectedItems.nodes.length===0||!Ut(this.diagram,this.hoverElement)))&&!(this.hoverElement instanceof B)&&(u=!0),!(this.hoverElement&&!(this.tool instanceof wn)&&r instanceof B&&(this.diagram.selectedItems.connectors.length===0||!Ut(this.diagram,this.hoverElement)))&&!(this.hoverElement instanceof M)&&(u=!0),this.diagram.updatePortVisibility(this.hoverElement,zt.Hover,u);var g=this.getContent();r===null&&this.hoverElement&&this.hoverElement.tooltip.openOn==="Auto"&&g&&(this.hoverElement=null,this.elementLeave()),a=!1}else{if(this.eventArgs.position=this.currentPosition,this.action==="Drag"&&!Ut(this.diagram,this.eventArgs.source,!1)&&this.eventArgs.source instanceof It&&this.getMouseEventArgs(this.currentPosition,this.eventArgs),this.mouseEvents(),e.ctrlKey||e.shiftKey){var v=e.ctrlKey&&e.shiftKey?{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey}:{ctrlKey:!0};this.eventArgs.info=v}this.checkAction(r);var m=this.getConnectorPadding(this.eventArgs);this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source,m),e.ctrlKey&&this.diagram.lineRoutingModule&&this.diagram.constraints&lt.LineRouting&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1&&(this.eventArgs.source=this.diagram.selectedItems),this.updateCursor(),this.inAction=!0,this.initialEventArgs=null,(this.action==="Drag"||this.action==="Rotate")&&(this.diagram.diagramActions=this.diagram.diagramActions|k.Interactions);var y=this.diagram.scroller.getPageBounds();this.tool&&this.mouseMoveExtend(e,r);var S=this.diagram.scroller.getPageBounds();if(r&&(y.width!==S.width||y.height!==S.height||y.x!==S.x||y.y!==S.y)&&this.diagram.views&&this.diagram.views.overview){var x=this.diagram.views.overview;x.updateView(x)}}this.prevPosition=this.currentPosition,this.isForeignObject(e.target,!0)||e.preventDefault()}}},n.prototype.getContent=function(){var e=this.hoverElement instanceof M&&this.hoverElement.constraints&W.Tooltip||this.hoverElement instanceof B&&this.hoverElement.constraints&yt.Tooltip||(this.hoverElement instanceof Se||this.hoverElement instanceof ke)&&this.hoverElement.constraints&Ct.ToolTip||(this.hoverElement instanceof ae||this.hoverElement instanceof Qt)&&this.hoverElement.constraints&He.Tooltip,t=this.hoverElement,i;t instanceof M&&t.children&&t.children.length>0&&(i=this.findIntersectChild(t));var r=e?this.hoverElement.tooltip.content:this.diagram.tooltip.content;return r=i?i.tooltip.content:r,r},n.prototype.findIntersectChild=function(e){for(var t,i=new it(this.currentPosition.x,this.currentPosition.y,8,8),r=0;r<e.children.length;r++)if(t=this.diagram.getObject(e.children[parseInt(r.toString(),10)]),t.wrapper.outerBounds.intersects(i))return t;return null},n.prototype.checkAutoScroll=function(e){var t=this.startAutoScroll(e);if(!t&&this.doingAutoScroll)this.doingAutoScroll=!1,clearInterval(this.timeOutValue);else if(t){if((this.tool instanceof da||this.tool instanceof qe||this.tool instanceof oi||this.tool instanceof Lr||this.tool instanceof Qr||this.tool instanceof zr)&&this.inAction){var i=this,r=this.diagram.scrollSettings.autoScrollFrequency;(r<10||isNaN(r))&&(r=100),this.diagram.scrollSettings.canAutoScroll&&t&&!this.doingAutoScroll&&(this.doingAutoScroll=!0,this.timeOutValue=setInterval(function(a){i.doAutoScroll(t,e,r)},r))}}else this.blocked=!this.tool.mouseMove(this.eventArgs)},n.prototype.mouseUp=function(e){clearTimeout(this.timeOutTapHold),this.touchArgs=void 0,this.diagram.diagramRenderer.touchMove=void 0,this.commandHandler.annotationRestrictDeltaValue={x:0,y:0},this.eventArgs&&this.eventArgs.target&&this.eventArgs.target!==this.hoverNode&&this.eventArgs.target!==this.lastObjectUnderMouse&&(this.hoverNode=this.eventArgs.target,this.lastObjectUnderMouse=this.eventArgs.target);var t=!1;(this.tool instanceof oi||this.tool instanceof Vs)&&(t=!0),this.checkFixedUserHandleEvent(Z.onFixedUserHandleMouseUp,this.targetItem,this.previousTarget),this.checkUserHandleEvent(Z.onUserHandleMouseUp),this.diagram.mode==="SVG"&&Le(this.diagram)&&this.updateVirtualization();var i=this.diagram.selectedItems.nodes,r=this.diagram.selectedItems.connectors,a;this.diagram.previousSelectedObject=null,this.diagram.diagramRenderer.rendererActions=this.diagram.removeConstraints(this.diagram.diagramRenderer.rendererActions,fi.DrawSelectorBorder);var s=e.touches;if(this.isScrolling){this.isScrolling=!1,e.preventDefault();return}if(!this.checkEditBoxAsTarget(e)&&mn(this.diagram)||vr(this.diagram)&&!xa(this.diagram)){if(this.tool&&(!(this.tool instanceof mi||this.tool instanceof si)||(this.tool instanceof mi||this.tool instanceof si)&&e.detail===2)){if(!this.isForeignObject(e.target)&&this.isMouseDown&&document.getElementById(this.diagram.element.id+"content").focus(),!this.inAction&&e.which!==3&&this.action==="Drag"){this.action="Select";var o=this.diagram.selectedItems.nodes.concat(this.diagram.selectedItems.connectors),h=this.diagram.findObjectsUnderMouse(this.currentPosition),l=this.diagram.findObjectUnderMouse(h,this.action,this.inAction),d=!0;if(!e.ctrlKey&&this.isMouseDown&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1&&e.which===1&&!Qv(this.diagram.diagramActions)&&(d=!1,this.commandHandler.clearSelection()),(!Ut(this.diagram,l)||!d)&&(this.commandHandler.selectObjects([l],void 0,o),this.diagram.selectedItems.canToggleSelection)){var f=this.diagram.selectedItems.nodes;f?f[0].parentObj instanceof Fr&&(a=!0):this.diagram.selectedItems.connectors.length>0&&(a=!0)}}var p=!1,c=this.updateContainerProperties();this.eventArgs.actualObject&&this.eventArgs.actualObject instanceof M&&(this.eventArgs.actualObject.shape.type==="Container"||this.eventArgs.actualObject.shape.activity&&this.eventArgs.actualObject.shape.activity.subProcess&&this.eventArgs.actualObject.shape.activity.subProcess.processes)&&this.diagram.updateDiagramElementQuad();var u=void 0;if(this.addUmlNode(),this.inAction=!1,this.isMouseDown=!1,this.diagram.selectedObject.helperObject&&(u=this.updateContainerBounds()),this.tool&&(this.tool.prevPosition||this.tool instanceof al)){this.eventArgs.position=this.currentPosition;var g=this.getConnectorPadding(this.eventArgs);this.getMouseEventArgs(this.currentPosition,this.eventArgs,this.eventArgs.source,g);var v=this.isMetaKey(e);if(v||e.shiftKey){var m=v&&e.shiftKey?{ctrlKey:v,shiftKey:e.shiftKey}:{ctrlKey:!0};this.eventArgs.info=m}if(this.diagram.diagramActions&k.Interactions&&(this.diagram.diagramActions=this.diagram.diagramActions&~k.Interactions),this.eventArgs.clickCount=e.detail,this.diagram.selectedObject.helperObject&&(this.tool instanceof oi||this.tool instanceof Lr)){if(this.diagram.selectedObject.actualObject&&this.diagram.selectedObject.actualObject.parentId!==""){var y=this.diagram.getObject(this.diagram.selectedObject.actualObject.parentId);y&&y.isLane&&(this.commandHandler.isContainer=!0)}p=this.diagram.lineRoutingModule&&this.diagram.nameTable.helper&&this.eventArgs.target&&this.eventArgs.target.isLane&&(this.eventArgs.source instanceof It&&this.eventArgs.source.nodes.length>0&&this.eventArgs.source.nodes[0].parentId===""||this.eventArgs.source.parentId===""),p&&(this.diagram.diagramActions=this.diagram.diagramActions|k.PreventLaneContainerUpdate),this.tool.mouseUp(this.eventArgs,c.isPreventHistory)}else{if(this.diagram.selectedItems.canToggleSelection){var S=void 0,x=void 0;if(this.diagram.selectedItems.nodes.length>0)for(var I=0;I<this.diagram.selectedItems.nodes.length;I++){var C=this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].isLane||this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].isPhase;C||this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].parentObj instanceof Fr||this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].parentObj instanceof ys||(S=this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].parentId!=="")}for(var P=this.diagram.selectedItems.nodes,I=0;I<i.length;I++)(i.length>1&&P[0].id===i[parseInt(I.toString(),10)].id||r.length>0)&&(x=!0);!this.isSwimlaneSelected&&!a&&!x&&this.tool instanceof oi&&this.currentAction==="Select"&&(!S||this.diagram.selectedItems.connectors.length>0)&&this.commandHandler.clearSelection(!0)}this.diagram.constraints&lt.AutomaticPortCreation&&e.ctrlKey&&this.createPortAutomaticallyAndActivateTool(!1),this.isSwimlaneSelected=!1,this.tool&&this.tool instanceof Qr?this.tool.mouseUp(this.eventArgs,e.button):this.tool&&this.tool.mouseUp(this.eventArgs),this.diagram.constraints&lt.AutomaticPortCreation&&e.ctrlKey&&this.deletePortAutomatically(),this.diagram.checkMenu&&(window.navigator.userAgent.indexOf("Linux")!==-1||window.navigator.userAgent.indexOf("X11")!==-1)&&(!e.pageY&&e instanceof TouchEvent&&e.changedTouches?(window.getSelection().removeAllRanges(),this.diagram.contextMenuModule.contextMenu.open(e.changedTouches[0].pageY,e.changedTouches[0].pageX,this.diagram.element),e.preventDefault()):this.diagram.contextMenuModule.contextMenu.open(e.pageY,e.pageX,this.diagram.element),this.diagram.checkMenu=!1)}c.hasStack&&this.diagram.endGroupAction()}if(u&&this.diagram.endGroupAction(),this.updateContainerBounds(!0),this.eventArgs.clickCount!==2&&(this.action!=="Select"&&this.commandHandler.updateSelectedNodeProperties(this.eventArgs.source),p)){this.diagram.diagramActions=this.diagram.diagramActions&~k.PreventLaneContainerUpdate;var A=this.eventArgs.source instanceof It?this.eventArgs.source.nodes:[this.eventArgs.source];if(A)for(var I=0;I<A.length;I++)A[parseInt(I.toString(),10)].container||(this.commandHandler.dropChildToContainer(this.eventArgs.target,A[parseInt(I.toString(),10)]),this.commandHandler.renderContainerHelper(A[parseInt(I.toString(),10)]))}if(this.diagram.selectedObject&&this.diagram.selectedObject.helperObject){var T=this.isSwimlaneChild(this.diagram.selectedObject.actualObject),z=this.diagram.selectedObject.actualObject&&this.diagram.selectedObject.actualObject.width===this.diagram.selectedObject.helperObject.width&&this.diagram.selectedObject.actualObject.height===this.diagram.selectedObject.helperObject.height;this.diagram.remove(this.diagram.selectedObject.helperObject),this.commandHandler.isTargetSubProcess(this.diagram.selectedObject.actualObject)&&this.diagram.selectedObject.actualObject.parentId===""&&this.swapProcessChildInDom(this.diagram.element.id+"_diagramLayer",this.diagram.selectedObject.actualObject),this.diagram.selectedObject={helperObject:void 0,actualObject:void 0},(this.diagram.diagramActions&k.PublicMethod&&this.diagram.constraints&lt.LineRouting||T&&z)&&(this.diagram.diagramActions=this.diagram.diagramActions&~k.PublicMethod)}if(this.blocked=!1,this.hoverElement){var L=zt.Connect;Ut(this.diagram,this.hoverElement)&&(L|=zt.Hover),this.diagram.updatePortVisibility(this.hoverElement,L,!0),this.hoverElement=null}this.touchStartList=null,this.touchMoveList=null,this.tool instanceof fa||(this.tool=null)}s||e.preventDefault(),this.diagram.currentDrawingObject=void 0;var R=this.diagram.selectedItems,O=!1;if(this.commandHandler.isUserHandle(this.currentPosition)&&this.isForeignObject(e.target)&&(O=!0),!this.inAction&&R.wrapper&&R.userHandles.length>0&&!O&&this.diagram.renderSelector(!0),!this.inAction&&!this.diagram.currentSymbol&&this.eventArgs){var N=this.getTargetElement(),H={element:N.target instanceof Se||N.target instanceof ke||N.target instanceof _o||N.target instanceof Go||N.target instanceof Xn?N.target:this.eventArgs.source||this.diagram,position:this.eventArgs.position,count:e.detail,actualObject:this.eventArgs.actualObject,button:e.button===0?"Left":e.button===1?"Middle":"Right"};this.diagram.tool!==Gt.ZoomPan&&this.diagram.triggerEvent(Z.click,H)}this.eventArgs={}}this.diagram.diagramActions=this.diagram.diagramActions&~k.PreventLaneContainerUpdate,t&&this.updateAnnotation(this.diagram.selectedItems),this.previousElement=null,this.eventArgs={},this.diagram.commandHandler.removeStackHighlighter()},n.prototype.isSwimlaneChild=function(e){if(e.shape&&e.shape.type!=="SwimLane"){var t=this.diagram.nameTable[e.parentId];if(!t)return!1;var i=t.parentId?this.diagram.nameTable[t.parentId]:t;return i&&i.shape&&i.shape.type==="SwimLane"}else return!1},n.prototype.updateAnnotation=function(e){var t=e.nodes;if(t.length>0)for(var i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)];this.diagram.updateConnectorEdges(r)}},n.prototype.swapProcessChildInDom=function(e,t){var i=document.getElementById(e);if(t.shape.activity.subProcess.processes)for(var r=0;r<t.shape.activity.subProcess.processes.length;r++){var a=document.getElementById(t.shape.activity.subProcess.processes[parseInt(r.toString(),10)]+"_groupElement");a&&i.appendChild(a)}},n.prototype.getTargetElement=function(){var e,t=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action),i=this.objectFinder.findObjectUnderMouse(this.diagram,t,this.action,this.inAction,this.eventArgs,this.currentPosition);if(this.previousAction!=="None"&&this.diagram.selectedItems.userHandles)for(var r=0;r<this.diagram.selectedItems.userHandles.length;r++){var a=this.diagram.selectedItems.userHandles[parseInt(r.toString(),10)];this.previousAction===a.name&&(e=a)}var s=null;i!==null&&(s=this.diagram.findElementUnderMouse(i,this.currentPosition,this.diagram),s&&(e=this.commandHandler.findTarget(s,i)));var o={obj:i,sourceElement:s,target:e};return o},n.prototype.getConnectorPadding=function(e){var t,i=e.source;if(i&&i instanceof It&&i.connectors.length){var r=i.connectors[0];t=r.constraints&yt.ConnectToNearByPort?r.connectionPadding:0}else i&&i instanceof B&&this.action==="PortDraw"&&this.tool instanceof qe&&i.constraints&yt.ConnectToNearByPort&&(t=i.connectionPadding);return t||0},n.prototype.addSwimLaneObject=function(e){var t,i,r,a,s,o=0,h,l=e.shape,d=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action);if(i||(i=this.diagram.findObjectUnderMouse(d,this.action,this.inAction)),this.diagram.clearSelectorLayer(),i&&!(i.isLane||i.isPhase||i.isHeader))for(var f=0;f<d.length;f++){var p=this.diagram.nameTable[d[parseInt(f.toString(),10)].id];(p.isLane||p.isPhase||p.isHeader)&&(i=p)}if(i&&(l.isPhase||l.isLane&&i.isLane)){var c=i.parentId;t=this.diagram.nameTable[""+c]}var u=null;if(t&&(r=t.shape,s=l.isLane?l.orientation===r.orientation:l.orientation!==r.orientation,l.isLane&&l.orientation!==r.orientation&&(s=!0,u=l.orientation==="Horizontal"?"height":"width")),s&&i){if(r&&r.header&&r.hasHeader&&r.orientation==="Horizontal"&&(o=1),r.phases&&r.phases.length>0&&(o+=1),l.isPhase){r.orientation==="Horizontal"?h=this.currentPosition.x-t.wrapper.bounds.x:h=this.currentPosition.y-(t.wrapper.bounds.y+(r.hasHeader?r.header.height:0));var g={id:K(),offset:h,header:{annotation:{content:l.phases[0].header===void 0?"Phase":l.phases[0].header.annotation.content,style:l.phases[0].header===void 0?{}:l.phases[0].header.annotation.style}},style:l.phases[0]===void 0?{}:l.phases[0].style};this.diagram.addPhases(t,[g])}else{var v={id:K(),style:l.lanes[0].style,canMove:l.lanes[0].canMove,header:{annotation:{content:l.lanes[0].header.annotation.content,style:l.lanes[0].header.annotation.style},style:l.lanes[0].header.style}},m=l.orientation==="Horizontal";if(m?v.height=l.lanes[0].height:v.width=l.lanes[0].width,r.orientation==="Horizontal"?(a=i.rowIndex?i.rowIndex:this.diagram.nameTable[i.parentId].rowIndex,i.wrapper.offsetY<this.currentPosition.y&&(a+=1)):(a=i.columnIndex?i.columnIndex:this.diagram.nameTable[i.parentId].columnIndex,this.currentPosition.x<i.wrapper.bounds.center.x&&(a-=1)),r.lanes.length>a)v.header.width=r.lanes[parseInt(a.toString(),10)].header.width,v.header.height=r.lanes[parseInt(a.toString(),10)].header.height;else{var y=void 0;r.orientation==="Horizontal"?y=i.rowIndex<3?0:a-o-1:y=a-1,v.header.width=r.lanes[parseInt(y.toString(),10)].header.width,v.header.height=r.lanes[parseInt(y.toString(),10)].header.height}u&&(u==="height"?(v.width=v.height,delete v.height):(v.height=v.width,delete v.width)),this.diagram.addLanes(t,[v],r.orientation==="Horizontal"?a-o:a)}this.commandHandler.select(t)}else if(l.isLane){var S={id:K(),width:e.width,height:e.height,addInfo:e.addInfo,shape:{type:"SwimLane",header:{annotation:{content:l.header===void 0?"Header":l.header.annotation.content,style:l.header===void 0?{}:l.header.annotation.style},height:50,style:l.header?l.header.style:l.lanes[0].header.style},phases:[{id:K(),header:{annotation:{content:l.phases===void 0||l.phases[0].header===void 0?"Phase":l.phases[0].header.annotation.content,style:l.phases===void 0?{}:l.phases[0].header===void 0?{}:l.phases[0].header.annotation.style},style:l.phases===void 0?{}:l.phases[0].header===void 0?{}:l.phases[0].header.style},style:l.phases===void 0?{}:l.phases[0].style}],lanes:[{id:K(),height:e.height,width:e.width,style:l.lanes[0].style,canMove:l.lanes[0].canMove,header:{annotation:{content:l.lanes[0].header.annotation.content,style:l.lanes[0].header.annotation.style},style:l.lanes[0].header.style}}],orientation:l.orientation}};l.orientation==="Vertical"&&(S.width+=20),S.offsetX=this.currentPosition.x+S.width/2,S.offsetY=this.currentPosition.y+S.height/2,S.style=e.style,this.diagram.add(S)}},n.prototype.mouseLeave=function(e){if(this.tool&&this.inAction&&this.tool.mouseLeave(this.eventArgs),this.diagram.selectedObject.helperObject){this.updateContainerProperties();var t=this.updateContainerBounds();t&&this.diagram.endGroupAction()}this.eventArgs&&this.eventArgs.source&&(this.diagram.updatePortVisibility(this.eventArgs.source,zt.Hover,!0),this.hoverElement=null),this.eventArgs&&!this.eventArgs.source&&this.hoverElement&&(this.hoverElement=null),this.tool instanceof zr&&this.eventArgs&&this.eventArgs.target&&this.eventArgs.target instanceof M&&(this.diagram.updatePortVisibility(this.eventArgs.target,zt.Hover|zt.Connect,!0),this.hoverElement=null);var i=this.diagram.selectedItems;i&&i.wrapper&&(kn(this.diagram,i)||this.diagram.renderSelector(!0)),(this.diagram.diagramActions&k.Interactions||this.diagram.diagramActions&k.ToolAction)&&(this.diagram.diagramActions=this.diagram.diagramActions&~k.ToolAction),this.isMouseDown=!1,this.focus=!1,this.touchStartList=null,this.touchMoveList=null,this.elementLeave(),this.commandHandler.removeSnap(),this.inAction=!1,this.eventArgs={},this.diagram.selectedObject&&this.diagram.selectedObject.helperObject&&(this.diagram.remove(this.diagram.selectedObject.helperObject),this.diagram.selectedObject={helperObject:void 0,actualObject:void 0}),this.tool=null,qm(),this.action==="Rotate"&&this.diagram.diagramCanvas.classList.remove("e-diagram-rotate"),e.preventDefault()},n.prototype.mouseWheel=function(e){this.diagram.blazorActions|=jt.interaction;var t={event:e,cancel:!1};if(this.diagram.triggerEvent(Z.mouseWheel,t),!t.cancel){var i=e.wheelDelta>0||-40*e.detail>0,r=this.getMousePosition(e);this.diagram.tooltipObject.close();var a=this.isMetaKey(e);if(a){var s=this.diagram.scrollSettings.zoomFactor;i?this.diagram.zoomTo({type:"ZoomIn",zoomFactor:s,focusPoint:r}):this.diagram.zoomTo({type:"ZoomOut",zoomFactor:s,focusPoint:r}),e.preventDefault()}else{var o=this.diagram.scroller.horizontalOffset,h=this.diagram.scroller.verticalOffset,l=i?10:-10;this.tool&&(this.tool instanceof mi||this.tool instanceof si)&&(this.eventArgs={},this.getMouseEventArgs(r,this.eventArgs),this.eventArgs.position=r,this.tool.mouseWheel(this.eventArgs)),this.diagram.scrollActions|=ei.Interaction;var d=!0;if(e.isTrusted){var f=!1;(Math.abs(e.deltaY)<100&&Math.abs(e.deltaX)===-0||Math.abs(e.deltaX)<100&&Math.abs(e.deltaY)===-0)&&(f=!0);var p=!1;if((e.deltaX!==0||e.deltaY!==0)&&(p=navigator.userAgent.includes("Macintosh")),p){var c=Math.abs(e.deltaX)>Math.abs(e.deltaY);c?(e.shiftKey||e.deltaX&&e.deltaX!==-0&&(f||!p))&&this.diagram.scroller.zoom(1,l,0,r,d,void 0,f):e.deltaY&&e.deltaY!==-0&&(f||!p)&&this.diagram.scroller.zoom(1,0,l,r,d,void 0,f)}else e.shiftKey||e.deltaX&&e.deltaX!==-0&&(f||!p)?this.diagram.scroller.zoom(1,l,0,r,d,void 0,f):e.deltaY&&e.deltaY!==-0&&(f||!p)&&this.diagram.scroller.zoom(1,0,l,r,d,void 0,f)}else e.shiftKey||e.deltaX&&e.deltaX!==-0?this.diagram.scroller.zoom(1,l,0,r,d):this.diagram.scroller.zoom(1,0,l,r,d);this.diagram.scrollActions&=~ei.Interaction,(o!==this.diagram.scroller.horizontalOffset||h!==this.diagram.scroller.verticalOffset)&&e.preventDefault()}if(this.diagram.textEditing){if(this.diagram.isTriggerEvent=!0,this.diagram.activeLabel.parentId){var u=this.diagram.getObject(this.diagram.activeLabel.parentId);this.diagram.startTextEdit(u,this.diagram.activeLabel.id)}this.diagram.isTriggerEvent=!1}this.diagram.blazorActions=this.diagram.blazorActions&~jt.interaction}},n.prototype.keyDown=function(e){if(e.fromMouseEvents&&(e.ctrlKey&&(this.keyArgs.keyModifiers=1),e.shiftKey&&(this.keyArgs.keyModifiers=4),e.shiftKey&&e.ctrlKey&&(this.keyArgs.keyModifiers=5)),!(this.diagram.diagramActions&k.TextEdit)&&!this.checkEditBoxAsTarget(e)||e.key==="Escape"||e.keyCode===27){var t="inAction",i=void 0,r=e.keyCode?e.keyCode:e.which,a=e.key;(a==="ArrowDown"||a==="ArrowUp"||a==="ArrowLeft"||a==="ArrowRight")&&(this.isNudgeKey=!0);var s=this.isMetaKey(e);if(this.diagram.commandManager&&this.diagram.commands)for(var o=this.diagram.commands,h=0,l=Object.keys(o);h<l.length;h++){var d=l[h];if(i=this.diagram.commands[""+d],i&&(i.gesture.keyModifiers||i.gesture.key)&&(r===i.gesture.key||ut[i.gesture.key]&&a===ut[i.gesture.key]||a===ut[i.gesture.key].split("Number")[1]||this.isDeleteKey(a,d))&&(!i.gesture.keyModifiers&&!e.altKey&&!e.shiftKey&&!s||i.gesture.keyModifiers&&(s||e.altKey||e.shiftKey)&&this.altKeyPressed(i.gesture.keyModifiers)&&e.altKey||this.shiftKeyPressed(i.gesture.keyModifiers)&&e.shiftKey||this.ctrlKeyPressed(i.gesture.keyModifiers)&&s&&this.keyArgs.keyModifiers===i.gesture.keyModifiers)){var f=_t(i.canExecute);if(f&&f({keyDownEventArgs:KeyboardEvent,parameter:i.parameter})){if(e.preventDefault(),e.key==="Escape")if(this.checkEditBoxAsTarget(e))document.getElementById(this.diagram.diagramCanvas.id).focus();else if(this.diagram.currentSymbol){var p="selectedSymbols",c="sourceElement",u="intDestroy";this.diagram.removeFromAQuad(this.diagram.currentSymbol),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[this.diagram.currentSymbol.id]),this.diagram.removeElements(this.diagram.currentSymbol);var g=this.diagram.currentSymbol;g instanceof M&&g.shape.type==="Bpmn"&&g.shape.shape==="TextAnnotation"&&this.diagram.removeDependentConnector(g),jo(this.diagram.currentSymbol,this.diagram),delete this.diagram.nameTable[this.diagram.currentSymbol.id];var v=this.diagram.droppable[""+c];v.draggable[""+u]();var m=this.diagram.droppable[""+p];m.parentNode.removeChild(m);var y=this.diagram.diagramActions;this.diagram.diagramActions=this.diagram.addConstraints(y,k.PreventClearSelection),this.tool.mouseUp(this.eventArgs),this.diagram.diagramRenderer.rendererActions=this.diagram.removeConstraints(this.diagram.diagramRenderer.rendererActions,fi.DrawSelectorBorder),this.diagram.previousSelectedObject&&this.diagram.select(this.diagram.previousSelectedObject),this.action="Select",this.diagram.previousSelectedObject=null,this.diagram.currentSymbol=null,this.diagram.diagramActions=this.diagram.removeConstraints(y,k.PreventClearSelection),this.isMouseDown=!1}else this.inAction&&this.diagram.drawingObject&&this.tool&&this.tool[""+t]&&(this.tool.mouseUp(this.eventArgs),this.tool=null,this.isMouseDown=!1);if(i.execute&&(this.commandObj=i,this.diagram.tool!==Gt.ZoomPan)){var S=_t(i.execute);this.isNudgeKey?(this.isKeyUp||(this.keyArgs.oldValue={offsetX:this.diagram.selectedItems.offsetX,offsetY:this.diagram.selectedItems.offsetY},this.keyCount++,this.keyCount>4&&(S({keyDownEventArgs:KeyboardEvent,parameter:i.parameter,type:"KEYDOWN"}),this.keyCount=0,this.keyArgs.newValue={offsetX:this.diagram.selectedItems.offsetX,offsetY:this.diagram.selectedItems.offsetY},this.diagram.triggerEvent(Z.positionChange,this.keyArgs))),this.isKeyUp=!1):S({keyDownEventArgs:KeyboardEvent,parameter:i.parameter})}break}}}}this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes:this.diagram.selectedItems.connectors;var x=this.diagram.selectedItems;this.keyArgs={element:x,key:e.key,keyCode:e.keyCode?e.keyCode:e.which},this.getKeyModifier(this.keyArgs,e),this.diagram.diagramActions&k.TextEdit&&this.getlabel(this.keyArgs,e),this.diagram.triggerEvent(Z.keyDown,this.keyArgs)},n.prototype.getlabel=function(e,t){var i=this.diagram.activeLabel;e.target=this.diagram.element.id+"_editBox";var r=this.diagram.nameTable[i.parentId];if(document.getElementById(this.diagram.element.id+"_editBox")){e.text=document.getElementById(this.diagram.element.id+"_editBox").value;for(var a=0;a<r.annotations.length;a++)if(r.annotations[parseInt(a.toString(),10)].id===i.id){e.label=r.annotations[parseInt(a.toString(),10)];break}}},n.prototype.getKeyModifier=function(e,t){e.keyModifiers=dt.None,t.ctrlKey&&(e.keyModifiers|=dt.Control),t.shiftKey&&(e.keyModifiers|=dt.Shift),t.altKey&&(e.keyModifiers|=dt.Alt),this.isMetaKey(t)&&(e.keyModifiers|=dt.Meta)},n.prototype.keyUp=function(e){var t=this.diagram.selectedItems;if(this.keyArgs={element:t,key:e.key,keyCode:e.keyCode?e.keyCode:e.which,oldValue:{offsetX:t.offsetX,offsetY:t.offsetY},newValue:{offsetX:t.offsetX,offsetY:t.offsetY}},this.diagram.selectedItems.nodes.length?this.diagram.selectedItems.nodes:this.diagram.selectedItems.connectors,this.getKeyModifier(this.keyArgs,e),this.diagram.diagramActions&k.TextEdit&&this.getlabel(this.keyArgs,e),this.diagram.triggerEvent(Z.keyUp,this.keyArgs),!this.isKeyUp&&this.isNudgeKey){var i=_t(this.commandObj.execute);i({keyDownEventArgs:KeyboardEvent,parameter:this.commandObj.parameter,type:"KEYUP"}),this.keyArgs.newValue={offsetX:this.diagram.selectedItems.offsetX,offsetY:this.diagram.selectedItems.offsetY},this.diagram.triggerEvent(Z.positionChange,this.keyArgs),this.isNudgeKey=!1,this.keyCount=0}},n.prototype.startAutoScroll=function(e){var t=this.getMousePosition(e);t.x*=this.diagram.scroller.currentZoom,t.y*=this.diagram.scroller.currentZoom;var i=Mi(this.diagram),r,a=this.diagram.scrollSettings.autoScrollBorder;if(vt.info.name==="mozilla"&&this.diagram.scroller.viewPortWidth===0){var s=document.getElementById(this.diagram.element.id).getBoundingClientRect();s.width!==this.diagram.scroller.viewPortWidth&&this.diagram.scroller.setViewPortSize(s.width,s.height)}return this.diagram.scrollSettings.canAutoScroll&&(t.x+this.diagram.scroller.horizontalOffset+a.right+i.width>=this.diagram.scroller.viewPortWidth-18?r="right":t.x+this.diagram.scroller.horizontalOffset<a.left?r="left":t.y+this.diagram.scroller.verticalOffset+a.bottom+i.height>this.diagram.scroller.viewPortHeight-18?r="bottom":t.y+this.diagram.scroller.verticalOffset<a.top&&(r="top")),r},n.prototype.doAutoScroll=function(e,t,i,r){var a=e,s=!0;if((this.tool instanceof da||this.tool instanceof qe||this.tool instanceof oi||this.tool instanceof Lr||this.tool instanceof Qr||this.tool instanceof zr)&&this.inAction){var o=this.getMousePosition(t);this.diagram.scrollSettings.autoScrollBorder;var h=0,l=0,d=!1,f="",p={x:o.x,y:o.y};switch(this.tool instanceof Lr&&(this.tool.corner==="ResizeSouthEast"||this.tool.corner==="ResizeSouthWest"||this.tool.corner==="ResizeNorthWest"||this.tool.corner==="ResizeNorthEast")&&(d=!0,f=this.tool.corner),a){case"right":p.x=o.x+10,h=10,d&&(f==="ResizeSouthEast"?(p.y=o.y+10,l=10):(p.y=o.y-10,l=-10));break;case"left":p.x=o.x-10,h=-10,d&&(f==="ResizeNorthWest"?(p.y=o.y-10,l=-10):(p.y=o.y+10,l=10));break;case"bottom":p.y=o.y+10,l=10,d&&(f==="ResizeSouthEast"?(p.x=o.x+10,h=10):(p.x=o.x-10,h=-10));break;case"top":p.y=o.y-10,l=-10,d&&(f==="ResizeNorthEast"?(p.x=o.x+10,h=10):(p.x=o.x-10,h=-10));break}this.eventArgs.position={x:p.x,y:p.y},this.currentPosition=this.eventArgs.position;var c=this.objectFinder.findObjectsUnderMouse(this.currentPosition,this.diagram,this.eventArgs,null,this.action);this.eventArgs.target=this.diagram.findObjectUnderMouse(c,this.action,this.inAction),this.tool.mouseMove(this.eventArgs),this.diagram.scrollActions|=ei.Interaction,this.diagram.scroller.zoom(1,-h,-l,o,s),this.diagram.scrollActions&=~ei.Interaction}},n.prototype.mouseEvents=function(){for(var e=this.diagram.findObjectsUnderMouse(this.currentPosition),t=0;t<e.length;t++)this.eventArgs.actualObject===e[parseInt(t.toString(),10)]&&e.splice(t,1);var i={targets:{}};if(i={targets:e,element:this.eventArgs.source===this.eventArgs.actualObject?void 0:this.eventArgs.source,actualObject:this.eventArgs.actualObject},this.lastObjectUnderMouse&&this.diagram.mouseLeave&&(!this.eventArgs.actualObject||this.lastObjectUnderMouse!==this.eventArgs.actualObject)){var r={targets:void 0,element:this.lastObjectUnderMouse,actualObject:void 0};this.diagram.triggerEvent(Z.mouseLeave,r),this.lastObjectUnderMouse=null}(!this.lastObjectUnderMouse&&this.eventArgs.source||this.lastObjectUnderMouse!==this.eventArgs.actualObject)&&(this.lastObjectUnderMouse=this.eventArgs.actualObject,this.eventArgs.actualObject!==void 0&&this.diagram.triggerEvent(Z.mouseEnter,i)),this.eventArgs.actualObject&&this.diagram.triggerEvent(Z.mouseOver,i)},n.prototype.elementEnter=function(e,t){if(!t){var i=this.hoverElement instanceof M&&this.hoverElement.constraints&W.Tooltip||this.hoverElement instanceof B&&this.hoverElement.constraints&yt.Tooltip||(this.hoverElement instanceof Se||this.hoverElement instanceof ke)&&this.hoverElement.constraints&Ct.ToolTip||(this.hoverElement instanceof ae||this.hoverElement instanceof Qt)&&this.hoverElement.constraints&He.Tooltip,r=this.getContent(),a=void 0;this.diagram.tooltipObject&&(this.diagram.tooltipObject.windowCollision=!0),this.hoverElement&&this.hoverElement.children&&this.hoverElement.children.length>0&&(a=this.findIntersectChild(this.hoverElement),r===""&&(r=this.hoverElement.tooltip.content)),this.hoverElement.tooltip.openOn==="Auto"&&r!==""&&Oh(this.diagram,i?this.hoverElement:void 0),this.hoverElement.tooltip.content&&(this.hoverElement.tooltip.relativeMode==="Mouse"?this.setTooltipOffset(e):(this.diagram.tooltipObject.offsetX=0,this.diagram.tooltipObject.offsetY=0));var s=this.diagram.findObjectsUnderMouse(this.currentPosition),o=this.diagram.findObjectUnderMouse(s,this.action,this.inAction);if(o!==null){var h=void 0;if(this.hoverElement.tooltip.isSticky&&(this.diagram.tooltipObject.isSticky=!0),o instanceof M&&o.children&&o.children.length>0&&(o=a||o),o.ports&&(this.hoverElement instanceof Se||this.hoverElement instanceof ke))h=document.getElementById(o.id+"_"+this.hoverElement.id);else if(o.annotations&&(this.hoverElement instanceof ae||this.hoverElement instanceof Qt))h=document.getElementById(o.id+"_"+this.hoverElement.id);else{var l=o.shape&&o.shape instanceof Jn?"_content_native_element":"_groupElement";h=document.getElementById(o.id+l)}this.hoverElement.tooltip.openOn==="Auto"&&r!==""&&(this.diagram.tooltipObject.close(),this.diagram.tooltipObject.openOn=this.hoverElement.tooltip.openOn,this.diagram.tooltipObject.dataBind()),Uv(this.hoverElement,this.diagram)&&this.hoverElement.tooltip.openOn==="Auto"&&(this.diagram.tooltipObject.target=this.hoverElement.id,this.hoverElement.tooltip.relativeMode==="Mouse"?this.diagram.tooltipObject.open(this.diagram.element):this.diagram.tooltipObject.open(h))}}},n.prototype.elementLeave=function(){this.diagram.tooltipObject&&!this.diagram.tooltipObject.isSticky&&this.diagram.tooltipObject.openOn!=="Custom"&&this.diagram.tooltipObject.close()},n.prototype.setTooltipOffset=function(e){var t=this.updatePointBasedOnScale(e),i=c0(this.diagram,t,this.hoverElement);this.diagram.tooltipObject.offsetX=i.x,this.diagram.tooltipObject.offsetY=i.y},n.prototype.updatePointBasedOnScale=function(e){var t=this.diagram.scaleValue,i={x:e.x*t,y:e.y*t};return i},n.prototype.altKeyPressed=function(e){return!!(e&dt.Alt)},n.prototype.ctrlKeyPressed=function(e){return!!(e&dt.Control)},n.prototype.shiftKeyPressed=function(e){return!!(e&dt.Shift)},n.prototype.scrolled=function(e){this.diagram.updateScrollOffset()},n.prototype.isMobileOrIPadDevice=function(){var e=navigator.userAgent||navigator.vendor||window.opera;return navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1?"iOS (iPad)":/iPhone|iPad|iPod/.test(e)&&!window.MSStream?"iOS":/android/i.test(e)?"Android":/Mobile|Tablet/.test(e)?"Mobile":"Desktop"},n.prototype.doubleClick=function(e){if(mn(this.diagram)){var t=this.isMobileOrIPadDevice(),i=this.diagram.tool;t!=="Desktop"&&this.tool&&(this.tool instanceof mi||this.tool instanceof si)&&(this.diagram.tool=0);var r=void 0,a=this.diagram.findObjectsUnderMouse(this.currentPosition),s=this.diagram.findObjectUnderMouse(a,this.action,this.inAction);if(s!==null&&mn(this.diagram))if(r=this.diagram.findElementUnderMouse(s,this.currentPosition,this.diagram),this.tool&&(this.tool instanceof mi||this.tool instanceof si))this.currentPosition,e.detail,this.diagram.tool=i,this.tool.mouseUp(this.eventArgs),this.isMouseDown=!1,this.eventArgs={},this.tool=null,e.preventDefault();else{var o=this.diagram.commandHandler.getObjectLayer(s.id);if(o&&!o.lock&&o.visible&&!(this.diagram.diagramActions&k.TextEdit)){var h="";this.diagram.startTextEdit(s,h||(r instanceof Tt?r.id.split(s.id+"_")[1]:void 0))}}var l={source:s||this.diagram,position:this.currentPosition,count:e.detail};this.diagram.triggerEvent(Z.doubleClick,l)}},n.prototype.itemClick=function(e,t){var i=e;return ne(this.diagram,i,!0)?i:null},n.prototype.inputChange=function(e){var t=90,i,r=12,a,s,o,h,l,d,f,p,c=document.getElementById(this.diagram.element.id+"_editBox"),u=document.getElementById(this.diagram.element.id+"_editTextBoxDiv"),g=c.value,v=g.split(`
`);o=this.diagram.selectedItems.nodes[0]?this.diagram.selectedItems.nodes[0]:this.diagram.selectedItems.connectors[0],(!o&&this.tool instanceof fa||o&&o.shape.type==="SwimLane")&&(o=this.diagram.nameTable[this.diagram.activeLabel.parentId]),o&&(o.shape.type!=="Text"&&o.annotations.length>0||o.shape.type==="Text")&&(s=this.diagram.getWrapper(o.wrapper,this.diagram.activeLabel.id),i=o.wrapper.bounds.width<s.bounds.width?o.wrapper.bounds.width:s.bounds.width,i=i>t?i:t,d=Af(s.style,g,void 0,void 0,i),a=Number(c.style.fontSize.split("px")[0]),v.length>1&&v[v.length-1]===""&&(d.height=d.height+a),f=this.diagram.scroller.transform,p=Ud(this.diagram)?f.scale:1,l=d.width,l=(t>l?t:l)*p,h=(r>d.height?r:d.height)*p,u.style.left=(s.bounds.center.x+f.tx)*f.scale-l/2-2.5+"px",u.style.top=(s.bounds.center.y+f.ty)*f.scale-h/2-3+"px",s.flipTransformOffset&&(u.style.left=parseFloat(u.style.left)+s.flipTransformOffset.x+"px",u.style.top=parseFloat(u.style.top)+s.flipTransformOffset.y+"px"),u.style.width=l+"px",u.style.height=h+"px",c.style.minHeight=r+"px",c.style.minWidth=t+"px",c.style.width=l+"px",c.style.height=h+"px")},n.prototype.isAddTextNode=function(e,t){return this.tool instanceof fa||t?(this.tool=null,e&&!ds(this.diagram)&&(this.diagram.drawingObject=void 0,this.diagram.currentDrawingObject=void 0),!(ml(this.diagram.nodes,e.id)||ml(this.diagram.connectors,e.id))):!1},n.prototype.checkEditBoxAsTarget=function(e){return!!(e.target&&e.target.id===this.diagram.element.id+"_editBox")},n.prototype.getMouseEventArgs=function(e,t,i,r){t.position=e;var a,s;i?(s=this.diagram.findObjectsUnderMouse(this.currentPosition,i),a=this.diagram.findTargetObjectUnderMouse(s,this.action,this.inAction,t.position,i)):this.action==="Drag"||this.action==="ConnectorSourceEnd"||this.action==="SegmentEnd"||this.action==="OrthoThumb"||this.action==="BezierSourceThumb"||this.action==="BezierTargetThumb"||this.action==="ConnectorTargetEnd"||this.action.indexOf("Rotate")!==-1||this.action.indexOf("Resize")!==-1?(a=this.diagram.selectedItems,!this.diagram.currentSymbol&&this.action==="Drag"&&a&&this.diagram.selectedItems.nodes.length>0&&this.diagram.selectedItems.nodes[0].shape.type==="SwimLane"&&(s=this.diagram.findObjectsUnderMouse(this.currentPosition),a=this.diagram.findObjectUnderMouse(s,this.action,this.inAction))):(s=this.diagram.findObjectsUnderMouse(this.currentPosition),a=this.diagram.findObjectUnderMouse(s,this.action,this.inAction)),a&&a.isHeader&&["LabelSelect","LabelDrag"].indexOf(this.currentAction)===-1&&(a=this.diagram.nameTable[a.parentId],this.eventArgs.actualObject=a);var o;if(a){o=this.diagram.findElementUnderMouse(a,this.currentPosition,this.diagram,r);var h=void 0,l=void 0,d=void 0;if((o&&a.ports&&a.ports.length&&!is(a,o)||!o||!a)&&s&&s.length&&i instanceof It){for(h=i.connectors[0],d=s.length-1;d>=0;d--)if(l=s[parseInt(d.toString(),10)],(l instanceof M||l instanceof B)&&h&&h.connectionPadding){if(a=l,o=this.diagram.findElementUnderMouse(a,this.currentPosition,this.diagram,r),h.constraints&yt.ConnectToNearByPort&&a&&a.ports&&a.ports.length&&is(a,o))break;if((l instanceof M||l instanceof B)&&h&&h.connectionPadding&&l.wrapper.outerBounds.containsPoint(this.currentPosition)&&h.constraints&yt.ConnectToNearByNode&&!(h.constraints&yt.ConnectToNearByPort)){a=l,o=this.diagram.findElementUnderMouse(a,this.currentPosition,this.diagram,0);break}}}}return i?(t.target=a,t.targetWrapper=o):(t.source=a,t.sourceWrapper=o),t.actualObject=this.eventArgs.actualObject,t.source instanceof It&&t.actualObject===void 0&&(t.source.nodes.length>0||t.source.connectors.length>0)&&(t.actualObject=t.source.nodes.length>0?this.diagram.nameTable[t.source.nodes[0].id]:this.diagram.nameTable[t.source.connectors[0].id]),t.startTouches=this.touchStartList,t.moveTouches=this.touchMoveList,t},n.prototype.resetTool=function(){this.action="Select",this.hoverElement=null,this.hoverNode=null,this.tool=this.diagram.getTool(this.action),this.updateCursor()},n.prototype.updateTool=function(){if(!this.currentPosition)this.action="Select";else{var e=this.diagram.findObjectsUnderMouse(this.currentPosition),t=this.diagram.findObjectUnderMouse(e,this.action,this.inAction),i=null,r=void 0;t!==null&&(i=this.diagram.findElementUnderMouse(t,this.currentPosition,this.diagram)),i&&(r=this.commandHandler.findTarget(i,t)),this.action=this.diagram.findActionToBeDone(t,i,this.currentPosition,r)}},n.prototype.getTool=function(e){switch(e){case"Select":return new Qr(this.commandHandler,!0);case"Drag":return new oi(this.commandHandler);case"Rotate":return new Vs(this.commandHandler);case"LayoutAnimation":return new zm(this.commandHandler);case"FixedUserHandle":return new Mm(this.commandHandler,!0);case"Hyperlink":return new al(this.commandHandler);case"ResizeSouthEast":case"ResizeSouthWest":case"ResizeNorthEast":case"ResizeNorthWest":case"ResizeSouth":case"ResizeNorth":case"ResizeWest":case"ResizeEast":return new Lr(this.commandHandler,e);case"ConnectorSourceEnd":case"ConnectorTargetEnd":case"BezierSourceThumb":case"BezierTargetThumb":return new zr(this.commandHandler,e);case"SegmentEnd":case"OrthoThumb":return new _y(this.commandHandler,e);case"Draw":var t="shape",i=s0(this.diagram.drawingObject);if(i==="Node"&&this.diagram.drawingObject.shape.type==="Text")return new fa(this.commandHandler);if(i==="Connector"&&this.diagram.drawingObject.type==="Freehand")return new Bm(this.commandHandler);if(i==="Node"&&this.diagram.drawingObject.shape[""+t]==="Polygon"&&!this.diagram.drawingObject.shape.points)return new mi(this.commandHandler);if(i==="Node"||i==="Node"&&this.diagram.drawingObject.shape[""+t]==="Polygon"&&this.diagram.drawingObject.shape.points)return new da(this.commandHandler,this.diagram.drawingObject);if(i==="Connector"&&this.diagram.drawingObject.type==="Polyline")return new si(this.commandHandler);if(i==="Connector")return new qe(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);break;case"Pan":return new wn(this.commandHandler,!1);case"PinchZoom":return new wn(this.commandHandler,!0);case"PortDrag":return new oi(this.commandHandler,"Port");case"PortDraw":return new qe(this.commandHandler,"ConnectorSourceEnd",this.diagram.drawingObject);case"LabelSelect":return new Qr(this.commandHandler,!0,"LabelSelect");case"LabelDrag":return new km(this.commandHandler);case"LabelResizeSouthEast":case"LabelResizeSouthWest":case"LabelResizeNorthEast":case"LabelResizeNorthWest":case"LabelResizeSouth":case"LabelResizeNorth":case"LabelResizeWest":case"LabelResizeEast":return new Rm(this.commandHandler,e);case"LabelRotate":return new Hm(this.commandHandler)}return null},n.prototype.getCursor=function(e){var t=this.diagram.selectedItems.annotation?this.diagram.selectedItems.wrapper.children[0]:this.diagram.selectedItems,i=this.diagram.selectedItems.annotation?t.rotateAngle+t.parentTransform:t.rotateAngle;return Lm(e,i)},n.prototype.findElementUnderMouse=function(e,t,i,r){return this.objectFinder.findElementUnderSelectedItem(e,t,i,r)},n.prototype.findObjectsUnderMouse=function(e,t){return this.objectFinder.findObjectsUnderMouse(e,this.diagram,this.eventArgs,t)},n.prototype.findObjectUnderMouse=function(e,t,i){return this.objectFinder.findObjectUnderMouse(this.diagram,e,t,i,this.eventArgs,this.currentPosition)},n.prototype.findTargetUnderMouse=function(e,t,i,r,a){return this.objectFinder.findObjectUnderMouse(this.diagram,e,t,i,this.eventArgs,r,a)},n.prototype.findActionToBeDone=function(e,t,i,r){return Tm(e,t,this.currentPosition,this.diagram,this.touchStartList,this.touchMoveList,r)},n.prototype.updateContainerBounds=function(e){var t=!1;if(this.diagram.selectedObject.helperObject&&this.diagram.selectedObject.actualObject)for(var i=this.diagram.selectedObject.actualObject,r=this.diagram.selectedObject.actualObject instanceof It?i.nodes:[i],a=0;a<r.length;a++){var s=r[parseInt(a.toString(),10)],o=this.tool instanceof Lr,h=this.diagram.nameTable[s.parentId];e?$d(this.diagram,s,this.currentPosition,o):((!h||h&&h.shape.type!=="SwimLane")&&this.diagram.updateDiagramObject(s),t=wm(this.diagram,s,this.currentPosition,o),this.diagram.updateSelector(),(s.isLane||s.isPhase)&&(this.diagram.clearSelection(),this.commandHandler.selectObjects([s])))}return t},n.prototype.updateContainerProperties=function(){var e,t=!1,i,r,a=!1,s,o={hasStack:!1,isPreventHistory:!1};if(this.diagram.selectedObject.helperObject){var h=this.diagram.findObjectsUnderMouse(this.currentPosition),l=this.diagram.findObjectUnderMouse(h,this.action,this.inAction);if(e=this.diagram.selectedObject.helperObject,s=this.diagram.selectedObject.actualObject,s instanceof M){if(s.shape.type==="SwimLane"&&(r=sr(this.diagram,s.wrapper.children[0])),s.shape.type!=="SwimLane"&&s.parentId&&this.diagram.getObject(s.parentId).shape.type==="SwimLane"&&l instanceof M&&this.diagram.getObject(l.parentId)&&this.diagram.getObject(l.parentId).shape.type!=="SwimLane"&&(l=this.diagram.getObject(l.parentId)),this.currentAction==="Drag"&&s.container&&s.container.type==="Canvas"&&s.parentId&&this.diagram.getObject(s.parentId).shape.type==="SwimLane"&&l&&l.container&&l.container.type==="Canvas"&&l.isLane&&s.isLane&&l.parentId===s.parentId)l!==s&&rm(this.diagram,s,l,this.currentPosition),o.isPreventHistory=!0;else{var d=this.diagram.nameTable[s.parentId];if(!d||d&&d.shape.type!=="SwimLane"){if(d&&d.isLane&&s.constraints&W.AllowMovingOutsideLane){var f=this.diagram.getObject(d.parentId),p=void 0,c=void 0;if(f.shape.orientation==="Vertical")p=f.wrapper.bounds.x+f.shape.phaseSize,c=f.wrapper.bounds.y+f.shape.header.height;else{var u=f.shape.header.height+f.shape.phaseSize;p=f.wrapper.bounds.x,c=f.wrapper.bounds.y+u}var g=f.wrapper.bounds.bottomRight.x-p,v=f.wrapper.bounds.bottomRight.y-c,m=new it(p,c,g,v);m.containsPoint(this.currentPosition)&&(s.offsetX=e.offsetX,s.offsetY=e.offsetY,s.width=e.width,s.height=e.height,s.rotateAngle=e.rotateAngle)}else if(this.diagram.selectedItems.nodes.length===1)s.offsetX=e.offsetX,s.offsetY=e.offsetY,s&&s.shape&&s.shape.type!=="UmlClassifier"&&(s.width=e.width,s.height=e.height),s.rotateAngle=e.rotateAngle;else if(this.diagram.selectedItems.nodes.length>1)for(var y=e.offsetX-this.diagram.selectedItems.offsetX,S=e.offsetY-this.diagram.selectedItems.offsetY,x=e.rotateAngle-this.diagram.selectedItems.rotateAngle,I=0;I<this.diagram.selectedItems.nodes.length;I++)this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].offsetX+=y,this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].offsetY+=S,this.diagram.selectedItems.nodes[parseInt(I.toString(),10)].rotateAngle+=x}var C=void 0;if(d&&d.container&&d.container.type==="Stack"&&(this.diagram.startGroupAction(),a=!0),!l&&d&&d.container&&d.container.type==="Stack"&&this.action==="Drag"&&d.shape.type!=="UmlClassifier"){var P=d.wrapper.children.indexOf(s.wrapper);if(C={targetIndex:void 0,target:void 0,sourceIndex:P,source:E(s)},P>-1){var A=d.children;A.splice(A.indexOf(s.id),1),this.diagram.nameTable[s.id].parentId="",i=!0,d.wrapper.children.splice(P,1)}}if(Pm(s,l,this.diagram,this.action),d=ne(this.diagram,s)?this.diagram.nameTable[s.parentId]:this.diagram.nameTable[s.parentId]||s,d&&d.container&&d.container.type==="Canvas"&&(d.wrapper.maxWidth=d.maxWidth=d.wrapper.actualSize.width,d.wrapper.maxHeight=d.maxHeight=d.wrapper.actualSize.height,t=!0),ne(this.diagram,s,!0)&&d&&d.container.type==="Canvas")if(this.diagram.selectedItems.nodes.length>1)for(var I=0;I<this.diagram.selectedItems.nodes.length;I++)Mn(this.diagram,this.diagram.selectedItems.nodes[parseInt(I.toString(),10)]);else Mn(this.diagram,s);else o=this.updateContainerPropertiesExtend(d,s,r,e,o);if(this.diagram.lineRoutingModule&&this.diagram.constraints&lt.LineRouting&&!ne(this.diagram,s,!0)&&(s.children&&(this.diagram.realActions|=Vt.EnableGroupAction),this.diagram.nodePropertyChange(s,{},{width:s.width,height:s.height,offsetX:s.offsetX,offsetY:s.offsetY}),s.children&&(this.diagram.realActions&=~Vt.EnableGroupAction)),s.shape.lanes&&this.updateLaneChildNode(s),t&&(d.maxWidth=d.wrapper.maxWidth=void 0,d.maxHeight=d.wrapper.maxHeight=void 0),i){this.diagram.nodePropertyChange(d,{},{offsetX:d.offsetX,offsetY:d.offsetY,width:d.width,height:d.height,rotateAngle:d.rotateAngle});var T={redoObject:{sourceIndex:void 0,source:C.source},type:"StackChildPositionChanged",undoObject:C,category:"Internal"};this.diagram.diagramActions&k.UndoRedo||this.diagram.addHistoryEntry(T)}s&&s.container&&(s.container.type==="Stack"||s.container.type==="Canvas"&&s.parentId==="")&&(s&&s.shape&&s.shape.type==="UmlClassifier"&&(s.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(s,{},{offsetX:s.offsetX,offsetY:s.offsetY,width:s.width,height:s.height,rotateAngle:s.rotateAngle}),s&&s.shape&&s.shape.type==="UmlClassifier"&&(s.wrapper.measureChildren=!1))}Pr(r,this.diagram),o.hasStack=a}else if(s instanceof It){var y=e.offsetX-s.offsetX,S=e.offsetY-s.offsetY,x=e.rotateAngle-s.rotateAngle,g=e.width-s.width,v=e.height-s.height,z=e.width/s.width,L=e.height/s.height;if(this.tool.corner)for(var R=this.tool.getPivot(this.tool.corner),I=0;I<s.nodes.length;I++){var O=s.nodes[parseInt(I.toString(),10)],N=O.wrapper,H=s.wrapper,p=H.offsetX-H.actualSize.width*H.pivot.x,c=H.offsetY-H.actualSize.height*H.pivot.y,F=ts(p,c,H.actualSize.width,H.actualSize.height,H.rotateAngle,H.offsetX,H.offsetY,R);this.diagram.commandHandler.scaleObject(z,L,F,O,N,s)}else for(var I=0;I<s.nodes.length;I++){var O=s.nodes[parseInt(I.toString(),10)],d=this.diagram.nameTable[O.parentId];d&&d.shape.type!=="SwimLane"&&ne(this.diagram,O,!0)&&d.container.type==="Canvas"&&(O.offsetX+=y,O.offsetY+=S,O&&O.shape&&O.shape.type!=="UmlClassifier"&&(O.width+=g,O.height+=v),O.rotateAngle+=x,Mn(this.diagram,O))}}}return s&&(s.isPhase||s.isLane||s.shape&&s.shape.type==="SwimLane")&&this.diagram.updateDiagramElementQuad(),o},n.prototype.updateLaneChildNode=function(e){for(var t=0;t<e.shape.lanes.length;t++)if(e.shape.lanes[parseInt(t.toString(),10)].children&&e.shape.lanes[parseInt(t.toString(),10)].children.length>0)for(var i=0;i<e.shape.lanes[parseInt(t.toString(),10)].children.length;i++){var r=e.shape.lanes[parseInt(t.toString(),10)].children[parseInt(i.toString(),10)].id,a=this.diagram.nameTable[""+r];a&&(a.offsetX=a.wrapper.offsetX,a.offsetY=a.wrapper.offsetY)}},n.prototype.updateContainerPropertiesExtend=function(e,t,i,r,a){if(this.currentAction==="ResizeEast"||this.currentAction==="ResizeSouth"||t.shape.type==="SwimLane"){var s=E(t),o=!1;if(e&&e.container&&e.container.type==="Grid"){var h=e.shape.type==="SwimLane",l=h?e.wrapper.children[0]:e.wrapper,d=h?e.shape.padding:void 0,f=e.wrapper.bounds.x,p=e.wrapper.bounds.y;if(t.columnIndex!==void 0&&e.container.orientation==="Horizontal"&&(h&&t.isPhase||!h&&t.rowIndex===1)||e.container.orientation==="Vertical"&&(!h&&t.rowIndex>0&&t.columnIndex>0||h&&t.isLane)){e.container.orientation==="Horizontal"&&t.isPhase&&t.wrapper.width>t.maxWidth&&(t.maxWidth=t.wrapper.width,t.wrapper.maxWidth=t.wrapper.width);var c=r.wrapper.actualSize.width-t.wrapper.actualSize.width;if(l.updateColumnWidth(t.columnIndex,r.width,!0,d),jh(this.diagram,t,e,r,c),t.isPhase){var u=e.shape.phases[t.columnIndex].header.id,g=this.diagram.nameTable[""+u];g.maxWidth<r.width&&(g.maxWidth=r.width,g.wrapper.maxWidth=r.width)}e.shape.type==="SwimLane"&&(e.width=e.width?l.width:e.width,Tr(this.diagram,e),e.wrapper.width=e.width,i=sr(this.diagram,l,t.rowIndex))}else if(t.rowIndex!==void 0){o=!0;var v=r.wrapper.actualSize.height-t.wrapper.actualSize.height;l.updateRowHeight(t.rowIndex,r.height,!0,d),jh(this.diagram,t,e,r,void 0,v),e.shape.type==="SwimLane"&&(e.height=e.height?l.height:e.height,e.wrapper.height=e.height,i=sr(this.diagram,l,t.rowIndex))}e.shape.type==="SwimLane"&&(a.isPreventHistory=!0),this.diagram.nodePropertyChange(e,{},{offsetX:e.offsetX,offsetY:e.offsetY,rotateAngle:e.rotateAngle}),this.diagram.drag(e,f-e.wrapper.bounds.x,p-e.wrapper.bounds.y)}else t&&t.shape&&t.shape.type==="UmlClassifier"&&(t.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(t,{},{offsetX:t.offsetX,offsetY:t.offsetY,width:t.width,height:t.height,rotateAngle:t.rotateAngle}),t.wrapper.measureChildren=!1;if(t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.currentAction==="ResizeEast"||this.currentAction==="ResizeSouth"){var m=E(t),y={category:"Internal",type:o?"RowHeightChanged":"ColumnWidthChanged",undoObject:s,redoObject:m};this.diagram.addHistoryEntry(y)}}return Pr(i,this.diagram),a},n.prototype.addUmlNode=function(){var e=this.diagram.selectedItems.nodes[0],t=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x+20,y:this.currentPosition.y}),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction),r,a;if(i||(t=this.diagram.findObjectsUnderMouse({x:this.currentPosition.x-20,y:this.currentPosition.y}),i=this.diagram.findObjectUnderMouse(t,this.action,this.inAction)),e&&e.container&&e.container.type==="Stack"&&i&&i.parentId&&i.parentId===e.id){var s=i,o=Vi(this.diagram.element.id),h=o.getElementById(o.id+"_stack_highlighter");if(h){var l=e.wrapper.children.indexOf(i.wrapper)+1;this.diagram.enableServerDataBinding(!1);var d=new M(this.diagram,"nodes",{style:{fill:e.style.fill,strokeColor:e.style.strokeColor==="black"?"#ffffff00":e.style.strokeColor},annotations:i.annotations,verticalAlignment:"Stretch",horizontalAlignment:"Stretch",constraints:(W.Default|W.HideThumbs)&~(W.Rotate|W.Drag|W.Resize),minHeight:25},!0);d.annotations[0].content=" + Name : Type",s.id.split("_"),d.id=K()+d.id,d.parentId=e.id,d.zIndex=-1,d.umlIndex=l,this.diagram.startGroupAction();var f={name:"Name",type:"Type"};if(e.shape.classifier==="Class"&&(i.id.includes("_umlProperty")&&e.shape.classShape.attributes.length>0?(r=new fn(e,"",f),e.shape.classShape.attributes.push(r)):i.id.includes("_umlMethods")&&e.shape.classShape.methods.length>0&&(a=new Kn(e,"",f),e.shape.classShape.methods.push(a))),e.shape.classifier==="Interface"&&(i.id.includes("_umlProperty")&&e.shape.interfaceShape.attributes.length>0?(r=new fn(e,"",f),e.shape.classShape.attributes.push(r)):i.id.includes("_umlMethods")&&e.shape.interfaceShape.methods.length>0&&(a=new Kn(e,"",f),e.shape.interfaceShape.methods.push(a))),e.shape.classifier==="Enumeration"&&i.id.includes("_umlMember")&&e.shape.enumerationShape.members.length>0){var p=new ms(e,"",f);e.shape.enumerationShape.members.push(p)}e.wrapper.children.indexOf(d.wrapper),this.diagram.enableServerDataBinding(!0),this.diagram.add(d),this.diagram.updateConnectorEdges(e),this.diagram.clearSelection(),this.diagram.select([this.diagram.nameTable[d.id]]),this.diagram.endGroupAction(),this.diagram.startTextEdit()}}},n})(),jy=(function(){function n(){}return n.prototype.findObjectsUnderMouse=function(e,t,i,r,a){var s=[];r&&r instanceof It&&r.nodes.length+r.connectors.length===1&&(r=r.nodes[0]||r.connectors[0],r.children&&r.children.length===0&&(i.actualObject=r));for(var o,h,l,d,f=r&&r instanceof B&&(r.constraints&yt.ConnectToNearByNode||r.constraints&yt.ConnectToNearByPort)&&r.connectionPadding||0,p=t.spatialSearch.findObjects(new it(e.x-50-f,e.y-50-f,100+f,100+f)),c={},u,g=0,v=p;g<v.length;g++){var m=v[g],y=e;h=m.wrapper.outerBounds;var S=m.rotateAngle?!1:h.containsPoint(y,f);if((m!==r||t.currentDrawingObject instanceof B)&&m instanceof B?m!==t.currentDrawingObject:m.wrapper.visible){var x=t.commandHandler.getObjectLayer(m.id);if(x&&!x.lock&&x.visible){if(u=c[x.zIndex]=c[x.zIndex]||[],m.rotateAngle){o=m.wrapper,h=se(o);for(var I=0,C=o.children;I<C.length;I++)l=C[I],d=xt(),Rt(d,-(l.rotateAngle+l.parentTransform),l.offsetX,l.offsetY),y=st(d,e),se(l).containsPoint(y,f)&&(S=!0)}if((!r||Ut(t,m)===!1)&&Xv(m)&&(m instanceof B?f0(m,e):S||m.flip)){var P=m instanceof B&&m.hitPadding||0,A=this.findElementUnderMouse(m,e,t,f||P);A&&m.id!=="helper"&&O0(m,"zIndex",u)}}}}for(var T=0,z=t.layers;T<z.length;T++){var x=z[T],L=c[x.zIndex];L&&L.length>1&&(L=B0(L)),s=s.concat(L||[]);for(var R=0,O=s;R<O.length;R++){var m=O[R],N="eventHandler";if(m.shape.type==="Bpmn"&&m.processId&&(!(t[""+N].tool instanceof oi)||t[""+N].tool instanceof oi&&Ga(m))){var H=s.indexOf(t.nameTable[m.processId]);H>-1&&s.splice(H,1)}if(m.shape.type==="UmlClassifier"&&m.container&&m.container.type==="Stack"){var H=s.indexOf(t.nameTable[t.nameTable[m.id].wrapper.children[0].id]);H>-1&&s.splice(H,1)}}}for(var F=0;F<s.length;F++){var Y=t.nameTable[s[parseInt(F.toString(),10)].parentId];if(Y){for(var et=this.findElementUnderMouse(Y,e,t),at=0;at<Y.ports.length;at++)if(et&&et.id.match("_"+Y.ports[parseInt(at.toString(),10)].id+"$")){var tt=Y.ports[parseInt(at.toString(),10)];if(Zo(tt)||fo(tt))return s}}for(;Y;){var H=s.indexOf(Y);if(H!==-1)s.splice(H,1);else break;Y=t.nameTable[Y.parentId]}}if(this.checkSwimlane(s,t),i&&!i.source)for(var F=0;F<s.length;F++){var nt=t.nameTable[s[parseInt(F.toString(),10)].parentId];if(nt&&nt.shape.type==="SwimLane")for(var at=0;at<s.length;at++){var wt=s[parseInt(at.toString(),10)];wt instanceof B&&s.splice(F,1)}}return s},n.prototype.checkSwimlane=function(e,t){for(var i,r=0;r<e.length;r++){var a=e[parseInt(r.toString(),10)],s=void 0,o=void 0;a instanceof M&&(s=e[parseInt(r.toString(),10)].parentId,o=a),s===""&&(o.shape.type!=="SwimLane"?i=!0:i=!1);var h=t.nameTable[""+s];if(h&&h.isLane&&t.nameTable[h.parentId].zIndex>a.zIndex&&(e[parseInt(r.toString(),10)]=h),r>0&&i&&o&&(o.isLane||o.isPhase||o.isHeader)&&e[parseInt(r.toString(),10)].zIndex<e[r-1].zIndex){var l=e[parseInt(r.toString(),10)];e[parseInt(r.toString(),10)]=e[r-1],e[r-1]=l}}if(e.length>=2){for(var d="",f=e.length-1;f>=0;f--)if(e[parseInt(f.toString(),10)].parentId){var p=Qn(e[parseInt(f.toString(),10)],t,d),c=Qn(e[f-1],t,d),u=t.nameTable[""+p],g=t.nameTable[""+c];g&&p!==c&&u.zIndex<g.zIndex&&e.splice(f,1)}}},n.prototype.isTarget=function(e,t,i){var r=t.selectedItems.connectors[0],a;if(a=i==="ConnectorSourceEnd"?t.nameTable[r.targetID]:a=t.nameTable[r.sourceID],a&&!(a.processId&&!e.processId||a.processId!==e.processId)&&(a.processId!==e.processId&&(e=null),e&&e.parentId&&t.nameTable[e.parentId].shape.type==="UmlClassifier"&&(e=t.nameTable[e.parentId])),i==="ConnectorSourceEnd"&&r.targetID){var s=t.nameTable[r.targetID];if(s&&s.shape&&s.shape.shape==="TextAnnotation"){var o=r.id.split("_");(s.shape.type==="Bpmn"&&e.shape.type!=="Bpmn"||o[0]===e.id||e.shape.shape==="TextAnnotation")&&(e=null),e&&e.parentId&&t.nameTable[e.parentId].shape.type==="UmlClassifier"&&(e=t.nameTable[e.parentId])}}return e&&(a&&e.id===a.processId||a&&e.shape.type==="Container"&&e.id===a.parentId||(i==="ConnectorSourceEnd"||i==="ConnectorTargetEnd")&&e.id===r.parentId)&&(e=null),e},n.prototype.findObjectUnderMouse=function(e,t,i,r,a,s,o){var h="eventHandler",l="endPoint",d,f,p=null;if(a===null&&(a={}),t.length!==0)if(o&&o instanceof It&&o.nodes.length+o.connectors.length===1&&(o=o.nodes[0]||o.connectors[0]),i==="ConnectorSourceEnd"&&o||i==="PortDraw"||(Yd(e)||ds(e))&&Fe(e.drawingObject)===B)for(var c=e.selectedItems.connectors[0],u=t.length-1;u>=0;u--){f=hn(t[parseInt(u.toString(),10)],!1),d=hn(t[parseInt(u.toString(),10)],!0);var g=e[""+h].tool,v=this.findTargetElement(t[parseInt(u.toString(),10)].wrapper,s,e,void 0);if(i==="Draw"&&v&&(t[parseInt(u.toString(),10)]instanceof M||t[parseInt(u.toString(),10)]instanceof B)&&!is(t[parseInt(u.toString(),10)],v)&&(g&&g[""+l]==="ConnectorSourceEnd"&&!Di(t[parseInt(u.toString(),10)])||g&&g[""+l]==="ConnectorTargetEnd"&&!ii(t[parseInt(u.toString(),10)])))return p;if(t[parseInt(u.toString(),10)]instanceof M||t[parseInt(u.toString(),10)]instanceof B&&(Di(t[parseInt(u.toString(),10)])||ar(f)||ii(t[parseInt(u.toString(),10)])||Li(d)||i==="PortDraw"&&g instanceof zr&&g[""+l]==="ConnectorTargetEnd"&&(ii(t[parseInt(u.toString(),10)])||Li(d))))return p=t[parseInt(u.toString(),10)],c&&(p=this.isTarget(p,e,i)),a.actualObject=p,p}else if(i==="ConnectorTargetEnd"&&o){for(var u=t.length-1;u>=0;u--)if(d=hn(t[parseInt(u.toString(),10)],!0),(t[parseInt(u.toString(),10)]instanceof M||t[parseInt(u.toString(),10)]instanceof B)&&(ii(t[parseInt(u.toString(),10)])||Li(d)))return p=t[parseInt(u.toString(),10)],p=this.isTarget(p,e,i),a.actualObject=p,p}else if(o&&(i==="Drag"||e[""+h].tool instanceof oi)){for(var m=0,u=0;u<t.length;u++){var y=t[parseInt(u.toString(),10)];o!==y&&(y instanceof B||!s||y.wrapper.bounds.containsPoint(s))&&Ga(y)&&(p?(p=m>=y.zIndex?p:y,m=Math.max(m,y.zIndex)):(p=y,m=p.zIndex))}return p&&p.shape.type==="Bpmn"&&(e.selectedItems.nodes.length>0&&e.selectedItems.nodes[0].shape.type==="Bpmn"&&e.selectedItems.nodes[0].shape.shape!=="TextAnnotation"?p=p:p=null),p&&(a.actualObject=p),p}else if((i==="Select"||i==="Pan")&&e[""+h].tool){for(var u=t.length-1;u>=0;u--)if(t[parseInt(u.toString(),10)]instanceof B){var S=t[u-1];if(t[u-1]instanceof M&&S.ports){var v=this.findTargetElement(S.wrapper,s,e,void 0);if(v&&(v.id.match("_icon_content_shape$")||v.id.match("_icon_content_rect$")))return S;for(var x=0;x<S.ports.length;x++)if(v&&v.id.match("_"+S.ports[parseInt(x.toString(),10)].id+"$")&&fo(S.ports[parseInt(x.toString(),10)]))return S}}if(p=t[t.length-1],a.actualObject=p,!e[""+h].itemClick(p,!0)&&p.parentId&&e.nameTable[p.parentId]&&e.nameTable[p.parentId].shape.type!=="Container")for(var I=p,C=Ut(e,I);I&&!(Ut(e,I)&&!C||(p=I,I.tooltip.content!==""));)I=e.nameTable[I.parentId]}else if(i==="Pan"||i==="LayoutAnimation"){for(var u=t.length-1;u>=0;u--)if(t[parseInt(u.toString(),10)]instanceof M||t[parseInt(u.toString(),10)]instanceof B){var v=this.findTargetElement(t[parseInt(u.toString(),10)].wrapper,s,e,void 0);if(i==="Pan"||v&&(v.id.match("_icon_content_shape$")||v.id.match("_icon_content_rect$")))return t[parseInt(u.toString(),10)]}}else p=t[t.length-1],a&&p&&(a.actualObject=p);return p},n.prototype.findElementUnderSelectedItem=function(e,t,i,r){if(e instanceof It){if(e.nodes.length===1&&(!e.connectors||!e.connectors.length))return this.findElementUnderMouse(e.nodes[0],t,i);if((!e.nodes||e.nodes.length)&&e.connectors.length===1)return this.findElementUnderMouse(e.connectors[0],t,i)}else return this.findElementUnderMouse(e,t,i,r);return null},n.prototype.findElementUnderMouse=function(e,t,i,r){return this.findTargetElement(e.wrapper,t,i,r)},n.prototype.findTargetElement=function(e,t,i,r){for(var a=e.children.length-1;a>=0;a--){var s=e.children[parseInt(a.toString(),10)],o=void 0;if(s instanceof Tt&&nh(s)&&s.position){var h={width:e.desiredSize.width,height:e.desiredSize.height,padding:e.padding,offsetX:e.offsetX,offsetY:e.offsetY,parentTransform:e.parentTransform,rotateAngle:e.rotateAngle},l=G0(h,s);s.flippedPoint=l;var d=l.x-s.corners.topLeft.x,f=l.y-s.corners.topLeft.y;l?(o={left:s.bounds.x+d,top:s.bounds.y+f,right:s.bounds.x+d+s.bounds.width,bottom:s.bounds.y+f+s.bounds.height},s.flippedPoint=l):s.flippedPoint=void 0}else s.flippedPoint=void 0;if(s&&(o?wl(o,t,r||0):s.outerBounds.containsPoint(t,r||0))){if(s.visible){if(s instanceof Je){var p=this.findTargetElement(s,t,i);if(p)return p}var c=s.style.textOverflow==="Clip"||s.style.textOverflow==="Ellipsis";if((o?wl(o,t,r||0):s.bounds.containsPoint(t,r||0))&&!c)return s;if(e.bounds.containsPoint(t,r||0)&&c)return s}else if(s instanceof Pt&&e&&e.id){var u=void 0;if(e.id.includes("group_container")){var g=e.id.slice(0,-15);u=i.getObject(g)}else u=i.getObject(e.id);var v=k0(u,s.id);if(v)return s}}}return e.bounds.containsPoint(t,r)&&e.style.fill!=="none"?e:null},n})(),tS=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Jr=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Wf=(function(n){tS(e,n);function e(t,i,r,a){var s=n.call(this,t,i,r,a)||this;return s.objectZIndex=-1,s.zIndexTable={},s.objects=[],s}return Jr([w("")],e.prototype,"id",void 0),Jr([w(!0)],e.prototype,"visible",void 0),Jr([w(!1)],e.prototype,"lock",void 0),Jr([w()],e.prototype,"objects",void 0),Jr([w()],e.prototype,"addInfo",void 0),Jr([w(-1)],e.prototype,"zIndex",void 0),e})(j),So=function(){return So=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},So.apply(this,arguments)},qs=function(n,e,t,i){return new(t||(t=Promise))(function(r,a){function s(l){try{h(i.next(l))}catch(d){a(d)}}function o(l){try{h(i.throw(l))}catch(d){a(d)}}function h(l){l.done?r(l.value):new t(function(d){d(l.value)}).then(s,o)}h((i=i.apply(n,e||[])).next())})},Qs=function(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(d){return h([l,d])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(d){l=[6,d],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},eS=(function(){function n(e){this.clipboardData={},this.diagramObject={},this.newSelectedObjects={},this.oldSelectedObjects={},this.changedNodeZIndexes={},this.connectorsTable=[],this.PreventConnectorSplit=!1,this.processTable={},this.containerChildTable={},this.isContainer=!1,this.canUpdateTemplate=!1,this.cloningInProgress=!1,this.clonedChildrenTable={},this.annotationRestrictDeltaValue={x:0,y:0},this.childTable={},this.objectStore=[],this.parentTable={},this.blazor="Blazor",this.blazorInterop="sfBlazor",this.cloneGroupChildCollection=[],this.diagram=e}return Object.defineProperty(n.prototype,"snappingModule",{get:function(){return this.diagram.snappingModule},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"layoutAnimateModule",{get:function(){return this.diagram.layoutAnimateModule},enumerable:!0,configurable:!0}),n.prototype.startTransaction=function(e){this.state={element:this.diagram.selectedItems,backup:null},e&&this.diagram.protectPropertyChange(!0),yo(this.diagram.element.id).style.pointerEvents="none"},n.prototype.endTransaction=function(e){this.state=null,e&&this.diagram.protectPropertyChange(!1),yo(this.diagram.element.id).style.pointerEvents="all"},n.prototype.setFocus=function(){document.getElementById(this.diagram.element.id).focus()},n.prototype.showTooltip=function(e,t,i,r,a){var s=this,o,h,l=!1;if(e instanceof It?e.nodes.length===1&&e.connectors.length===0?(o=e.nodes[0].id,e.nodes[0].shape&&e.nodes[0].shape instanceof Jn&&(l=!0)):e.nodes.length===0&&e.connectors.length===1?o=e.connectors[0].id:h=document.getElementById(this.diagram.element.id+"_SelectorElement"):e instanceof M?(o=e.id,e.shape&&e.shape instanceof Jn&&(l=!0)):o=e.id,V(h)&&!V(o)){var d=l?"_content_native_element":"_groupElement";h=document.getElementById(o+d)}if(a&&(this.diagram.tooltipObject.position="BottomCenter",this.diagram.tooltipObject.animation={open:{delay:0,duration:0}},this.diagram.tooltipObject.openDelay=0,this.diagram.tooltipObject.closeDelay=0),this.diagram.selectedItems.setTooltipTemplate){var f=void 0,p=_t(this.diagram.selectedItems.setTooltipTemplate);p&&(f=p(e,this.diagram)),f instanceof HTMLElement?i=f.cloneNode(!0):i=f||i}this.diagram.tooltipObject.isSticky=!1,e.tooltip&&(this.diagram.tooltipObject.openOn=e.tooltip.openOn),typeof i=="string"?this.diagram.tooltipObject.content=xr(function(){return i}):this.diagram.tooltipObject.content=i,this.diagram.tooltipObject.offsetX=0,this.diagram.tooltipObject.offsetY=0,this.diagram.tooltipObject.refresh(h),a&&setTimeout(function(){s.diagram.tooltipObject.open(h)},1)},n.prototype.connectorSplit=function(e,t){var i=e.id,r=E(t),a=this.diagram.connectors.indexOf(t),s=this.diagram.nodes.indexOf(e),o=E(e),h={},l={},d={offsetX:o.offsetX,offsetY:o.offsetY},f={sourceID:r.sourceID,sourcePoint:r.sourcePoint,sourcePortID:r.sourcePortID,targetID:r.targetID,targetPoint:r.targetPoint,targetPortID:r.targetPortID};h[parseInt(a.toString(),10)]=f,l[parseInt(s.toString(),10)]=d;var p={},c={},u={},g={};if(r.sourceID!==""&&r.targetID!==""?g.targetID=this.ConnectorTargetChange(t,i):r.sourceID!==""&&r.targetID===""?(this.nodeOffsetChange(u,o,t.targetPoint),g.targetID=this.ConnectorTargetChange(t,i)):(r.sourceID===""&&r.targetID===""||r.sourceID===""&&r.targetID!=="")&&(this.nodeOffsetChange(u,o,t.sourcePoint),g.sourceID=this.ConnectorSourceChange(t,i)),p[parseInt(a.toString(),10)]=g,c[parseInt(s.toString(),10)]=u,this.diagram.nodePropertyChange(e,d,u),this.diagram.updateSelector(),this.diagram.connectorPropertyChange(t,f,g),r.sourceID!==""&&r.targetID!==""){var v={id:"connector "+i,constraints:yt.Default|yt.AllowDrop,sourceID:i};v.type=r.type,v.style=r.style,v.sourceDecorator=r.sourceDecorator,v.targetDecorator=r.targetDecorator,v.targetID=r.targetID,r.targetPortID!==""&&(v.targetPortID=r.targetPortID),this.diagram.add(v)}var m={type:"PropertyChanged",redoObject:{nodes:c},undoObject:{nodes:l},category:"Internal"};this.diagram.addHistoryEntry(m);var y={type:"PropertyChanged",redoObject:{connectors:p},undoObject:{connectors:h},category:"Internal"};this.diagram.addHistoryEntry(y)},n.prototype.nodeOffsetChange=function(e,t,i){e.offsetX=t.offsetX=i.x,e.offsetY=t.offsetY=i.y},n.prototype.ConnectorTargetChange=function(e,t){return e.targetID=t,t},n.prototype.ConnectorSourceChange=function(e,t){return e.sourceID=t,t},n.prototype.closeTooltip=function(){this.diagram.tooltipObject.close()},n.prototype.canEnableDefaultTooltip=function(){return!!(this.diagram.selectedItems.constraints&Ae.ToolTip)},n.prototype.updateSelector=function(){this.diagram.updateSelector()},n.prototype.triggerEvent=function(e,t){return qs(this,void 0,void 0,function(){var i;return Qs(this,function(r){switch(r.label){case 0:return e===Z.drop||e===Z.positionChange||e===Z.connectionChange?this.diagram.currentSymbol?[2]:(e===Z.drop&&(t.source=this.diagram),this.diagram.currentDrawingObject instanceof B&&e!==Z.positionChange?[4,this.diagram.triggerEvent(e,t)]:[3,2]):[3,3];case 1:return[2,r.sent()];case 2:if(this.diagram.currentDrawingObject&&e!==Z.positionChange)return[2];r.label=3;case 3:return[4,this.diagram.triggerEvent(e,t)];case 4:return i=r.sent(),[2,i]}})})},n.prototype.dragOverElement=function(e,t){if(this.diagram.currentSymbol){var i={element:e.source,target:e.target,mousePosition:t,diagram:this.diagram};this.triggerEvent(Z.dragOver,i)}},n.prototype.disConnect=function(e,t,i){var r={},a={},s,o,h;if(e instanceof It?(o=e,h=o.connectors[0]):e instanceof B&&this.diagram.currentDrawingObject&&this.diagram.currentDrawingObject instanceof B?h=this.diagram.currentDrawingObject:this.diagram.eventHandler.tool&&this.diagram.eventHandler.tool instanceof qe&&this.diagram.eventHandler.tool.drawingObject&&(h=this.diagram.eventHandler.tool.drawingObject),e&&h&&(_d(this.diagram)||this.diagram.currentDrawingObject)){if(t&&(t==="ConnectorSourceEnd"||t==="ConnectorTargetEnd")){var l=t==="ConnectorSourceEnd"?"sourceID":"targetID",d=t==="ConnectorSourceEnd"?"sourcePortID":"targetPortID";h[""+l]&&(r[""+l]=h[""+l],h[""+l]="",a[""+l]=h[""+l],(h.sourcePortID||h.targetPortID)&&(r[""+d]=h[""+d],h[""+d]="",a[""+d]=h[""+d]),s=this.connectionEventChange(h,r,a,t,i))}else if(t!=="OrthoThumb"&&t!=="SegmentEnd"&&(h.sourceID||h.targetID)){r={sourceID:h.sourceID,sourcePortID:h.sourcePortID,targetID:h.targetID,targetPortID:h.targetPortID},h.sourceID="",h.sourcePortID="",h.targetID="",h.targetPortID="",a={sourceID:h.sourceID,sourcePortID:h.sourcePortID,targetID:h.targetID,targetPortID:h.targetPortID};var f={connector:h,oldValue:r,newValue:a,cancel:!1,state:"Changing",connectorEnd:t};this.triggerEvent(Z.connectionChange,f),f.cancel?(h.sourceID=r.sourceID,h.sourcePortID=r.sourcePortID,h.targetID=r.targetID,h.targetPortID=r.targetPortID):(this.diagram.connectorPropertyChange(h,r,a),this.diagram.updateDiagramObject(h),f={connector:h,oldValue:r,newValue:a,cancel:!1,state:"Changed",connectorEnd:t},this.triggerEvent(Z.connectionChange,f))}}return s},n.prototype.trackConnectorChange=function(e){if(e.nodes&&e.nodes.length>0)for(var t=0,i=e.nodes;t<i.length;t++)for(var r=i[t],a=0,s=r.outEdges.concat(r.inEdges);a<s.length;a++){var o=s[a],h=this.diagram.getObject(o),l=h&&h.segments&&(h.type==="Bezier"?h.segments.length>=1:h.segments.length>1);if(l&&e.connectors.indexOf(h)===-1){var d=E(h);e.connectors.push(d)}}},n.prototype.connectionEventChange=function(e,t,i,r,a){var s=r==="ConnectorSourceEnd"?"sourceID":"targetID",o=r==="ConnectorSourceEnd"?"sourcePortID":"targetPortID",h;if(this.enableCloneObject){h=this.diagram.nameTable[i[""+s]];var l=E(h);this.diagram.insertValue(l,!0)}var d,f={cancel:!1,state:"Changing",connectorEnd:r,connector:e,oldValue:{nodeId:t[""+s],portId:t[""+o]},newValue:{nodeId:i[""+s],portId:i[""+o]}};if(this.triggerEvent(Z.connectionChange,f),f.cancel&&(e[""+s]=t[""+s],e[""+o]=t[""+o],i=t),this.diagram.connectorPropertyChange(e,t,i),this.diagram.updateDiagramObject(e),f={connector:e,oldValue:{nodeId:t[""+s],portId:t[""+o]},newValue:{nodeId:i[""+s],portId:i[""+o]},cancel:!1,state:"Changing",connectorEnd:r},this.enableCloneObject&&h===void 0){h=this.diagram.nameTable[t[""+s]];var l=E(h);this.diagram.insertValue(l,!0)}if(this.diagram.bpmnModule&&e.isBpmnAnnotationConnector){var p=this.diagram.nameTable[e.targetID];p.shape.textAnnotation.textAnnotationTarget=e.sourceID}return d},n.prototype.findTarget=function(e,t,i,r){if(t instanceof M){if(e&&e.id===t.id+"_content")return t;if(i&&t.shape.type==="Bpmn"&&t.shape.shape==="Activity"&&t.shape.activity.subProcess.type==="Transaction"){var a=t.shape.activity.subProcess.transaction;if(a.success.visible&&e.id.indexOf(t.id+"_success")===0)return a.success;if(a.cancel.visible&&e.id.indexOf(t.id+"_cancel")===0)return a.cancel;if(a.failure.visible&&e.id.indexOf(t.id+"_failure")===0)return a.failure}if(e instanceof Pt||e instanceof we){var s=this.findMatch(t.ports,t.id,e.id);if(s)return s;var o=this.findMatch(t.fixedUserHandles,t.id,e.id);if(o)return o}}if(t instanceof B){if(e&&e.id===t.id+"_path")return t;if(e instanceof Pt||e instanceof we){var h=this.findMatch(t.ports,t.id,e.id);if(h)return h;var l=this.findMatch(t.fixedUserHandles,t.id,e.id);if(l)return l}}if(!r){for(var d=void 0,f=0;f<t.annotations.length;f++)if(d=t.annotations[parseInt(f.toString(),10)],e.id===t.id+"_"+d.id)return d}return t},n.prototype.findMatch=function(e,t,i){for(var r=0;r<e.length;r++){var a=e[parseInt(r.toString(),10)];if(i===t+"_"+a.id||i===t+"_"+a.id+"_shape")return a}},n.prototype.canDisconnect=function(e,t,i,r){var a,s;t.source instanceof It?(a=t.source,s=a.connectors[0]):t.source instanceof B&&this.diagram.currentDrawingObject&&(s=this.diagram.currentDrawingObject),this.findTarget(t.targetWrapper,t.target,e==="ConnectorSourceEnd",!0);var o=e==="ConnectorSourceEnd"?"sourceID":"targetID",h=e==="ConnectorSourceEnd"?"sourcePortID":"targetPortID";return s[""+o]!==r||s[""+h]!==i},n.prototype.connect=function(e,t,i){var r={},a={},s,o,h,l,d;t.source instanceof It?(h=t.source,l=h.connectors[0]):t.source instanceof B&&this.diagram.currentDrawingObject&&this.diagram.currentDrawingObject instanceof B?l=this.diagram.currentDrawingObject:this.diagram.eventHandler.tool&&(this.diagram.eventHandler.tool instanceof si||this.diagram.eventHandler.tool instanceof qe)&&this.diagram.eventHandler.tool.drawingObject&&(l=this.diagram.eventHandler.tool.drawingObject);var f=this.findTarget(t.targetWrapper||t.sourceWrapper,t.target||t.actualObject,e==="ConnectorSourceEnd",!0),p=e==="ConnectorSourceEnd"?"sourceID":"targetID",c=e==="ConnectorSourceEnd"?"sourcePortID":"targetPortID";if(f instanceof M)a[""+p]=l[""+p],l[""+p]=f.id,r[""+p]=l[""+p],a[""+c]=l[""+c],d=this.connectionEventChange(l,a,r,e,i);else if(f instanceof No||f instanceof Ir){s=l[""+p],o=l[""+c],l[""+c]=f.id,l[""+p]=t.target&&t.target.id||t.actualObject.id,r[""+p]=l[""+p],r[""+c]=l[""+c];var u={connector:l,oldValue:{nodeId:s,portId:o},newValue:{nodeId:r[""+p],portId:r[""+c]},cancel:!1,state:"Changing",connectorEnd:e};this.triggerEvent(Z.connectionChange,u),u.cancel?(l[""+p]=s,l[""+c]=o,r[""+p]=s,r[""+c]=o):(this.diagram.connectorPropertyChange(l,a,r),this.diagram.updateDiagramObject(l),u={connector:l,oldValue:{nodeId:s,portId:o},newValue:{nodeId:r[""+p],portId:r[""+c]},cancel:!1,state:"Changing",connectorEnd:e})}return this.updateSelector(),this.renderHighlighter(t,void 0,e==="ConnectorSourceEnd"),d},n.prototype.cut=function(){this.clipboardData.pasteIndex=0,this.diagram.undoRedoModule&&this.diagram.historyManager.startGroupAction(),this.clipboardData.clipObject=this.copyObjects(),this.diagram.undoRedoModule&&this.diagram.historyManager.endGroupAction(),this.diagram.mode!=="SVG"&&this.diagram.refreshDiagramLayer()},n.prototype.addLayer=function(e,t,i){e.id=e.id||K(),e.zIndex=this.diagram.layers.length;var r=this.diagram.allowServerDataBinding;if(this.diagram.enableServerDataBinding(!1),e=new Wf(this.diagram,"layers",e,!0),this.diagram.enableServerDataBinding(r),e.objectZIndex=-1,e.zIndexTable={},this.diagram.layers.push(e),this.diagram.layerZIndexTable[e.zIndex]=e.id,this.diagram.activeLayer=e,e.objects,t)for(var a=0;a<t.length;a++)this.diagram.add(t[parseInt(a.toString(),10)])},n.prototype.getObjectLayer=function(e){var t=this.diagram.layers;if(t.length>1)for(var i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)].objects.indexOf(e);if(r>-1)return t[parseInt(i.toString(),10)]}return this.diagram.activeLayer},n.prototype.getLayer=function(e){for(var t=this.diagram.layers,i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].id===e)return t[parseInt(i.toString(),10)]},n.prototype.removeLayer=function(e,t){var i=this.getLayer(e);if(i){for(var r=this.diagram.layers.indexOf(i),a=i.objects,s=a.length-1;s>=0;s--)this.diagram.unSelect(this.diagram.nameTable[a[parseInt(s.toString(),10)]]),this.diagram.remove(this.diagram.nameTable[a[parseInt(s.toString(),10)]]),i.id!=="default_layer"&&this.diagram.activeLayer.id===e&&(this.diagram.activeLayer=this.diagram.layers[this.diagram.layers.length-1]);delete this.diagram.layerZIndexTable[i.zIndex],this.diagram.layers.splice(r,1),this.diagram.mode!=="SVG"&&this.diagram.refreshDiagramLayer()}},n.prototype.collectAllDescendants=function(e,t,i,r){r===void 0&&(r={});var a=this.diagram.nameTable[""+e],s=r;if(a&&a.children&&a.children.length>0){s[""+e]=[];for(var o=0,h=a.children;o<h.length;o++){var l=h[o],d=this.diagram.nameTable[""+l];if(d instanceof M){var f={inEdges:d.inEdges,outEdges:d.outEdges};i[""+d.id]=E(f)}else if(d instanceof B){var f={sourceID:d.sourceID,targetID:d.targetID,sourcePortID:d.sourcePortID,targetPortID:d.targetPortID};i[""+d.id]=E(f)}s[""+e].push(t.nameTable[""+l]),this.collectAllDescendants(l,t,i,s)}}return s},n.prototype.moveObjects=function(e,t){this.diagram.startGroupAction();for(var i={},r=0;r<e.length;r++){var a=this.diagram.nameTable[e[parseInt(r.toString(),10)]];if(!a.parentId){if(a instanceof M){var s={inEdges:a.inEdges,outEdges:a.outEdges};i[""+a.id]=E(s)}else if(a instanceof B){var s={sourceID:a.sourceID,targetID:a.targetID,sourcePortID:a.sourcePortID,targetPortID:a.targetPortID};i[""+a.id]=E(s)}}}var o=this.getLayer(t)||this.diagram.activeLayer;this.diagram.setActiveLayer(o.id);for(var h,l=0,d=e;l<d.length;l++){var r=d[l],f=this.diagram.nameTable[""+r];if(!f.parentId){var p=this.getObjectLayer(r),c=p.objects.indexOf(r);if(c>-1){h=this.diagram.nameTable[""+r];var u=this.collectAllDescendants(""+r,this.diagram,i);this.diagram.unSelect(h),this.diagram.deleteDependentConnector=!1,this.diagram.remove(this.diagram.nameTable[""+r]),this.diagram.deleteDependentConnector=!0;for(var g=null,v=0;v<o.objects.length;v++){var m=o.objects[parseInt(v.toString(),10)],a=this.diagram.nameTable[""+m];a&&(g===null||a.zIndex>g)&&(g=a.zIndex)}if(Object.keys(u).length){for(var y in u)if(u.hasOwnProperty(y)&&!this.diagram.nameTable[""+y]){var S=u[""+y],x=this.assignZindexAndAddNode(u,S,g+2,i);h.children=x,h.zIndex=g+1;var I=this.diagram.add(h);this.setConnectorDetails(I||h,i)}}else{h.zIndex=g+1;var I=this.diagram.add(h);this.setConnectorDetails(I||h,i)}if(h.parentId){var y=h.parentId,C=this.diagram.nameTable[""+y];this.diagram.addChildToGroup(C,h.id)}}}}this.diagram.endGroupAction()},n.prototype.assignZindexAndAddNode=function(e,t,i,r){for(var a=[],s=0;s<t.length;s++){var o=t[parseInt(s.toString(),10)];if(o){if(o.children){var h=this.assignZindexAndAddNode(e,e[o.id],i+1,r);o.children=h}o.zIndex=i,i++,o.children&&o.children.length&&(i+=o.children.length);var l=this.diagram.add(o);a.push(l.id),this.setConnectorDetails(l||o,r)}}return a},n.prototype.setConnectorDetails=function(e,t){var i=t[e.id];if(e instanceof M){if(i){if(i.inEdges&&i.inEdges.length>0)for(var r=0;r<i.inEdges.length;r++){var a=this.diagram.nameTable[i.inEdges[parseInt(r.toString(),10)]];a.targetID=e.id}if(i.outEdges&&i.outEdges.length>0)for(var r=0;r<i.outEdges.length;r++){var a=this.diagram.nameTable[i.outEdges[parseInt(r.toString(),10)]];a.sourceID=e.id}}}else e instanceof B&&i&&(e.sourceID=i.sourceID,e.targetID=i.targetID,e.sourcePortID=i.sourcePortID,e.targetPortID=i.targetPortID)},n.prototype.cloneLayer=function(e){this.diagram.layers;var t=this.getLayer(e);if(t){var i=[],r={id:e+"_"+K(),objects:[],visible:!0,lock:!1};this.addLayer(r,null,!0),r.zIndex=this.diagram.layers.length-1,i.length;for(var a=0,s=t.objects;a<s.length;a++){var o=s[a];i.push(this.diagram.nameTable[""+o])}this.paste(i)}},n.prototype.copy=function(){return this.clipboardData.pasteIndex=1,this.clipboardData.clipObject=this.copyObjects(),this.clipboardData.clipObject},n.prototype.copyObjects=function(){var e=[],t=[];this.clipboardData.childTable={};var i={};if(this.diagram.selectedItems.connectors.length>0){e=e.concat(this.diagram.selectedItems.connectors);for(var r=0;r<e.length;r++){var a=void 0;this.diagram.bpmnModule&&e[parseInt(r.toString(),10)].isBpmnAnnotationConnector?a=E(this.diagram.nameTable[e[parseInt(r.toString(),10)].targetID]):a=E(e[parseInt(r.toString(),10)]),t.push(a)}}if(this.diagram.selectedItems.nodes.length>0){e=e.concat(this.diagram.selectedItems.nodes);for(var s=function(p){if(!o.diagram.selectedItems.nodes[parseInt(p.toString(),10)].isPhase){var c;o.diagram.selectedItems.nodes.forEach(function(F){F.isLane&&(c=F.parentId,i[parseInt(c.toString(),10)]=i[parseInt(c.toString(),10)]||[],i[parseInt(c.toString(),10)].indexOf(F.id)===-1&&i[parseInt(c.toString(),10)].push(F.id))});var u=E(o.diagram.selectedItems.nodes[parseInt(p.toString(),10)]),g=t.filter(function(F){return F.isLane}),v=!1;if(u.isLane)for(var m=0,y=g;m<y.length;m++){var S=y[m];if(ym(S,u,o.diagram)){v=!0;break}}if(!((u.isLane||u.isHeader)&&o.checkSwimlaneInSelection(u,t))&&!(mm(u,o.diagram)||v)){u.wrapper&&u.offsetX!==u.wrapper.offsetX&&(u.offsetX=u.wrapper.offsetX),u.wrapper&&u.offsetY!==u.wrapper.offsetY&&(u.offsetY=u.wrapper.offsetY),o.copyProcesses(u),o.copyContainerChild(u),t.push(E(u));var x=xt();if(Rt(x,-u.rotateAngle,u.offsetX,u.offsetY),u.children){for(var I=o.clipboardData.childTable,C=void 0,P=[],A=o.getAllDescendants(u,P,!0),T=0;T<A.length;T++){C=o.diagram.nameTable[A[parseInt(T.toString(),10)].id];var z=I[C.id]=E(C),L=st(x,{x:z.wrapper.offsetX,y:z.wrapper.offsetY});C instanceof M&&(z.offsetX=L.x,z.offsetY=L.y,z.rotateAngle-=u.rotateAngle)}o.clipboardData.childTable=I}if(u.shape.type==="SwimLane")for(var R=o.diagram.getObject(o.diagram.selectedItems.nodes[parseInt(p.toString(),10)].id),I=o.clipboardData.childTable,O=sr(o.diagram,R.wrapper.children[0]),T=0;T<O.length;T++){var N=o.diagram.getObject(O[parseInt(T.toString(),10)]);I[N.id]=E(N),I[N.id].parentSwimlaneId=u.id}if(u&&u.isLane){var I=o.clipboardData.childTable,R=o.diagram.getObject(u.parentId);if(o.clipboardData.pasteIndex===0&&R&&R.shape&&R.shape.lanes&&R.shape.lanes.length===i[parseInt(c.toString(),10)].length)return{value:[]};var H=Zn(u,o.diagram);I[u.id]=E(H),I[u.id].width=R.wrapper.actualSize.width}}}},o=this,r=0;r<this.diagram.selectedItems.nodes.length;r++){var h=s(r);if(typeof h=="object")return h.value}}if(this.sortByZIndex(t,"zIndex"),this.diagram.selectedItems.nodes.some(function(p){return p.shape.type==="SwimLane"})&&(t=this.removeDuplicateObjects(t)),this.clipboardData.pasteIndex===0){this.startGroupAction();for(var l=0,d=e;l<d.length;l++){var f=d[l];this.diagram.nameTable[f.id]&&(this.diagram.itemType="Clipboard",this.diagram.remove(f))}this.endGroupAction()}return t},n.prototype.findProcesses=function(e){var t=[],i=e.shape.lanes;return i.forEach(function(r){r.children&&r.children.forEach(function(a){var s=a.shape.activity;s&&s.subProcess.processes&&s.subProcess.processes.forEach(function(o){t.push(o)})})}),t},n.prototype.removeDuplicateObjects=function(e){for(var t={},i=0;i<e.length;i++)t[e[parseInt(i.toString(),10)].id]=e[parseInt(i.toString(),10)];var r=[];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&r.push(t[""+a]);for(var s=function(f){if(r[parseInt(f.toString(),10)].parentId){var p=o.diagram.getObject(r[parseInt(f.toString(),10)].parentId);p&&p.isLane&&p.parentId&&r.some(function(c){return c.id===p.parentId})&&(r.splice(f,1),f--)}h=f},o=this,h,i=0;i<r.length;i++)s(i),i=h;var l=Object.keys(this.clipboardData.childTable),d=r.filter(function(f){return l.indexOf(f.id)===-1||f.isLane});return d},n.prototype.checkSwimlaneInSelection=function(e,t){return this.diagram.selectedItems.nodes.some(function(i){return i.id===e.parentId})},n.prototype.copyProcesses=function(e){var t=[];e.shape.type==="Bpmn"&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length>0?t=e.shape.activity.subProcess.processes:e.shape.type==="SwimLane"&&(t=this.findProcesses(e));for(var i=0,r=t;i<r.length;i++){var a=r[i];this.processTable[""+a]=E(this.diagram.nameTable[""+a]),this.processTable[""+a].shape.activity.subProcess.processes&&this.processTable[""+a].shape.activity.subProcess.processes.length>0&&this.copyProcesses(this.processTable[""+a])}this.clipboardData.processTable=this.processTable},n.prototype.copyContainerChild=function(e){var t=[];if(e.shape.type==="Container"&&e.shape.children&&e.shape.children.length>0&&(t=e.shape.children),e.children&&e.children.length>0)for(var i=0;i<e.children.length;i++){var r=e.children[parseInt(i.toString(),10)],a=this.diagram.nameTable[""+r];a&&a.shape.type==="Container"&&a.shape.children.length>0&&(t=t.concat(a.shape.children))}for(var s=0,o=t;s<o.length;s++){var h=o[s];this.containerChildTable[""+h]=E(this.diagram.nameTable[""+h]),this.containerChildTable[""+h].shape.children&&this.containerChildTable[""+h].shape.children.length>0&&this.copyContainerChild(this.containerChildTable[""+h])}this.clipboardData.containerChildTable=this.containerChildTable},n.prototype.group=function(){var e=this;this.oldSelectedObjects=es(this.diagram);var t="isProtectedOnChange",i=this.diagram[""+t];this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|k.Group;var r=[],a={};a.id="group"+K(),a=new M(this.diagram,"nodes",a,!0),a.children=[],r=this.diagram.selectedItems.nodes,r=r.concat(this.diagram.selectedItems.connectors);var s=this.diagram.connectors;s.forEach(function(c){var u=e.diagram.nameTable[c.sourceID],g=e.diagram.nameTable[c.targetID],v=u&&u.processId&&Ut(e.diagram,e.diagram.nameTable[u.processId]),m=g&&g.processId&&Ut(e.diagram,e.diagram.nameTable[g.processId]),y=r.some(function(S){return S.id===c.id});!y&&(v||m)&&r.push(c)});for(var o=r.sort(function(c,u){return c.zIndex-u.zIndex}),h={},l=0;l<o.length;l++)!o[parseInt(l.toString(),10)].parentId&&!o[parseInt(l.toString(),10)].processId&&(a.children.push(o[parseInt(l.toString(),10)].id),h[o[parseInt(l.toString(),10)].id]=o[parseInt(l.toString(),10)].zIndex);if(a.children.length>0){this.diagram.itemType="Group";var d=this.diagram.add(a),f=this.getObjectLayer(d.id);this.updateGroupInZindexTable(d,h,f),d&&this.select(d),a.annotations=d.annotations,a.ports=d.ports,a.zIndex=d.zIndex,a.style=d.style;var p={type:"Group",undoObject:a,redoObject:a,category:"Internal"};this.addHistoryEntry(p),this.diagram.diagramActions=this.diagram.diagramActions&~k.Group,this.diagram.protectPropertyChange(i)}},n.prototype.updateGroupInZindexTable=function(e,t,i){var r=i.zIndexTable;for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var s=t[""+a];r[parseInt(s.toString(),10)]===a&&delete r[parseInt(s.toString(),10)]}if(e.children&&e.children.length)for(var o=0,h=e.children;o<h.length;o++){var a=h[o],l=this.diagram.nameTable[""+a];l&&(r[l.zIndex]=l.id)}},n.prototype.unGroup=function(e){var t="isProtectedOnChange",i=this.diagram[""+t];this.diagram.protectPropertyChange(!0),this.diagram.diagramActions=this.diagram.diagramActions|k.Group;var r=[];if(e){var a=this.diagram.nameTable[e.id];r.push(a)}else r=this.diagram.selectedItems.nodes;this.diagram.startGroupAction();for(var s=0;s<r.length;s++){for(var o=r[parseInt(s.toString(),10)],h=E(o),l=[],d=0;d<o.children.length;d++)l.push(o.children[parseInt(d.toString(),10)]);if(o.children){o.ports&&o.ports.length>0&&this.diagram.removePorts(o,o.ports),o.annotations&&o.annotations.length>0&&this.diagram.removeLabels(o,o.annotations);for(var f=this.diagram.nameTable[o.parentId],p=o.children.length-1;p>=0;p--){this.diagram.nameTable[o.children[parseInt(p.toString(),10)]].parentId="";var c=o.children[parseInt(p.toString(),10)];this.diagram.deleteChild(this.diagram.nameTable[o.children[parseInt(p.toString(),10)]],o),o.parentId&&c&&this.diagram.addChild(f,c)}this.resetDependentConnectors(o.inEdges,!0),this.resetDependentConnectors(o.outEdges,!1);var u={type:"UnGroup",undoObject:h,redoObject:h,category:"Internal"};this.diagram.diagramActions&k.UndoRedo||this.addHistoryEntry(u),o.parentId&&this.diagram.deleteChild(o,f)}this.diagram.removeNode(o,l),this.clearSelection()}this.diagram.endGroupAction(),this.diagram.diagramActions=this.diagram.diagramActions&~k.Group,this.diagram.protectPropertyChange(i)},n.prototype.resetDependentConnectors=function(e,t){for(var i=0;i<e.length;i++){var r=this.diagram.nameTable[e[parseInt(i.toString(),10)]],a=E(r),s=void 0;t?(r.targetID="",r.targetPortID="",s={targetID:r.targetID,targetPortID:r.targetPortID}):(r.sourceID="",r.sourcePortID="",s={sourceID:r.sourceID,sourcePortID:r.sourcePortID}),this.diagram.connectorPropertyChange(r,{},s);var o={type:"ConnectionChanged",undoObject:{connectors:[a],nodes:[]},redoObject:{connectors:[E(r)],nodes:[]},category:"Internal"};this.diagram.diagramActions&k.UndoRedo||this.addHistoryEntry(o)}},n.prototype.paste=function(e){if(e||this.clipboardData.clipObject){this.diagram.protectPropertyChange(!0);var t=e?this.getNewObject(e):this.clipboardData.clipObject;if(t){var i=t.length!==1,r=!1,a={},s={};this.clonedChildrenTable={},this.clipboardData.pasteIndex!==0&&this.clearSelection(),this.diagram.undoRedoModule&&(r=!0,this.diagram.historyManager.startGroupAction());for(var o=0,h=t;o<h.length;o++){var l=h[o];a[l.id]=l}var d=[];i&&(this.diagram.isServerUpdate=!0);for(var f=0;f<t.length;f++){var l=t[parseInt(f.toString(),10)];if(l.parentId){var p=this.diagram.getObject(l.parentId);p.shape.type!=="SwimLane"&&l.parentId&&(l.parentId="")}if(Fe(l)===B){var c=E(l),u=c.sourceID;c.sourceID="",a[""+u]&&s[""+u]&&(c.sourceID=s[""+u]),this.clonedChildrenTable[""+u]&&(c.sourceID=this.clonedChildrenTable[""+u]),u=c.targetID,c.targetID="",a[""+u]&&s[""+u]&&(c.targetID=s[""+u]),this.clonedChildrenTable[""+u]&&(c.targetID=this.clonedChildrenTable[""+u]);var g=!0;if(c.targetID){var v=this.diagram.nameTable[c.targetID];v.shape.shape==="TextAnnotation"&&v.inEdges&&v.inEdges.length>0&&(g=!1)}if(g){var m=this.cloneConnector(c,i);d.push(m),s[l.id]=m.id}}else{l.shape&&l.shape.type==="Bpmn"&&(l.processId=""),this.cloningInProgress=!0;var y=this.cloneNode(l,i);if(this.cloningInProgress=!1,d.push(y),y){s[l.id]=y.id;var S=l.inEdges;if(S)for(var x=0,I=S;x<I.length;x++){var C=I[x];if(a[""+C]&&s[""+C]){var P=this.diagram.nameTable[s[""+C]];P.targetID=s[l.id],this.diagram.connectorPropertyChange(P,{targetID:"",targetPortID:""},{targetID:P.targetID,targetPortID:P.targetPortID})}}if(S=l.outEdges,S)for(var A=0,T=S;A<T.length;A++){var C=T[A];if(a[""+C]&&s[""+C]){var P=this.diagram.nameTable[s[""+C]];P.sourceID=s[l.id],this.diagram.connectorPropertyChange(P,{sourceID:"",sourcePortID:""},{sourceID:P.sourceID,sourcePortID:P.sourcePortID})}}}}}i&&(this.diagram.isServerUpdate=!1,this.diagram.select(d,!0)),r===!0&&(this.diagram.historyManager.endGroupAction(),r=!1),this.diagram.mode!=="SVG"&&this.diagram.refreshDiagramLayer(),this.clipboardData.pasteIndex++,this.diagram.protectPropertyChange(!1)}}},n.prototype.getNewObject=function(e){var t,i=[];this.clipboardData.pasteIndex=1;for(var r=0;r<e.length;r++)t=E(e[parseInt(r.toString(),10)]),i.push(t);return i},n.prototype.cloneConnector=function(e,t){var i=E(e);this.translateObject(i),i.zIndex=Number.MIN_VALUE,this.diagram.itemType="Clipboard";var r=this.diagram.add(i);return this.diagram.isServerUpdate||this.selectObjects([r],t),r},n.prototype.cloneNode=function(e,t,i,r){var a,s={},o=E(e),h,l,d=this.diagram.nameTable[e.parentId];e.shape&&e.shape.type==="Bpmn"&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length&&(h=o.shape.activity.subProcess.processes,o.zIndex=Number.MIN_VALUE,o.shape.activity.subProcess.processes=void 0),e.shape&&e.shape.type==="Container"&&e.shape.children&&e.shape.children.length&&(l=o.shape.children,o.zIndex=Number.MIN_VALUE,o.shape.children=void 0),e.shape&&e.shape.type==="SwimLane"?po(e,this.diagram,this.clipboardData):d&&d.shape.type==="SwimLane"?po(E(d),this.diagram,this.clipboardData,e,!0):e.children&&e.children.length&&(!i||!i.length)?a=this.cloneGroup(e,t):(this.translateObject(o,r),o.zIndex=Number.MIN_VALUE,i&&(o.children=i),o.shape&&o.shape.shape==="TextAnnotation"&&(o.isTextAnnotationCopied=!0),this.diagram.itemType="Clipboard",a=this.diagram.add(o)),e.shape&&e.shape.type==="SwimLane"&&(h=this.findProcesses(e));for(var f=0,p=Object.keys(s);f<p.length;f++){var c=p[f];this.diagram.add(s[""+c])}return h&&h.length&&(e.shape.type==="Bpmn"?(a.shape.activity.subProcess.processes=h,this.cloneSubProcesses(a)):e.shape.type==="SwimLane"&&this.cloneSubProcesses(e)),l&&l.length&&(a.shape.children=l,this.cloneSubProcesses(a)),a&&!this.diagram.isServerUpdate&&this.selectObjects([a],t),a},n.prototype.cloneSubProcesses=function(e){var t=this,i=[];if(e.shape.type==="Bpmn"&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length)i=e.shape.activity.subProcess.processes,this.cloneProcessess(i,e);else if(e.shape.type==="Container"&&e.shape.children&&e.shape.children.length)for(var r=[],a={},s=e.shape.children,o=0;o<s.length;o++){for(var h=this.diagram.nameTable[s[parseInt(o.toString(),10)]]||this.clipboardData.containerChildTable[s[parseInt(o.toString(),10)]],l=0,d=h.outEdges;l<d.length;l++){var f=d[l];r.indexOf(f)<0&&r.push(f)}for(var p=0,c=h.inEdges;p<c.length;p++){var f=c[p];r.indexOf(f)<0&&r.push(f)}var u=E(this.clipboardData.containerChildTable[s[parseInt(o.toString(),10)]]);u.parentId=e.id;var g=this.cloneNode(u,!1);a[s[parseInt(o.toString(),10)]]=g.id,s[parseInt(o.toString(),10)]=g.id,this.clonedChildrenTable[u.id]=g.id,yf(g,e.id,this.diagram);for(var v=function(A){var T=m.diagram.nameTable[""+A]||m.diagram.connectorTable[""+A],z=m.clipboardData.clipObject.find(function(R){return R.id===T.id});if(!z){var L=E(T);a[L.sourceID]&&a[L.targetID]&&(L.zIndex=-1,L.id+=K(),L.sourceID=a[L.sourceID],L.targetID=a[L.targetID],r.splice(r.indexOf(A),1),L.zIndex=Number.MIN_VALUE,m.diagram.add(L))}},m=this,y=0,S=r;y<S.length;y++){var x=S[y];v(x)}}if(e.shape.type==="SwimLane")for(var I=void 0,C=e.shape.lanes,x=0;x<C.length;x++)for(var h=C[parseInt(x.toString(),10)].children,f=0;f<h.length;f++){var P=h[parseInt(f.toString(),10)].shape.activity;P&&P.subProcess.processes&&(i=P.subProcess.processes,I=h[parseInt(f.toString(),10)],i.forEach(function(L){t.diagram.nameTable[""+L]&&(t.clipboardData.processTable[""+L]=t.diagram.nameTable[""+L])}),this.diagram.isServerUpdate=!0,this.cloneProcessess(i,I),this.diagram.isServerUpdate=!1)}},n.prototype.cloneProcessess=function(e,t){for(var i=[],r={},a=this.diagram.nameTable[t.id],s=0;s<e.length;s++){for(var o=this.diagram.nameTable[e[parseInt(s.toString(),10)]]||this.clipboardData.processTable[e[parseInt(s.toString(),10)]],h=0,l=o.outEdges;h<l.length;h++){var d=l[h];i.indexOf(d)<0&&i.push(d)}for(var f=0,p=o.inEdges;f<p.length;f++){var d=p[f];i.indexOf(d)<0&&i.push(d)}var c=E(this.clipboardData.processTable[e[parseInt(s.toString(),10)]]);c.processId=a.id;var u=this.cloneNode(c,!1);r[e[parseInt(s.toString(),10)]]=u.id,a.shape.activity.subProcess.processes[parseInt(s.toString(),10)]=u.id,e[parseInt(s.toString(),10)]=u.id,this.diagram.addProcess(u,a.id);for(var g=0,v=i;g<v.length;g++){var m=v[g],y=this.diagram.nameTable[""+m]||this.diagram.connectorTable[""+m],S=E(y);r[S.sourceID]&&r[S.targetID]&&(S.zIndex=-1,S.id+=K(),S.sourceID=r[S.sourceID],S.targetID=r[S.targetID],i.splice(i.indexOf(m),1),S.zIndex=Number.MIN_VALUE,this.diagram.add(S))}}},n.prototype.cloneGroup=function(e,t){var i,r,a=[],s=[],o=[],h,l=[];s=s.concat(e.children);var d=K(),f=[];if(this.diagram.blazorActions|=jt.GroupClipboardInProcess,this.clipboardData.childTable||e.children.length>0)for(var p=0;p<s.length;p++){var c=void 0;this.clipboardData.childTable?(c=this.clipboardData.childTable[s[parseInt(p.toString(),10)]],c||(c=this.diagram.nameTable[s[parseInt(p.toString(),10)]])):c=this.diagram.nameTable[s[parseInt(p.toString(),10)]],c.parentId="",c&&(Fe(c)===B?o.push(c):(h=this.cloneNode(c,t,void 0,d),l.push(c.id),a.push(h.id),f.push(h)))}for(var u=0;u<o.length;u++){if(o[parseInt(u.toString(),10)].sourceID||o[parseInt(u.toString(),10)].targetID)for(var g=0;g<l.length;g++)o[parseInt(u.toString(),10)].sourceID===l[parseInt(g.toString(),10)]&&(i=o[parseInt(u.toString(),10)].sourceID,o[parseInt(u.toString(),10)].sourceID+=d),o[parseInt(u.toString(),10)].targetID===l[parseInt(g.toString(),10)]&&(r=o[parseInt(u.toString(),10)].targetID,o[parseInt(u.toString(),10)].targetID+=d);h=this.cloneConnector(o[parseInt(u.toString(),10)],t),o[parseInt(u.toString(),10)].sourceID=i,o[parseInt(u.toString(),10)].targetID=r,a.push(h.id),f.push(h)}var v=this.cloneNode(e,t,a);return f.push(v),v&&v.container&&v.shape&&v.shape.type==="UmlClassifier"&&(this.diagram.updateDiagramObject(v),v.wrapper.measure(new U)),this.diagram.blazorActions&=~jt.GroupClipboardInProcess,this.diagram.isServerUpdate?this.cloneGroupChildCollection=f:this.diagram.UpdateBlazorDiagramModelCollection(void 0,f,void 0,!0),v},n.prototype.translateObject=function(e,t){e.id+=t||K();var i=this.clipboardData.pasteIndex*10;if(Fe(e)===B){if(e.sourcePoint={x:e.sourcePoint.x+i,y:e.sourcePoint.y+i},e.targetPoint={x:e.targetPoint.x+i,y:e.targetPoint.y+i},e.type==="Bezier")for(var r=e.segments,a=0;a<r.length;a++)b.isEmptyPoint(r[parseInt(a.toString(),10)].point1)||(r[parseInt(a.toString(),10)].point1={x:r[parseInt(a.toString(),10)].point1.x+i,y:r[parseInt(a.toString(),10)].point1.y+i}),b.isEmptyPoint(r[parseInt(a.toString(),10)].point2)||(r[parseInt(a.toString(),10)].point2={x:r[parseInt(a.toString(),10)].point2.x+i,y:r[parseInt(a.toString(),10)].point2.y+i});if((e.type==="Straight"||e.type==="Bezier")&&e.segments&&e.segments.length>0)for(var r=e.segments,a=0;a<r.length-1;a++)r[parseInt(a.toString(),10)].point.x+=i,r[parseInt(a.toString(),10)].point.y+=i}else e.offsetX+=i,e.offsetY+=i},n.prototype.drawObject=function(e){var t;e&&e.shape&&e.shape.type==="Text"&&(e.width=this.diagram.drawingObject.width?this.diagram.drawingObject.width:50,e.height=this.diagram.drawingObject.height?this.diagram.drawingObject.height:20);for(var i=E(this.diagram.drawingObject),r=0,a=Object.keys(e);r<a.length;r++){var s=a[r];i[""+s]=e[""+s]}return Fe(this.diagram.drawingObject)===M||Fe(this.diagram.drawingObject)===B&&this.diagram.drawingObject.type==="Freehand"&&e.type!=="Bezier"?(t=new M(this.diagram,"nodes",i,!0),t.id=(this.diagram.drawingObject.id||"node")+K()):(t=new B(this.diagram,"connectors",i,!0),t.id=(this.diagram.drawingObject&&this.diagram.drawingObject.id?this.diagram.drawingObject.id:"connector")+K()),this.diagram.initObject(t),this.diagram.updateDiagramObject(t),this.diagram.currentDrawingObject=t,t},n.prototype.addObjectToDiagram=function(e){this.diagram.removeFromAQuad(e),this.diagram.removeObjectsFromLayer(this.diagram.nameTable[e.id]),delete this.diagram.nameTable[e.id],e instanceof B&&e.type==="Bezier"&&e.segments.length>0&&this.diagram.drawingObject&&this.diagram.drawingObject.type==="Bezier"&&(e.segments=[]),this.diagram.itemType="DrawingTool";var t=this.diagram.add(e);this.diagram.mode!=="SVG"&&this.diagram.refreshDiagramLayer(),this.selectObjects([t]),e&&!ds(this.diagram)&&(this.diagram.tool&=~Gt.DrawOnce,this.diagram.currentDrawingObject=void 0)},n.prototype.enableServerDataBinding=function(e){this.diagram.enableServerDataBinding(e)},n.prototype.addText=function(e,t){var i=this.diagram.findElementUnderMouse(e,t,this.diagram);this.diagram.startTextEdit(e,i instanceof Tt?i.id.split("_")[1]:void 0)},n.prototype.isUserHandle=function(e){var t=this.diagram.selectedItems;if(t.wrapper&&Kt(t.constraints,"UserHandle"))for(var i=0,r=t.userHandles;i<r.length;i++){var a=r[i];if(a.visible&&!(a.disableConnectors&&this.diagram.selectedItems.connectors.length>0||a.disableNodes&&this.diagram.selectedItems.nodes.length>0)){var s=eh(t,a,this.diagram.scroller.transform);if($t(e,s,a.size/(2*this.diagram.scroller.transform.scale)))return!0}}return!1},n.prototype.selectObjects=function(e,t,i){return qs(this,void 0,void 0,function(){var r,a,s,o,c,h,l,d,f,p,c,u,g,v;return Qs(this,function(m){if(r={oldValue:i||this.getSelectedObject(),newValue:e,cause:this.diagram.diagramActions,state:"Changing",type:"Addition",cancel:!1},e.length>0&&e[0]&&e[0].isLane)for(a=this.diagram.getObject(e[0].parentId),e[0].shape.header=[],s="",o=0;o<e.length;o++)for(c=0;c<a.shape.lanes.length;c++)h=e[0].id.split(e[0].parentId),s=h[1].slice(0,-1),s===a.shape.lanes[parseInt(c.toString(),10)].id&&e[0].shape.header.push(a.shape.lanes[parseInt(c.toString(),10)].header);if(this.diagram.enableServerDataBinding(!1),l=!0,this.diagram.triggerEvent(Z.selectionChange,r),d=this.diagram.selectedItems.annotation?[this.diagram.selectedItems.annotation]:this.diagram.selectedItems.nodes.concat(this.diagram.selectedItems.connectors),f=Un(this.diagram),p=Yn(this.diagram),p||f){if(!f&&(e.length>1||t&&e.length===1))if(e.length===1)this.clearSelection();else return[2];if(!(p||f)&&e.length===1&&(!t||!Si(this.diagram)))return this.clearSelection(),[2]}if(!r.cancel){for(c=0;c<e.length;c++)if(u=e[parseInt(c.toString(),10)],u)if(l=!0,!Si(this.diagram))this.select(u,c>0||t,!0);else{if((c>0||t)&&u.children&&!u.parentId)for(g=0;g<this.diagram.selectedItems.nodes.length;g++)v=this.diagram.nameTable[this.diagram.selectedItems.nodes[parseInt(g.toString(),10)].parentId],v&&(v=this.findParent(v),v&&u.id===v.id&&this.selectGroup(u));this.selectProcesses(u),l=this.selectBpmnSubProcesses(u),l&&this.select(u,c>0||t,!0)}i===void 0&&(i=d),r={oldValue:i||[],newValue:this.getSelectedObject(),cause:this.diagram.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.diagram.renderSelector(t||e&&e.length>1),this.diagram.triggerEvent(Z.selectionChange,r),this.diagram.enableServerDataBinding(!0)}return[2]})})},n.prototype.findParent=function(e){return e.parentId&&(e=this.diagram.nameTable[e.parentId],this.findParent(e)),e},n.prototype.selectProcesses=function(e){if(this.hasProcesses(e))for(var t=e.shape.activity.subProcess.processes,i=0;i<t.length;i++){var r=this.diagram.nameTable[t[parseInt(i.toString(),10)]];this.hasProcesses(r)&&this.selectObjects([r],!0),this.unSelect(r)}else if(e&&e.shape.type==="Container"&&e.shape.children&&e.shape.children.length>0)for(var a=e.shape.children,i=0;i<a.length;i++){var r=this.diagram.nameTable[a[parseInt(i.toString(),10)]];r&&r.shape.type==="Container"&&r.shape.children&&r.shape.children.length>0&&this.selectObjects([r],!0),this.unSelect(r)}},n.prototype.selectGroup=function(e){for(var t=0;t<e.children.length;t++){var i=this.diagram.nameTable[e.children[parseInt(t.toString(),10)]];i.children&&this.selectGroup(i),this.unSelect(this.diagram.nameTable[e.children[parseInt(t.toString(),10)]])}},n.prototype.selectBpmnSubProcesses=function(e){var t=!0,i;if(e.processId)Ut(this.diagram,this.diagram.nameTable[e.processId])?t=!1:t=this.selectBpmnSubProcesses(this.diagram.nameTable[e.processId]);else if(e.parentId&&this.diagram.nameTable[e.parentId]&&this.diagram.nameTable[e.parentId].shape.type==="Container")Ut(this.diagram,this.diagram.nameTable[e.parentId])?t=!1:t=this.selectBpmnSubProcesses(this.diagram.nameTable[e.parentId]);else if(e instanceof B){if(e.sourceID&&this.diagram.nameTable[e.sourceID]&&this.diagram.nameTable[e.sourceID].processId&&(i=this.diagram.nameTable[e.sourceID].processId),e.targetID&&this.diagram.nameTable[e.targetID]&&this.diagram.nameTable[e.targetID].processId&&(i=this.diagram.nameTable[e.targetID].processId),i){if(Ut(this.diagram,this.diagram.nameTable[""+i]))return!1;t=this.selectBpmnSubProcesses(this.diagram.nameTable[""+i])}}else e.parentId&&this.diagram.nameTable[e.parentId]&&this.diagram.nameTable[e.parentId].shape.type==="UmlClassifier"&&Ut(this.diagram,this.diagram.nameTable[e.parentId])&&(t=!1);return t},n.prototype.hasProcesses=function(e){return!!(e&&e.shape.type==="Bpmn"&&e.shape.activity&&e.shape.activity.subProcess.processes&&e.shape.activity.subProcess.processes.length>0)},n.prototype.select=function(e,t,i){var r=this.getObjectLayer(e.id);if(Wr(e)&&!(e instanceof It)&&!Ut(this.diagram,e)&&r&&!r.lock&&r.visible&&e.wrapper.visible){t=Si(this.diagram)?t:!1,t||this.clearSelection(),this.diagram.enableServerDataBinding(!1);var a=this.diagram.selectedItems,s=e;if(s instanceof M)if(e.isHeader){var o=this.diagram.nameTable[e.parentId];a.nodes.push(o)}else a.nodes.push(e);else a.connectors.push(e);if(a.selectedObjects.push(e),t)a.wrapper.rotateAngle=a.rotateAngle=0,a.wrapper.children.push(e.wrapper);else if(a.init(this.diagram),a.nodes.length===1&&a.connectors.length===0){var h=Us(this.diagram,a);h&&(a.wrapper.children[0]=h),a.rotateAngle=a.nodes[0].rotateAngle,a.wrapper.rotateAngle=a.nodes[0].rotateAngle,a.wrapper.pivot=a.nodes[0].pivot}i||this.diagram.renderSelector(t),this.diagram.enableServerDataBinding(!0)}},n.prototype.labelSelect=function(e,t,i){this.oldSelectedObjects=es(this.diagram);var r=this.findTarget(t,e),a={oldValue:i||this.getSelectedObject(),newValue:[r],cause:this.diagram.diagramActions,state:"Changing",type:"Addition",cancel:!1};if(this.diagram.triggerEvent(Z.selectionChange,a),!a.cancel){var s=this.diagram.selectedItems,o=this.diagram.allowServerDataBinding;this.diagram.allowServerDataBinding=!1,s.nodes=s.connectors=[],this.diagram.allowServerDataBinding=o,e instanceof M?s.nodes[0]=e:s.connectors[0]=e,s.annotation=r,s.init(this.diagram),this.diagram.renderSelector(!1),a={oldValue:i||[],newValue:[s.annotation],cause:this.diagram.diagramActions,state:"Changed",type:"Addition",cancel:!1},this.diagram.triggerEvent(Z.selectionChange,a)}},n.prototype.unSelect=function(e){var t=this.diagram.selectedItems.nodes.concat(this.diagram.selectedItems.connectors),i=t.filter(function(o){return o.id!==e.id}),r={oldValue:t,newValue:i,cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1};if(this.diagram.currentSymbol||this.diagram.triggerEvent(Z.selectionChange,r),Ut(this.diagram,e)){var a=this.diagram.selectedItems,s=void 0;e instanceof M?(s=a.nodes.indexOf(e,0),a.nodes.splice(s,1)):(s=a.connectors.indexOf(e,0),a.connectors.splice(s,1)),s=a.selectedObjects.indexOf(e,0),a.selectedObjects.splice(s,1),r={oldValue:t,newValue:i,cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},r={oldValue:t,newValue:i,cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:r.cancel},r.cancel||(s=a.wrapper.children.indexOf(e.wrapper,0),a.wrapper.children.splice(s,1),this.diagram.updateSelector(),this.diagram.currentSymbol||this.diagram.triggerEvent(Z.selectionChange,r))}},n.prototype.moveSvgNode=function(e,t){var i=this.diagram.nameTable[""+t];if(i.shape.type==="Native"||i.shape.type==="HTML")this.updateNativeNodeIndex(e,t);else{var r=St(t+"_groupElement",this.diagram.element.id),a=St(e+"_groupElement",this.diagram.element.id);r.parentNode.insertBefore(a,r)}},n.prototype.moveAfterSvgNode=function(e,t){var i=this.diagram.nameTable[""+t];if(i&&(i.shape.type==="HTML"||i.shape.type==="Native"))for(var r=0;r<this.diagram.views.length;r++){var a=i.shape.type==="HTML"?"_html_element":"_content_groupElement",s=St(e+a,this.diagram.views[parseInt(r.toString(),10)]),o=t?St(t+a,this.diagram.views[parseInt(r.toString(),10)]):s.parentElement.firstChild;s&&o&&s.parentNode.id===o.parentNode.id&&o.insertAdjacentElement("afterend",s)}else{var o=St(t+"_groupElement",this.diagram.element.id),s=St(e+"_groupElement",this.diagram.element.id);o.insertAdjacentElement("afterend",s)}},n.prototype.sendLayerBackward=function(e){var t=this.getLayer(e);if(t&&t.zIndex!==0){var i=t.zIndex;if(this.diagram.mode==="SVG"){var r=t.objects,a=this.getLayer(this.diagram.layerZIndexTable[i-1]).objects[0];if(a)for(var s=0,o=r;s<o.length;s++){var h=o[s];this.moveSvgNode(h,a)}}var l=this.getLayer(this.diagram.layerZIndexTable[i-1]);l.zIndex=l.zIndex+1,t.zIndex=t.zIndex-1;var d=this.diagram.layerZIndexTable[parseInt(i.toString(),10)];this.diagram.layerZIndexTable[parseInt(i.toString(),10)]=this.diagram.layerZIndexTable[i-1],this.diagram.layerZIndexTable[i-1]=d,this.diagram.layers[l.zIndex]=l,this.diagram.layers[t.zIndex]=t,this.diagram.mode==="Canvas"&&this.diagram.refreshDiagramLayer()}},n.prototype.bringLayerForward=function(e){var t=this.getLayer(e);if(t&&t.zIndex<this.diagram.layers.length-1){var i=t.zIndex,r=this.getLayer(this.diagram.layerZIndexTable[i+1]);if(this.diagram.mode==="SVG")for(var a=t.objects[0],s=r.objects,o=0,h=s;o<h.length;o++){var l=h[o];l&&this.moveSvgNode(l,a)}r.zIndex=r.zIndex-1,t.zIndex=t.zIndex+1;var d=this.diagram.layerZIndexTable[parseInt(i.toString(),10)];this.diagram.layerZIndexTable[parseInt(i.toString(),10)]=this.diagram.layerZIndexTable[i+1],this.diagram.layerZIndexTable[i+1]=d,this.diagram.layers[r.zIndex]=r,this.diagram.layers[t.zIndex]=t,this.diagram.mode==="Canvas"&&this.diagram.refreshDiagramLayer()}},n.prototype.sendToBack=function(e){if(this.diagram.protectPropertyChange(!0),Si(this.diagram)||e){var t=this.diagram.selectedItems,i=[];e&&e.id?i.push(e):(i=i.concat(t.nodes),i=i.concat(t.connectors));var r=e&&e.id,a=E(this.diagram.selectedItems);i=i.slice().sort(function(N,H){return N.zIndex-H.zIndex});for(var s=this.diagram.layers.indexOf(this.getObjectLayer(i[0].id)),o=this.diagram.layers[parseInt(s.toString(),10)].objects,h=null,l,d=0;d<o.length;d++){var f=this.diagram.nameTable[o[parseInt(d.toString(),10)]];(h===null||f.zIndex<h)&&(h=f.zIndex,l=f)}var p=i.some(function(N){return N.id===l.id});if(p){var c=i.every(function(N,H){return H===0?!0:N.zIndex===i[H-1].zIndex+1});if(c){this.diagram.protectPropertyChange(!1);return}}for(var d=i.length-1;d>=0;d--){E(i[parseInt(d.toString(),10)]),r=i[parseInt(d.toString(),10)].id;var u=this.diagram.nameTable[""+r].zIndex,g=this.diagram.layers.indexOf(this.getObjectLayer(r));this.updateLayerZindexTable(g);for(var v=this.diagram.layers[parseInt(g.toString(),10)].zIndexTable,m=this.diagram.layers[parseInt(g.toString(),10)].objects,y=null,S=0;S<m.length;S++){var f=this.diagram.nameTable[m[parseInt(S.toString(),10)]];(y===null||f.zIndex<y)&&(y=f.zIndex,f.id)}var x=JSON.parse(JSON.stringify(v)),I=0;if(this.diagram.nodes.length!==1&&(this.diagram.nameTable[""+r].children===void 0||this.checkObjectBehind(r,v,u))){var f=this.diagram.nameTable[""+r];if(f.zIndex>y&&f.shape.type!=="SwimLane"){var C=E(f),P=null,A=null;f.children?(P=this.findMaxZIndex(f),A=P-f.zIndex,f.zIndex=y-1-A,this.updateGroupZindex(f,"SendToBack",y)):f.zIndex=y-1,this.triggerOrderCommand(C,f,f)}else f.shape.type==="SwimLane"&&(I=this.swapZIndexObjects(u,v,r,x));if(this.diagram.mode==="SVG"){for(var T=this.diagram.nameTable[""+r],z=T.shape.type!=="SwimLane"?y:I,L=v[parseInt(z.toString(),10)];!L&&z<u;)L=v[++z];L=this.resetTargetNode(r,L,z,v),L&&(L=this.diagram.nameTable[""+L].parentId?this.checkParentExist(L):L,this.moveSvgNode(r,L)),this.updateNativeNodeIndex(r),this.updateLayerZindexTable(g)}else this.diagram.refreshCanvasLayers(),this.updateLayerZindexTable(g)}}var R=E(this.diagram.selectedItems),O={type:"SendToBack",category:"Internal",undoObject:a,redoObject:R};this.diagram.diagramActions&k.UndoRedo||this.addHistoryEntry(O),this.refreshOverviewLayer()}this.diagram.protectPropertyChange(!1)},n.prototype.findMaxZIndex=function(e){var t=this,i=null,r=function(a){for(var s=0;s<a.children.length;s++){var o=t.diagram.nameTable[a.children[parseInt(s.toString(),10)]];(i===null||o.zIndex>i)&&(i=o.zIndex),o.children&&r(o)}};return r(e),i},n.prototype.updateGroupZindex=function(e,t,i){var r=this,a;a===void 0&&(a=e.zIndex+1);var s=function(o){for(var h=0;h<o.children.length;h++){var l=r.diagram.nameTable[o.children[parseInt(h.toString(),10)]];l.children?(l.zIndex=a++,s(l)):l.zIndex=a++}};s(e)},n.prototype.updateLayerZindexTable=function(e){var t=this.diagram.layers[parseInt(e.toString(),10)];t.zIndexTable={};for(var i=0;i<t.objects.length;i++){var r=this.diagram.nameTable[t.objects[parseInt(i.toString(),10)]];t.zIndexTable[r.zIndex]=r.id}},n.prototype.swapZIndexObjects=function(e,t,i,r){for(var a=0,s=0,o=-1,h=1,l=0;l<=e;l++)t[parseInt(l.toString(),10)]&&this.diagram.nameTable[t[parseInt(l.toString(),10)]].parentId===i&&(o===-1&&(o=l),s++);for(var l=0;l<=e;l++)if(t[parseInt(l.toString(),10)]&&h<=s){for(;!t[parseInt(o.toString(),10)];)o++;t[parseInt(l.toString(),10)]=t[parseInt(o.toString(),10)],this.diagram.nameTable[t[parseInt(l.toString(),10)]].zIndex=l,o++,h++}for(var d=0,l=0;l<s;l++){for(;!t[parseInt(d.toString(),10)];)d++;a=this.diagram.nameTable[t[parseInt(d.toString(),10)]].zIndex,d++}for(a=a+1;!t[parseInt(a.toString(),10)];)++a;d=0,t[parseInt(a.toString(),10)]=this.diagram.nameTable[""+i].id,this.diagram.nameTable[""+i].zIndex=a,a=a+1;for(var l=a;l<=e;l++)if(t[parseInt(l.toString(),10)]){for(;!r[parseInt(d.toString(),10)];)d++;t[parseInt(l.toString(),10)]=r[parseInt(d.toString(),10)],this.diagram.nameTable[t[parseInt(l.toString(),10)]].zIndex=l,d++}return a},n.prototype.resetTargetNode=function(e,t,i,r){return this.diagram.nameTable[""+e].shape.type==="SwimLane"&&this.diagram.nameTable[""+t].parentId!==void 0&&this.diagram.nameTable[""+t].parentId!==""&&this.diagram.nameTable[this.diagram.nameTable[""+t].parentId].isLane?(i=i+1,r[parseInt(i.toString(),10)]?(t=r[parseInt(i.toString(),10)],t=this.resetTargetNode(e,t,i,r)):t):t},n.prototype.checkParentExist=function(e){for(var t=e;this.diagram.nameTable[""+t].parentId;)t=this.diagram.nameTable[""+t].parentId;return t},n.prototype.checkObjectBehind=function(e,t,i){return!0},n.prototype.bringToFront=function(e){if(this.diagram.protectPropertyChange(!0),Si(this.diagram)||e){var t=e&&e.id,i=this.diagram.selectedItems,r=[];e&&e.id?r.push(e):(r=r.concat(i.nodes),r=r.concat(i.connectors));var a=E(this.diagram.selectedItems);r=r.slice().sort(function(vi,_i){return vi.zIndex-_i.zIndex});for(var s=this.diagram.layers.indexOf(this.getObjectLayer(r[0].id)),o=this.diagram.layers[parseInt(s.toString(),10)].objects,h=null,l,d=0;d<o.length;d++){var f=this.diagram.nameTable[o[parseInt(d.toString(),10)]];(h===null||f.zIndex>h)&&(h=f.zIndex,l=f)}var p=r.some(function(vi){return vi.id===l.id});if(p){var c=r.every(function(vi,_i){return _i===0?!0:vi.zIndex===r[_i-1].zIndex+1});if(c){this.diagram.protectPropertyChange(!1);return}}for(var d=0;d<r.length;d++){E(r[parseInt(d.toString(),10)]),t=r[parseInt(d.toString(),10)].id;var u=this.diagram.layers.indexOf(this.getObjectLayer(t));this.updateLayerZindexTable(u);for(var g=this.diagram.layers[parseInt(u.toString(),10)].zIndexTable,v=this.diagram.layers[parseInt(u.toString(),10)].objects,m=null,y=0;y<v.length;y++){var S=this.diagram.nameTable[v[parseInt(y.toString(),10)]];(m===null||S.zIndex>m)&&(m=S.zIndex)}for(var x=JSON.parse(JSON.stringify(g)),I=0,C=Number(Object.keys(g).sort(function(_i,xs){return Number(_i)-Number(xs)}).reverse()[0]),P=this.diagram.nameTable[""+t].zIndex,A=[],T=0,z=0;z<=C;z++)A.push(g[parseInt(z.toString(),10)]);var L=this.diagram.nameTable[""+t];if(L.shape.type==="SwimLane"){for(var R=C;R>=P;R--)if(g[parseInt(R.toString(),10)]&&this.diagram.nameTable[g[parseInt(R.toString(),10)]].parentId!==t){T=R,C=T;break}}var O=this.diagram.nameTable[""+t];if(O.zIndex<m&&O.shape.type!=="SwimLane"){var N=E(O),H=null;O.children?(H=this.findMaxZIndex(O),H<m&&(O.zIndex=m+1,this.updateGroupZindex(O,"BringToFront",m))):O.zIndex=m+1,this.triggerOrderCommand(N,O,O)}else if(O.shape.type==="SwimLane"){for(var F=0,Y=-1,et=0,at=0,tt=JSON.parse(JSON.stringify(g)),nt=0;nt<=P;nt++)if(g[parseInt(nt.toString(),10)]&&this.diagram.nameTable[g[parseInt(nt.toString(),10)]].parentId===t&&Y===-1){Y=nt,et=nt;break}for(var wt=0;wt<=C;wt++)if(x[parseInt(wt.toString(),10)]&&x[parseInt(wt.toString(),10)]!==t&&this.diagram.nameTable[x[parseInt(wt.toString(),10)]].parentId!==t){var $=this.diagram.nameTable[x[parseInt(wt.toString(),10)]],pt=this.diagram.nameTable[""+t];$.zIndex>=pt.zIndex&&F++}for(var rt=Y,mt=0;mt<=F;mt++){for(;!g[parseInt(rt.toString(),10)];)rt++;at=this.diagram.nameTable[g[parseInt(rt.toString(),10)]].zIndex,rt++}for(var ct=at;ct<=C;ct++){for(;!tt[parseInt(Y.toString(),10)];)Y++;for(;!g[parseInt(ct.toString(),10)];)ct++;g[parseInt(ct.toString(),10)]=tt[parseInt(Y.toString(),10)],this.diagram.nameTable[g[parseInt(ct.toString(),10)]].zIndex=ct,Y++}g[parseInt(C.toString(),10)]=this.diagram.nameTable[""+t].id,this.diagram.nameTable[""+t].zIndex=C,rt=P+1;for(var Dt=et,Ge=0;Ge<F;Ge++){for(;!x[parseInt(rt.toString(),10)];)rt++;for(;this.diagram.nameTable[x[parseInt(rt.toString(),10)]].parentId===t;)rt++;for(;!g[parseInt(Dt.toString(),10)];)Dt++;g[parseInt(Dt.toString(),10)]=x[parseInt(rt.toString(),10)],this.diagram.nameTable[g[parseInt(Dt.toString(),10)]].zIndex=Dt,rt++,Dt++}}if(this.diagram.mode==="SVG"){var Ce=this.diagram.nameTable[""+t],ie=Ce.shape.type!=="SwimLane"?m:I,Oe=g[parseInt(ie.toString(),10)];Oe=this.resetTargetNode(t,Oe,ie,g),Oe&&(Oe=this.diagram.nameTable[""+Oe].parentId?this.checkParentExist(Oe):Oe,this.moveAfterSvgNode(t,Oe));var ni=this.diagram.diagramLayer,Ft=St(t+"_groupElement",this.diagram.element.id),ge=this.diagram.selectedItems.nodes;if(ge.length>0&&(ge[0].shape.type==="Native"||ge[0].shape.type==="HTML")){Ft.parentNode.removeChild(Ft);for(var Dt=0;Dt<this.diagram.views.length;Dt++){Ft=St(t+(ge[0].shape.type==="HTML"?"_html_element":"_content_groupElement"),this.diagram.views[parseInt(Dt.toString(),10)]);var Ze=Ft.parentNode.lastChild;Ze.parentNode.insertBefore(Ft,Ze.nextSibling)}var gi=ti(this.diagram.element.id);this.diagram.diagramRenderer.renderElement(this.diagram.nameTable[""+t].wrapper,ni,gi)}this.updateLayerZindexTable(u)}else this.diagram.refreshCanvasLayers(),this.updateLayerZindexTable(u)}var Ji=E(this.diagram.selectedItems),Ar={type:"BringToFront",category:"Internal",undoObject:a,redoObject:Ji};this.diagram.diagramActions&k.UndoRedo||this.addHistoryEntry(Ar),this.refreshOverviewLayer()}this.diagram.protectPropertyChange(!1)},n.prototype.triggerOrderCommand=function(e,t,i){var r=E(e),a={zIndex:r.zIndex},s={zIndex:t.zIndex},o={element:i,cause:this.diagram.diagramActions,diagramAction:this.diagram.getDiagramAction(this.diagram.diagramActions),oldValue:a,newValue:s};this.diagram.triggerEvent(Z.propertyChange,o)},n.prototype.checkGroupNode=function(e,t,i){return i[""+t].parentId===i[""+e].parentId},n.prototype.sortByZIndex=function(e,t,i){if(i==="BringForward"){var r=t||"zIndex";e=e.sort(function(s,o){return o[""+r]-s[""+r]})}else{var a=t||"zIndex";e=e.sort(function(s,o){return s[""+a]-o[""+a]})}return e},n.prototype.refreshOverviewLayer=function(){for(var e=0,t=this.diagram.views;e<t.length;e++){var i=t[e],r=this.diagram.views[""+i],a=ti(r.element.id);r instanceof Xe||this.diagram.renderDiagramElements(r.diagramLayer,r.diagramRenderer,a,void 0,void 0,void 0)}},n.prototype.orderCommands=function(e,t,i){var r=this,a=t.nodes;a=a.concat(t.connectors);for(var s=this.diagram.layers.indexOf(this.getObjectLayer(a[0].id)),o=this.diagram.layers[parseInt(s.toString(),10)].objects,h=null,l,d=0;d<o.length;d++){var f=this.diagram.nameTable[o[parseInt(d.toString(),10)]];(h===null||f.zIndex<h)&&(h=f.zIndex,l=f)}for(var p=a.some(function($){return $.id===l.id}),c=null,u,g=0;g<o.length;g++){var f=this.diagram.nameTable[o[parseInt(g.toString(),10)]];(c===null||f.zIndex>c)&&(c=f.zIndex,u=f)}var v=a.some(function($){return $.id===u.id});if(e){var m=t.selectedObjects;if(m=m.slice().sort(function($,pt){return $.zIndex-pt.zIndex}),i==="SendBackward")for(var d=0;d<m.length;d++)this.sendBackward(m[parseInt(d.toString(),10)]);else if(i==="SendForward")for(var d=m.length-1;d>=0;d--)this.sendForward(m[parseInt(d.toString(),10)]);else if(i==="BringToFront"){if(!v)for(var d=0;d<m.length;d++)this.bringToFront(m[parseInt(d.toString(),10)])}else if(i==="SendToBack"&&!p)for(var d=m.length-1;d>=0;d--)this.sendToBack(m[parseInt(d.toString(),10)])}else{var y=a[0],S=this.getObjectLayer(y.id),x=S.zIndex,I=S.zIndexTable,C=void 0;if(i==="SendBackward"||i==="SendToBack"){a=a.slice().sort(function($,pt){return $.zIndex-pt.zIndex});for(var d=0;d<a.length;d++){var P=a[parseInt(d.toString(),10)],A=this.diagram.nameTable[a[parseInt(d.toString(),10)].id];if(A.zIndex=P.zIndex,this.diagram.layers[parseInt(x.toString(),10)].zIndexTable[P.zIndex]=P.id,C=P.id,i==="SendToBack"&&(a[0].shape.type==="SwimLane"&&this.bringToFront(a[0]),A.children&&this.updateGroupZindex(A,"",null),this.updateLayerZindexTable(S.zIndex)),this.diagram.mode==="SVG"){for(var T=this.diagram.nameTable[""+C],z=T.zIndex,L=this.diagram.layers.indexOf(this.getObjectLayer(C)),R=this.diagram.layers[parseInt(L.toString(),10)].objects,O=null,N=function(rt){var mt=H.diagram.nameTable[R[parseInt(rt.toString(),10)]];if(mt.isHeader||mt.isLane||mt.isPhase)return"continue";var ct=!0;t.selectedObjects.forEach(function(Dt){ct=r.notChildOfSelectedNode(mt,Dt)}),ct&&mt.zIndex<z&&(O===null||mt.zIndex>O)&&(t.selectedObjects[0].shape.type===mt.shape.type||t.selectedObjects[0].shape.type!=="Native"&&mt.shape.type!=="Native"&&t.selectedObjects[0].shape.type!=="HTML"&&mt.shape.type!=="HTML")&&(O=mt.zIndex)},H=this,F=0;F<R.length;F++)N(F);var f=this.diagram.nameTable[""+C],Y=O,et=void 0;V(Y)||(et=I[parseInt(Y.toString(),10)]),et&&(et=this.diagram.nameTable[""+et].parentId?this.checkParentExist(et):et,i==="SendBackward"?T.parentId===""&&this.moveAfterSvgNode(C,et):i==="SendToBack"&&a[0].shape.type!=="SwimLane"&&this.moveAfterSvgNode(C,et)),this.refreshOverviewLayer()}else this.diagram.refreshCanvasLayers()}}else if(i==="SendForward"||i==="BringToFront"){a=a.slice().sort(function($,pt){return $.zIndex-pt.zIndex});for(var d=0;d<a.length;d++){var P=a[parseInt(d.toString(),10)],A=this.diagram.nameTable[a[parseInt(d.toString(),10)].id];if(A.zIndex=P.zIndex,this.diagram.layers[parseInt(x.toString(),10)].zIndexTable[P.zIndex]=P.id,C=P.id,i==="BringToFront"&&(a[0].shape.type==="SwimLane"&&this.sendToBack(a[0]),A.children&&this.updateGroupZindex(A,"",null),this.updateLayerZindexTable(S.zIndex)),this.diagram.mode==="SVG"){for(var T=this.diagram.nameTable[""+C],z=T.zIndex,L=this.diagram.layers.indexOf(this.getObjectLayer(C)),R=this.diagram.layers[parseInt(L.toString(),10)].objects,at=null,tt=function(ni){var Ft=nt.diagram.nameTable[R[parseInt(ni.toString(),10)]];if(Ft.isHeader||Ft.isLane||Ft.isPhase)return"continue";var ge=!0;t.selectedObjects.forEach(function(gi){ge=r.notChildOfSelectedNode(Ft,gi)});var Ze=t.selectedObjects.some(function(gi){return gi.id===Ft.id});!Ze&&ge&&Ft.zIndex>z&&(at===null||Ft.zIndex<at)&&(t.selectedObjects[0].shape.type===Ft.shape.type||t.selectedObjects[0].shape.type!=="Native"&&Ft.shape.type!=="Native"&&t.selectedObjects[0].shape.type!=="HTML"&&Ft.shape.type!=="HTML")&&(at=Ft.zIndex)},nt=this,wt=R.length-1;wt>=0;wt--)tt(wt);var f=this.diagram.nameTable[""+C],Y=at,et=void 0;V(Y)||(et=I[parseInt(Y.toString(),10)]),et&&(et=this.diagram.nameTable[""+et].parentId?this.checkParentExist(et):et,i==="SendForward"?T.parentId===""&&this.moveSvgNode(C,et):i==="BringToFront"&&a[0].shape.type!=="SwimLane"&&this.moveSvgNode(C,et)),this.refreshOverviewLayer()}else this.diagram.refreshCanvasLayers()}}}},n.prototype.sendForward=function(e){var t=this;if(this.diagram.protectPropertyChange(!0),Si(this.diagram)||e){var i=this.diagram.selectedItems,r=[];e&&e.id?r.push(e):(r=r.concat(i.nodes),r=r.concat(i.connectors)),this.sortByZIndex(r);var a=e&&e.id,s=E(this.diagram.selectedItems);this.diagram.startGroupAction();for(var o=[],h=function(c){E(r[parseInt(c.toString(),10)]),a=r[parseInt(c.toString(),10)].id;var u=l.diagram.layers.indexOf(l.getObjectLayer(a)),g=E(l.diagram.nameTable),v=l.diagram.layers[parseInt(u.toString(),10)].zIndexTable,m=l.diagram.nameTable[""+a],y=[],S=l.diagram.spatialSearch.findObjects(m.wrapper.bounds);S.length>2&&(S=l.sortByZIndex(S,void 0,"BringForward"));for(var x=function($){if(m.id!==$.id){var pt=l.getObjectLayer($.id).zIndex,rt=l.diagram.selectedItems.selectedObjects.some(function(mt){return mt.id===$.id});(l.diagram.selectedItems.selectedObjects.length===1||!rt)&&u===pt&&Number(l.diagram.nameTable[""+a].zIndex)<Number($.zIndex)&&$.parentId===""&&m.wrapper.bounds.intersects($.wrapper.bounds)&&(m.shape.type===$.shape.type||m.shape.type!=="Native"&&m.shape.type!=="HTML"&&$.shape.type!=="Native"&&$.shape.type!=="HTML")&&y.push($)}},I=0,C=S;I<C.length;I++){var P=C[I];x(P)}for(var P=y.length-1;P>=0;P--){var A=l.diagram.nameTable[y[parseInt(P.toString(),10)].id];A.parentId===a&&y.splice(P,1)}if(y.length>0){var T=l.diagram.nameTable[y[y.length-1].id];if(T.parentId){var z="",L=Qn(T,l.diagram,z),R=l.diagram.nameTable[""+L];R.id!==a&&(y[0]=R)}for(var O={},P=0;P<l.diagram.nodes.length;P++){var N=l.diagram.nodes[parseInt(P.toString(),10)];O[N.id]=N.zIndex}for(var H=0;H<l.diagram.connectors.length;H++){var F=l.diagram.connectors[parseInt(H.toString(),10)];O[F.id]=F.zIndex}var Y=y[0].zIndex;v[parseInt(Y.toString(),10)];var et={};y.forEach(function($){et[$.id]=$.zIndex});var at=[];if(m){var tt=m.zIndex;Object.keys(et).length>0&&(Object.values(et).forEach(function($){$>=tt&&at.push($)}),at.length!==0&&l.updateZIndexBySendForward(m,at,u))}var nt=[];if(Object.keys(l.changedNodeZIndexes).forEach(function($){var pt=g[""+$]?g[""+$].zIndex:null,rt=t.changedNodeZIndexes[""+$];if(pt!==rt){var mt=E(g[""+$]);nt.push(mt)}}),l.updateLayerZindexTable(u),nt.forEach(function($){if(!s.nodes.some(function(rt){return rt.id===$.id})){var pt=E($);s.nodes.push(pt)}}),l.diagram.mode==="SVG"){var wt=y[y.length-1].id;l.moveAfterSvgNode(a,wt),l.updateNativeNodeIndex(wt,a)}else l.diagram.refreshCanvasLayers();Object.keys(l.changedNodeZIndexes).forEach(function($){var pt=g[""+$]?g[""+$].zIndex:null,rt=t.changedNodeZIndexes[""+$];if(pt!==rt){var mt=E(t.diagram.nameTable[""+$]);o.push(mt)}})}},l=this,d=r.length-1;d>=0;d--)h(d);var f=E(this.diagram.selectedItems);o.forEach(function(c){if(!f.nodes.some(function(g){return g.id===c.id})){var u=E(c);f.nodes.push(u)}});var p={type:"SendForward",category:"Internal",undoObject:s,redoObject:f};!(this.diagram.diagramActions&k.UndoRedo)&&o.length>0&&this.addHistoryEntry(p),this.diagram.endGroupAction(),o.length>0&&this.refreshOverviewLayer()}this.diagram.protectPropertyChange(!1)},n.prototype.updateZIndexBySendForward=function(e,t,i){var r=E(e),a=Math.min.apply(Math,t),s=this.diagram.layers[parseInt(i.toString(),10)].zIndexTable[parseInt(a.toString(),10)];this.diagram.nameTable[""+s].children&&(a=this.findGreatestChildZIndex(this.diagram.nameTable[""+s]));var o,h=this.diagram.layers[parseInt(i.toString(),10)].objects,l=this.diagram.nodes.filter(function(y){return h.indexOf(y.id)!==-1}),d=this.diagram.connectors.filter(function(y){return h.indexOf(y.id)!==-1});d.forEach(function(y){l.push(y)});var f=l.filter(function(y){return y.zIndex===a&&y.id!==e.id});e.children?(e.zIndex=a+1,this.updateGroupZindex(e,"BringForward",e.zIndex),o=this.findGreatestChildZIndex(e)):(e.zIndex=a+1,o=e.zIndex),this.triggerOrderCommand(r,e,e);for(var p=l.slice().sort(function(y,S){return y.zIndex-S.zIndex}),c=!0,u=0;u<p.length;u++){var g=p[parseInt(u.toString(),10)];if(e.children&&(c=this.notChildOfSelectedNode(g,e)),g.zIndex>a&&g!==e&&g.parentId!==e.id&&c&&f&&f.length>0&&g.parentId!==f[0].id){var v=E(g);if(g.zIndex<=o+1)g.zIndex=o+1,o++,this.triggerOrderCommand(v,g,g);else break}var m=g.zIndex;this.changedNodeZIndexes.hasOwnProperty(g.id)?this.changedNodeZIndexes[g.id]=m:this.changedNodeZIndexes[g.id]=m}},n.prototype.findGreatestChildZIndex=function(e){var t=this,i=e.zIndex,r=function(a){for(var s=0;s<a.children.length;s++){var o=t.diagram.nameTable[a.children[parseInt(s.toString(),10)]];o.children?r(o):o.zIndex>i&&(i=o.zIndex)}};return r(e),i},n.prototype.notChildOfSelectedNode=function(e,t){var i=this,r=!0,a=function(s,o){for(var h=0;h<o.children.length;h++){var l=i.diagram.nameTable[o.children[parseInt(h.toString(),10)]];if(l.id===s.id)return r=!1,r;l.children&&a(s,l)}return r};return t.children&&a(e,t),r},n.prototype.sendBackward=function(e){var t=this;if(this.diagram.protectPropertyChange(!0),Si(this.diagram)||e){var i=this.diagram.selectedItems,r=[];e&&e.id?r.push(e):(r=r.concat(i.nodes),r=r.concat(i.connectors)),this.sortByZIndex(r);var a=e&&e.id,s=E(this.diagram.selectedItems);this.diagram.startGroupAction();for(var o=[],h=function(c){E(r[parseInt(c.toString(),10)]),a=r[parseInt(c.toString(),10)].id;var u=l.diagram.layers.indexOf(l.getObjectLayer(a)),g=E(l.diagram.nameTable),v=l.diagram.layers[parseInt(u.toString(),10)].zIndexTable,m=l.diagram.nameTable[""+a],y=[],S=l.diagram.spatialSearch.findObjects(m.wrapper.bounds);S.length>2&&(S=l.sortByZIndex(S));for(var x=function(pt){if(m.id!==pt.id){var rt=l.getObjectLayer(pt.id).zIndex,mt=l.diagram.selectedItems.selectedObjects.some(function(ct){return ct.id===pt.id});(l.diagram.selectedItems.selectedObjects.length===1||!mt)&&u===rt&&Number(l.diagram.nameTable[""+a].zIndex)>Number(pt.zIndex)&&pt.parentId===""&&m.wrapper.bounds.intersects(pt.wrapper.bounds)&&(m.shape.type===pt.shape.type||m.shape.type!=="Native"&&m.shape.type!=="HTML"&&pt.shape.type!=="Native"&&pt.shape.type!=="HTML")&&y.push(pt)}},I=0,C=S;I<C.length;I++){var P=C[I];x(P)}for(var P=y.length-1;P>=0;P--){var A=l.diagram.nameTable[y[parseInt(P.toString(),10)].id];A.parentId===a&&y.splice(P,1)}if(y.length>0){var A=l.diagram.nameTable[y[y.length-1].id];if(A.parentId){var T="",z=Qn(A,l.diagram,T),L=l.diagram.nameTable[""+z];a!==L.id&&(y[y.length-1]=L)}for(var R={},P=0;P<l.diagram.nodes.length;P++){var O=l.diagram.nodes[parseInt(P.toString(),10)];R[O.id]=O.zIndex}for(var N=0;N<l.diagram.connectors.length;N++){var H=l.diagram.connectors[parseInt(N.toString(),10)];R[H.id]=H.zIndex}var F=y[y.length-1].zIndex;v[parseInt(F.toString(),10)];var Y={};y.forEach(function(rt){Y[rt.id]=rt.zIndex});var et=[];if(m){var at=m.zIndex;Object.keys(Y).length>0&&(Object.values(Y).forEach(function(rt){rt<=at&&et.push(rt)}),et.length!==0&&l.updateZIndexBySendBackward(m,et,u))}var tt=[];if(Object.keys(l.changedNodeZIndexes).forEach(function(rt){var mt=g[""+rt]?g[""+rt].zIndex:null,ct=t.changedNodeZIndexes[""+rt];if(mt!==ct){var Dt=E(g[""+rt]);tt.push(Dt)}}),l.updateLayerZindexTable(u),tt.forEach(function(rt){if(!s.nodes.some(function(ct){return ct.id===rt.id})){var mt=E(rt);s.nodes.push(mt)}}),l.diagram.mode==="SVG"){var nt=y[y.length-1].id,wt=y[y.length-1];wt&&!(wt.shape.type==="HTML"||wt.shape.type==="Native")&&l.moveSvgNode(a,nt);var $=l.diagram.nameTable[""+nt];$.children&&$.children.length>0?l.updateNativeNodeIndex(a):l.updateNativeNodeIndex(a,nt)}else l.diagram.refreshCanvasLayers();Object.keys(l.changedNodeZIndexes).forEach(function(rt){var mt=g[""+rt]?g[""+rt].zIndex:null,ct=t.changedNodeZIndexes[""+rt];if(mt!==ct){var Dt=E(t.diagram.nameTable[""+rt]);o.push(Dt)}})}},l=this,d=0;d<r.length;d++)h(d);var f=E(this.diagram.selectedItems);o.forEach(function(c){if(!f.nodes.some(function(g){return g.id===c.id})){var u=E(c);f.nodes.push(u)}});var p={type:"SendBackward",category:"Internal",undoObject:s,redoObject:f};!(this.diagram.diagramActions&k.UndoRedo)&&o.length>0&&this.addHistoryEntry(p),this.diagram.endGroupAction(),o.length>0&&this.refreshOverviewLayer()}this.diagram.protectPropertyChange(!1)},n.prototype.updateZIndexBySendBackward=function(e,t,i){var r=E(e),a=Math.max.apply(Math,t),s=this.diagram.layers[parseInt(i.toString(),10)].objects,o=this.diagram.nodes.filter(function(S){return s.indexOf(S.id)!==-1}),h=this.diagram.connectors.filter(function(S){return s.indexOf(S.id)!==-1});h.forEach(function(S){o.push(S)});var l=o.filter(function(S){return S.zIndex===a&&S.id!==e.id}),d,f,p;e.children?(d=this.findMaxZIndex(e),f=d-e.zIndex,e.zIndex=a-1-f,this.updateGroupZindex(e,"SendBackward",e.zIndex),p=this.findLowestChildZIndex(e)):(e.zIndex=a-1,p=e.zIndex),this.triggerOrderCommand(r,e,e);for(var c=o.slice().sort(function(S,x){return x.zIndex-S.zIndex}),u=!0,g=0;g<c.length;g++){var v=c[parseInt(g.toString(),10)];if(e.children&&(u=this.notChildOfSelectedNode(v,e)),v.zIndex<a&&v!==e&&v.parentId!==e.id&&u&&l&&l.length>0&&v.parentId!==l[0].id){var m=E(v);if(v.zIndex>=p-1)v.zIndex=p-1,p--,this.triggerOrderCommand(m,v,v);else break}var y=v.zIndex;this.changedNodeZIndexes.hasOwnProperty(v.id)?this.changedNodeZIndexes[""+v.id]=y:this.changedNodeZIndexes[""+v.id]=y}},n.prototype.findLowestChildZIndex=function(e){for(var t=e.zIndex,i=0;i<e.children.length;i++){var r=this.diagram.nameTable[e.children[parseInt(i.toString(),10)]];r.zIndex<t&&(t=r.zIndex)}return t},n.prototype.updateNativeNodeIndex=function(e,t){var i=this.diagram.selectedItems.nodes[0]||this.diagram.getObject(t);if(i&&(i.shape.type==="HTML"||i.shape.type==="Native"))for(var r=0;r<this.diagram.views.length;r++){var a=i.shape.type==="HTML"?"_html_element":"_content_groupElement",s=St(e+a,this.diagram.views[parseInt(r.toString(),10)]),o=t?St(t+a,this.diagram.views[parseInt(r.toString(),10)]):s.parentElement.firstChild;s&&o&&s.parentNode.id===o.parentNode.id&&o.parentNode.insertBefore(s,o)}else if(t){var h=this.diagram.nameTable[""+t];if(h&&(h.shape.type==="HTML"||h.shape.type==="Native")){var o=St(t+"_groupElement",this.diagram.element.id),s=St(e+"_groupElement",this.diagram.element.id);s&&o&&o.parentNode.insertBefore(s,o)}}},n.prototype.initSelectorWrapper=function(){var e=this.diagram.selectedItems;e.init(this.diagram),e.nodes.length===1&&e.connectors.length===0&&(e.rotateAngle=e.nodes[0].rotateAngle,e.wrapper.rotateAngle=e.nodes[0].rotateAngle,e.wrapper.pivot=e.nodes[0].pivot)},n.prototype.doRubberBandSelection=function(e){this.clearSelectionRectangle();var t=[],i=[];t=this.diagram.getNodesConnectors(t),this.diagram.selectedItems.rubberBandSelectionMode==="CompleteIntersect"?i=n0(e,t):i=this.diagram.spatialSearch.findObjects(e),i.length&&this.selectObjects(i,!0)},n.prototype.clearSelectionRectangle=function(){var e=Vi(this.diagram.element.id),t=e.getElementById(this.diagram.element.id+"_diagramAdorner_selected_region");t&&sn(t)},n.prototype.dragConnectorEnds=function(e,t,i,r,a,s){var o,h,l,d,f=!1;return t instanceof It?(o=t,h=o.connectors[0]):t instanceof B&&this.diagram.currentDrawingObject&&(this.clearSelection(),h=this.diagram.currentDrawingObject),h&&h instanceof B?((e==="BezierSourceThumb"||e==="BezierTargetThumb")&&(f=!0,h.isBezierEditing=!0),e==="ConnectorSourceEnd"||e==="BezierSourceThumb"?(l=i.x-(f?r.bezierPoint1.x:h.sourcePoint.x),d=i.y-(f?r.bezierPoint1.y:h.sourcePoint.y),this.dragSourceEnd(h,l,d,null,i,e,void 0,a,s,void 0,r)):(l=i.x-(f?r.bezierPoint2.x:h.targetPoint.x),d=i.y-(f?r.bezierPoint2.y:h.targetPoint.y),this.dragTargetEnd(h,l,d,null,i,e,void 0,r))):!0},n.prototype.getSelectedObject=function(){var e=this.diagram.selectedItems;return e.annotation?[e.annotation]:e.nodes.concat(e.connectors)},n.prototype.enableCloneObject=function(e){},n.prototype.getBlazorOldValues=function(e,t){},n.prototype.clearObjectSelection=function(e){var t=this.diagram.selectedItems,i=[];i=i.concat(t.nodes,t.connectors),i.indexOf(e)===-1&&(this.clearSelection(i.length>0),this.selectObjects([e],!0))},n.prototype.clearSelection=function(e,t){return qs(this,void 0,void 0,function(){var i,r,a,s;return Qs(this,function(o){return i=this.diagram.allowServerDataBinding,this.diagram.enableServerDataBinding(!1),Si(this.diagram)&&(r=this.diagram.selectedItems,a=this.getSelectedObject(),this.diagram.currentSymbol&&(this.diagram.previousSelectedObject=a),s={oldValue:a,newValue:[],cause:this.diagram.diagramActions,state:"Changing",type:"Removal",cancel:!1},e&&this.diagram.triggerEvent(Z.selectionChange,s),s.cancel||(r.offsetX=0,r.offsetY=0,r.width=0,r.height=0,r.rotateAngle=0,r.nodes=[],r.connectors=[],r.wrapper=null,r.annotation=void 0,r.selectedObjects=[],this.diagram.clearSelectorLayer(),e&&(s={oldValue:a,newValue:[],cause:this.diagram.diagramActions,state:"Changed",type:"Removal",cancel:!1},this.diagram.triggerEvent(Z.selectionChange,s))),this.diagram.enableServerDataBinding(i)),[2]})})},n.prototype.clearSelectedItems=function(){var e=this.diagram.selectedItems.nodes?this.diagram.selectedItems.nodes.length:0,t=this.diagram.selectedItems.connectors?this.diagram.selectedItems.connectors.length:0;this.clearSelection(e+t>0)},n.prototype.removeStackHighlighter=function(){var e=Vi(this.diagram.element.id),t=e.getElementById(e.id+"_stack_highlighter");t&&t.parentNode.removeChild(t)},n.prototype.renderStackHighlighter=function(e,t){var i=this.diagram.selectedItems.nodes[0],r,a,s;if(!t){var o=this.diagram.findObjectsUnderMouse(e.position);if(t=this.diagram.findObjectUnderMouse(o,"Drag",!0),t&&!(t.isLane||t.isPhase||t.isHeader))for(var h=0;h<o.length;h++){var l=this.diagram.nameTable[o[parseInt(h.toString(),10)].id];(!l.isLane||l.isPhase||l.isHeader)&&(t=l,this.diagram.parentObject=t)}}if(i&&t&&t.isLane&&i.shape&&!i.shape.isPhase&&(a=this.diagram.nameTable[t.parentId],this.diagram.currentSymbol&&a.shape.type==="SwimLane"&&(r=!0),i&&!i.parentId&&i.shape.type!=="SwimLane"||i&&i.parentId&&this.diagram.nameTable[i.parentId]&&this.diagram.nameTable[i.parentId].isLane&&i.parentId!==t.parentId&&i.parentId!==t.id)){s=this.diagram.selectedItems;var d=Us(this.diagram,s,t.id,!0);this.diagram.renderSelector(!1,!0,d),s.wrapper.children[0]=s.nodes[0].wrapper}if(i&&t&&t.parentId&&i.shape&&i.shape.isPhase){var f=this.diagram.nameTable[t.parentId];if(f.shape.type==="SwimLane"){var d=this.diagram.nameTable[t.parentId].wrapper;this.diagram.renderSelector(!1,!0,d)}}if(r&&this.diagram.currentSymbol.shape.isLane||i&&t&&i.parentId&&t.parentId&&!i.isPhase&&i.parentId===t.parentId&&i.id!==t.id&&a&&a.container&&(a.container.type==="Stack"||a.container.type==="Grid")){var d=void 0,p=a.container.orientation==="Vertical",c=a.container==="Stack"?p:!p;a.container.type==="Grid"&&t.isLane&&(a.shape.orientation==="Horizontal"&&t.rowIndex!==i.rowIndex||a.shape.orientation==="Vertical"&&t.columnIndex!==i.columnIndex||this.diagram.currentSymbol&&this.diagram.currentSymbol.shape.orientation===a.container.orientation)&&(s=this.diagram.selectedItems,(i.isLane&&go(i,this.diagram)||!i.isLane)&&(d=Us(this.diagram,s,t.id,r)));var u=a.container.type==="Stack"?t.wrapper:d;u&&Qd(u,c,e.position,this.diagram,!1,!0)}},n.prototype.insertBlazorConnector=function(e){if(e instanceof It)for(var t=0;t<e.connectors.length;t++)this.diagram.insertBlazorConnector(e.connectors[parseInt(t.toString(),10)]);else this.diagram.insertBlazorConnector(e)},n.prototype.drag=function(e,t,i){var r,a=[];if(!this.diagram.rotateUsingButton&&e.shape&&e.shape.type!=="SwimLane"&&(this.diagram.eventHandler.currentAction="Drag"),Qe(e)&&this.checkBoundaryConstraints(t,i,e.wrapper.bounds)&&yn(this.diagram))if(e instanceof M){var s={offsetX:e.offsetX,offsetY:e.offsetY};if(e.offsetX+=t,e.offsetY+=i,e.children&&!e.container){ne(this.diagram,e,!0)||(this.diagram.diagramActions=this.diagram.diagramActions|k.isGroupDragging);for(var o=this.getAllDescendants(e,a),h=0;h<o.length;h++)r=this.diagram.nameTable[o[parseInt(h.toString(),10)].id],this.drag(r,t,i);this.updateInnerParentProperties(e),this.diagram.diagramActions=this.diagram.diagramActions&~k.isGroupDragging}if(ne(this.diagram,e,!0)?Mn(this.diagram,e):(e&&e.shape&&e.shape.type==="UmlClassifier"&&(e.wrapper.measureChildren=!0),this.diagram.nodePropertyChange(e,s,{offsetX:e.offsetX,offsetY:e.offsetY},void 0,void 0,!1),e.wrapper.measureChildren=!1),e.shape.type==="SwimLane"&&!this.diagram.currentSymbol){var l=e.wrapper.children[0],d=sr(this.diagram,l);Pr(d,this.diagram)}}else{var f=e,p=E(e),s={sourcePoint:p.sourcePoint,targetPoint:p.targetPoint},c=f.type==="Bezier",u=!1;f.sourceWrapper?u=!0:this.dragSourceEnd(f,t,i,!0,null,"",c),f.targetWrapper?u=!0:this.dragTargetEnd(f,t,i,!0,null,"",c);var g=!1;if(e instanceof B&&(g=!0),!u||g){this.dragControlPoint(f,t,i,!0);var v={sourcePoint:f.sourcePoint,targetPoint:f.targetPoint};this.diagram.connectorPropertyChange(f,s,v)}}for(var m=0,y=this.diagram.views;m<y.length;m++){var S=y[m],x=this.diagram.views[S];x instanceof mr&&this.diagram.refreshCanvasDiagramLayer(x)}},n.prototype.connectorSegmentChange=function(e,t,i){var r,a,s=!0;if(t.equals(t,e.wrapper.bounds)===!1&&e.outEdges.length>0)for(var o=0;o<e.outEdges.length;o++){var h=this.diagram.nameTable[e.outEdges[parseInt(o.toString(),10)]];if(h.targetID!==""?s=!this.isSelected(this.diagram.nameTable[h.targetID]):s=!this.isSelected(this.diagram.nameTable[h.id]),h.type==="Orthogonal"&&h.segments&&h.segments.length>1){if(i){if(!this.isSelected(this.diagram.nameTable[h.id])){var l=h.segments[0],d=h.segments[1],f=Wa(e.wrapper,e.wrapper.corners,e.wrapper.bounds),p=Fi(f,l.direction);p=Ei(h,h.sourceWrapper,p,{x:h.sourceWrapper.offsetX,y:h.sourceWrapper.offsetY},!1);var c={corners:void 0,point:p,margin:void 0,direction:l.direction},u={corners:void 0,point:d.points[1],margin:void 0,direction:void 0},g=Gi(c,u);l.length=b.distancePoints(g[0],g[1]),d.direction&&d.length&&(d.length=b.distancePoints(g[1],g[2]))}}else if(s){switch(h.segments[0].direction){case"Bottom":r=e.wrapper.bounds.bottomCenter.x-t.bottomCenter.x,a=e.wrapper.bounds.bottomCenter.y-t.bottomCenter.y;break;case"Top":r=e.wrapper.bounds.topCenter.x-t.topCenter.x,a=e.wrapper.bounds.topCenter.y-t.topCenter.y;break;case"Left":r=e.wrapper.bounds.middleLeft.x-t.middleLeft.x,a=e.wrapper.bounds.middleLeft.y-t.middleLeft.y;break;case"Right":r=e.wrapper.bounds.middleRight.x-t.middleRight.x,a=e.wrapper.bounds.middleRight.y-t.middleRight.y;break}this.dragSourceEnd(h,r,a,!0,null,"ConnectorSourceEnd",void 0,void 0,void 0,!(e.parentId&&this.diagram.diagramActions&k.isGroupDragging))}}}},n.prototype.updateEndPoint=function(e,t){e.sourcePoint,e.targetPoint,e.sourceID&&e.sourceID,e.targetID&&e.targetID,e.sourcePortID&&e.sourcePortID,e.targetPortID&&e.targetPortID,e.segments&&e.segments;var i={sourcePoint:e.sourcePoint,targetPoint:e.targetPoint};e.sourceID&&(i.sourceID=e.sourceID),e.targetID&&(i.targetID=e.targetID),e.sourcePortID&&(i.sourcePortID=e.sourcePortID),e.targetPortID&&(i.targetPortID=e.targetPortID),e.segments&&(i.segments=e.segments),this.diagram.connectorPropertyChange(e,t||{},i),this.diagram.updateSelector()},n.prototype.dragSourceEnd=function(e,t,i,r,a,s,o,h,l,d,f){var p=this.diagram.nameTable[e.id],c={},u=this.checkBoundaryConstraints(t,i,p.wrapper.bounds);if(Ya(p)&&u&&s!=="BezierSourceThumb"&&yn(this.diagram)){if(c={sourcePoint:p.sourcePoint},c=E(c),this.diagram.constraints&lt.RestrictNegativeAxisDragDrop){var g=p.sourcePoint.x+t,v=p.sourcePoint.y+i;p.sourcePoint.x=g<0?0:g,p.sourcePoint.y=v<0?0:v}else p.sourcePoint.x+=t,p.sourcePoint.y+=i;s==="ConnectorSourceEnd"&&p.type==="Orthogonal"&&this.changeSegmentLength(p,h,l,d),p.shape.type==="Bpmn"&&p.shape.sequence==="Default"&&p.shape.flow==="Sequence"&&this.updatePathElementOffset(p)}if(p.type==="Bezier")if(c={sourcePoint:p.sourcePoint},f)this.translateBezierPoints(e,s===""?"ConnectorSourceEnd":s,t,i,f,a,!o);else for(var m=0;m<e.segments.length;m++)this.translateBezierPoints(e,s===""?"ConnectorSourceEnd":s,t,i,e.segments[parseInt(m.toString(),10)],a,!o);return r||this.updateEndPoint(p,c),this.diagram.realActions&Vt.AnimationClick||this.diagram.refreshCanvasLayers(),u},n.prototype.updatePathElementOffset=function(e){e.wrapper.children.splice(3,1);var t=new Pt,i=e.intermediatePoints;t=cf(i,e),e.wrapper.children.splice(3,0,t)},n.prototype.getDirection=function(e,t){var i;return e==="Right"||e==="Left"?i=t.points[0].x<t.points[1].x?"Right":"Left":(e==="Top"||e==="Bottom")&&(i=t.points[0].y<t.points[1].y?"Bottom":"Top"),i},n.prototype.changeSegmentLength=function(e,t,i,r){var a=t?this.canConnect(e,t):!0;if(e.segments&&e.segments[0].direction&&(!t&&e.sourceID===""||r)&&a){var s=e.segments[0];if(s.direction!==this.getDirection(s.direction,s)&&(e.segments.splice(0,1),e.segments[0].direction===null))return;var o=e.segments[0],h=e.segments[1],l=this.diagram.nameTable[e.sourceID],d=void 0;o.points[0]=e.sourcePoint,o.direction==="Top"||o.direction==="Bottom"?(o.points[o.points.length-1].x=e.sourcePoint.x,h.points[0].y=o.points[o.points.length-1].y):(o.points[o.points.length-1].y=e.sourcePoint.y,h.points[0].x=o.points[o.points.length-1].x),o.direction&&(o.length||o.length===0)&&(o.length=b.distancePoints(o.points[0],o.points[o.points.length-1])),h.direction&&(h.length||h.length===0)&&(h.length=b.distancePoints(o.points[o.points.length-1],h.points[h.points.length-1]),h.direction=b.direction(o.points[o.points.length-1],h.points[h.points.length-1]));var f,p=o.points,c=o.direction,u=p[0],g=p[p.length-1];switch(c){case"Left":f=u.x-g.x;break;case"Right":f=g.x-u.x;break;case"Top":f=u.y-g.y;break;case"Bottom":f=g.y-u.y;break}if(e.sourcePortID!==""&&(o.length<10||f<0))if(e.segments.length>2){var v=e.segments[2],m=e.segments[3],y=b.direction(v.points[0],v.points[1]);if(o.direction===de(y))o.direction==="Right"?v.points[0].x=o.points[o.points.length-1].x=l.wrapper.corners.middleRight.x+20:o.direction==="Left"?v.points[0].x=o.points[o.points.length-1].x=l.wrapper.corners.middleLeft.x-20:o.direction==="Top"?v.points[0].y=o.points[o.points.length-1].y=l.wrapper.corners.topCenter.y-20:v.points[0].y=o.points[o.points.length-1].y=l.wrapper.corners.bottomCenter.y+20,v.direction&&v.length&&(v.length=b.distancePoints(v.points[0],v.points[v.points.length-1])),o.length=b.distancePoints(o.points[0],o.points[o.points.length-1]);else if(o.direction===y&&v.direction&&v.length){var S=20-f,x=5;if(o.length=20,v.length-=S,m&&v.length<x){var I=e.segments[1],C=I.length,P=0;I.direction===m.direction?P=Math.abs(C+m.length):P=Math.abs(C-m.length),m.length=P;var A=m.direction,T=o.points[o.points.length-1],z=m.points[m.points.length-1];m.direction=b.direction(T,z),A===m.direction||A===de(m.direction)||(m.direction=de(A));var L=e.segments[4];if(L){var R=0;c==="Bottom"?o.points[0].y>m.points[0].y&&(R=Math.abs(o.points[0].y-m.points[0].y),R+=20):c==="Top"?o.points[0].y<m.points[0].y&&(R=Math.abs(o.points[0].y-m.points[0].y),R+=20):c==="Left"?o.points[0].x<m.points[0].x&&(R=Math.abs(o.points[0].x-m.points[0].x),R+=20):c==="Right"&&o.points[0].x>m.points[0].x&&(R=Math.abs(o.points[0].x-m.points[0].x),R+=20),L.length+=R}e.segments.splice(1,2)}}else o.length=20}else o.length=20;else if(o.length<1)if(e.sourceID!==""){if(h.direction==="Right"?(d=l.wrapper.corners.middleRight,h.points[h.points.length-1].y=d.y):h.direction==="Left"?(d=l.wrapper.corners.middleLeft,h.points[h.points.length-1].y=d.y):h.direction==="Top"?(d=l.wrapper.corners.topCenter,h.points[h.points.length-1].x=d.x):(d=l.wrapper.corners.bottomCenter,h.points[h.points.length-1].x=d.x),h.length=b.distancePoints(d,h.points[h.points.length-1]),e.segments.length>2){var v=e.segments[2];v.direction&&v.length&&(v.length=b.distancePoints(h.points[h.points.length-1],v.points[v.points.length-1]))}e.segments.splice(0,1)}else e.segments.splice(0,1)}else if(e.segments&&e.segments[0].direction)if(t&&t instanceof M&&!i){var s=e.segments[0],O=e.segments[1],N=s.direction,H=e.sourcePoint,F=this.diagram.nameTable[t.id],Y=F.wrapper?F.wrapper.corners:void 0,et=function(){if(!N||!Y)return H;switch(N){case"Bottom":return Y.bottomCenter;case"Top":return Y.topCenter;case"Left":return Y.middleLeft;case"Right":return Y.middleRight;default:return H}},at=et();e.sourcePoint.x=at.x,e.sourcePoint.y=at.y,s.points[0]=at;var tt=s.points[s.points.length-1];if(N==="Top"||N==="Bottom"?(tt.x=at.x,O.points[0].y=tt.y):(tt.y=at.y,O.points[0].x=tt.x),s.length=b.distancePoints(s.points[0],tt),O.direction){var nt=O.points[O.points.length-1];O.length=b.distancePoints(tt,nt),O.direction=b.direction(tt,nt)}}else t&&t instanceof M&&i&&e.sourcePortID!==i&&this.changeSourceEndToPort(e,t,i)},n.prototype.canConnect=function(e,t){return!!(ii(t)&&Di(t))},n.prototype.changeSourceEndToPort=function(e,t,i){var r=this.diagram.getWrapper(t.wrapper,i),a={x:r.offsetX,y:r.offsetY};e.sourcePoint.x=a.x,e.sourcePoint.y=a.y;var s=ui(a,se(t.wrapper),t.wrapper.bounds),o=e.segments[0],h=e.segments[1],l=s==="Top"||s==="Bottom",d=20;if(o.direction===s){o.points[0]=a;var f=o.points[o.points.length-1];if(l?f.x=a.x:f.y=a.y,o.length=b.distancePoints(o.points[0],f),h.direction){var p=h.points[h.points.length-1];h.length=b.distancePoints(f,p),h.direction=b.direction(f,p)}return}if(o.direction!==de(s)){if(h.direction===s){if(e.segments.splice(0,1),e.segments.length>1){o=h,h=e.segments[1],o.points[0]=a;var c=o.points[o.points.length-1];if(l?c.x=a.x:c.y=a.y,o.length=b.distancePoints(o.points[0],c),h.direction){var p=h.points[h.points.length-1];h.length=b.distancePoints(c,p),h.direction=b.direction(c,p)}}return}var u=e.segments.slice(0,-2).filter(function(P){return P.isTerminal}).length;u>1&&(this.removeTerminalSegment(e),o=e.segments[0],h=e.segments[1]);var g=new Te(e,"segments",{type:"Orthogonal",direction:s,length:d,isTerminal:!0},!0),v=o.points[0],m=o.points[o.points.length-1];if(l?(v.x=a.x,v.y=m.y=s==="Top"?a.y-d:a.y+d):(v.y=a.y,v.x=m.x=s==="Right"?a.x+d:a.x-d),o.length=b.distancePoints(v,m),h.direction){var p=h.points[h.points.length-1];h.length=b.distancePoints(m,p),h.direction=b.direction(m,p)}e.segments=[g].concat(e.segments),e.sourcePoint.x=a.x,e.sourcePoint.y=a.y;return}var y=e.segments.length>2?e.segments[2]:void 0,S=o.points.length-1,x=So({},o.points[parseInt(S.toString(),10)]),I=o.points[o.points.length-1];if(o.points[0]=a,l?(I.x=a.x,I.y=s==="Top"?a.y-d:a.y+d,h.points[0].x=I.x,h.points[0].y=I.y,h.points[h.points.length-1].y=I.y):(I.y=a.y,I.x=s==="Right"?a.x+d:a.x-d,h.points[0].x=I.x,h.points[0].y=I.y,h.points[h.points.length-1].x=I.x),o.length=b.distancePoints(o.points[0],I),h.direction){var p=h.points[h.points.length-1];h.length=b.distancePoints(I,p),h.direction=b.direction(I,p)}var C=Math.abs(l?x.y-I.y:x.x-I.x);y&&y.direction&&(o.direction===y.direction?y.length+=C:y.length-=C)},n.prototype.removeTerminalSegment=function(e,t){for(var i=0;i<e.segments.length-2;i++){var r=e.segments[0];r.isTerminal&&(t?r.isTerminal=!1:(e.segments.splice(i,1),i--))}},n.prototype.translateBezierPoints=function(e,t,i,r,a,s,o){var h=e.segments.indexOf(a),l=e.segments[parseInt(h.toString(),10)],d=h>0?e.segments[h-1]:null,f=d!==null?d.point:e.sourcePoint,p=h===e.segments.length-1?e.targetPoint:l.point;if(l)if(t==="BezierSourceThumb"&&(l.vector1.angle||l.vector1.distance)){var c=l.vector1.distance,u=l.vector1.angle;l.vector1={distance:e.distance(f,s),angle:b.findAngle(f,s)};var g=l.vector1.distance-c,v=l.vector1.angle-u;this.translateSubsequentSegment(e,a,!0,g,v)}else if(t==="BezierTargetThumb"&&(l.vector2.angle||l.vector2.distance)){var c=l.vector2.distance,u=l.vector2.angle;l.vector2={distance:e.distance(p,s),angle:b.findAngle(p,s)};var g=l.vector2.distance-c,v=l.vector2.angle-u;this.translateSubsequentSegment(e,a,!1,g,v)}else(t==="ConnectorSourceEnd"&&!e.sourceID||t==="ConnectorTargetEnd"&&!e.targetID)&&o&&pa(l.vector1)&&pa(l.vector2)?(b.isEmptyPoint(l.point1)&&(l.bezierPoint1=Qa(e.sourcePoint,e.targetPoint)),b.isEmptyPoint(l.point2)&&(l.bezierPoint2=Qa(e.targetPoint,e.sourcePoint))):t==="BezierSourceThumb"||t==="ConnectorSourceEnd"&&!o&&pa(l.vector1)?(l.bezierPoint1.x+=i,l.bezierPoint1.y+=r,(!b.isEmptyPoint(l.point1)||o)&&(l.point1={x:l.bezierPoint1.x,y:l.bezierPoint1.y}),(i!==0||r!==0)&&a.isInternalSegment===!0&&(a.isInternalSegment=!1)):(t==="BezierTargetThumb"||t==="ConnectorTargetEnd"&&!o&&pa(l.vector2))&&(l.bezierPoint2.x+=i,l.bezierPoint2.y+=r,(!b.isEmptyPoint(l.point2)||o)&&(l.point2={x:l.bezierPoint2.x,y:l.bezierPoint2.y}),(i!==0||r!==0)&&a.isInternalSegment===!0&&(a.isInternalSegment=!1))},n.prototype.translateSubsequentSegment=function(e,t,i,r,a){var s=e.segments.indexOf(t);e.segments[parseInt(s.toString(),10)],e.bezierSettings.smoothness&Bn.SymmetricAngle||(a=null),e.bezierSettings.smoothness&Bn.SymmetricDistance||(r=null),!(r==null&&a==null)&&(i?s!==0&&this.updatePreviousBezierSegment(e,s,r,a):s!==e.segments.length-1&&this.updateNextBezierSegment(e,s,r,a))},n.prototype.updatePreviousBezierSegment=function(e,t,i,r){var a=e.segments[t-1],s=a.vector2.distance+i,o=(a.vector2.angle+r)%360;o<0&&(o+=360),a.vector2={distance:s,angle:o}},n.prototype.updateNextBezierSegment=function(e,t,i,r){var a=e.segments[t+1],s=a.vector1.distance+i,o=(a.vector1.angle+r)%360;o<0&&(o+=360),a.vector1={distance:s,angle:o}},n.prototype.dragTargetEnd=function(e,t,i,r,a,s,o,h){var l=this.diagram.nameTable[e.id];if(!l)return!1;var d,f=this.checkBoundaryConstraints(t,i,l.wrapper.bounds);if(Ua(l)&&s!=="BezierTargetThumb"&&f&&yn(this.diagram)){if(d={targetPoint:l.targetPoint},d=E(d),this.diagram.constraints&lt.RestrictNegativeAxisDragDrop){var p=l.targetPoint.x+t,c=l.targetPoint.y+i;l.targetPoint.x=p<0?0:p,l.targetPoint.y=c<0?0:c}else l.targetPoint.x+=t,l.targetPoint.y+=i;if(s==="ConnectorTargetEnd"&&l.type==="Orthogonal"&&l.segments&&l.segments.length>0){var u=l.segments[l.segments.length-2];u&&l.segments[l.segments.length-1].points.length===2&&(u.direction==="Left"||u.direction==="Right"?u.points[u.points.length-1].x=l.targetPoint.x:u.points[u.points.length-1].y=l.targetPoint.y,u.length=b.distancePoints(u.points[0],u.points[u.points.length-1]),u.direction=b.direction(u.points[0],u.points[u.points.length-1]))}l.shape.type==="Bpmn"&&l.shape.sequence==="Default"&&l.shape.flow==="Sequence"&&this.updatePathElementOffset(l)}if(l.type==="Bezier")if(d={targetPoint:l.targetPoint},h)this.translateBezierPoints(e,s===""?"ConnectorTargetEnd":s,t,i,h,a,!o);else for(var g=0;g<e.segments.length;g++)this.translateBezierPoints(e,s===""?"ConnectorTargetEnd":s,t,i,e.segments[parseInt(g.toString(),10)],a,!o);return r||this.updateEndPoint(l,d),this.diagram.realActions&Vt.AnimationClick||this.diagram.refreshCanvasLayers(),f},n.prototype.dragControlPoint=function(e,t,i,r,a){var s=this.diagram.nameTable[e.id];if((s.type==="Straight"||s.type==="Bezier")&&s.segments.length>0){if(a!==void 0&&s.segments[parseInt(a.toString(),10)])if(s.type==="Bezier"){var o=s.segments[parseInt(a.toString(),10)],h=o.isInternalSegment;!h||s.bezierSettings===null||s.bezierSettings.segmentEditOrientation==="FreeForm"?(o.point.x+=t,o.point.y+=i):(o.orientation==="Horizontal"?o.point.x+=t:o.point.y+=i,this.updateDirectionalBezierCurve(s)),h&&(s.isBezierEditing=!0)}else s.segments[parseInt(a.toString(),10)].point.x+=t,s.segments[parseInt(a.toString(),10)].point.y+=i;else for(var l=0;l<s.segments.length-1;l++)s.segments[parseInt(l.toString(),10)].point.x+=t,s.segments[parseInt(l.toString(),10)].point.y+=i;r||this.updateEndPoint(s)}return!0},n.prototype.updateDirectionalBezierCurve=function(e){var t=[];t.push(e.sourcePoint);for(var i=0;i<e.segments.length-1;i++){var r=e.segments[parseInt(i.toString(),10)];r.orientation==="Horizontal"?t.push({x:r.point.x,y:t[t.length-1].y}):t.push({x:t[t.length-1].x,y:r.point.y}),i===e.segments.length-2&&(r.orientation==="Horizontal"?t.push({x:r.point.x,y:e.targetPoint.y}):t.push({x:e.targetPoint.x,y:r.point.y}))}t.push(e.targetPoint);var a=t[0],s=t[t.length-1];if(e.segments.length>1){var o=t[1],h=t[2],l={x:(o.x+h.x)*.5,y:(o.y+h.y)*.5},d=e.segments[0];d.vector1.angle=At(a,o),d.vector1.distance=b.findLength(a,o)*.5,d.vector2.angle=At(l,o),d.vector2.distance=b.findLength(l,o)*.5,d.point=l;var f=e.segments[1];if(f.vector1.angle=At(l,h),f.vector1.distance=b.findLength(l,h)*.5,e.segments.length>2){var p=t[3],c={x:(h.x+p.x)*.5,y:(h.y+p.y)*.5};f.vector2.angle=At(c,h),f.vector2.distance=b.findLength(c,h)*.5,f.point=c;var u=e.segments[2];if(u.vector1.angle=At(c,p),u.vector1.distance=b.findLength(c,p)*.5,e.segments.length>3){var g=t[4],v={x:(p.x+g.x)*.5,y:(p.y+g.y)*.5};u.vector2.angle=At(v,p),u.vector2.distance=b.findLength(v,p)*.5,u.point=v;var m=e.segments[3];m.vector1.angle=At(v,g),m.vector1.distance=b.findLength(v,g)*.5,m.vector2.angle=At(s,g),m.vector2.distance=b.findLength(s,g)*.5}else u.vector2.angle=At(s,p),u.vector2.distance=b.findLength(s,p)*.5}else f.vector2.angle=At(s,h),f.vector2.distance=b.findLength(s,h)*.5}},n.prototype.rotateObjects=function(e,t,i,r,a){r=r||{};var s=xt();Rt(s,i,r.x,r.y);for(var o,h=0,l=t;h<l.length;h++){var d=l[h];if(d instanceof M){if(Va(d)&&yn(this.diagram)){if(a!==!1||e!==d){o={offsetX:d.wrapper.offsetX,offsetY:d.wrapper.offsetY,rotateAngle:d.rotateAngle},d.rotateAngle=(d.rotateAngle+i+360)%360;var f=st(s,{x:d.wrapper.offsetX,y:d.wrapper.offsetY});d.offsetX=f.x,d.offsetY=f.y,this.diagram.nodePropertyChange(d,o,{offsetX:d.offsetX,offsetY:d.offsetY,rotateAngle:d.rotateAngle})}var p=this.diagram.nameTable[d.parentId];if(d.processId){var c=this.diagram.nameTable[d.processId],u=this.diagram.bpmnModule.getChildrenBound(c,d.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(u,d,this.diagram)}else if(p&&p.shape instanceof Sr){var u=Rn(p,d.id,this.diagram);ns(u,d,this.diagram,!1)}d.children&&d.children.length&&!d.container&&this.getChildren(d,t)}}else this.rotatePoints(d,i,r||{x:d.wrapper.offsetX,y:d.wrapper.offsetY});this.diagram.updateDiagramObject(d)}this.diagram.refreshCanvasLayers(),this.diagram.updateSelector()},n.prototype.snapConnectorEnd=function(e){return this.diagram.snapSettings.constraints&pi.SnapToLines&&this.snappingModule&&this.diagram.snappingModule.snapConnectorEnd(e),e},n.prototype.snapAngle=function(e){return this.diagram.snapSettings.constraints&pi.SnapToLines&&this.snappingModule?this.snappingModule.snapAngle(this.diagram,e):0},n.prototype.rotatePoints=function(e,t,i){if(!e.sourceWrapper||!e.targetWrapper){var r=xt();Rt(r,t,i.x,i.y),e.sourcePoint=st(r,e.sourcePoint),e.targetPoint=st(r,e.targetPoint),e.shape.type==="Bpmn"&&e.shape.sequence==="Default"&&e.shape.flow==="Sequence"&&this.updatePathElementOffset(e);var a={sourcePoint:e.sourcePoint,targetPoint:e.targetPoint};if(this.diagram.connectorPropertyChange(e,{},a),e.segments&&e.segments.length>0){var s=this.diagram.getProtectPropertyChangeValue();this.diagram.protectPropertyChange(!0);var o=e;o.segments=[],this.diagram.connectorPropertyChange(o,{},{segments:o.segments}),this.diagram.protectPropertyChange(s)}}},n.prototype.updateInnerParentProperties=function(e){var t=[],i="isProtectedOnChange",r=this.diagram[""+i];this.diagram.protectPropertyChange(!0);for(var a=this.getAllDescendants(e,t,!1,!0),s=0;s<a.length;s++){var o=this.diagram.nameTable[a[parseInt(s.toString(),10)].id];o.offsetX=o.wrapper.offsetX,o.offsetY=o.wrapper.offsetY,o.width=o.wrapper.width,o.height=o.wrapper.height}this.diagram.protectPropertyChange(r)},n.prototype.scale=function(e,t,i,r,a,s){var o=this.diagram.nameTable[e.id],h=o,l=[],d=o.wrapper;a||(a=e);var f=a.wrapper,p=f.offsetX-f.actualSize.width*f.pivot.x,c=f.offsetY-f.actualSize.height*f.pivot.y,u=ts(p,c,f.actualSize.width,f.actualSize.height,f.rotateAngle,f.offsetX,f.offsetY,r);if(d.actualSize.width!==void 0&&d.actualSize.height!==void 0&&yn(this.diagram)){if(h.children&&!h.container){for(var g=this.getAllDescendants(h,l),v=0,m=g;v<m.length;v++){var y=m[v];this.scaleObject(t,i,u,y,d,a)}e.wrapper.measure(new U),e.wrapper.arrange(e.wrapper.desiredSize),this.diagram.updateGroupOffset(o),this.updateInnerParentProperties(h)}else this.scaleObject(t,i,u,o,d,a);var S=ze(e.wrapper),x=this.checkBoundaryConstraints(void 0,void 0,S);if(!x&&s)return this.scale(e,1/t,1/i,r,void 0,!0),!1;this.diagram.updateDiagramObject(e)}return!0},n.prototype.getAllDescendants=function(e,t,i,r){for(var a=e,s=[],o=0;o<a.children.length;o++)e=this.diagram.nameTable[a.children[parseInt(o.toString(),10)]],e&&(e.children?(i&&t.push(e),r&&s.push(e),t=this.getAllDescendants(e,t)):t.push(e));return r?s:t},n.prototype.getChildren=function(e,t){var i=e;if(e.children&&e.children.length)for(var r=0;r<i.children.length;r++)e=this.diagram.nameTable[i.children[parseInt(r.toString(),10)]],e&&t.push(e);return t},n.prototype.cloneChild=function(e){var t=this.diagram.nameTable[""+e];return t},n.prototype.scaleObject=function(e,t,i,r,a,s,o){e=e<0?1:e,t=t<0?1:t;var h={};if(e!==1||t!==1){var l=void 0,d=void 0;if(r instanceof M){var f=r,p=void 0,c=void 0;if(h={width:r.wrapper.actualSize.width,height:r.wrapper.actualSize.height,offsetX:r.wrapper.offsetX,offsetY:r.wrapper.offsetY,margin:{top:f.margin.top,left:f.margin.left}},f.shape.type==="Bpmn"&&f.shape.activity.subProcess.processes&&f.shape.activity.subProcess.processes.length>0&&(c=this.diagram.bpmnModule.getChildrenBound(f,f.id,this.diagram),p=f.wrapper.bounds.containsRect(c)),f.shape.type==="Container"&&f.shape.children&&f.shape.children.length>0&&(c=Rn(f,f.id,this.diagram),p=f.wrapper.bounds.containsRect(c)),l=f.wrapper.actualSize.width*e,d=f.wrapper.actualSize.height*t,f.shape.type==="SwimLane"&&(e<1||t<1)){var u=r.shape.type==="SwimLane",g=u?r.shape.padding:void 0,v=f.shape.orientation==="Horizontal"?f.shape.phases[f.shape.phases.length-1]:f.shape.lanes[f.shape.lanes.length-1],m=this.diagram.nameTable[v.header.id];r.wrapper.children[0].updateColumnWidth(m.columnIndex,l,!0,g),l=m.actualSize.width,d=r.height}var y=(f.constraints&W.AspectRatio)===W.AspectRatio,S=f.minWidth!==void 0&&f.minWidth!==0,x=f.maxWidth!==void 0&&f.maxWidth!==0,I=f.minHeight!==void 0&&f.minHeight!==0,C=f.maxHeight!==void 0&&f.maxHeight!==0;if(y){var P=f.wrapper.actualSize;S&&I?d/f.minHeight<l/f.minWidth?d<f.minHeight&&(d=f.minHeight,l=f.minHeight*(P.width/P.height)):l<f.minWidth&&(l=f.minWidth,d=f.minWidth*(P.height/P.width)):S?l<f.minWidth&&(l=f.minWidth,d=f.minWidth*(P.height/P.width)):I&&d<f.minHeight&&(d=f.minHeight,l=f.minHeight*(P.width/P.height)),x&&C?d/f.maxHeight>l/f.maxWidth?d>f.maxHeight&&(d=f.maxHeight,l=f.maxHeight*(P.width/P.height)):l>f.maxWidth&&(l=f.maxWidth,d=f.maxWidth*(P.height/P.width)):x?l>f.maxWidth&&(l=f.maxWidth,d=f.maxWidth*(P.height/P.width)):C&&d>f.maxHeight&&(d=f.maxHeight,l=f.maxHeight*(P.width/P.height))}else x&&(l=Math.min(f.maxWidth,l)),S&&(l=Math.max(f.minWidth,l)),I&&(d=Math.max(f.minHeight,d)),C&&(d=Math.min(f.maxHeight,d));p&&(l=Math.max(l,c.right-f.wrapper.bounds.x),d=Math.max(d,c.bottom-f.wrapper.bounds.y)),e=l/f.actualSize.width,t=d/f.actualSize.height}var A=xt();s||(s=r);var T=s.wrapper;if(Rt(A,-T.rotateAngle,i.x,i.y),Or(A,e,t,i.x,i.y),Rt(A,T.rotateAngle,i.x,i.y),r instanceof M){var f=r,z=f.wrapper.offsetX-f.wrapper.actualSize.width*f.pivot.x,L=f.wrapper.offsetY-f.wrapper.actualSize.height*f.pivot.y,R=!(this.diagram.undoRedoModule&&this.diagram.checkUndoRedo&&(f.shape.type==="Bpmn"||f.parentId&&this.diagram.nameTable[f.parentId])),O=st(A,{x:f.wrapper.offsetX,y:f.wrapper.offsetY}),N=R?O.x:h.offsetX,H=R?O.y:h.offsetY,F=f.processId?this.diagram.nameTable[f.processId]:f.parentId?this.diagram.nameTable[f.parentId]:void 0;if(l>0){var Y=f.margin.left+l,et=!F||F.maxWidth===void 0||Y<F.maxWidth;F&&f.processId&&Y>F.wrapper.actualSize.width&&(et=!!(F.constraints&W.Resize)),et&&(f.width=l,f.offsetX=N)}if(d>0){var at=f.margin.top+d,tt=!F||F.maxHeight===void 0||at<F.maxHeight;F&&f.processId&&at>F.wrapper.actualSize.height&&(tt=!!(F.constraints&W.Resize)),tt&&(f.height=d,f.offsetY=H)}var nt=f.wrapper.offsetX-f.wrapper.actualSize.width*f.pivot.x,wt=f.wrapper.offsetY-f.wrapper.actualSize.height*f.pivot.y,$=this.diagram.nameTable[f.processId],pt=0;!$&&this.diagram.nameTable[f.parentId]&&this.diagram.nameTable[f.parentId].shape.type==="Container"&&($=this.diagram.nameTable[f.parentId],$.shape.hasHeader&&(pt=$.shape.header.height)),$&&(nt=f.offsetX-f.width*f.pivot.x,wt=f.offsetY-f.height*f.pivot.y),$&&(f.margin.top-pt+(wt-L)<=0||f.margin.left+(nt-z)<=0)?this.diagram.eventHandler.currentAction!=="Drag"?this.diagram.nodePropertyChange(r,{},{margin:{top:f.margin.top,left:f.margin.left}}):this.diagram.nodePropertyChange(r,{},{width:f.width,height:f.height,margin:{top:f.margin.top,left:f.margin.left}}):ne(this.diagram,r,!0)?Mn(this.diagram,r):o||this.diagram.nodePropertyChange(r,h,{width:f.width,height:f.height,offsetX:f.offsetX,offsetY:f.offsetY,margin:{top:f.margin.top+(wt-L),left:f.margin.left+(nt-z)}})}else{var rt=r,mt={sourcePoint:rt.sourcePoint,targetPoint:rt.targetPoint};(!rt.sourceWrapper||!rt.targetWrapper)&&this.scaleConnector(rt,A,mt,e,t,i)}var ct=this.diagram.nameTable[r.processId],Dt=this.diagram.nameTable[r.parentId];if(ct){ct.wrapper.bounds,r.wrapper.bounds;var c=this.diagram.bpmnModule.getChildrenBound(ct,r.id,this.diagram);this.diagram.bpmnModule.updateSubProcessess(c,r,this.diagram)}else if(Dt&&Dt.shape instanceof Sr){var c=Rn(Dt,r.id,this.diagram);ns(c,r,this.diagram,!0)}}},n.prototype.scaleConnector=function(e,t,i,r,a,s){e.sourcePoint=st(t,e.sourcePoint),e.targetPoint=st(t,e.targetPoint),e.shape.type==="Bpmn"&&e.shape.sequence==="Default"&&e.shape.flow==="Sequence"&&this.updatePathElementOffset(e);var o={sourcePoint:e.sourcePoint,targetPoint:e.targetPoint};this.diagram.connectorPropertyChange(e,i,o);var h=this.diagram.selectedItems;if(kn(this.diagram,h)){var l=E(this.diagram.selectedItems),d={offsetX:l.offsetX,offsetY:l.offsetY,height:l.height,width:l.width,rotateAngle:l.rotateAngle},f=new M(this.diagram,"nodes",d,!0);f.wrapper=l.wrapper,f.wrapper.rotateAngle=h.rotateAngle,this.scaleObject(r,a,s,f,f.wrapper,f,!0),h.wrapper.actualSize.width=f.width,h.wrapper.actualSize.height=f.height,h.wrapper.offsetX=f.offsetX,h.wrapper.offsetY=f.offsetY;var p=this.diagram.selectedItems.connectors[0];p.id!==e.id&&this.measureSelector(h)}},n.prototype.measureSelector=function(e){var t=void 0,i=E(this.diagram.selectedItems),r=[],a;r=i.connectors;for(var s={x:this.diagram.selectedItems.offsetX,y:this.diagram.selectedItems.offsetY},o=0;o<r.length;o++){var h=xt();Rt(h,-e.rotateAngle,s.x,s.y),r[parseInt(o.toString(),10)].sourcePoint=st(h,r[parseInt(o.toString(),10)].sourcePoint),r[parseInt(o.toString(),10)].targetPoint=st(h,r[parseInt(o.toString(),10)].targetPoint);var l={x:r[parseInt(o.toString(),10)].sourcePoint.x,y:r[parseInt(o.toString(),10)].sourcePoint.y},d={x:r[parseInt(o.toString(),10)].targetPoint.x,y:r[parseInt(o.toString(),10)].targetPoint.y};a=this.calculateBounds(l,d),t===void 0?t=a:t.uniteRect(a)}var f={};t!==void 0&&(f={x:t.x+t.width*e.wrapper.pivot.x,y:t.y+t.height*e.wrapper.pivot.y});var p={offsetX:f.x,offsetY:f.y,height:t.height,width:t.width,rotateAngle:0},c=new M(this.diagram,"nodes",p,!0),u=xt();Rt(u,e.rotateAngle,s.x,s.y),c.rotateAngle+=e.rotateAngle,c.rotateAngle=(c.rotateAngle+360)%360;var g=st(u,{x:c.offsetX,y:c.offsetY});c.offsetX=g.x,c.offsetY=g.y,e.wrapper.actualSize.width=t.width,e.wrapper.actualSize.height=t.height,e.wrapper.offsetX=c.offsetX,e.wrapper.offsetY=c.offsetY;var v=Ln(this.diagram.element.id);this.diagram.diagramRenderer.renderResizeHandle(e.wrapper,v,e.thumbsConstraints,this.diagram.scroller.currentZoom,e.constraints,this.diagram.scroller.transform,!1,Qe(e),null,null,e.handleSize)},n.prototype.calculateBounds=function(e,t){var i=Math.min(e.x,t.x),r=Math.max(e.x,t.x),a=Math.min(e.y,t.y),s=Math.max(e.y,t.y),o=r-i,h=s-a,l=new it(i,a,o,h);return l},n.prototype.portDrag=function(e,t,i,r){var a,s,o=this.findTarget(t,e),h=ze(e.wrapper);o&&Zo(o,this.diagram)&&(e instanceof M?(a=this.getPortChanges(e,o),o.offset.x+=i/h.width,o.offset.y+=r/h.height,o.offset.x=Math.max(0,Math.min(1,o.offset.x)),o.offset.y=Math.max(0,Math.min(1,o.offset.y)),s=this.getPortChanges(e,o),this.diagram.nodePropertyChange(e,a,s)):(a=this.getConnectorPortChanges(e,o),this.updatePortOffset(e,o,i,r),o.alignment="Center",s=this.getConnectorPortChanges(e,o),this.diagram.connectorPropertyChange(e,a,s)),this.diagram.updateDiagramObject(e))},n.prototype.labelDrag=function(e,t,i,r){var a=this.findTarget(t,e),s=se(e.wrapper),o=this.getAnnotationChanges(e,a),h=this.getSelectedObject();if(a instanceof ae){var l=t.flippedPoint&&t.flip===G.Horizontal||t.flip===G.Both?-1:1,d=t.flippedPoint&&t.flip===G.Vertical||t.flip===G.Both?-1:1;if(this.diagram.constraints&lt.RestrictNegativeAxisDragDrop){this.annotationRestrictDeltaValue=this.annotationRestrictDeltaValue||{x:0,y:0},this.annotationRestrictDeltaValue.x>0&&(this.annotationRestrictDeltaValue.x-=i,i=this.annotationRestrictDeltaValue.x>0?0:-this.annotationRestrictDeltaValue.x,this.annotationRestrictDeltaValue.x=Math.max(0,this.annotationRestrictDeltaValue.x)),this.annotationRestrictDeltaValue.y>0&&(this.annotationRestrictDeltaValue.y-=r,r=this.annotationRestrictDeltaValue.y>0?0:-this.annotationRestrictDeltaValue.y,this.annotationRestrictDeltaValue.y=Math.max(0,this.annotationRestrictDeltaValue.y));var f=Math.cos(t.parentTransform*Math.PI/180),p=Math.sin(t.parentTransform*Math.PI/180),c={x:e.offsetX+((s.x+a.offset.x*s.width+i-e.offsetX)*f-(s.y+a.offset.y*s.height+r-e.offsetY)*p),y:e.offsetY+((s.x+a.offset.x*s.width+i-e.offsetX)*p+(s.y+a.offset.y*s.height+r-e.offsetY)*f)},u=(t.parentTransform+t.rotateAngle)%360,g=this.getRotatedAnnotationCorners(c,t.actualSize.width,t.actualSize.height,u),v=g.map(function(T){return T.x}),m=g.map(function(T){return T.y}),y=Math.min.apply(Math,v),S=Math.min.apply(Math,m);(y<0||S<0)&&(i=0,r=0,t.parentTransform===0&&(y<0&&(this.annotationRestrictDeltaValue.x+=-y),S<0&&(this.annotationRestrictDeltaValue.y+=-S)))}a.offset.x+=l*i/s.width,a.offset.y+=d*r/s.height}else this.updatePathAnnotationOffset(e,a,i,r),a instanceof Qt&&(a.alignment="Center");var x=this.getAnnotationChanges(e,a);e instanceof M?this.diagram.nodePropertyChange(e,o,x):this.diagram.connectorPropertyChange(e,o,x),this.diagram.updateDiagramObject(e),Ut(this.diagram,a,!1,t)||this.labelSelect(e,t,h);for(var I=0,C=this.diagram.views;I<C.length;I++){var P=C[I],A=this.diagram.views[P];A instanceof Xe||this.diagram.refreshCanvasDiagramLayer(A)}},n.prototype.getRotatedAnnotationCorners=function(e,t,i,r){var a=Math.cos(r*Math.PI/180),s=Math.sin(r*Math.PI/180),o=t/2,h=i/2;return[{x:e.x+(-o*a- -h*s),y:e.y+(-o*s+-h*a)},{x:e.x+(o*a- -h*s),y:e.y+(o*s+-h*a)},{x:e.x+(-o*a-h*s),y:e.y+(-o*s+h*a)},{x:e.x+(o*a-h*s),y:e.y+(o*s+h*a)}]},n.prototype.updatePathAnnotationOffset=function(e,t,i,r,a,s){var o=this.diagram.getWrapper(e.wrapper,t.id),h=o.offsetX,l=o.offsetY,d,f=e.intermediatePoints,p,c=0,u=0,g,v;switch(t.verticalAlignment){case"Center":t.horizontalAlignment==="Center"?v=a||{x:h+i,y:l+r}:t.horizontalAlignment==="Right"?v=a||{x:h+o.actualSize.width/2+i,y:l+r}:t.horizontalAlignment==="Left"&&(v=a||{x:h-o.actualSize.width/2+i,y:l+r});break;case"Top":t.horizontalAlignment==="Center"?v=a||{x:h+i,y:l-o.actualSize.height/2+r}:t.horizontalAlignment==="Right"?v=a||{x:h+o.actualSize.width/2+i,y:l-o.actualSize.height/2+r}:t.horizontalAlignment==="Left"&&(v=a||{x:h-o.actualSize.width/2+i,y:l-o.actualSize.height/2+r});break;case"Bottom":t.horizontalAlignment==="Center"?v=a||{x:h+i,y:l+o.actualSize.height/2+r}:t.horizontalAlignment==="Right"?v=a||{x:h+o.actualSize.width/2+i,y:l+o.actualSize.height/2+r}:t.horizontalAlignment==="Left"&&(v=a||{x:h-o.actualSize.width/2+i,y:l+o.actualSize.height/2+r});break}var m=this.getInterceptWithSegment(v,f),y=f[f.length-1];if(u=b.getLengthFromListOfPoints(f),m.length>0){if(t.dragLimit=t.dragLimit?t.dragLimit:{},t.dragLimit.top||t.dragLimit.bottom||t.dragLimit.left||t.dragLimit.right){var S={minDistance:null};y=this.getRelativeOffset(v,f,S);var x={minDistance:null};if(g=this.getRelativeOffset(v,m,x),S!=null&&x.minDistance<S.minDistance)y=g;else{var I=_a(e.intermediatePoints,t);y=I.point}}else g=m[m.length-1],y=g;if(y){var C=void 0,P=void 0;for(C=0;C<f.length;C++){if(p!=null)if(P=it.toBounds([p,f[parseInt(C.toString(),10)]]),P.containsPoint(y)){c+=b.findLength(p,y);break}else c+=b.findLength(p,f[parseInt(C.toString(),10)]);p=f[parseInt(C.toString(),10)]}d={x:c/u,y:0}}this.updateLabelMargin(e,t,d,v,s,i,r)}else this.updateLabelMargin(e,t,null,v,s,i,r)},n.prototype.updatePortOffset=function(e,t,i,r,a,s){var o=this.diagram.getWrapper(e.wrapper,t.id),h=o.offsetX,l=o.offsetY,d,f=e.intermediatePoints,p,c=0,u=0,g,v;switch(t.verticalAlignment){case"Center":t.horizontalAlignment==="Center"?v=a||{x:h+i,y:l+r}:t.horizontalAlignment==="Right"?v=a||{x:h+o.actualSize.width/2+i,y:l+r}:t.horizontalAlignment==="Left"&&(v=a||{x:h-o.actualSize.width/2+i,y:l+r});break;case"Top":t.horizontalAlignment==="Center"?v=a||{x:h+i,y:l-o.actualSize.height/2+r}:t.horizontalAlignment==="Right"?v=a||{x:h+o.actualSize.width/2+i,y:l-o.actualSize.height/2+r}:t.horizontalAlignment==="Left"&&(v=a||{x:h-o.actualSize.width/2+i,y:l-o.actualSize.height/2+r});break;case"Bottom":t.horizontalAlignment==="Center"?v=a||{x:h+i,y:l+o.actualSize.height/2+r}:t.horizontalAlignment==="Right"?v=a||{x:h+o.actualSize.width/2+i,y:l+o.actualSize.height/2+r}:t.horizontalAlignment==="Left"&&(v=a||{x:h-o.actualSize.width/2+i,y:l+o.actualSize.height/2+r});break}var m=this.getInterceptWithSegment(v,f),y=f[f.length-1];if(u=b.getLengthFromListOfPoints(f),m.length>0){g=m[m.length-1],y=g;var S={minDistance:null};y=this.getRelativeOffset(v,f,S);var x={minDistance:null};if(g=this.getRelativeOffset(v,m,x),S!=null&&x.minDistance<S.minDistance)y=g;else{var I=_a(e.intermediatePoints,t);y=I.point}if(y){var C=void 0,P=void 0;for(C=0;C<f.length;C++){if(p!=null)if(P=it.toBounds([p,f[parseInt(C.toString(),10)]]),P.containsPoint(y)){c+=b.findLength(p,y);break}else c+=b.findLength(p,f[parseInt(C.toString(),10)]);p=f[parseInt(C.toString(),10)]}d={x:c/u,y:0}}this.updateLabelMargin(e,t,d,v,s,i,r)}else this.updateLabelMargin(e,t,null,v,s,i,r)},n.prototype.getRelativeOffset=function(e,t,i){var r,a,s,o;for(o=0;o<t.length;o++)s=t[parseInt(o.toString(),10)],a=Math.round(Math.sqrt(Math.pow(e.x-s.x,2)+Math.pow(e.y-s.y,2))),(i.minDistance===null||Math.min(Math.abs(i.minDistance),Math.abs(a))===Math.abs(a))&&(r=s,i.minDistance=a);return r},n.prototype.dragLimitValue=function(e,t,i,r){var a=!1,s=!1;return i.x>=t.x-e.left-r.width/2&&i.x<=t.x+e.right+r.width/2&&(a=!0),i.y>=t.y-e.top-r.height/2&&i.y<=t.y+e.bottom+r.height/2&&(s=!0),{x:a,y:s}},n.prototype.updateLabelMargin=function(e,t,i,r,a,s,o){if(i=i||{x:t.offset,y:0},t&&i&&i.x>0&&i.x<1){var h=b.getLengthFromListOfPoints(e.intermediatePoints),l=this.getPointAtLength(h*i.x,e.intermediatePoints,0),d=this.diagram.scrollSettings.currentZoom,f=t.dragLimit?t.dragLimit:{left:0,right:0,top:0,bottom:0};if(f.top||f.bottom||f.left||f.right||t instanceof ke){this.diagram.getWrapper(e.wrapper,t.id);var p=new it(0,0,0,0),c=this.diagram.getWrapper(e.wrapper,t.id);p.x=c.offsetX/d+s,p.y=c.offsetY/d+o,p.width=t instanceof ke?0:c.bounds.width/d,p.height=t instanceof ke?0:c.bounds.height/d;var u=new it(l.x-(f.left||0)-p.width/2,l.y-(f.top||0)-p.height/2,(f.left||0)+(f.right||0)+p.width,(f.top||0)+(f.bottom||0)+p.height);if(u.containsPoint(r))r=r;else{var g=void 0,v=[l,r];g=this.boundsInterSects(v,u,!1);for(var m=0,y=g;m<y.length;m++){var S=y[m],x=S;r=x}}var I=this.dragLimitValue(f,l,r,p);t.margin={left:I.x?r.x-l.x:t.margin.left,top:I.y?r.y-l.y:t.margin.top,right:0,bottom:0}}else t.margin={left:r.x-l.x,top:r.y-l.y,right:0,bottom:0};t.offset=i.x,a&&(t.width=a.width,t.height=a.height)}},n.prototype.boundsInterSects=function(e,t,i){var r;if(t){var a=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height},{x:t.x,y:t.y}];r=this.intersect(e,a,i)}return r},n.prototype.intersect=function(e,t,i){for(var r=[],a=0;a<e.length-1;a++)for(var s=0;s<t.length-1;s++){var o=p0(e[a],e[a+1],t[s],t[s+1]);o.x!==0&&o.y!==0&&r.push(o)}return r},n.prototype.getPointAtLength=function(e,t,i){for(var r=0,a,s={x:0,y:0},o,h=0;h<t.length;h++){if(o=t[h],a){var l=b.findLength(a,o),d=void 0,f=void 0,p=void 0,c=void 0;if(r+l>=e){d=e-r,f=b.findAngle(a,o),p=d*Math.cos(f*Math.PI/180),c=d*Math.sin(f*Math.PI/180),s={x:a.x+p,y:a.y+c};break}else r+=l}else{a=o;continue}a=o}return s},n.prototype.getInterceptWithSegment=function(e,t){for(var i=[],r=[],a=[],s,o,h=b.findLength({x:0,y:0},{x:this.diagram.scroller.viewPortWidth,y:this.diagram.scroller.viewPortHeight}),l=1;l<t.length;l++){a=[t[l-1],t[l]],r=[],o=Math.round(b.findAngle(a[0],a[1])%360),s=Math.round(b.findAngle(a[1],a[0])%360);var d=o>0&&o<=90||o>180&&o<=270?90:-90;r.push(b.transform(e,o+d,h)),r.push(b.transform(e,s+d,h));var f={x1:a[0].x,y1:a[0].y,x2:a[1].x,y2:a[1].y},p={x1:r[0].x,y1:r[0].y,x2:r[1].x,y2:r[1].y},c=ea(f,p);c.enabled&&i.push(c.intersectPt)}return i},n.prototype.getAnnotationChanges=function(e,t){var i=ja(e,t.id,!0),r={};return r[i]={width:t.width,height:t.height,offset:e instanceof M?{x:t.offset.x,y:t.offset.y}:t.offset,rotateAngle:t.rotateAngle,margin:{left:t.margin.left,right:t.margin.right,top:t.margin.top,bottom:t.margin.bottom},horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,alignment:e instanceof B?t.alignment:void 0},{annotations:r}},n.prototype.getConnectorPortChanges=function(e,t){var i=R0(e,t.id),r={};return r[i]={width:t.width,height:t.height,offset:t.offset,margin:{left:t.margin.left,right:t.margin.right,top:t.margin.top,bottom:t.margin.bottom},horizontalAlignment:t.horizontalAlignment,verticalAlignment:t.verticalAlignment,alignment:e instanceof B?t.alignment:void 0},{ports:r}},n.prototype.getPortChanges=function(e,t){var i=ja(e,t.id,!1),r={};return r[i]={offset:t.offset},{ports:r}},n.prototype.labelRotate=function(e,t,i,r){var a,s;a=this.getAnnotationChanges(e,t),xt(),t.rotateAngle;var o=this.diagram.getWrapper(e.wrapper,t.id),h=0,l=0;o.flippedPoint&&(h=o.flippedPoint.x-o.corners.topLeft.x,l=o.flippedPoint.y-o.corners.topLeft.y);var d=At({x:o.offsetX+h,y:o.offsetY+l},i)+90,f=this.snapAngle(d);if(d=f!==0?f:d,t instanceof Qt&&t.segmentAngle){var p=Ko(e.intermediatePoints,t,e.wrapper.bounds);d-=p.angle}d=(d+360)%360,t.rotateAngle+=d-(t.rotateAngle+o.parentTransform),t instanceof Qt&&(t.alignment="Center");var c=o.rotateAngle;o.rotateAngle=t.rotateAngle,r.wrapper.rotateAngle=r.rotateAngle=t.rotateAngle,o.rotateAngle=this.diagram.canRotateOnNegativeAxis(o)?t.rotateAngle:t.rotateAngle=c,s=this.getAnnotationChanges(e,t),e instanceof M?this.diagram.nodePropertyChange(e,a,s):this.diagram.connectorPropertyChange(e,a,s),this.diagram.updateDiagramObject(e);for(var u=0,g=this.diagram.views;u<g.length;u++){var v=g[u],m=this.diagram.views[v];m instanceof Xe||this.diagram.refreshCanvasDiagramLayer(m)}},n.prototype.labelResize=function(e,t,i,r,a,s){var o,h,l;o=this.getAnnotationChanges(e,t);var d=s.wrapper.children[0];if(i&&i!==1||r&&r!==1){var f=xt(),p=xt();Rt(f,-e.rotateAngle,e.offsetX,e.offsetY),l=(d.rotateAngle+(e instanceof M?e.rotateAngle:0)+360)%360,Rt(p,-l,a.x,a.y),Or(p,i,r,a.x,a.y),Rt(p,l,a.x,a.y);var c=st(p,{x:d.offsetX,y:d.offsetY}),u=d.actualSize.height*r,g=d.actualSize.width*i;if(this.diagram.constraints&lt.RestrictNegativeAxisDragDrop){var v={x:d.offsetX,y:d.offsetY},m=st(p,v),y=this.getRotatedAnnotationCorners(m,g,u,l),S=y.some(function(N){return N.x<0||N.y<0});if(S){i=1,r=1,g=d.actualSize.width,u=d.actualSize.height;return}}var x=this.findTarget(d,e);if(x instanceof Qt&&(c.y+=x.verticalAlignment==="Top"?-u/2:x.verticalAlignment==="Bottom"?u/2:0,c.x+=x.horizontalAlignment==="Left"?-g/2:x.horizontalAlignment==="Right"?g/2:0),x instanceof Qt)this.updatePathAnnotationOffset(e,t,0,0,c,new U(g,u));else{var I=se(e.wrapper);c=st(f,c),c.x=c.x-d.margin.left+d.margin.right,c.y=c.y-d.margin.top+d.margin.bottom,c.y+=x.verticalAlignment==="Top"?-u/2:x.verticalAlignment==="Bottom"?u/2:0,c.x+=x.horizontalAlignment==="Left"?-g/2:x.horizontalAlignment==="Right"?g/2:0;var C=I.width/(c.x-I.x),P=I.height/(c.y-I.y);if(g>1){x.width=g;var A=x.offset.x;x.offset.x=1/C,d.flippedPoint&&(d.flip===G.Horizontal||d.flip===G.Both)&&d.horizontalAlignment==="Center"&&(x.offset.x=A+A-x.offset.x)}if(u>1){x.height=u;var T=x.offset.y;x.offset.y=1/P,d.flippedPoint&&(d.flip===G.Vertical||d.flip===G.Both)&&d.verticalAlignment==="Center"&&(x.offset.y=T+T-x.offset.y)}}}t instanceof Qt&&(t.alignment="Center"),h=this.getAnnotationChanges(e,t),e instanceof M?this.diagram.nodePropertyChange(e,o,h):this.diagram.connectorPropertyChange(e,o,h),this.diagram.updateDiagramObject(e);for(var z=0,L=this.diagram.views;z<L.length;z++){var R=L[z],O=this.diagram.views[R];O instanceof Xe||this.diagram.refreshCanvasDiagramLayer(O)}},n.prototype.getSubProcess=function(e){var t={nodes:[],connectors:[]},i;return e instanceof M?i=e.processId:e&&e.nodes&&e.nodes.length&&e.nodes[0].processId&&(i=e.nodes[0].processId),i&&t.nodes.push(E(this.diagram.nameTable[i])),t},n.prototype.getContainer=function(e){var t={nodes:[],connectors:[]},i;return e instanceof M?i=e.parentId:e&&e.nodes&&e.nodes.length&&e.nodes[0].parentId&&(i=e.nodes[0].parentId),i&&t.nodes.push(E(this.diagram.nameTable[i])),t},n.prototype.checkBoundaryConstraints=function(e,t,i,r){var a=this.diagram.pageSettings,s=this.diagram.pageSettings.boundaryConstraints,o=this.diagram.scroller;if(s==="Page"||s==="Diagram"){var h=i?void 0:this.diagram.selectedItems.wrapper.bounds,l=s==="Page"?a.width:o.viewPortWidth,d=s==="Page"?a.height:o.viewPortHeight,f=i,p=(i?f.right:h.right)+(e||0),c=(i?f.left:h.left)+(e||0),u=(i?f.top:h.top)+(t||0),g=(i?f.bottom:h.bottom)+(t||0);return!!(p<=l&&c>=0&&g<=d&&u>=0||this.diagram.layout.type!=="None"&&r)}return!0},n.prototype.dragSelectedObjects=function(e,t){var i=this,r=this.diagram.selectedItems;this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=r.offsetX,this.state.backup.offsetY=r.offsetY),r=la(this.diagram,r)||r;var a=this.diagram.selectedItems.nodes.filter(function(f){return f.shape.type==="SwimLane"}),s=[];if(a.length>0&&!this.diagram.currentSymbol&&this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>1){var o=this.diagram.selectedItems.nodes.filter(function(f){return f.parentId===""||i.diagram.nameTable[f.parentId].shape.type!=="SwimLane"});if(o.length>0){for(var h=0;h<o.length;h++)(this.diagram.nameTable[o[parseInt(h.toString(),10)].parentId]&&this.diagram.nameTable[o[parseInt(h.toString(),10)].parentId].isLane||o[parseInt(h.toString(),10)].shape.type==="SwimLane")&&(o.splice(h,1),h--);for(var l=a.filter(function(f,p,c){return p===c.findIndex(function(u){return u.id===f.id})}),h=0;h<l.length;h++)s=s.concat(sr(this.diagram,l[h].wrapper.children[0]));(o.length>0||l.length>1||this.diagram.selectedItems.connectors.length>0)&&(o=o.concat(l),this.diagram.selectedItems.nodes.splice(0,this.diagram.selectedItems.nodes.length),o.forEach(function(f){i.diagram.selectedItems.nodes.push(f)}),r=this.diagram.selectedItems,this.diagram.selectedObject.helperObject=void 0)}}if(this.checkBoundaryConstraints(e,t)){this.diagram.diagramActions=this.diagram.diagramActions|(k.PreventZIndexOnDragging|k.DragUsingMouse);var d=this.diagram.selectedObject.actualObject;return(d&&d instanceof M&&d.isLane&&go(d,this.diagram)||!d||!d.isLane)&&(this.diagram.drag(r,e,t),Pr(s,this.diagram)),this.diagram.diagramActions=this.diagram.diagramActions&~(k.PreventZIndexOnDragging|k.DragUsingMouse),this.diagram.refreshCanvasLayers(),this.checkHtmlObjectDrag(r),!0}return!1},n.prototype.checkHtmlObjectDrag=function(e){var t=!1;this.diagram.views&&this.diagram.views.length>1&&(e instanceof It?t=e.nodes.some(function(i){return i.shape&&i.shape.type==="HTML"}):e.shape&&e.shape.type==="HTML"&&(t=!0),t&&this.resetOverviewCanvas())},n.prototype.resetOverviewCanvas=function(){for(var e=0,t=this.diagram.views;e<t.length;e++){var i=t[e],r=this.diagram.views[i];if(!(r instanceof Xe)){var a=document.getElementById(r.canvas.id+"overviewrect"),s=Number(a.getAttribute("x")),o=Number(a.getAttribute("y")),h=Number(a.getAttribute("width")),l=Number(a.getAttribute("height")),d={x:s,y:o,width:Math.max(1,h),height:Math.max(1,l)};bi(a,d)}}},n.prototype.scaleSelectedItems=function(e,t,i){var r=this.diagram.selectedItems;this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.offsetX=r.offsetX,this.state.backup.offsetY=r.offsetY,this.state.backup.width=r.width,this.state.backup.height=r.height,this.state.backup.pivot=i),r=la(this.diagram,r)||r;var a=10;if((isNaN(e)||!isFinite(e))&&(e=1),(isNaN(t)||!isFinite(t))&&(t=1),r&&r.connectors&&r.connectors.length>0&&r.wrapper&&r.wrapper.actualSize){var s=r.wrapper.actualSize.width||r.width||0,o=r.wrapper.actualSize.height||r.height||0;s>0&&s*e<a&&(e=a/s),o>0&&o*t<a&&(t=a/o)}return r.width*e<1&&(e=1),r.height*t<1&&(t=1),this.diagram.scale(r,e,t,i)},n.prototype.rotateSelectedItems=function(e){var t=this.diagram.selectedItems;return this.state&&!this.state.backup&&(this.state.backup={},this.state.backup.angle=t.rotateAngle),t=la(this.diagram,t)||t,this.diagram.rotate(t,e,void 0,!0)},n.prototype.hasSelection=function(){return Si(this.diagram)},n.prototype.isSelected=function(e){return Ut(this.diagram,e)},n.prototype.initExpand=function(e){var t="isProtectedOnChange",i=this.diagram[t];this.diagram.protectPropertyChange(!0);var r=e.target||e.source,a={isExpanded:r.isExpanded};r.isExpanded=!r.isExpanded,this.diagram.preventNodesUpdate=!0,this.diagram.diagramActions|=k.PreventIconsUpdate,this.diagram.nodePropertyChange(r,a,{isExpanded:r.isExpanded}),this.diagram.diagramActions=this.diagram.diagramActions&~k.PreventIconsUpdate,this.diagram.preventNodesUpdate=!1;for(var s=0,o=this.diagram.views;s<o.length;s++){var h=o[s],l=this.diagram.views[h];l instanceof Xe||this.diagram.refreshCanvasDiagramLayer(l)}this.diagram.protectPropertyChange(i)},n.prototype.expandNode=function(e,t,i){var r=this.diagram.preventNodesUpdate,a=e.isExpanded;this.diagram.preventNodesUpdate=!0,this.expandCollapse(e,a,this.diagram,void 0),e.isExpanded=a;var s=this.diagram.layout.fixedNode;this.diagram.layout.fixedNode=e.id,this.diagram.diagramActions!=k.Render&&this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&this.diagram.organizationalChartModule&&(this.diagram.organizationalChartModule.isAnimation=!0),this.diagram.blazorActions|=jt.expandNode;var o={};if(i||(this.layoutAnimateModule&&this.layoutAnimateModule.setIntervalObject.length>0&&(this.layoutAnimateModule.stopCurrentAnimation(this.objectStore[0],t,e),this.objectStore=[]),o=this.diagram.doLayout(),this.objectStore.push(o)),this.canUpdateTemplate=!1,this.diagram.blazorActions&=~jt.expandNode,this.diagram.preventNodesUpdate=r,this.diagram.layoutAnimateModule&&this.diagram.organizationalChartModule&&!i)this.diagram.allowServerDataBinding=!1,this.layoutAnimateModule.expand(this.diagram.layout.enableAnimation,o,e,this.diagram);else{var h={element:E(e),state:!!e.isExpanded};this.triggerEvent(Z.expandStateChange,h),this.diagram.lineRoutingModule&&this.diagram.constraints&lt.LineRouting&&this.diagram.layout.type!=="ComplexHierarchicalTree"&&this.diagram.resetSegments()}return this.diagram.layout.fixedNode=s===""?"":this.diagram.layout.fixedNode,o},n.prototype.getparentexpand=function(e,t,i,r){for(var a,s=0;s<e.inEdges.length;s++){var o=t.nameTable[e.inEdges[s]],h=t.nameTable[o.sourceID];if(h.isExpanded&&!i&&h.id!==r.sourceID&&o.visible)return!1;a=!0}return a},n.prototype.expandCollapse=function(e,t,i,r){if((!r||r.length===0)&&(r=[]),!r.some(function(f){return f.id===e.id})){r.push(e);for(var a=0;a<e.outEdges.length;a++){var s=i.nameTable[e.outEdges[a]],o=i.nameTable[s.targetID],h=this.getparentexpand(o,i,t,s);s.visible=t;var l={visible:o.visible,style:{opacity:o.wrapper.style.opacity}},d={visible:o.visible,style:{opacity:o.wrapper.style.opacity}};h&&(o.isExpanded&&this.expandCollapse(o,t,i,r),o.visible=t,o.style.opacity=this.diagram.layoutAnimateModule&&this.diagram.layout.enableAnimation&&t?.1:o.style.opacity,i.nodePropertyChange(o,l,d)),i.connectorPropertyChange(s,l,d)}}},n.prototype.updateNodeDimension=function(e,t){e instanceof M&&(e.offsetX=t.x+t.width/2,e.offsetY=t.y+t.height/2,e.width=t.width,e.height=t.height,e.wrapper.children[0].canMeasurePath=!0,this.diagram.nodePropertyChange(e,{},{width:t.width,height:t.height,offsetX:e.offsetX,offsetY:e.offsetY}),this.diagram.mode!=="SVG"&&this.diagram.refreshDiagramLayer())},n.prototype.updateConnectorPoints=function(e,t){e instanceof B&&e.type!=="Bezier"?(this.diagram.connectorPropertyChange(e,{},{targetPoint:e.targetPoint}),this.diagram.updateDiagramObject(e)):(this.diagram.connectorPropertyChange(e,{},{segments:e.segments}),this.diagram.updateDiagramObject(e))},n.prototype.updateSelectedNodeProperties=function(e){if(this.diagram.lineRoutingModule&&this.diagram.constraints&lt.LineRouting){this.diagram.protectPropertyChange(!0);var t=[],i=[],r=this.diagram.selectedObject.actualObject,a=this.diagram.selectedObject.helperObject,s=r instanceof It?E(r):void 0;if(a&&r){var o=a.offsetX-r.offsetX,h=a.offsetY-r.offsetY,l=a.width-r.width,d=a.height-r.height,f=a.rotateAngle-r.rotateAngle;if(this.diagram.selectedItems.nodes.length+this.diagram.selectedItems.connectors.length>0&&(this.diagram.selectedItems.wrapper.rotateAngle=this.diagram.selectedItems.rotateAngle=a.rotateAngle),r instanceof M&&r.shape.type!=="SwimLane"&&!r.isLane&&!r.isPhase&&!r.isHeader&&!ne(this.diagram,r))(r.offsetX!==r.wrapper.offsetX||r.offsetY!==r.wrapper.offsetY||r.width!==r.wrapper.width||r.height!==r.wrapper.height||r.rotateAngle!==r.wrapper.rotateAngle)&&(r.offsetX+=o,r.offsetY+=h,r.width+=l,r.height+=d,r.rotateAngle+=f,this.diagram.nodePropertyChange(r,{},{offsetX:r.offsetX,offsetY:r.offsetY,width:r.width,height:r.height,rotateAngle:r.rotateAngle},!1,!0)),t=this.diagram.spatialSearch.findObjects(r.wrapper.outerBounds);else if(r instanceof It){var p=a.width/r.width,c=a.height/r.height,u=this.diagram.eventHandler.tool.getPivot(this.diagram.eventHandler.tool.corner);if(this.diagram.eventHandler.tool.corner)for(var g=0;g<r.nodes.length;g++){var v=r.nodes[parseInt(g.toString(),10)],m=v.wrapper,y=r.wrapper,S=y.offsetX-y.actualSize.width*y.pivot.x,x=y.offsetY-y.actualSize.height*y.pivot.y,I=ts(S,x,y.actualSize.width,y.actualSize.height,y.rotateAngle,y.offsetX,y.offsetY,u);this.diagram.commandHandler.scaleObject(p,c,I,v,m,r)}else{for(var g=0;g<r.nodes.length;g++){var v=r.nodes[g];if(v instanceof M&&v.shape.type!=="SwimLane"&&!ne(this.diagram,v)&&!v.isLane&&!v.isPhase&&!v.isHeader){v.constraints&W.Drag&&(v.offsetX+=o,v.offsetY+=h),v.width+=l,v.height+=d;var C=v.rotateAngle;v.rotateAngle+=f;var P=C!==v.rotateAngle,A={offsetX:v.offsetX,offsetY:v.offsetY,width:v.width,height:v.height,rotateAngle:v.rotateAngle};P||delete A.rotateAngle,this.diagram.nodePropertyChange(v,{},A),t=t.concat(this.diagram.spatialSearch.findObjects(r.wrapper.outerBounds))}}if(this.diagram.lineRoutingModule)for(var g=0;g<r.connectors.length;g++){var T=r.connectors[g],z={sourcePoint:T.sourcePoint,targetPoint:T.targetPoint,sourceID:T.sourceID,targetID:T.targetID,sourcePortID:T.sourcePortID,targetPortID:T.targetPortID};this.diagram.connectorPropertyChange(T,{},z,void 0,!0)}}}}else if(e instanceof B?t.push(e):e instanceof It&&e.connectors.length&&(t=t.concat(e.connectors)),e instanceof It&&this.diagram.nodes.indexOf(e.nodes[0])!==-1){var v=r||e.nodes[0];v instanceof M&&v.shape.type!=="SwimLane"&&!ne(this.diagram,v)&&!v.isLane&&!v.isPhase&&!v.isHeader&&(t=t.concat(this.diagram.spatialSearch.findObjects(v.wrapper.outerBounds)))}for(var g=0;g<t.length;g++)t[g]instanceof B&&i.indexOf(t[g].id)===-1&&i.push(t[g].id);(i.length>0||this.diagram.routedConnectors.length>0)&&(this.diagram.avoidLineOverlappingModule&&(this.diagram.avoidLineOverlappingModule.removeConnectors(i),this.diagram.avoidLineOverlappingModule.removeConnectors(this.diagram.routedConnectors)),this.diagram.lineRoutingModule.renderVirtualRegion(this.diagram,!0)),this.diagram.lineRoutingModule.skipObstacleCheck=!0;for(var g=0;g<this.diagram.routedConnectors.length;g++){var T=this.diagram.nameTable[this.diagram.routedConnectors[g]];this.ReRouteConnector(T)}this.diagram.lineRoutingModule.skipObstacleCheck=!1;for(var g=0;g<i.length;g++){var T=this.diagram.nameTable[i[g]];this.diagram.routedConnectors.indexOf(T.id)===-1&&this.ReRouteConnector(T)}if(this.diagram.routedConnectors=[],a&&r&&s&&this.diagram.eventHandler.currentAction==="Drag"){for(var L=!1,R=this.diagram.nameTable,g=0;g<r.nodes.length;g++)R[r.nodes[g].parentId]&&R[r.nodes[g].parentId].isLane||(L=!0);if(L){var O=E(r);this.diagram.startGroupAction();var N={type:"PositionChanged",redoObject:E(O),undoObject:s,category:"Internal"};this.diagram.addHistoryEntry(N),this.diagram.endGroupAction()}}this.updateSelector(),this.diagram.protectPropertyChange(!1)}},n.prototype.drawSelectionRectangle=function(e,t,i,r){this.diagram.drawSelectionRectangle(e,t,i,r)},n.prototype.ReRouteConnector=function(e){if(e instanceof B&&e.type==="Orthogonal"&&e.sourceID&&e.targetID&&e.sourceID!=e.targetID&&this.diagram.layout.type!=="ComplexHierarchicalTree"){var t=this.diagram.getObject(e.sourceID),i=this.diagram.getObject(e.targetID),r=i.offsetX>t.offsetX?i.wrapper.outerBounds.middleLeft.x-t.wrapper.outerBounds.middleRight.x:t.wrapper.outerBounds.middleLeft.x-i.wrapper.outerBounds.middleRight.x,a=i.offsetY>t.offsetY?i.wrapper.outerBounds.topCenter.y-t.wrapper.outerBounds.bottomCenter.y:t.wrapper.outerBounds.topCenter.y-i.wrapper.outerBounds.bottomCenter.y;(r>30||a>30)&&this.diagram.lineRoutingModule.refreshConnectorSegments(this.diagram,e,!0)}},n.prototype.startGroupAction=function(){this.diagram.startGroupAction()},n.prototype.endGroupAction=function(){this.diagram.endGroupAction()},n.prototype.removeChildFromBPmn=function(e,t,i){var r=this,a=this.diagram.nameTable[e.id]||e.nodes[0];if(i){if(a&&a.processId&&a.processId===i.wrapper.id){var s=E(a);s.processId=a.processId;var o=this.diagram.nameTable[a.processId].shape.activity.subProcess.processes||[];if(a.hasTextAnnotation){var h=a.outEdges.concat(a.inEdges);h.forEach(function(d){var f=r.diagram.nameTable[d],p=f.targetID,c=o.indexOf(p);c!==-1&&(o.splice(c,1),r.diagram.bpmnModule.removeChildFromBPMN(r.diagram.nameTable[a.processId].wrapper,p,r.diagram),r.diagram.nameTable[p].processId="")})}o.splice(o.indexOf(a.id),1),this.diagram.bpmnModule.removeChildFromBPMN(this.diagram.nameTable[a.processId].wrapper,a.id,this.diagram),this.diagram.nameTable[a.id].processId="",a.offsetX=a.wrapper.offsetX,a.offsetY=a.wrapper.offsetY}else if(a&&a.parentId&&a.parentId===i.wrapper.id&&this.diagram.nameTable[a.parentId].shape instanceof Sr){var s=E(a);s.parentId=a.parentId;var l=this.diagram.nameTable[a.parentId].shape.children||[];l.splice(l.indexOf(a.id),1),gs(this.diagram.nameTable[a.parentId].wrapper,a.id,this.diagram),this.diagram.nameTable[a.id].parentId="",a.offsetX=a.wrapper.offsetX,a.offsetY=a.wrapper.offsetY}}},n.prototype.isDroppable=function(e,t){var i=this.diagram.nameTable[e.id]||e.nodes[0]||e.connectors[0];return i instanceof M||i instanceof B?i.shape.shape==="TextAnnotation"?!0:(t.shape.shape==="Group"&&(t.shape.activity.subProcess.collapsed=!1),!(i&&i.shape.type==="Bpmn"&&(i.processId===t.id||i.id===t.processId||t.shape.type==="Bpmn"&&!(t instanceof B)&&t.shape.activity&&t.shape.activity.subProcess&&t.shape.activity.subProcess.collapsed)||i&&(i.parentId===t.id||i.id===t.parentId)&&t.shape.type==="Container"&&!(t instanceof B)||i&&i.shape.type==="Container"&&t.isLane||i&&i.shape.type==="SwimLane"&&t.shape.type==="Container")):!1},n.prototype.renderHighlighter=function(e,t,i){if(new it,e.target instanceof M||e.target instanceof B||t&&(e.source instanceof M||e.source instanceof B)){var r=t?e.source:e.target,a=t?e.sourceWrapper:e.targetWrapper,s=this.findTarget(a,r,i,!0),o=void 0;if(s instanceof Ir)for(var h=s.id,l=e.target,d=l.wrapper.children[0].children[0].children[2],f=0,p=d.children;f<p.length;f++){var c=p[f];if(c.id===l.id+"_"+h){o=c.children[0];break}}else o=s instanceof M?s.wrapper:t?e.sourceWrapper:e.targetWrapper;o&&!(s instanceof B)&&this.diagram.renderHighlighter(o)}},n.prototype.mouseOver=function(e,t,i){return!0},n.prototype.snapPoint=function(e,t,i,r){var a=this.diagram.selectedItems,s,o=t.x<e.x,h=t.y<e.y;s={x:i,y:r};var l=s;return this.snappingModule&&(a.nodes.length>0&&a.nodes[0].constraints&W.Drag||a.connectors.length>0&&a.connectors[0].constraints&yt.Drag)&&(l=this.diagram.snappingModule.snapPoint(this.diagram,a,o,h,s,e,t)),l},n.prototype.removeSnap=function(){this.diagram.snapSettings.constraints&pi.SnapToObject&&this.snappingModule&&this.snappingModule.removeGuidelines(this.diagram)},n.prototype.dropAnnotation=function(e,t){if(e instanceof M||e instanceof It){var i=e instanceof M?e:e.nodes[0];if(this.diagram.bpmnModule&&t.shape.type==="Bpmn"&&i.shape.shape==="TextAnnotation"){var r="hasTarget";i[r]=t.id,i.shape.annotation.nodeId=t.id,this.diagram.currentSymbol||(this.diagram.addTextAnnotation(i.shape.annotation,t),i.shape.annotation.nodeId="",this.diagram.remove(i)),this.diagram.refreshDiagramLayer()}}},n.prototype.drop=function(e,t,i){if(this.diagram.bpmnModule&&t.shape.type!=="Container"){var r=e instanceof M?[e]:e.nodes;if(r){for(var a=0;a<r.length;a++){var s=r[a];if(s&&s.shape.type==="Bpmn"&&t instanceof M&&t.shape.type==="Bpmn"&&!(t instanceof B)&&(this.diagram.bpmnModule.dropBPMNchild(t,s,this.diagram),s.hasTextAnnotation))for(var o=0;o<s.outEdges.length;o++){var h=this.diagram.nameTable[s.outEdges[parseInt(o.toString(),10)]];if(h.isBpmnAnnotationConnector){var l=this.diagram.nameTable[h.targetID];this.diagram.bpmnModule.dropBPMNchild(t,l,this.diagram)}}}this.diagram.refreshDiagramLayer()}}else if(t.shape.type==="Container"){for(var d=e instanceof M?[e]:e.nodes,f=0;f<d.length;f++){var p=d[f];mf(t,p,this.diagram)}this.diagram.refreshDiagramLayer()}},n.prototype.addHistoryEntry=function(e){this.diagram.addHistoryEntry(e)},n.prototype.align=function(e,t,i){if(e.length>0){var r=0;e[0]=this.diagram.nameTable[e[0].id]||e[0];var a=i==="Object"?ze(e[0].wrapper):this.diagram.selectedItems.wrapper.bounds,s={nodes:[],connectors:[]},o={nodes:[],connectors:[]};for(r=i==="Object"?r+1:r;r<e.length;r++){var h=0,l=0;e[r]=this.diagram.nameTable[e[r].id]||e[r];var d=ze(e[r].wrapper);t==="Left"?h=a.left+d.width/2-d.center.x:t==="Right"?h=a.right-d.width/2-d.center.x:t==="Top"?l=a.top+d.height/2-d.center.y:t==="Bottom"?l=a.bottom-d.height/2-d.center.y:t==="Center"?h=a.center.x-d.center.x:t==="Middle"&&(l=a.center.y-d.center.y),s=this.storeObject(s,e[r]),this.drag(e[r],h,l),this.diagram.updateSelector(),o=this.storeObject(o,e[r])}s=E(s),o=E(o);var f={type:"Align",category:"Internal",undoObject:E(s),redoObject:E(o)};this.addHistoryEntry(f)}},n.prototype.distribute=function(e,t){if(e.length>0){var i=0,r=0,a=0,s=0,o=0,h=0,l=0,d=0,f=0,p={nodes:[],connectors:[]},c={nodes:[],connectors:[]};for(i=0;i<e.length;i++)e[i]=this.diagram.nameTable[e[i].id]||e[i];for(e=g0(e,t),i=1;i<e.length;i++)r=r+e[i].wrapper.bounds.topRight.x-e[i-1].wrapper.bounds.topRight.x,a=a+e[i].wrapper.bounds.topLeft.x-e[i-1].wrapper.bounds.topLeft.x,s=s+e[i].wrapper.bounds.topRight.y-e[i-1].wrapper.bounds.topRight.y,o=o+e[i].wrapper.bounds.bottomRight.y-e[i-1].wrapper.bounds.bottomRight.y,h=h+e[i].wrapper.bounds.center.x-e[i-1].wrapper.bounds.center.x,l=l+e[i].wrapper.bounds.center.y-e[i-1].wrapper.bounds.center.y,d=d+e[i].wrapper.bounds.topRight.y-e[i-1].wrapper.bounds.bottomRight.y,f=f+e[i].wrapper.bounds.middleLeft.x-e[i-1].wrapper.bounds.middleRight.x;for(i=1;i<e.length-1;i++){var u=0,g=0,v=ze(e[i-1].wrapper),m=ze(e[i].wrapper);t==="Center"?u=v.center.x-m.center.x+h/(e.length-1):t==="RightToLeft"?u=v.middleRight.x-m.middleLeft.x+f/(e.length-1):t==="Right"?u=v.topRight.x-m.topRight.x+r/(e.length-1):t==="Left"?u=v.topLeft.x-m.topLeft.x+a/(e.length-1):t==="Middle"?g=v.center.y-m.center.y+l/(e.length-1):t==="Top"?g=v.topRight.y-m.topRight.y+s/(e.length-1):t==="Bottom"?g=v.bottomRight.y-m.bottomRight.y+o/(e.length-1):t==="BottomToTop"&&(g=v.bottomRight.y-m.topRight.y+d/(e.length-1)),p=this.storeObject(p,e[i]),this.drag(e[i],u,g),this.diagram.updateSelector(),c=this.storeObject(c,e[i])}p=E(p),c=E(c);var y={type:"Distribute",category:"Internal",undoObject:E(p),redoObject:E(c)};this.addHistoryEntry(y)}},n.prototype.sameSize=function(e,t){if(e.length>0){var i=0,r={x:.5,y:.5};e[0]=this.diagram.nameTable[e[0].id]||e[0];var a=ze(e[0].wrapper),s={nodes:[],connectors:[]},o={nodes:[],connectors:[]};for(i=1;i<e.length;i++){e[parseInt(i.toString(),10)]=this.diagram.nameTable[e[parseInt(i.toString(),10)].id]||e[0];var h=ze(e[parseInt(i.toString(),10)].wrapper),l=1,d=1;t==="Width"?l=a.width/h.width:t==="Height"?d=a.height/h.height:t==="Size"&&(l=a.width/h.width,d=a.height/h.height),s=this.storeObject(s,e[parseInt(i.toString(),10)]),this.scale(e[parseInt(i.toString(),10)],l,d,r),o=this.storeObject(o,e[parseInt(i.toString(),10)])}this.diagram.updateSelector(),s=E(s),o=E(o);var f={type:"Sizing",category:"Internal",undoObject:E(s),redoObject:E(o)};this.addHistoryEntry(f)}},n.prototype.storeObject=function(e,t){return t instanceof M?e.nodes.push(E(t)):e.connectors.push(E(t)),e},n.prototype.updatePanState=function(e){if(e)this.diagram.realActions=this.diagram.realActions|Vt.PanInProgress;else{this.diagram.dataBind();var t=this.diagram.scrollSettings,i=this.diagram.initialScrollValues;this.diagram.realActions=this.diagram.realActions&~Vt.PanInProgress;var r={VerticalOffset:i?i.VerticalOffset:t.verticalOffset,HorizontalOffset:i?i.HorizontalOffset:t.horizontalOffset,ViewportHeight:i?i.ViewportHeight:t.viewPortHeight,ViewportWidth:i?i.ViewportWidth:t.viewPortWidth,CurrentZoom:i?i.CurrentZoom:t.currentZoom},a={VerticalOffset:t.verticalOffset,HorizontalOffset:t.horizontalOffset,ViewportHeight:t.viewPortHeight,ViewportWidth:t.viewPortWidth,CurrentZoom:t.currentZoom},s={oldValue:r,newValue:a,source:this.diagram,panState:"Completed"};this.triggerEvent(Z.scrollChange,s)}},n.prototype.dataBinding=function(){this.diagram.dataBind()},n.prototype.setBlazorDiagramProps=function(e){this.diagram.setBlazorDiagramProps(e)},n.prototype.scroll=function(e,t,i){var r=Zv(this.diagram),a=$v(this.diagram),s=!0;this.diagram.pan((e=r?e:0)*this.diagram.scroller.currentZoom,(t=a?t:0)*this.diagram.scroller.currentZoom,i,s)},n.prototype.drawHighlighter=function(e){this.diagram.renderHighlighter(e.wrapper)},n.prototype.removeHighlighter=function(){this.diagram.clearHighlighter()},n.prototype.renderContainerHelper=function(e){return la(this.diagram,e)},n.prototype.isParentAsContainer=function(e,t){return ne(this.diagram,e,t)},n.prototype.isTargetSubProcess=function(e){return!!(e&&e.shape&&e.shape.type==="Bpmn"&&e.shape.activity&&e.shape.activity.activity==="SubProcess")},n.prototype.dropChildToContainer=function(e,t){if(!(this.diagram.diagramActions&k.PreventLaneContainerUpdate)&&(zn(this.diagram,e,t),t.hasTextAnnotation))for(var i=0;i<t.outEdges.length;i++){var r=this.diagram.nameTable[t.outEdges[parseInt(i.toString(),10)]];if(r.isBpmnAnnotationConnector){var a=this.diagram.nameTable[r.targetID];zn(this.diagram,e,a)}}},n.prototype.updateLaneChildrenZindex=function(e,t){var i=this.findLeastIndexObject(e,t),r=this.diagram.nameTable[t.parentId];if(r&&r.zIndex>i.zIndex){for(var a=this.diagram.layers.indexOf(this.diagram.getActiveLayer()),s=this.diagram.layers[parseInt(a.toString(),10)].zIndexTable,o=JSON.parse(JSON.stringify(s)),h=i.zIndex,l=r.zIndex,d=l;d>=h;d--)h!==d?s[d-1]?(s[parseInt(d.toString(),10)]=s[d-1],this.diagram.nameTable[s[parseInt(d.toString(),10)]].zIndex=d):(s[d-1]=s[parseInt(d.toString(),10)],this.diagram.nameTable[s[d-1]].zIndex=d,delete s[parseInt(d.toString(),10)]):this.swapZIndexObjects(l,s,r.id,o);this.diagram.mode==="SVG"?(this.moveSvgNode(t.parentId,i.id),this.updateNativeNodeIndex(t.parentId,i.id)):this.diagram.refreshCanvasLayers()}},n.prototype.findLeastIndexConnector=function(e,t,i){for(var r=0;r<e.length;r++){var a=this.diagram.nameTable[e[parseInt(r.toString(),10)]];i.zIndex>a.zIndex&&(i=a)}return i},n.prototype.findLeastIndexObject=function(e,t){var i=e;return e instanceof M&&(i=this.findLeastIndexConnector(e.inEdges,t,i),i=this.findLeastIndexConnector(e.outEdges,t,i)),i},n.prototype.checkSelection=function(e,t){var i;if(e.nodes.length===1&&e.connectors.length===0)if(ne(this.diagram,e.nodes[0],!0)){i=e.nodes[0].shape==="SwimLane"?e.nodes[0]:this.diagram.nameTable[e.nodes[0].parentId];var r=e.nodes[0];if(i.shape.type==="SwimLane"){var a=i.shape.orientation==="Horizontal";(r.isPhase&&(a&&t==="ResizeSouth"||!a&&t==="ResizeEast")||r.isLane&&(a&&t==="ResizeEast"||!a&&t==="ResizeSouth"))&&el(this.diagram,i,t)}else if(i.container.type==="Grid"){if(i.container.orientation==="Horizontal"&&r.rowIndex===1||i.container.orientation==="Vertical"&&r.rowIndex>0&&r.columnIndex>0){if(t==="ResizeSouth")for(var s=0;s<this.diagram.nodes.length;s++){var o=this.diagram.nodes[parseInt(s.toString(),10)];if(o.rowIndex===i.rows.length-1&&o.columnIndex===0){this.select(o);break}}}else if(t==="ResizeEast")for(var s=0;s<this.diagram.nodes.length;s++){var o=this.diagram.nodes[parseInt(s.toString(),10)];if(o.rowIndex===1&&o.columnIndex===i.columns.length-1){this.select(o);break}}}}else el(this.diagram,e.nodes[0],t)},n.prototype.zoom=function(e,t,i,r){this.diagram.scroller.zoom(e,t*this.diagram.scroller.currentZoom,i*this.diagram.scroller.currentZoom,r)},n})(),iS=(function(){function n(e){this.transform={tx:0,ty:0,scale:1},this.oldCollectionObjects=[],this.removeCollection=[],this.vPortWidth=0,this.vPortHeight=0,this.currentZoomFActor=1,this.hOffset=0,this.vOffset=0,this.scrolled=!1,this.hScrollSize=0,this.vScrollSize=0,this.diagram=e,this.objects=[],this.transform=e.scroller?e.scroller.transform:{tx:0,ty:0,scale:1},this.vPortWidth=e.scrollSettings.viewPortWidth,this.vPortHeight=e.scrollSettings.viewPortHeight,this.currentZoomFActor=e.scrollSettings.currentZoom,this.hOffset=e.scrollSettings.horizontalOffset,this.vOffset=e.scrollSettings.verticalOffset}return Object.defineProperty(n.prototype,"viewPortHeight",{get:function(){return this.vPortHeight},set:function(e){this.vPortHeight=e,this.diagram.scrollSettings.viewPortHeight=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"currentZoom",{get:function(){return this.currentZoomFActor||1},set:function(e){this.currentZoomFActor=e,this.diagram.scrollSettings.currentZoom=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewPortWidth",{get:function(){return this.vPortWidth},set:function(e){this.vPortWidth=e,this.diagram.scrollSettings.viewPortWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"horizontalOffset",{get:function(){return this.hOffset},set:function(e){this.hOffset=e,Math.abs(this.hOffset-this.diagram.scrollSettings.horizontalOffset)>1&&(this.diagram.realActions=this.diagram.realActions|Vt.hScrollbarMoved,this.scrolled=!0),this.diagram.scrollSettings.horizontalOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"verticalOffset",{get:function(){return this.vOffset},set:function(e){this.vOffset=e,Math.abs(this.vOffset-this.diagram.scrollSettings.verticalOffset)>1&&(this.diagram.realActions=this.diagram.realActions|Vt.vScrollbarMoved,this.scrolled=!0),this.diagram.scrollSettings.verticalOffset=e},enumerable:!0,configurable:!0}),n.prototype.getBounds=function(){var e,t=this.diagram.spatialSearch.getPageBounds(0,0);return(t.x<0||t.y<0)&&!this.diagram.pageSettings.multiplePage?e=this.getPageBounds(void 0,void 0,!0,!0):e=this.getPageBounds(void 0,void 0,!0),e},n.prototype.updateScrollOffsets=function(e,t){var i=0,r=0,a=this.getBounds();a.x*=this.currentZoom,a.y*=this.currentZoom,a.width*=this.currentZoom,a.height*=this.currentZoom,i=Math.max(0,e-a.left),r=Math.max(0,t-a.top),e!==void 0&&t!==void 0?(this.horizontalOffset=i,this.verticalOffset=r,this.diagram.setOffset(i,r)):this.diagram.setOffset(-this.horizontalOffset-a.x,-this.verticalOffset-a.y),this.transform={tx:Math.max(this.horizontalOffset,-a.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-a.top)/this.currentZoom,scale:this.currentZoom}},n.prototype.setScrollOffset=function(e,t){this.scrolled=!1;var i=this.getBounds();i.x*=this.currentZoom,i.y*=this.currentZoom,i.width*=this.currentZoom,i.height*=this.currentZoom;var r=-i.left,a=-i.top,s=r-e;s!==this.horizontalOffset&&(r<this.horizontalOffset?this.horizontalOffset>s?this.horizontalOffset-=e:this.horizontalOffset=s:this.horizontalOffset=s);var o=a-t;o!==this.verticalOffset&&(a<this.verticalOffset?this.verticalOffset>o?this.verticalOffset-=t:this.verticalOffset=o:this.verticalOffset=o),this.transform={tx:Math.max(this.horizontalOffset,-i.left)/this.currentZoom,ty:Math.max(this.verticalOffset,-i.top)/this.currentZoom,scale:this.currentZoom},this.setSize()},n.prototype.getObjects=function(e,t){for(var i=[],r=new Set(t),a=0;a<e.length;a++)r.has(e[parseInt(a.toString(),10)])||i.push(e[parseInt(a.toString(),10)]);return i},n.prototype.virtualizeElements=function(){for(var e=this.viewPortWidth/this.currentZoom,t=this.viewPortHeight/this.currentZoom,i=this.diagram.spatialSearch.findObjects(new it(-this.horizontalOffset/this.currentZoom,-this.verticalOffset/this.currentZoom,e,t)),r=[],a=[],s=0;s<i.length;s++){var o=i[parseInt(s.toString(),10)].shape;if(o.type==="Bpmn"&&o&&o.activity&&o.activity.subProcess&&o.activity.subProcess.processes&&o.activity.subProcess.processes.length>0){for(var h=0;h<o.activity.subProcess.processes.length;h++)a.push(o.activity.subProcess.processes[parseInt(h.toString(),10)]);a.push(i[parseInt(s.toString(),10)].id)}else(i[parseInt(s.toString(),10)].processId===""||i[parseInt(s.toString(),10)].processId===void 0)&&a.push(i[parseInt(s.toString(),10)].id)}r=a;for(var l=[],s=0;s<i.length;s++){var d=i[parseInt(s.toString(),10)].shape;if(d.type==="Bpmn"&&d&&d.activity&&d.activity.subProcess&&d.activity.subProcess.processes&&d.activity.subProcess.processes.length>0){l.push(i[parseInt(s.toString(),10)].id);for(var f=0;f<d.activity.subProcess.processes.length;f++)l.push(d.activity.subProcess.processes[parseInt(f.toString(),10)])}else(i[parseInt(s.toString(),10)].processId===""||i[parseInt(s.toString(),10)].processId===void 0)&&l.push(i[parseInt(s.toString(),10)].id)}for(var p={},h=0;h<l.length;h++)p[l[parseInt(h.toString(),10)]]=h;this.diagram.protectPropertyChange(!0);for(var s=0;s<i.length;s++){var c=i[parseInt(s.toString(),10)].id;c in p&&(i[parseInt(s.toString(),10)].zIndex=p[""+c])}this.diagram.protectPropertyChange(!1);var u=this.getObjects(r,this.oldCollectionObjects);this.oldCollectionObjects.length===0&&(this.oldCollectionObjects=r);var g=this.getObjects(this.oldCollectionObjects,r);this.diagram.updateVirtualObjects(u,!1,g),this.oldCollectionObjects=r},n.prototype.setSize=function(e){var t=this.getPageBounds(void 0,void 0,!0);t.x*=this.currentZoom,t.y*=this.currentZoom,t.width*=this.currentZoom,t.height*=this.currentZoom;var i=Math.min(t.x,-this.horizontalOffset),r=Math.min(t.y,-this.verticalOffset);-this.horizontalOffset+this.viewPortWidth-t.right,-this.verticalOffset+this.viewPortHeight-t.bottom;var a=this.scrollerWidth,s=this.scrollerWidth;-this.verticalOffset<=t.y&&-this.verticalOffset+this.viewPortHeight>=t.bottom&&(s=0),-this.horizontalOffset<=t.x&&-this.horizontalOffset+this.viewPortWidth>=t.right&&(a=0),this.hScrollSize=a,this.vScrollSize=s;var o=this.diagramWidth,h=this.diagramHeight;this.diagramWidth=Math.max(t.right,-this.horizontalOffset+this.viewPortWidth-s)-i,this.diagramHeight=Math.max(t.bottom,-this.verticalOffset+this.viewPortHeight-a)-r,(o!==this.diagramWidth||h!==this.diagramHeight)&&this.diagram.scrollSettings.scrollLimit!=="Diagram"&&this.diagram.setSize(this.diagramWidth,this.diagramHeight);var l=t.height>this.viewPortHeight||t.width>this.viewPortWidth;this.diagram.scrollSettings.scrollLimit==="Diagram"&&((o!==this.diagramWidth||h!==this.diagramHeight||this.currentZoom!==1)&&(!this.diagram.diagramActions||!e||this.diagram.diagramActions&&e&&(this.verticalOffset!==0||this.verticalOffset===e.y)&&(this.horizontalOffset!==0||this.horizontalOffset===e.x))?(this.diagram.scrollActions&ei.Interaction&&e&&l&&(this.transform={tx:Math.max(e.x,-(t.left/this.currentZoom))/this.currentZoom,ty:Math.max(e.y,-(t.top/this.currentZoom))/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=e.x,this.verticalOffset=e.y),this.diagram.setSize(this.diagramWidth,this.diagramHeight),!(this.diagram.scrollActions&ei.PropertyChange)&&e&&l&&(this.horizontalOffset=e.x,this.verticalOffset=e.y,this.transform={tx:Math.max(e.x,-t.left)/this.currentZoom,ty:Math.max(e.y,-t.top)/this.currentZoom,scale:this.currentZoom})):e&&o===this.diagramWidth&&h===this.diagramHeight&&(this.diagram.diagramCanvas.scrollHeight>this.viewPortHeight&&e.y<0&&this.horizontalOffset===e.x&&this.verticalOffset===0||this.diagram.diagramCanvas.scrollWidth>this.viewPortWidth&&e.x<0&&this.verticalOffset===e.y&&this.horizontalOffset===0)&&(this.verticalOffset=e.y,this.horizontalOffset=e.x,this.transform={tx:Math.max(e.x,-t.left)/this.currentZoom,ty:Math.max(e.y,-t.top)/this.currentZoom,scale:this.currentZoom})),this.diagram.transformLayers(),this.diagram.element.style.overflow="hidden"},n.prototype.setViewPortSize=function(e,t){this.viewPortWidth=e,this.viewPortHeight=t},n.prototype.getPageBounds=function(e,t,i,r){var a=new it,s;if(t!=="Content"&&!r&&this.diagram.pageSettings.width!==null&&this.diagram.pageSettings.height!==null){var o=this.diagram.pageSettings.width,h=this.diagram.pageSettings.height,l=0,d=0;if(this.diagram.pageSettings.multiplePage){if(a=this.diagram.spatialSearch.getPageBounds(0,0),a.right>o){var f=Math.ceil(a.right/o);o=o*f}if(a.bottom>h){var f=Math.ceil(a.bottom/h);h=h*f}if(a.left<0&&Math.abs(a.left)>l){var f=Math.ceil(Math.abs(a.left)/this.diagram.pageSettings.width);l=this.diagram.pageSettings.width*f}if(a.top<0&&Math.abs(a.top)>d){var f=Math.ceil(Math.abs(a.top)/this.diagram.pageSettings.height);d=this.diagram.pageSettings.height*f}}s=new it(-l,-d,o+l,h+d)}else{var p=e?void 0:0;s=this.diagram.spatialSearch.getPageBounds(p,p)}if(i){var c=this.diagram.scrollSettings.padding;s.x-=c.left,s.y-=c.top,s.width+=c.left+c.right,s.height+=c.top+c.bottom}return s},n.prototype.getPageBreak=function(e){for(var t=0,i=0,r=-1,a=[],s=0,o=0,h=0,l=0,d=this.diagram.pageSettings.margin.left,f=this.diagram.pageSettings.margin.right,p=this.diagram.pageSettings.margin.top,c=this.diagram.pageSettings.margin.bottom,u=1,g=1,v={x1:s,y1:h,x2:o,y2:l};e.width>t;)t=t+(this.diagram.pageSettings.width?this.diagram.pageSettings.width:e.width),t===this.diagram.pageSettings.width&&(v={x1:e.left+d,y1:e.top+p,x2:e.left+d,y2:e.bottom-c},a[++r]=v),t<e.width&&(s=e.topLeft.x+this.diagram.pageSettings.width*u,h=e.topLeft.y+p,o=e.bottomLeft.x+this.diagram.pageSettings.width*u,l=e.bottomLeft.y-c,v={x1:s,y1:h,x2:o,y2:l},a[++r]=v,u++),e.width===t&&(v={x1:e.right-f,y1:e.top+p,x2:e.right-f,y2:e.bottom-c},a[++r]=v);for(;e.height>i;)i=i+(this.diagram.pageSettings.height?this.diagram.pageSettings.height:e.height),i===this.diagram.pageSettings.height&&(v={x1:e.left+d,y1:e.top+p,x2:e.right-f,y2:e.top+p},a[++r]=v),i<e.height&&(s=e.topLeft.x+d,h=e.topLeft.y+this.diagram.pageSettings.height*g,o=e.topRight.x-f,l=e.topRight.y+this.diagram.pageSettings.height*g,v={x1:s,y1:h,x2:o,y2:l},a[++r]=v,g++),e.height===i&&(v={x1:e.left+d,y1:e.bottom-c,x2:e.right-f,y2:e.bottom-c},a[++r]=v);return a},n.prototype.zoom=function(e,t,i,r,a,s,o,h){if(Fv(this.diagram)&&e!==1||Vv(this.diagram)&&e===1){var l=xt();if(Or(l,this.currentZoom,this.currentZoom),xh(l,this.horizontalOffset,this.verticalOffset),r=r||{x:(this.viewPortWidth/2-this.horizontalOffset)/this.currentZoom,y:(this.viewPortHeight/2-this.verticalOffset)/this.currentZoom},r=st(l,r),this.currentZoom*e<=this.diagram.scrollSettings.maxZoom&&(this.currentZoom*e>=this.diagram.scrollSettings.minZoom||h||e>=1)){this.currentZoom*=e;var d=this.getPageBounds(void 0,void 0,!0);d.x*=this.currentZoom,d.y*=this.currentZoom;var f=xt();Or(f,e,e,r.x,r.y),xh(f,t||0,i||0),Ao(l,f);var p=st(l,{x:0,y:0});if(e===1&&(p=this.applyScrollLimit(p.x,p.y,a,s,o)),o=-d.y>=p.y&&-d.x>=p.x&&o,(this.diagram.scrollActions&ei.PropertyChange||!(this.diagram.scrollActions&ei.Interaction)||this.diagram.scrollSettings.scrollLimit!=="Diagram"||o)&&(this.transform={tx:Math.max(p.x,-d.left)/this.currentZoom,ty:Math.max(p.y,-d.top)/this.currentZoom,scale:this.currentZoom},this.horizontalOffset=p.x,this.verticalOffset=p.y),this.setSize(p),this.diagram.mode!=="SVG"&&Le(this.diagram)&&this.diagram.scroller.virtualizeElements(),this.diagram.mode!=="SVG"&&!Le(this.diagram)&&this.diagram.refreshDiagramLayer(),this.diagram.setOffset(-this.horizontalOffset-d.x,-this.verticalOffset-d.y),Ja(this.diagram),this.diagram.views&&this.diagram.views.overview){var c=this.diagram.views.overview,u=c.scrollOverviewRect(c.parent.scroller.horizontalOffset,c.parent.scroller.verticalOffset,c.parent.scroller.currentZoom,!0);c.updateOverviewrect(-u.x,-u.y,u.width,u.height),c.updateView(c)}}}},n.prototype.fitToPage=function(e){e=e||{};var t=e.mode,i=e.region,r=e.margin||{},a=e.canZoomIn,s=e.customBounds,o=e.canZoomOut;r.bottom=r.bottom||25,r.top=r.top||25,r.left=r.left||25,r.right=r.right||25;var h=s,l,d=-this.horizontalOffset,f=-this.verticalOffset;if(i=i||"PageSettings",i==="PageSettings"&&this.diagram.pageSettings.width&&this.diagram.pageSettings.height||this.diagram.nodes.length>0||this.diagram.connectors.length>0){t=t||"Page",i!=="CustomBounds"&&(h=this.getPageBounds(!0,i,!0));var p={x:0,y:0};r.left+r.right>this.viewPortWidth&&(this.viewPortWidth<=100?(r.left=5,r.right=5):(r.left=25,r.right=25)),r.top+r.bottom>this.viewPortHeight&&(this.viewPortHeight<=100?(r.top=5,r.bottom=5):(r.top=25,r.bottom=25)),p.x=(this.viewPortWidth-(r.left+r.right))/h.width,p.y=(this.viewPortHeight-(r.top+r.bottom))/h.height,!a&&h.width-this.horizontalOffset<this.viewPortWidth&&h.height-this.verticalOffset<this.viewPortHeight&&(p.x=Math.min(this.currentZoom,p.x),p.y=Math.min(this.currentZoom,p.y));var c=void 0,u=void 0,g=void 0;switch(t){case"Width":c=p.x,l=c/this.currentZoom,u=(this.viewPortWidth-h.width*c)/2-h.x*c,d+=u+(r.left-r.right)/2*c,f-=-this.verticalOffset*l,f=i!=="CustomBounds"?f:f-this.verticalOffset*l;break;case"Height":c=p.y,l=c/this.currentZoom,u=(this.viewPortWidth-h.width*c)/2-h.x*c,g=(this.viewPortHeight-h.height*c)/2-h.y*c,d+=u+(r.left-r.right)/2*c,f+=g+(r.top-r.bottom)/2*c;break;case"Page":c=Math.min(p.x,p.y),l=c/this.currentZoom,u=(this.viewPortWidth-h.width*c)/2-h.x*c,g=(this.viewPortHeight-h.height*c)/2-h.y*c,d+=u+(r.left-r.right)/2*c,f+=g+(r.top-r.bottom)/2*c;break}this.zoom(l,d,f,{x:0,y:0},!0,void 0,void 0,o)}else l=1/this.currentZoom,this.zoom(l,d,f,{x:0,y:0},!0,void 0,void 0,o)},n.prototype.bringIntoView=function(e,t){var i=0,r=0,a=this.currentZoom,s=e,o=-this.horizontalOffset,h=-this.verticalOffset;s=new it(s.x*a,s.y*a,s.width*a,s.height*a);var l=new it(o,h,this.viewPortWidth,this.viewPortHeight),d=20;l.containsRect(s)||(s.right>-o+this.viewPortWidth&&(i=s.right-this.viewPortWidth,i+=d),s.x<-o&&(i=s.x),s.bottom>-h+this.viewPortHeight&&(r=s.bottom-this.viewPortHeight,r+=d),s.y<-h&&(r=s.y),this.zoom(1,-this.horizontalOffset-i,-this.verticalOffset-r,null,void 0,t))},n.prototype.bringToCenter=function(e){var t=this.currentZoom,i=new it(e.x*t,e.y*t,e.width*t,e.height*t),r=i.x+i.width/2-this.viewPortWidth/2,a=i.y+i.height/2-this.viewPortHeight/2;r*=-1,a*=-1,this.zoom(1,-this.horizontalOffset-r,-this.verticalOffset-a,null)},n.prototype.applyScrollLimit=function(e,t,i,r,a){if(this.diagram.scrollSettings.scrollLimit==="Infinity"&&i===void 0&&!r&&(e=-e,t=-t),this.diagram.scrollSettings.scrollLimit!=="Infinity"){var s=void 0;if(this.diagram.scrollSettings.scrollLimit==="Limited"){var o=this.diagram.scrollSettings.scrollableArea;s=new it(o.x,o.y,o.width,o.height)}s=s||(a?this.getPageBounds(!1,void 0,!0):this.getPageBounds(!0,void 0,!0));var h="eventHandler";this.diagram[""+h].currentAction==="Pan"&&this.diagram[""+h].inAction&&(s=this.getPageBounds(!1,void 0,!0)),s.x*=this.currentZoom,s.y*=this.currentZoom,s.width*=this.currentZoom,s.height*=this.currentZoom,i!==void 0&&(e*=-1,t*=-1),r&&(e*=-1,t*=-1);var l=Math.max(s.right,this.viewPortWidth);if(!r&&!(e<=s.x&&(e+this.viewPortWidth>=s.right||e>=s.right-this.viewPortWidth)||e>=s.x&&e+this.viewPortWidth<=l))if(e>=s.x)e=Math.max(s.x,Math.min(e,e-(e+this.viewPortWidth-this.vScrollSize-l)));else{var d=s.right-this.viewPortWidth;e=Math.min(d,s.x)}var f=Math.max(s.bottom,this.viewPortHeight);if(!r&&!(t<=s.y&&t+this.viewPortHeight>=s.bottom||t>=s.y&&t+this.viewPortHeight<=f))if(t>=s.y)t=Math.max(s.y,Math.min(t,t-(t+this.viewPortHeight-this.hScrollSize-f)));else{var d=s.bottom-this.viewPortHeight;t=Math.min(s.y,d)}e*=-1,t*=-1}return{x:e,y:t}},n})(),rS=(function(){function n(e,t,i,r,a){this.objects=[],this.left=e,this.top=t,this.width=i,this.height=r,this.spatialSearch=a}return n.prototype.findQuads=function(e,t){this.first!=null&&this.first.isIntersect(e)&&this.first.findQuads(e,t),this.second!=null&&this.second.isIntersect(e)&&this.second.findQuads(e,t),this.third!=null&&this.third.isIntersect(e)&&this.third.findQuads(e,t),this.fourth!=null&&this.fourth.isIntersect(e)&&this.fourth.findQuads(e,t),this.objects.length>0&&t.push(this)},n.prototype.isIntersect=function(e){return!(this.left+this.width<e.left||this.top+this.height<e.top||this.left>e.right||this.top>e.bottom)},n.prototype.selectQuad=function(){for(var e=null,t=this,i;t!=null;)i=t.getQuad(e),t=i.source,e=i.target||e;return e},n.prototype.getQuad=function(e){var t=this.width/2,i=this.height/2;if(t>=1e3&&i>=1e3){var r=this.left+t,a=this.top+i;if(this.spatialSearch.childRight<=r){if(this.spatialSearch.childBottom<=a){if(!this.first){var s=new n(this.left,this.top,t,i,this.spatialSearch);s.parent=this,this.first=s}return{source:this.first}}if(this.spatialSearch.childTop>=a){if(!this.third){var s=new n(this.left,a,t,i,this.spatialSearch);s.parent=this,this.third=s}return{source:this.third}}}else if(this.spatialSearch.childLeft>=r){if(this.spatialSearch.childBottom<=a){if(!this.second){var s=new n(r,this.top,t,i,this.spatialSearch);s.parent=this,this.second=s}return{source:this.second}}if(this.spatialSearch.childTop>=a){if(!this.fourth){var s=new n(r,a,t,i,this.spatialSearch);s.parent=this,this.fourth=s}return{source:this.fourth}}}}return this.objects.push(this.spatialSearch.childNode),{target:this}},n.prototype.isContained=function(){return this.spatialSearch.childLeft>=this.left&&this.spatialSearch.childRight<=this.left+this.width&&this.spatialSearch.childTop>=this.top&&this.spatialSearch.childBottom<=this.top+this.height},n.prototype.addIntoAQuad=function(e){var t={};this.spatialSearch.setCurrentNode(e);for(var i=null;!t.isAdded;)t=this.spatialSearch.parentQuad.add(i),i=t.quad;return i},n.prototype.add=function(e){if(e=null,this.isContained())return e=this.selectQuad(),{isAdded:!0,quad:e};var t=void 0,i=this.objects.length===0&&!this.first&&!this.second&&!this.third&&!this.fourth,r=this.width*2,a=this.height*2;return this.spatialSearch.childLeft<this.left?this.spatialSearch.childTop<this.top?(t=new n(this.left-this.width,this.top-this.height,r,a,this.spatialSearch),i||(t.fourth=this)):(t=new n(this.left-this.width,this.top,r,a,this.spatialSearch),i||(t.second=this)):this.spatialSearch.childTop<this.top?(t=new n(this.left,this.top-this.height,r,a,this.spatialSearch),i||(t.third=this)):(t=new n(this.left,this.top,r,a,this.spatialSearch),i||(t.first=this)),this.parent=t,this.spatialSearch.parentQuad=t,{isAdded:!1,quad:e}},n})(),Dl=(function(){function n(e){this.quadSize=500,this.objectTable=e,this.parentQuad=new rS(0,0,this.quadSize*2,this.quadSize*2,this),this.pageLeft=Number.MAX_VALUE,this.pageRight=-Number.MAX_VALUE,this.pageTop=Number.MAX_VALUE,this.pageBottom=-Number.MAX_VALUE,this.quadTable={}}return n.prototype.removeFromAQuad=function(e){if(this.quadTable[e.id]){var t=this.quadTable[e.id],i=this.objectIndex(t.objects,e);i!==-1&&(t.objects.splice(i,1),this.update(t),delete this.quadTable[e.id])}},n.prototype.update=function(e){if(e.parent&&e.objects.length===0&&e.first==null&&e.second==null&&e.third==null&&e.fourth==null){var t=e.parent;t.first===e?t.first=null:t.second===e?t.second=null:t.third===e?t.third=null:t.fourth===e&&(t.fourth=null),this.update(e.parent)}else{e===this.parentQuad&&!e.first&&!e.second&&!e.third&&!e.fourth&&e.objects.length===0&&(e.left=0,e.width=1e3,e.top=0,e.height=1e3);return}},n.prototype.addIntoAQuad=function(e){var t=this.parentQuad.addIntoAQuad(e);this.quadTable[e.id]=t},n.prototype.objectIndex=function(e,t){for(var i=0;i<e.length;i++)if(e[parseInt(i.toString(),10)].id===t.id)return i;return-1},n.prototype.updateQuad=function(e){this.setCurrentNode(e);var t=e.outerBounds;if(!(!isNaN(t.x)&&!isNaN(t.y)&&!isNaN(t.width)&&!isNaN(t.height)))return!1;if(this.quadTable[e.id]){var i=this.quadTable[e.id];i.isContained()||(this.removeFromAQuad(e),this.addIntoAQuad(e))}else this.addIntoAQuad(e);if(!(this.isWithinPageBounds(t)&&this.leftElement!==e&&this.topElement!==e&&this.rightElement!==e&&this.bottomElement!==e)){var r=!1;return(this.pageLeft!==this.childLeft||e!==this.leftElement)&&(this.pageLeft>=this.childLeft?(this.pageLeft=this.childLeft,this.leftElement=e,r=!0):e===this.leftElement&&(this.pageLeft=Number.MAX_VALUE,this.findLeft(this.parentQuad),r=!0)),(this.pageTop!==this.childTop||e!==this.topElement)&&(this.pageTop>=this.childTop?(this.pageTop=this.childTop,this.topElement=e,r=!0):e===this.topElement&&(this.pageTop=Number.MAX_VALUE,this.findTop(this.parentQuad),r=!0)),(this.pageBottom!==this.childBottom||e!==this.bottomElement)&&(this.pageBottom<=this.childBottom?(r=!0,this.pageBottom=this.childBottom,this.bottomElement=e):e===this.bottomElement&&(this.pageBottom=-Number.MAX_VALUE,this.findBottom(this.parentQuad),r=!0)),(this.pageRight!==this.childRight||e!==this.rightElement)&&(this.pageRight<=this.childRight?(this.pageRight=this.childRight,this.rightElement=e,r=!0):e===this.rightElement&&(this.pageRight=-Number.MAX_VALUE,this.findRight(this.parentQuad),r=!0)),r}return this.setCurrentNode(null),!1},n.prototype.isWithinPageBounds=function(e){return e.left>=this.pageLeft&&e.right<=this.pageRight&&e.top>=this.pageTop&&e.bottom<=this.pageBottom},n.prototype.findQuads=function(e){var t=[];return this.parentQuad.findQuads(e,t),t},n.prototype.findObjects=function(e){for(var t=this.findQuads(e),i=[],r=0,a=t;r<a.length;r++)for(var s=a[r],o=0,h=s.objects;o<h.length;o++){var l=h[o];(l.outerBounds.intersects(e)||nh(l))&&i.push(this.objectTable[l.id])}return i},n.prototype.updateBounds=function(e,t){var i=!1;return t?(this.topElement&&e.id===this.topElement.id&&(i=this.updateTop()),this.leftElement&&e.id===this.leftElement.id&&(i=this.updateLeft()),this.rightElement&&e.id===this.rightElement.id&&(i=this.updateRight()),this.bottomElement&&e.id===this.bottomElement.id&&(i=this.updateBottom())):(e===this.topElement&&(i=this.updateTop()),e===this.leftElement&&(i=this.updateLeft()),e===this.rightElement&&(i=this.updateRight()),e===this.bottomElement&&(i=this.updateBottom())),i},n.prototype.updateTop=function(){return this.pageTop=Number.MAX_VALUE,this.topElement=null,this.findTop(this.parentQuad),!0},n.prototype.updateBottom=function(){return this.pageBottom=-Number.MAX_VALUE,this.bottomElement=null,this.findBottom(this.parentQuad),!0},n.prototype.updateLeft=function(){return this.pageLeft=Number.MAX_VALUE,this.leftElement=null,this.findLeft(this.parentQuad),!0},n.prototype.updateRight=function(){return this.pageRight=-Number.MAX_VALUE,this.rightElement=null,this.findRight(this.parentQuad),!0},n.prototype.findBottom=function(e){e.third||e.fourth?(e.third&&this.findBottom(e.third),e.fourth&&this.findBottom(e.fourth)):(e.second&&this.findBottom(e.second),e.first&&this.findBottom(e.first));for(var t=0,i=e.objects;t<i.length;t++){var r=i[t];this.pageBottom<=r.outerBounds.bottom&&(this.pageBottom=r.outerBounds.bottom,this.bottomElement=r)}},n.prototype.findRight=function(e){(e.second||e.fourth)&&(e.second&&this.findRight(e.second),e.fourth&&this.findRight(e.fourth)),e.first&&this.findRight(e.first),e.third&&this.findRight(e.third);for(var t=0,i=e.objects;t<i.length;t++){var r=i[t];this.pageRight<=r.outerBounds.right&&(this.pageRight=r.outerBounds.right,this.rightElement=r)}},n.prototype.findLeft=function(e){e.first||e.third?(e.first&&this.findLeft(e.first),e.third&&this.findLeft(e.third)):(e.second&&this.findLeft(e.second),e.fourth&&this.findLeft(e.fourth));for(var t=0,i=e.objects;t<i.length;t++){var r=i[t];this.pageLeft>=r.outerBounds.left&&(this.pageLeft=r.outerBounds.left,this.leftElement=r)}},n.prototype.findTop=function(e){e.first||e.second?(e.first&&this.findTop(e.first),e.second&&this.findTop(e.second)):(e.third&&this.findTop(e.third),e.fourth&&this.findTop(e.fourth));for(var t=0,i=e.objects;t<i.length;t++){var r=i[t];this.pageTop>=r.outerBounds.top&&(this.pageTop=r.outerBounds.top,this.topElement=r)}},n.prototype.setCurrentNode=function(e){if(this.childNode=e,e){var t=e.outerBounds;this.childLeft=Number(t.left),this.childTop=Number(t.top),this.childRight=Number(t.right),this.childBottom=Number(t.bottom)}else this.childLeft=Number.MAX_VALUE,this.childTop=Number.MAX_VALUE,this.childRight=-Number.MAX_VALUE,this.childBottom=-Number.MAX_VALUE},n.prototype.getPageBounds=function(e,t){if(this.pageLeft===Number.MAX_VALUE)return new it(0,0,0,0);var i=e!==void 0?Math.min(this.pageLeft,0):this.pageLeft,r=t!==void 0?Math.min(this.pageTop,0):this.pageTop;return new it(Math.round(i),Math.round(r),Math.round(this.pageRight-i),Math.round(this.pageBottom-r))},n.prototype.getQuad=function(e){return this.quadTable[e.id]},n})(),nS=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),aS=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},sS=(function(n){nS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return aS([w(!1)],e.prototype,"preventDefaults",void 0),e})(j),oS=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Ll=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},hS=(function(n){oS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Ll([w("")],e.prototype,"action",void 0),Ll([w("")],e.prototype,"cursor",void 0),e})(j),lS=(function(){function n(){this.size=20,this.intermediatePoints=[],this.gridCollection=[],this.startArray=[],this.targetGridCollection=[],this.sourceGridCollection=[],this.considerWalkable=[],this.skipObstacleCheck=!1,this.nonWalkableGrids=[]}return n.prototype.lineRouting=function(e){var t=e.connectors.length;if(this.renderVirtualRegion(e),t>0)for(var i=0;i<t;i++){var r=e.connectors[parseInt(i.toString(),10)];r.type==="Orthogonal"&&r.visible&&this.refreshConnectorSegments(e,r,!0)}},n.prototype.renderVirtualRegion=function(e,t){var i=this.size;(e.spatialSearch.pageTop<0||e.spatialSearch.pageLeft<0)&&(i=this.size+this.size/2);var r=e.spatialSearch.pageRight+i,a=e.spatialSearch.pageBottom+i,s=e.spatialSearch.pageLeft-i,o=e.spatialSearch.pageTop-i;if(s=s<0?s-20:0,o=o<0?o-20:0,t&&(this.width!==r-s||this.height!==a-o||this.diagramStartX!==s||this.diagramStartY!==o)||t===void 0){this.width=r-s,this.height=a-o,this.diagramStartX=s,this.diagramStartY=o,this.gridCollection=[],this.noOfRows=this.width/this.size,this.noOfCols=this.height/this.size;for(var h=this.size,l=this.diagramStartX<0?this.diagramStartX:0,d=this.diagramStartY<0?this.diagramStartY:0,f=0;f<this.noOfCols;f++){for(var p=0;p<this.noOfRows;p++){f===0&&this.gridCollection.push([0]);var c={x:l,y:d,width:h,height:h,gridX:p,gridY:f,walkable:!0,tested:void 0,nodeId:[]};this.gridCollection[parseInt(p.toString(),10)][parseInt(f.toString(),10)]=c,l+=h}l=this.diagramStartX<0?this.diagramStartX:0,d+=h}this.nonWalkableGrids.length!==0&&(this.nonWalkableGrids.length=0)}var u=this.findNodes(e.nodes);this.updateNodesInVirtualRegion(u)},n.prototype.findNodes=function(e){for(var t=[],i,r=0;r<e.length;r++)i=e[parseInt(r.toString(),10)],i.shape.type!=="SwimLane"&&!i.isLane&&!i.isPhase&&!i.isHeader&&i.visible&&t.push(i);return t},n.prototype.updateNodesInVirtualRegion=function(e){for(var t=this.size,i=0,r=this.nonWalkableGrids;i<r.length;i++){var a=r[i];a.walkable=!0,a.tested=void 0,a.nodeId=[],a.parentNodeId=""}this.nonWalkableGrids.length!==0&&(this.nonWalkableGrids.length=0);for(var s=0;s<e.length;s++){var o=e[parseInt(s.toString(),10)],h=o.wrapper.bounds;if(h)for(var l=this.getGridsIntersectBounds(h),d=0,f=l;d<f.length;d++){var a=f[d],p=new it(a.x,a.y,t,t),c=this.intersectRect(p,h);c&&(a.nodeId.push(o.id),a.walkable=!1,this.nonWalkableGrids.push(a),o.parentId!==""&&(a.parentNodeId=o.parentId))}}},n.prototype.getGridsIntersectBounds=function(e){for(var t=[],i=e.topLeft.x,r=e.bottomRight.x,a=e.topLeft.y,s=e.bottomRight.y,o=this.size,h=Math.floor((i-this.diagramStartX)/o),l=Math.floor((a-this.diagramStartY)/o),d=Math.floor((r-this.diagramStartX)/o),f=Math.floor((s-this.diagramStartY)/o),p=h;p<=d;p++)for(var c=l;c<=f;c++){var u=this.gridCollection[parseInt(p.toString(),10)];if(u){var g=u[parseInt(c.toString(),10)];g&&t.indexOf(g)===-1&&t.push(g)}}return t},n.prototype.intersectRect=function(e,t){return!(t.left>=e.right||t.right<=e.left||t.top>=e.bottom||t.bottom<=e.top)},n.prototype.findEndPoint=function(e,t,i){var r,a;if(t&&e.sourcePortID!==""&&e.sourcePortWrapper||!t&&e.targetPortID!==""&&e.targetPortWrapper){r=t?{x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY}:{x:e.targetPortWrapper.offsetX,y:e.targetPortWrapper.offsetY},a=ui(r,void 0,t?e.sourceWrapper.bounds:e.targetWrapper.bounds);var s=t?e.sourcePortWrapper.bounds:e.targetPortWrapper.bounds;i?a==="Top"?r={x:s.topCenter.x,y:s.topCenter.y}:a==="Left"?r={x:s.middleLeft.x,y:s.middleLeft.y}:a==="Right"?r={x:s.middleRight.x,y:s.middleRight.y}:r={x:s.bottomCenter.x,y:s.bottomCenter.y}:r={x:s.center.x,y:s.center.y}}else t&&this.startNode||!t&&this.targetNode?r=t?{x:this.startNode.wrapper.offsetX,y:this.startNode.wrapper.offsetY}:{x:this.targetNode.wrapper.offsetX,y:this.targetNode.wrapper.offsetY}:r=t?{x:e.sourcePoint.x,y:e.sourcePoint.y}:{x:e.targetPoint.x,y:e.targetPoint.y};return r},n.prototype.getGridsIntersect=function(e,t){var i=[],r=Math.min(e.x,t.x),a=Math.min(e.y,t.y),s=Math.max(e.x,t.x),o=Math.max(e.y,t.y),h=this.size,l=Math.floor((r-this.diagramStartX)/h),d=Math.floor((a-this.diagramStartY)/h),f=Math.floor((s-this.diagramStartX)/h),p=Math.floor((o-this.diagramStartY)/h),c=s-r>o-a;if(c)for(var u=l;u<=f;u++){var g=this.gridCollection[parseInt(u.toString(),10)];if(g){var v=g[parseInt(d.toString(),10)];v&&i.indexOf(v)===-1&&i.push(v)}}else for(var m=d;m<=p;m++){var g=this.gridCollection[parseInt(l.toString(),10)];if(g){var v=g[parseInt(m.toString(),10)];v&&i.indexOf(v)===-1&&i.push(v)}}return i},n.prototype.isPathWalkable=function(e,t,i,r){for(var a=Math.min(e.x,t.x),s=Math.min(e.y,t.y),o=Math.max(e.x,t.x),h=Math.max(e.y,t.y),l=this.getGridsIntersect(e,t),d=0;d<l.length;d++){var f=l[parseInt(d.toString(),10)];if(!(r&&(f.nodeId.indexOf(r.sourceID)!==-1||f.nodeId.indexOf(r.targetID)!==-1))&&!f.walkable)for(var p=o-a>h-s,c=0,u=f.nodeId;c<u.length;c++){var g=u[c],v=i.nameTable[""+g];if(v){var m=v.wrapper.bounds,y=5;if(p){if(m.top-y<s&&m.bottom+y>h)return!1}else if(m.left-y<a&&m.right+y>o)return!1}}}return!0},n.prototype.checkObstaclesIntersect=function(e,t,i){for(var r=1;r<e.length;r++){var a=e[r-1],s=e[parseInt(r.toString(),10)];if(!this.isPathWalkable(a,s,i,t))return!1}return!0},n.prototype.refreshConnectorSegments=function(e,t,i,r){if(!(!t.sourceID||!t.targetID||t.sourceID===t.targetID)){if(!this.skipObstacleCheck&&t.segments&&t.segments.length<2&&t.intermediatePoints&&this.checkObstaclesIntersect(t.intermediatePoints,t,e)){e.avoidLineOverlappingModule&&i&&(e.avoidLineOverlappingModule.addConnector(t),e.avoidLineOverlappingModule.refreshModifiedConnectors(e));return}var a=t.sourceID,s=t.targetID,o=t.sourcePortID,h=t.targetPortID,l,d,f,p,c,u,g,v,m,y,S,x,I,C;if(Yv(t,e)||r){this.startNode=e.nameTable[""+a],this.targetNode=e.nameTable[""+s],this.intermediatePoints=[],this.startArray=[],this.targetGridCollection=[],this.sourceGridCollection=[],this.startGrid=void 0,this.targetGrid=void 0;for(var P=0;P<this.noOfCols;P++)for(var A=0;A<this.noOfRows;A++)this.gridCollection[parseInt(A.toString(),10)][parseInt(P.toString(),10)].tested=this.gridCollection[parseInt(A.toString(),10)][parseInt(P.toString(),10)].parent=void 0,this.gridCollection[parseInt(A.toString(),10)][parseInt(P.toString(),10)].previousDistance=this.gridCollection[parseInt(A.toString(),10)][parseInt(P.toString(),10)].afterDistance=void 0,this.gridCollection[parseInt(A.toString(),10)][parseInt(P.toString(),10)].totalDistance=void 0;l=this.findEndPoint(t,!0),d=this.findEndPoint(t,!1);for(var P=0;P<this.noOfRows;P++)for(var A=0;A<this.noOfCols;A++){c=this.gridCollection[parseInt(P.toString(),10)][parseInt(A.toString(),10)];var T=new it(c.x,c.y,c.width,c.height);if(T.containsPoint(l)&&!this.startGrid&&(c.nodeId.indexOf(a)!==-1||a==="")&&(this.startGrid=o&&this.startGrid&&f==="Top"?this.startGrid:c),T.containsPoint(d)&&!this.targetGrid&&(c.nodeId.indexOf(s)!==-1||s==="")&&(this.targetGrid=h&&this.targetGrid&&p==="Top"?this.targetGrid:c),!o&&this.startNode){var z=this.startNode.wrapper.bounds;T.containsPoint(z.topCenter)&&!u&&(u=c),T.containsPoint(z.middleLeft)&&!m&&(m=c),T.containsPoint(z.middleRight)&&!y&&(y=c),T.containsPoint(z.bottomCenter)&&!g&&(g=c)}if(!h&&this.targetNode){var z=this.targetNode.wrapper.bounds;T.containsPoint(z.topCenter)&&!x&&(x=c),T.containsPoint(z.middleLeft)&&!C&&(C=c),T.containsPoint(z.middleRight)&&!S&&(S=c),T.containsPoint({x:z.bottomCenter.x,y:z.bottomCenter.y})&&!I&&(I=c)}}this.findEdgeBoundary(o,m,y,u,g,!0),this.findEdgeBoundary(h,C,S,x,I,!1),this.startGrid.totalDistance=0,this.startGrid.previousDistance=0,this.intermediatePoints.push({x:this.startGrid.gridX,y:this.startGrid.gridY}),this.startArray.push(this.startGrid),t&&C&&S&&x&&I&&this.checkObstacles(t,e,C,S,x,I);t:for(;this.startArray.length>0;){var L=this.startArray.pop();if(L){for(var P=0;P<this.targetGridCollection.length;P++){var R=this.targetGridCollection[parseInt(P.toString(),10)];if(L&&L.gridX===R.gridX&&L.gridY===R.gridY)if(this.getIntermediatePoints(L),this.optimizeIntermediatePoints(),L.nodeId&&L.nodeId.length>1&&(t.segments=[]),v=this.updateConnectorSegments(e,this.intermediatePoints,this.gridCollection,t,i),!v)this.targetGridCollection.splice(this.targetGridCollection.indexOf(R),1),L=this.startArray.pop();else{this.considerWalkable=[];break t}}L&&this.findPath(L)}}}}},n.prototype.checkChildNodes=function(e,t){var i=!1,r=!1;if(e.nodeId.length>=1&&!t)for(var a=0;a<e.nodeId.length;a++){for(var s=e.nodeId[parseInt(a.toString(),10)],o=0;o<e.nodeId.length;o++)this.targetNode.parentId===e.nodeId[parseInt(o.toString(),10)]&&(r=!0);!r&&this.targetNode.id===s?i=!0:i=!1}else e.nodeId.length===1&&(i=!0);return i},n.prototype.findEdgeBoundary=function(e,t,i,r,a,s){var o,h=s?this.sourceGridCollection:this.targetGridCollection;if(!e&&(s?this.startNode:this.targetNode)){for(var l=t.gridX;l<=i.gridX;l++)o=this.gridCollection[parseInt(l.toString(),10)][t.gridY],(this.checkChildNodes(o,s)&&(l===t.gridX||l===i.gridX)||l!==t.gridX&&l!==i.gridX)&&h.push(o);for(var l=r.gridY;l<=a.gridY;l++)o=this.gridCollection[r.gridX][parseInt(l.toString(),10)],(this.checkChildNodes(o,s)&&(l===r.gridY||l===a.gridY)||l!==r.gridY&&l!==a.gridY)&&h.indexOf(o)===-1&&h.push(o)}else h.push(s?this.startGrid:this.targetGrid)},n.prototype.checkObstacles=function(e,t,i,r,a,s){var o=this.findNearestNeigbours(this.startGrid,this.gridCollection,!0);if(o.length===0)if(e.sourcePortID!==""){var h={x:e.sourcePortWrapper.offsetX,y:e.sourcePortWrapper.offsetY},l=ui(h,void 0,e.sourceWrapper.bounds);l==="Top"?this.resetGridColl(this.startGrid,"top",!0):l==="Right"?this.resetGridColl(this.startGrid,"right",!0):l==="Bottom"?this.resetGridColl(this.startGrid,"bottom",!0):this.resetGridColl(this.startGrid,"left",!0)}else this.resetGridColl(this.startGrid,"top",!0),this.resetGridColl(this.startGrid,"right",!0),this.resetGridColl(this.startGrid,"bottom",!0),this.resetGridColl(this.startGrid,"left",!0);if(o=this.findNearestNeigbours(this.targetGrid,this.gridCollection,!1),o.length===0)if(e.targetPortID!==""){var h={x:e.targetPortWrapper.offsetX,y:e.targetPortWrapper.offsetY},l=ui(h,void 0,e.targetWrapper.bounds);l==="Top"?this.resetGridColl(this.targetGrid,"top",!0):l==="Right"?this.resetGridColl(this.targetGrid,"right",!0):l==="Bottom"?this.resetGridColl(this.targetGrid,"bottom",!0):this.resetGridColl(this.targetGrid,"left",!0)}else this.resetGridColl(this.targetGrid,"top",!1),this.resetGridColl(this.targetGrid,"right",!1),this.resetGridColl(this.targetGrid,"bottom",!1),this.resetGridColl(this.targetGrid,"left",!1);if(this.targetGridCollection.length>1&&this.targetGridCollection[0].nodeId.length>1)for(var d=0;d<=1;d++){for(var f=this.targetGridCollection[parseInt(d.toString(),10)].gridX,p=this.targetGridCollection[parseInt(d.toString(),10)].gridY,c=this.targetGridCollection[parseInt(d.toString(),10)].nodeId,u=void 0,g=0;g<c.length;g++)if(this.targetNode.id!==c[parseInt(g.toString(),10)]){u=c[parseInt(g.toString(),10)];break}var v=void 0,m=void 0,y=void 0;t.nameTable[this.targetNode.id]&&(v=t.nameTable[this.targetNode.id].wrapper),t.nameTable[""+u]&&(m=t.nameTable[""+u].wrapper),v&&m&&(y=this.contains(m.bounds,v.bounds));for(var S=void 0,x=0;x<c.length;x++)this.targetNode.parentId===c[parseInt(x.toString(),10)]&&(S=!0);if(!this.gridCollection[parseInt(f.toString(),10)][parseInt(p.toString(),10)].walkable&&y&&!S){var I=void 0,C=void 0;I=this.getEndvalue(i,"left"),C=i.gridX-I.gridX,this.changeValue(i,C,"left"),I=this.getEndvalue(r,"right"),C=I.gridX-r.gridX,this.changeValue(r,C,"right"),I=this.getEndvalue(a,"top"),C=a.gridY-I.gridY,this.changeValue(a,C,"top"),I=this.getEndvalue(s,"bottom"),C=s.gridY-I.gridY,this.changeValue(s,C,"top")}}},n.prototype.contains=function(e,t){return e.left<=t.left&&e.right>=t.right&&e.top<=t.top&&e.bottom>=t.bottom},n.prototype.getEndvalue=function(e,t){return this.gridCollection[e.gridX][e.gridY].walkable?e:t==="left"?this.getEndvalue(this.gridCollection[e.gridX-1][e.gridY],t):t==="right"?this.getEndvalue(this.gridCollection[e.gridX+1][e.gridY],t):t==="top"?this.getEndvalue(this.gridCollection[e.gridX][e.gridY-1],t):t==="bottom"?this.getEndvalue(this.gridCollection[e.gridX][e.gridY+1],t):e},n.prototype.changeValue=function(e,t,i){e.walkable||this.considerWalkable.push(e);for(var r,a=0;a<=t;a++)i==="left"?r=this.gridCollection[e.gridX-a][e.gridY]:i==="right"?r=this.gridCollection[e.gridX+a][e.gridY]:i==="top"?r=this.gridCollection[e.gridX][e.gridY-a]:i==="bottom"&&(r=this.gridCollection[e.gridX][e.gridY+a]),r.walkable||this.considerWalkable.push(r)},n.prototype.getIntermediatePoints=function(e){var t;for(this.intermediatePoints=[];e;)this.intermediatePoints.push({x:e.gridX,y:e.gridY}),e=e.parent;this.intermediatePoints.reverse(),this.intermediatePoints.length>=1&&this.intermediatePoints[0]!==void 0&&this.intermediatePoints[1]!==void 0&&(this.intermediatePoints[0].x===this.intermediatePoints[1].x?this.intermediatePoints[0].y<this.intermediatePoints[1].y?(t=this.neigbour(this.startGrid,"bottom",void 0,!0),this.intermediatePoints[0].y+=t-1):(t=this.neigbour(this.startGrid,"top",void 0,!0),this.intermediatePoints[0].y-=t-1):this.intermediatePoints[0].x<this.intermediatePoints[1].x?(t=this.neigbour(this.startGrid,"right",void 0,!0),this.intermediatePoints[0].x+=t-1):(t=this.neigbour(this.startGrid,"left",void 0,!0),this.intermediatePoints[0].x-=t-1))},n.prototype.optimizeIntermediatePoints=function(){this.intermediatePoints=this.removePointsInSameLine(this.intermediatePoints),this.intermediatePoints=this.getValidPoints(this.intermediatePoints)},n.prototype.removePointsInSameLine=function(e){if(e.length<3)return e;for(var t=[e[0]],i=1;i<e.length-1;i++){var r=t[t.length-1],a=e[parseInt(i.toString(),10)],s=e[i+1];this.arePointsInSameLine(r,a,s)||t.push(a)}return t.push(e[e.length-1]),t},n.prototype.arePointsInSameLine=function(e,t,i){return(t.x-e.x)*(i.y-e.y)===(i.x-e.x)*(t.y-e.y)},n.prototype.getValidPoints=function(e){if(e.length<4)return e;for(var t=1;t<e.length-3;){var i=e[parseInt(t.toString(),10)],r=e[t+1],a=e[t+2],s=e[t+3];if(i.x===r.x){if(r.y<i.y&&s.y<a.y||r.y>i.y&&s.y>a.y){for(var o=i.x<a.x?1:-1,h=r.y<i.y?-1:1,l=i.x+o,d=i.y,f=!1;l!==s.x||d!==s.y;){if(this.isWalkable(l,d))f=!0;else{f=!1;break}l!==a.x?l+=o:d+=h}if(f){i.x=a.x,e.splice(t+1,2);continue}}}else if(i.y===r.y&&(r.x<i.x&&s.x<a.x||r.x>i.x&&s.x>a.x)){for(var p=i.y<a.y?1:-1,c=r.x<i.x?-1:1,u=i.y+p,g=i.x,v=!1;g!==s.x||u!==s.y;){if(this.isWalkable(g,u))v=!0;else{v=!1;break}u!==a.y?u+=p:g+=c}if(v){i.y=a.y,e.splice(t+1,2);continue}}t++}return e},n.prototype.updateConnectorSegments=function(e,t,i,r,a){var s=[],o,h,l,d,f,p=[],c,u,g,v,m=r.targetWrapper,y=r.sourceWrapper,S=this.findEndPoint(r,!0);(r.targetPortID!==""||!r.targetWrapper)&&(h=this.findEndPoint(r,!1,!0));for(var x=0;x<t.length;x++)f=i[t[parseInt(x.toString(),10)].x][t[parseInt(x.toString(),10)].y],f&&(l=f.x+f.width/2,d=f.y+f.height/2,p.push({x:l,y:d}),x>=1&&p.length>1&&(p[p.length-2].x!==p[p.length-1].x?g=p[p.length-2].x>p[p.length-1].x?"Left":"Right":g=p[p.length-2].y>p[p.length-1].y?"Top":"Bottom"),x>=2&&v===g&&p.length>1&&p.splice(p.length-2,1),v=g);if(p&&p.length>1){for(var I=0;I<p.length-1;I++){var C=p[parseInt(I.toString(),10)],P=p[I+1];if(C.x!==P.x){if(I===0&&r.sourcePortID===""&&y&&(S=C.x>P.x?y.bounds.middleLeft:y.bounds.middleRight),I===p.length-2&&r.targetPortID===""&&m&&(h=C.x>P.x?m.bounds.middleRight:m.bounds.middleLeft),I===0&&S){if(C.x=S.x,C.y=P.y=S.y,r.sourcePortID===""){var A=C.x>P.x?"Left":"Right",T=Fi(y.bounds,de(A));S=Ei(r,y,S,T,!1)}C.x=S.x}I===p.length-2&&h&&(I>0&&r.targetDecorator&&h.x-P.x<0&&Math.abs(h.x-C.x)<r.targetDecorator.width+1&&(C.x=p[I-1].x-=this.size/2),I>0&&r.targetDecorator&&h.x-P.x>0&&Math.abs(h.x-C.x)<r.targetDecorator.width+1&&(C.x=p[I-1].x+=this.size/2),P.x=h.x,C.y=P.y=h.y)}else{if(I===0&&r.sourcePortID===""&&y&&(S=C.y>P.y?y.bounds.topCenter:y.bounds.bottomCenter),I===p.length-2&&r.targetPortID===""&&m&&(h=C.y>P.y?m.bounds.bottomCenter:m.bounds.topCenter),I===0&&S){if(C.y=S.y,C.x=P.x=S.x,r.sourcePortID===""){var z=C.y>P.y?"Top":"Bottom",T=Fi(y.bounds,de(z));S=Ei(r,y,S,T,!1)}C.y=S.y}I===p.length-2&&h&&(I>0&&r.targetDecorator&&h.y-P.y<0&&Math.abs(h.y-C.y)<r.targetDecorator.height+1&&(C.y=p[I-1].y-=this.size/2),I>0&&r.targetDecorator&&h.y-P.y>0&&Math.abs(h.y-C.y)<r.targetDecorator.height+1&&(C.y=p[I-1].y+=this.size/2),P.y=h.y,C.x=P.x=h.x)}}if(e.avoidLineOverlappingModule&&a){e.avoidLineOverlappingModule.addConnector(r,p);var L=e.avoidLineOverlappingModule.getModifiedConnector();L.has(r)&&(s=e.avoidLineOverlappingModule.getModifiedConnectorSegments(r),L.delete(r)),L.size>0&&e.avoidLineOverlappingModule.refreshModifiedConnectors(e)}if(s.length===0)for(var I=0;I<p.length-1;I++){var C=p[parseInt(I.toString(),10)],P=p[I+1];C.x!==P.x?C.x>P.x?(c="Left",u=C.x-P.x):(c="Right",u=P.x-C.x):C.y>P.y?(c="Top",u=C.y-P.y):(c="Bottom",u=P.y-C.y),o={type:"Orthogonal",length:u,direction:c},s.push(o)}}if(s&&s.length>0){var R=s[s.length-1];if(s.length===1&&(R.length-=20),R.length<10&&s.length===2&&(s.pop(),s.length>0&&(s[0].length-=20,R=s[0])),r.targetDecorator&&(R.direction==="Top"||R.direction==="Bottom")&&R.length>r.targetDecorator.height+1||(R.direction==="Right"||R.direction==="Left")&&R.length>r.targetDecorator.width+1)return(a||!e.avoidLineOverlappingModule)&&(r.segments=s),a&&e.connectorPropertyChange(r,{},{type:"Orthogonal",segments:s}),!0}return!1},n.prototype.findPath=function(e){for(var t,i=[],r=this.findNearestNeigbours(e,this.gridCollection,!0),a=0;a<r.length;a++)if(t=this.findIntermediatePoints(r[parseInt(a.toString(),10)].gridX,r[parseInt(a.toString(),10)].gridY,e.gridX,e.gridY,this.targetGrid.gridX,this.targetGrid.gridY),t!==null){var s=this.gridCollection[t.x][t.y],o=this.octile(Math.abs(t.x-e.gridX),Math.abs(t.y-e.gridY));e.parent&&e.parent.parent&&s.gridX!==e.parent.gridX&&s.gridY!==e.parent.gridY&&(o+=.1);var h=e.previousDistance+o;(!s.previousDistance||s.previousDistance>h)&&!(t.x===e.gridX&&t.y===e.gridY)&&(i.push(t),s.previousDistance=h,s.afterDistance=s.afterDistance||this.manhattan(Math.abs(t.x-this.targetGrid.gridX),Math.abs(t.y-this.targetGrid.gridY)),s.totalDistance=s.previousDistance+s.afterDistance,s.parent=e)}if(i.length>0)for(var a=0;a<i.length;a++){var s=this.gridCollection[i[parseInt(a.toString(),10)].x][i[parseInt(a.toString(),10)].y];this.startArray.indexOf(s)===-1&&this.startArray.push(s)}this.sorting(this.startArray)},n.prototype.sorting=function(e){return e.sort(function(t,i){return i.totalDistance-t.totalDistance})},n.prototype.octile=function(e,t){var i=Math.SQRT2-1;return t>e?i*e+t:i*t+e},n.prototype.manhattan=function(e,t){return e+t},n.prototype.findNearestNeigbours=function(e,t,i){var r=[],a=e.parent;if(a){var s=(e.gridX-a.gridX)/Math.max(Math.abs(e.gridX-a.gridX),1),o=(e.gridY-a.gridY)/Math.max(Math.abs(e.gridY-a.gridY),1);s!==0?(this.isWalkable(e.gridX,e.gridY-1,!0)&&this.sourceGridCollection.indexOf(t[e.gridX][e.gridY-1])===-1&&r.push(t[e.gridX][e.gridY-1]),this.isWalkable(e.gridX,e.gridY+1,!0)&&this.sourceGridCollection.indexOf(t[e.gridX][e.gridY+1])&&r.push(t[e.gridX][e.gridY+1]),this.isWalkable(e.gridX+s,e.gridY,!0)&&this.sourceGridCollection.indexOf(t[e.gridX+s][e.gridY])===-1&&r.push(t[e.gridX+s][e.gridY])):o!==0&&(this.isWalkable(e.gridX-1,e.gridY,!0)&&this.sourceGridCollection.indexOf(t[e.gridX-1][e.gridY])===-1&&r.push(t[e.gridX-1][e.gridY]),this.isWalkable(e.gridX+1,e.gridY,!0)&&this.sourceGridCollection.indexOf(t[e.gridX+1][e.gridY])===-1&&r.push(t[e.gridX+1][e.gridY]),this.isWalkable(e.gridX,e.gridY+o,!0)&&this.sourceGridCollection.indexOf(t[e.gridX][e.gridY+o])===-1&&r.push(t[e.gridX][e.gridY+o]))}else this.neigbour(e,"top",r,i),this.neigbour(e,"right",r,i),this.neigbour(e,"bottom",r,i),this.neigbour(e,"left",r,i);return r},n.prototype.neigbour=function(e,t,i,r){for(var a=1,s;a>0;){var o=t==="top"||t==="bottom"?e.gridX:t==="left"?e.gridX-a:e.gridX+a,h=t==="right"||t==="left"?e.gridY:t==="top"?e.gridY-a:e.gridY+a;if(s=this.gridCollection[parseInt(o.toString(),10)][parseInt(h.toString(),10)],s&&(r&&this.sourceGridCollection.indexOf(s)===-1||!r&&this.targetGridCollection.indexOf(s)===-1))return i&&this.isWalkable(o,h)&&i.push(s),a;if(o>0&&h>0)a++;else break}return null},n.prototype.resetGridColl=function(e,t,i){for(var r=1,a;r>0;){var s=t==="top"||t==="bottom"?e.gridX:t==="left"?e.gridX-r:e.gridX+r,o=t==="right"||t==="left"?e.gridY:t==="top"?e.gridY-r:e.gridY+r;if(a=this.gridCollection[parseInt(s.toString(),10)][parseInt(o.toString(),10)],a&&(i&&this.sourceGridCollection.indexOf(a)===-1||!i&&this.targetGridCollection.indexOf(a)===-1)){if(this.isWalkable(s,o))break;var h=this.gridCollection[parseInt(s.toString(),10)][parseInt(o.toString(),10)];this.considerWalkable.push(h)}if(s>0&&o>0)t==="top"||t==="left"?r--:r++;else break}return null},n.prototype.isWalkable=function(e,t,i){if(e>=0&&e<this.noOfRows&&t>=0&&t<this.noOfCols){var r=this.gridCollection[parseInt(e.toString(),10)][parseInt(t.toString(),10)];if(r&&(r.walkable||(r.nodeId.length===1||r.nodeId.length===2&&r.parentNodeId||this.considerWalkable.indexOf(r)!==-1)&&(this.sourceGridCollection.indexOf(r)!==-1||this.targetGridCollection.indexOf(r)!==-1||this.considerWalkable.indexOf(r)!==-1))&&(i&&!r.parent||!i))return!0}return!1},n.prototype.findIntermediatePoints=function(e,t,i,r,a,s){for(var o=e-i,h=t-r,l=e,d=t,f=0;f<this.targetGridCollection.length;f++)if(e===this.targetGridCollection[parseInt(f.toString(),10)].gridX&&t===this.targetGridCollection[parseInt(f.toString(),10)].gridY)return{x:e,y:t};if(!this.isWalkable(e,t))return null;var p=this.gridCollection[parseInt(e.toString(),10)][parseInt(t.toString(),10)];if(p.tested)return{x:e,y:t};if(p.tested=!0,o!==0&&(o=o>0?1:-1,this.isWalkable(l,d-1)&&!this.isWalkable(l-o,d-1)||this.isWalkable(l,d+1)&&!this.isWalkable(l-o,d+1)))return{x:e,y:t};if(h!==0){if(h=h>0?1:-1,this.isWalkable(l-1,d)&&!this.isWalkable(l-1,d-h)||this.isWalkable(l+1,d)&&!this.isWalkable(l+1,d-h))return{x:e,y:t};if(this.findIntermediatePoints(l+1,d,l,d,a,s)||this.findIntermediatePoints(l-1,d,l,d,a,s))return{x:e,y:t}}return this.findIntermediatePoints(l+o,d+h,l,d,a,s)},n.prototype.destroy=function(){},n.prototype.getModuleName=function(){return"LineRouting"},n})(),dS=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),fS=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},pS=(function(n){dS(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return fS([w(!0)],e.prototype,"inversedAlignment",void 0),e})(j),Zr=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),ee=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},qt;(function(n){n.Synchronous="Synchronous",n.Asynchronous="Asynchronous",n.Reply="Reply",n.Create="Create",n.Delete="Delete",n.Self="Self"})(qt||(qt={}));var Ee;(function(n){n.Alternative="Alternative",n.Loop="Loop",n.Optional="Optional"})(Ee||(Ee={}));var wi;(function(n){n.Solid="Solid",n.Dashed="Dashed",n.SolidArrow="SolidArrow",n.DashedArrow="DashedArrow",n.Bidirectional="Bidirectional",n.DashedBidirectional="DashedBidirectional",n.OpenArrow="OpenArrow",n.DashedOpenArrow="DashedOpenArrow"})(wi||(wi={}));var cS=(function(n){Zr(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ee([w(void 0)],e.prototype,"id",void 0),ee([w(void 0)],e.prototype,"startMessageID",void 0),ee([w(void 0)],e.prototype,"endMessageID",void 0),e})(j),uS=(function(n){Zr(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.width=100,t.height=50,t}return ee([w(void 0)],e.prototype,"id",void 0),ee([w("")],e.prototype,"content",void 0),ee([w(!1)],e.prototype,"isActor",void 0),ee([w(!1)],e.prototype,"showDestructionMarker",void 0),ee([Lt([],cS)],e.prototype,"activationBoxes",void 0),e})(j),gS=(function(n){Zr(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ee([w(void 0)],e.prototype,"id",void 0),ee([w(void 0)],e.prototype,"fromParticipantID",void 0),ee([w(void 0)],e.prototype,"toParticipantID",void 0),ee([w("")],e.prototype,"content",void 0),ee([w("Synchronous")],e.prototype,"type",void 0),e})(j),vS=(function(n){Zr(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ee([w("")],e.prototype,"content",void 0),ee([w([])],e.prototype,"messageIds",void 0),ee([w(void 0)],e.prototype,"fragmentIds",void 0),e})(j),mS=(function(n){Zr(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return ee([w(void 0)],e.prototype,"id",void 0),ee([w("Optional")],e.prototype,"type",void 0),ee([Lt([],vS)],e.prototype,"conditions",void 0),e})(j),yS=(function(n){Zr(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.isLoadedFromMermaid=!1,t.hideFootBox=!0,t.activationWidth=20,t.initialLifelineLength=100,t.messageSpacing=50,t.participantWidth=100,t.participantHeight=50,t.margin=0,t}return e.prototype.parse=function(t,i){this.diagram=i,this.diagram.clear(),rr.clearLifelines(),Io.clearMessages();var r=new AS(i);this.model=r.parse(t),this.isLoadedFromMermaid=!0},e.prototype.loadDiagramFromMermaid=function(t,i){var r=new Ml(i);r.render(this.model,this),this.mermaidData=t},e.prototype.generateMermaidFromModel=function(){var t=new bS,i=t.generateMermaidText(this);return i},e.prototype.updateUmlSequenceDiagram=function(t){this.diagram||(this.diagram=t),this.diagram.clear(),rr.clearLifelines(),Io.clearMessages(),this.model=new Nf(this.diagram),this.model.isLoadedFromMermaid=!1,this.model.updateParticipants(this.participants),this.model.updateMessages(this.messages),this.model.updateActivations(this.participants),this.model.updateFragments(this.fragments)},e.prototype.render=function(){var t=new Ml(this.diagram);t.render(this.model,this),this.isLoadedFromMermaid=!1},ee([Lt([],uS)],e.prototype,"participants",void 0),ee([Lt([],gS)],e.prototype,"messages",void 0),ee([Lt([],mS)],e.prototype,"fragments",void 0),ee([w(100)],e.prototype,"spaceBetweenParticipants",void 0),e})(j),Nf=(function(){function n(e){this.maxParticipantWidth=100,this.maxParticipantHeight=50,this.isLoadedFromMermaid=!1,this.diagram=e,ft.clearMessageMapping(),this.participants=new Map,this.messages=[],this.activations=[],this.fragments=[],this.affectedParticipants=[],this.destroyedParticipants=[],this.destroyAtEndParticipants=[],this.aliases=new Map}return n.prototype.addParticipant=function(e){ft.updateNodeColor(e,"#6495ED"),this.diagram.nodes.push(e),this.participants.set(e.id,e),this.addLifeLine(e)},n.prototype.addLifeLine=function(e){var t=new B(this.diagram,"connectors",{id:e.id+"_Lifeline"},!0);ft.updateConnectorStyles(t,"Dashed"),this.diagram.connectors.push(t),rr.lifelines.set(e.id,t)},n.prototype.addMessage=function(e){this.diagram.connectors.push(e),this.messages.push(e)},n.prototype.addActivation=function(e){ft.updateNodeColor(e.node,"#6495ED"),this.activations.push(e)},n.prototype.addFragment=function(e){e.node&&this.diagram.nodes.push(e.node),this.fragments.push(e)},n.prototype.addAlias=function(e,t){this.aliases.set(e,t)},n.prototype.updateParticipants=function(e){this.participants.clear();for(var t=0,i=0,r=0,a=e;r<a.length;r++){var s=a[r];if(!s.id){console.warn("[WARNING] :: Participant ID cannot be undefined.");continue}var o=new M(this.diagram,"nodes",{id:s.id.toString(),width:s.width,height:s.height,data:s},!0);ft.updateNodeShape(o,s.isActor),ft.updateAnnotation(o,s.content,s.isActor),s.showDestructionMarker&&this.destroyAtEndParticipants.push(s.id.toString()),this.addParticipant(o),s.width>t&&(t=s.width),s.height>i&&(i=s.height)}this.maxParticipantWidth=t,this.maxParticipantHeight=i},n.prototype.updateMessages=function(e){this.messages=[],this.affectedParticipants=[];for(var t=0,i=e;t<i.length;t++){var r=i[t];if(!r.id){console.warn("[WARNING] :: Message ID cannot be undefined.");continue}var a=null,s=null;if(r.type===qt.Self?(a=this.getNodeFromId(r.fromParticipantID||r.toParticipantID),s=a):(a=this.getNodeFromId(r.fromParticipantID),s=this.getNodeFromId(r.toParticipantID)),!!(a&&s)){var o=new B(this.diagram,"connectors",{id:r.id.toString()},!0);ft.addOrUpdateParticipantDetails(o,a.id,s.id,r.type,null),ft.updateConnectorStyles(o,r.type.toString()),ft.updateAnnotation(o,r.content),r.type===qt.Create?(ft.addOrUpdateParticipantDetails(o,a.id,s.id,qt.Create,r.toParticipantID.toString()),this.affectedParticipants.push(r.toParticipantID.toString())):r.type===qt.Delete&&(ft.addOrUpdateParticipantDetails(o,a.id,s.id,qt.Delete,r.toParticipantID.toString()),this.affectedParticipants.indexOf(r.toParticipantID.toString())===-1&&this.affectedParticipants.push(r.toParticipantID.toString()),this.destroyedParticipants.push(r.toParticipantID.toString())),this.addMessage(o)}}},n.prototype.updateActivations=function(e){this.activations=[];for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.id&&r.activationBoxes&&r.activationBoxes.length>0)for(var a=0,s=r.activationBoxes;a<s.length;a++){var o=s[a];if(o.startMessageID&&o.endMessageID){var h=this.getNodeFromId(r.id),l=o.id?o.id.toString():K(),d=new M(this.diagram,"nodes",{id:h.id+"_Activation_"+l,minHeight:10,minWidth:10,data:o},!0);ft.updateNodeShape(d,!1);var f=this.getConnectorFromId(o.startMessageID),p=this.getConnectorFromId(o.endMessageID);if(f&&p){var c=ft.getParticipantDetails(f),u=ft.getParticipantDetails(p),g=new Xi(f.id,c.sourceParticipantName,c.targetParticipantName,ft.getAnnotation(f),0),v=new Xi(p.id,u.sourceParticipantName,u.targetParticipantName,ft.getAnnotation(p),0),m=new wo(d,h.id,g,v,0);this.addActivation(m)}else console.warn("[WARNING] :: Activation or deactivation connector details not found.")}}}},n.prototype.updateFragments=function(e){this.fragments=[];for(var t=0,i=e;t<i.length;t++){var r=i[t];if(!r.id){console.warn("[WARNING] :: Fragment ID cannot be null.");continue}var a=this.processFragment(r);this.removeChildFragmentsFromCollection(a),this.addFragment(a)}},n.prototype.removeChildFragmentsFromCollection=function(e){for(var t=0,i=e.childFragments;t<i.length;t++){var r=i[t],a=this.fragments.indexOf(r);a!==-1&&this.fragments.splice(a,1),this.removeChildFragmentsFromCollection(r)}},n.prototype.processFragment=function(e){for(var t=new Xf(e.id.toString(),e.type,[],[],new M(this.diagram,"nodes",{id:e.id.toString()+"_Fragment",data:e,shape:{type:"Path"},style:{fill:"transparent",strokeColor:"#000000",strokeWidth:1}},!0),0),i=0,r=e.conditions;i<r.length;i++){var a=r[i],s=new Yf(a.content,[],[],new mh);if(a.fragmentIds)for(var o=function(p){var c=h.fragments.find(function(u){return u.id===p});c?(s.nestedFragments.push(c),t.childFragments.push(c)):console.warn("[WARNING] :: Please ensure that all child fragments are defined in the collection before their respective parent fragments.")},h=this,l=0,d=a.fragmentIds;l<d.length;l++){var f=d[l];o(f)}this.processSequenceMessageIds(s,a.messageIds),e.type===Ee.Alternative&&this.populateConditionAltBlockDetails(s),t.conditions.push(s)}return t},n.prototype.populateConditionAltBlockDetails=function(e){for(var t=function(l){var d=e.altBlockDetails.connectors.some(function(f){return f.id===l.id});d||e.altBlockDetails.connectors.push(new ss(l.id,l.source,l.target,l.message,-1,"",!1,-1))},i=0,r=e.connectors;i<r.length;i++){var a=r[i];t(a)}for(var s=0,o=e.nestedFragments;s<o.length;s++){var h=o[s];this.addChildFragmentConnectors(e,h)}},n.prototype.addChildFragmentConnectors=function(e,t){for(var i=0,r=t.conditions;i<r.length;i++){for(var a=r[i],s=function(c){var u=e.altBlockDetails.connectors.some(function(g){return g.id===c.id});u||e.altBlockDetails.connectors.push(new ss(c.id,c.source,c.target,c.message,-1,t.id.toString(),!0,-1))},o=0,h=a.connectors;o<h.length;o++){var l=h[o];s(l)}for(var d=0,f=a.nestedFragments;d<f.length;d++){var p=f[d];this.addChildFragmentConnectors(e,p)}}},n.prototype.processSequenceMessageIds=function(e,t){for(var i=0,r=t;i<r.length;i++){var a=r[i];a!==void 0&&a!==""&&this.processConnector(e,a)}},n.prototype.processConnector=function(e,t){var i=this.getConnectorFromId(t);if(i){var r=ft.getParticipantDetails(i),a=new Xi(i.id.toString(),r.sourceParticipantName,r.targetParticipantName,ft.getAnnotation(i),0);e.connectors.push(a)}},n.prototype.getNodeFromId=function(e){var t;return e?this.participants.has(e.toString())?t=this.participants.get(e.toString()):console.warn("[WARNING] :: Participant '"+e.toString()+"' not found."):console.warn("[WARNING] :: ParticipantID is null."),t},n.prototype.getConnectorFromId=function(e){var t=this.messages.find(function(i){return i.id.toString()===e.toString()});return t||console.warn("[WARNING] :: Message ID '"+e.toString()+"' is not found."),t},n})(),ft=(function(){function n(){}return n.addOrUpdateParticipantDetails=function(e,t,i,r,a){var s=new SS(t,i,a,r);this.messageMapping.set(e,s)},n.getParticipantDetails=function(e){return this.messageMapping.get(e)},n.clearMessageMapping=function(){this.messageMapping.clear()},n.updateAnnotation=function(e,t,i){var r=t.trim();if(e instanceof M){if(e.annotations=[{content:r,horizontalAlignment:"Center"}],i){var a=e.annotations[0];a.style.textWrapping="NoWrap",a.offset={x:.5,y:1},a.margin={left:0,top:6,right:0,bottom:0}}}else e.annotations=[{content:r,style:{textWrapping:"NoWrap"},margin:{left:0,top:-10,right:0,bottom:0},rotationReference:"Page"}]},n.getAnnotation=function(e){return e.annotations[0].content},n.updateNodeShape=function(e,t){t?e.shape={type:"Path",data:zl}:e.shape={type:"Path",data:TS}},n.isActor=function(e){var t=e.shape;return t.type==="Path"&&t.data===zl},n.updateNodeColor=function(e,t){e.style={fill:t,strokeColor:"#000000",strokeWidth:1}},n.updateConnectorStyles=function(e,t){e.segments=[{type:"Straight"}];var i={fill:"black",strokeColor:"black",strokeWidth:1};e.sourceDecorator={shape:"None",style:i},e.targetDecorator={shape:"None",style:i};var r={strokeColor:"black",strokeWidth:1},a={strokeColor:"black",strokeWidth:1,strokeDashArray:"5,5"};if(this.isMermaidConnectorType(t))switch(t){case"Solid":e.style=r;break;case"Dashed":e.style=a;break;case"SolidArrow":e.style=r,e.targetDecorator.shape="Arrow";break;case"DashedArrow":e.style=a,e.targetDecorator.shape="Arrow";break;case"Bidirectional":e.style=r,e.sourceDecorator.shape="Arrow",e.targetDecorator.shape="Arrow";break;case"DashedBidirectional":e.style=a,e.sourceDecorator.shape="Arrow",e.targetDecorator.shape="Arrow";break;case"OpenArrow":e.style=r,e.targetDecorator.shape="OpenArrow";break;case"DashedOpenArrow":e.style=a,e.targetDecorator.shape="OpenArrow";break}else if(this.isUmlSequenceMessageType(t))switch(t){case"Synchronous":e.style=r,e.targetDecorator.shape="Arrow";break;case"Asynchronous":e.style=r,e.targetDecorator.shape="OpenArrow";break;case"Create":e.style=r,e.targetDecorator.shape="OpenArrow";break;case"Delete":e.style=r,e.targetDecorator.shape="Arrow";break;case"Reply":e.style=a,e.targetDecorator.shape="OpenArrow";break;case"Self":e.type="Orthogonal",e.segments=[{type:"Orthogonal",length:20,direction:"Left"},{type:"Orthogonal",length:50,direction:"Bottom"},{type:"Orthogonal",length:20,direction:"Right"}],e.style=r,e.targetDecorator.shape="Arrow";break}},n.removeConnectableConstraintForNode=function(e){e&&(e.constraints=W.Default&~(W.InConnect|W.OutConnect))},n.isMermaidConnectorType=function(e){var t=["Solid","Dashed","SolidArrow","DashedArrow","Bidirectional","DashedBidirectional","OpenArrow","DashedOpenArrow"];return t.indexOf(e)!==-1},n.isUmlSequenceMessageType=function(e){var t=["Synchronous","Asynchronous","Create","Delete","Reply","Self"];return t.indexOf(e)!==-1},n.messageMapping=new Map,n})(),wo=(function(){function n(e,t,i,r,a){this._node=null,this.node=e,this.participantName=t,this.activateConnectorDetails=i,this.deactivateConnectorDetails=r,this.depth=a}return Object.defineProperty(n.prototype,"node",{get:function(){return this._node},set:function(e){this._node=e,this._node.annotations=null,ft.removeConnectableConstraintForNode(this._node)},enumerable:!0,configurable:!0}),n})(),Xi=(function(){function n(e,t,i,r,a){this.id="",this.index=-1,this.source="",this.target="",this.message="",this.id=e,this.index=a,this.source=t,this.target=i,this.message=r}return n})(),Xf=(function(){function n(e,t,i,r,a,s,o){this.id="",this.conditions=[],this.depth=0,this.index=0,this.childFragments=[],this.id=e,this.type=t,this.conditions=i,this.childFragments=r,this.node=a,this.index=s,this.depth=o,this.fragmentStartIndex=-1,this.fragmentEndIndex=-1}return Object.defineProperty(n.prototype,"node",{get:function(){return this._node},set:function(e){this._node=e,ft.removeConnectableConstraintForNode(this._node)},enumerable:!0,configurable:!0}),n})(),Yf=(function(){function n(e,t,i,r){this.content="",this.connectors=[],this.altBlockDetails=new mh,this.nestedFragments=[],this.conditionStartIndex=-1,this.conditionEndIndex=-1,this.content=e,this.nestedFragments=t,this.connectors=i,this.altBlockDetails=r}return n})(),mh=(function(){function n(){this.connectors=[]}return n})(),ss=(function(n){Zr(e,n);function e(t,i,r,a,s,o,h,l){var d=n.call(this,t,i,r,a,s)||this;return d.fragmentID="",d.inFragment=!1,d.fragmentIndex=-1,d.fragmentID=o,d.inFragment=h,d.fragmentIndex=l,d}return e})(Xi),SS=(function(){function n(e,t,i,r){this.sourceParticipantName=e,this.targetParticipantName=t,this.affectedParticipantName=i,this.messageType=r}return n})(),Ml=(function(){function n(e){this.diagram=e}return n.prototype.render=function(e,t){t.messageSpacing=50,wS.render(this.diagram,e,t),Io.render(this.diagram,e,t);for(var i=0;i<this.diagram.nodes.length;i++){var r=this.diagram.nodes[parseInt(i.toString(),10)];this.diagram.preventNodesUpdate=!0,this.diagram.nodePropertyChange(r,{},{offsetX:r.offsetX,offsetY:r.offsetY,width:r.width,height:r.height,annotations:r.annotations,ports:r.ports},!0),this.diagram.preventNodesUpdate=!1}for(var i=0;i<this.diagram.connectors.length;i++){var a=this.diagram.connectors[parseInt(i.toString(),10)];this.diagram.preventConnectorsUpdate=!0,this.diagram.connectorPropertyChange(a,{},{sourcePoint:a.sourcePoint,targetPoint:a.targetPoint,sourceID:a.sourceID,targetID:a.targetID,sourcePortID:a.sourcePortID,targetPortID:a.targetPortID,sourcePadding:a.sourcePadding,targetPadding:a.targetPadding,sourceDecorator:a.sourceDecorator,targetDecorator:a.targetDecorator,annotations:a.annotations,ports:a.ports,constraints:a.constraints,segments:a.segments},!0),this.diagram.preventConnectorsUpdate=!1}CS.render(this.diagram,e,t),PS.render(this.diagram,e,t)},n})(),wS=(function(){function n(){}return n.render=function(e,t,i){this.diagram=e,this.model=t,this.settings=i;var r=[];t.participants.forEach(function(f,p){return r.push(f)}),this.updateParticipantsSize(r);for(var a=this.getUpdatedMargin(),s=i.margin+a.x,o=0;o<r.length;o++){var h=r[parseInt(o.toString(),10)];h.offsetX=s,h.offsetY=i.margin+a.y;var l=0;if(o<r.length-1){var d=r[o+1];ft.isActor(d)&&t.isLoadedFromMermaid&&this.resizeWithAspectRatio(d,t.maxParticipantHeight),l=d.width>0?d.width:this.model.maxParticipantWidth}s+=h.width/2+i.spaceBetweenParticipants+l/2,rr.render(e,t,h,i)}},n.updateParticipantsSize=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(ft.isActor(r)){var a=r.annotations[0];a.style.textWrapping="NoWrap",a.offset={x:.5,y:1},a.margin={left:0,top:6,right:0,bottom:0},this.model.isLoadedFromMermaid?this.resizeWithAspectRatio(r,this.model.maxParticipantHeight):this.resizeWithAspectRatio(r,50)}else r.width>0||(r.width=this.model.maxParticipantWidth),r.height>0||(r.height=this.model.maxParticipantHeight)}},n.resizeWithAspectRatio=function(e,t){var i=60,r=90,a=r/i;e.width=t,e.height=e.width*a},n.getUpdatedMargin=function(){var e=0,t=0,i=!0;return this.model.participants.forEach(function(r,a){r.width/2;var s=r.height/2;i&&(e=r.width/2,i=!1),s>t&&(t=s)}),{x:e,y:t}},n})(),Io=(function(){function n(){}return n.render=function(e,t,i){this.diagram=e,this.model=t,this.settings=i,this.messageLayouts=[],this.model.participants.forEach(function(h,l){h.height>t.maxParticipantHeight&&(t.maxParticipantHeight=h.height)});var r=i.messageSpacing+t.maxParticipantHeight;this.adjustMessageSpacing(t,i);for(var a=0;a<t.messages.length;a++){var s=t.messages[parseInt(a.toString(),10)];r=this.storeLayoutInfo(r,s),r+=i.messageSpacing}xS.adjustMessagePositionsForFragments(t,this.messageLayouts,i.messageSpacing);var o=this.calculateRequiredLifelineLength();this.model.participants.forEach(function(h,l){rr.updateLifelineLength(h,o)}),this.updateCreateMessage(),this.updateDestroyMessage(),this.renderMessagesOnLifeline()},n.adjustMessageSpacing=function(e,t){var i=t.messageSpacing;e.maxParticipantHeight>100&&(i+=(e.maxParticipantHeight-100)*.5),this.settings.messageSpacing=Math.max(i,t.messageSpacing)},n.storeLayoutInfo=function(e,t){return this.messageLayouts.push(new IS(t.id.toString(),e,t)),this.isSelfMessage(t)&&(e+=this.settings.messageSpacing),this.isCreateMessage(t)&&(e+=this.settings.messageSpacing/2),e},n.calculateRequiredLifelineLength=function(){if(!this.messageLayouts||this.messageLayouts.length===0)return this.getTopAndBottomPadding();for(var e=0,t=0,i=this.messageLayouts;t<i.length;t++){var r=i[t];r.yPosition>e&&(e=r.yPosition)}var a=this.settings.messageSpacing;return e+a},n.getTopAndBottomPadding=function(){return 2*(this.settings.messageSpacing+this.model.maxParticipantHeight)},n.isSelfMessage=function(e){var t=ft.getParticipantDetails(e);return t?t.sourceParticipantName===t.targetParticipantName:!1},n.isCreateMessage=function(e){var t=ft.getParticipantDetails(e);return t&&t.messageType===qt.Create},n.updateCreateMessage=function(){for(var e=function(s){var o=ft.getParticipantDetails(s);if(o&&o.messageType===qt.Create){var h=void 0;if(o.affectedParticipantName&&t.model.participants.has(o.affectedParticipantName)){h=t.model.participants.get(o.affectedParticipantName);var l=t.messageLayouts.find(function(d){return d.messageID===s.id.toString()});l&&(h.offsetY=l.yPosition,rr.updateLifelinePosition(h,l.yPosition))}}},t=this,i=0,r=this.model.messages;i<r.length;i++){var a=r[i];e(a)}},n.updateDestroyMessage=function(){for(var e=function(s){var o=ft.getParticipantDetails(s);if(o&&o.messageType===qt.Delete){var h=void 0;if(o.affectedParticipantName&&t.model.participants.has(o.affectedParticipantName)){h=t.model.participants.get(o.affectedParticipantName);var l=t.messageLayouts.find(function(d){return d.messageID===s.id.toString()});l&&rr.updateLifelineToDestroy(h,s,l.yPosition)}}},t=this,i=0,r=this.model.messages;i<r.length;i++){var a=r[i];e(a)}},n.renderMessagesOnLifeline=function(){rr.clearPorts();for(var e=0,t=this.messageLayouts;e<t.length;e++){var i=t[e],r=i.connector,a=ft.getParticipantDetails(r);if(a){var s=this.getLifeline(this.model.participants,a.sourceParticipantName),o=this.getLifeline(this.model.participants,a.targetParticipantName);this.isSelfMessage(r)?this.renderSelfMessage(s,r,i.yPosition):this.renderNormalMessage(s,o,r,i.yPosition)}}},n.renderNormalMessage=function(e,t,i,r){var a=this.createPort(e,r),s=this.createPort(t,r);this.applyActivationPadding(a,i,r,!0),this.applyActivationPadding(s,i,r,!1),this.assignPortOrPoint(i,a,e,r,!0),this.assignPortOrPoint(i,s,t,r,!1),i.sourcePortID||(i.sourcePoint.y=r),i.targetPortID||(i.targetPoint.y=r)},n.renderSelfMessage=function(e,t,i){var r=this.createPort(e,i),a=this.createPort(e,i+this.settings.messageSpacing);this.applyActivationPadding(r,t,i,!0),this.applyActivationPadding(a,t,i+this.settings.messageSpacing,!1),t.type="Orthogonal",t.segments=[{type:"Orthogonal",length:20,direction:"Left"},{type:"Orthogonal",length:50,direction:"Bottom"},{type:"Orthogonal",length:20,direction:"Right"}],this.assignPortOrPoint(t,r,e,i,!0),this.assignPortOrPoint(t,a,e,i,!1)},n.applyActivationPadding=function(e,t,i,r){var a=ft.getParticipantDetails(t);if(a&&this.model.activations){var s=r?a.sourceParticipantName:a.targetParticipantName;this.isWithinActivation(s,i,t)&&(r?t.sourcePadding=this.settings.activationWidth/2-e.height/2:t.targetPadding=this.settings.activationWidth/2-e.height/2)}},n.isWithinActivation=function(e,t,i){var r=this.model.messages.findIndex(function(f){return f.id.toString()===i.id.toString()});if(r===-1)return!1;for(var a=function(f){if(f.participantName===e&&f.activateConnectorDetails&&f.deactivateConnectorDetails){var p=s.model.messages.findIndex(function(g){return g.id.toString()===f.activateConnectorDetails.id}),c=s.model.messages.findIndex(function(g){return g.id.toString()===f.deactivateConnectorDetails.id});if(p!==-1&&c!==-1){var u=ft.getParticipantDetails(s.model.messages[parseInt(p.toString(),10)]);if(u&&u.sourceParticipantName===u.targetParticipantName&&r===p)return{value:!1};if(r>=p&&r<=c)return{value:!0}}}},s=this,o=0,h=this.model.activations;o<h.length;o++){var l=h[o],d=a(l);if(typeof d=="object")return d.value}return!1},n.createPort=function(e,t){var i=this.getLifelineSourceY(e),r=this.calculateLifelineLength(e,i),a=this.calculateLengthFraction(t,i,r);a=a>1?1:a;var s=new ke(this.diagram,"ports",{id:K(),offset:a});return this.addPortToLifeline(e,s),s},n.assignPortOrPoint=function(e,t,i,r,a){var s=i.sourcePoint.x;if(t.offset===1)a?e.sourcePoint={x:s,y:r}:e.targetPoint={x:s,y:r};else if(a)e.sourceID=i.id,e.sourcePortID=t.id;else{var o=ft.getParticipantDetails(e),h=o&&o.messageType===qt.Create&&o.affectedParticipantName&&o.targetParticipantName===o.affectedParticipantName;if(h){var l=void 0;this.model.participants.has(o.affectedParticipantName)&&(l=this.model.participants.get(o.affectedParticipantName),e.targetID=l.id,e.targetPadding=0)}e.targetID||(e.targetID=i.id,e.targetPortID=t.id)}},n.addPortToLifeline=function(e,t){this.diagram.addPorts(e,[t]),this.diagram.protectPropertyChange(!0)},n.getLifelineSourceY=function(e){return e.sourcePoint.y},n.calculateLifelineLength=function(e,t){return e.targetPoint.y-t},n.calculateLengthFraction=function(e,t,i){return(e-t)/i},n.getLifeline=function(e,t){return rr.lifelines.get(t)},n.clearMessages=function(){this.messageLayouts=[]},n.messageLayouts=[],n})(),IS=(function(){function n(e,t,i){this.messageID=e,this.yPosition=t,this.connector=i}return n})(),xS=(function(){function n(){}return n.adjustMessagePositionsForFragments=function(e,t,i){for(var r=0,a=e.fragments;r<a.length;r++){var s=a[r];this.computeFragmentMessageRange(s,e)}var o=[];this.collectAllFragments(e.fragments,o),o.sort(function(P,A){return P.fragmentStartIndex-A.fragmentStartIndex});for(var h=1.5,l=.7,d=.8,f=0,p=o;f<p.length;f++){var s=p[f];if(!(s.fragmentStartIndex<0)){var c=s.childFragments&&s.childFragments.length>0,u=c?i*h:i,g=i*l;if(this.shiftMessages(t,s.fragmentStartIndex,u),s.fragmentEndIndex>=0&&s.fragmentEndIndex+1<t.length&&this.shiftMessages(t,s.fragmentEndIndex+1,g),s.type===Ee.Alternative){for(var v=0,m=s.conditions;v<m.length;v++){var y=m[v];this.computeConditionMessageRange(y,e)}for(var S=s.conditions.filter(function(A){return A.conditionStartIndex>=0}).sort(function(A,T){return A.conditionStartIndex-T.conditionStartIndex}),x=i*d,I=1;I<S.length;I++){var C=S[parseInt(I.toString(),10)].conditionStartIndex;C>=0&&C<t.length&&this.shiftMessages(t,C,x)}}}}},n.collectAllFragments=function(e,t){for(var i=0,r=e;i<r.length;i++){var a=r[i];t.push(a),a.childFragments&&a.childFragments.length>0&&this.collectAllFragments(a.childFragments,t)}},n.computeFragmentMessageRange=function(e,t){for(var i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=0,s=e.conditions;a<s.length;a++)for(var o=s[a],h=function(g){var v=t.messages.findIndex(function(m){return m.id.toString()===g.id});v>=0&&v<i&&(i=v),v>r&&(r=v)},l=0,d=o.connectors;l<d.length;l++){var f=d[l];h(f)}for(var p=0,c=e.childFragments;p<c.length;p++){var u=c[p];this.computeFragmentMessageRange(u,t),u.fragmentStartIndex>=0&&u.fragmentStartIndex<i&&(i=u.fragmentStartIndex),u.fragmentEndIndex>r&&(r=u.fragmentEndIndex)}i===Number.MAX_SAFE_INTEGER&&(i=-1),r===Number.MIN_SAFE_INTEGER&&(r=-1),e.fragmentStartIndex=i,e.fragmentEndIndex=r},n.computeConditionMessageRange=function(e,t){for(var i=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,a=function(l){var d=t.messages.findIndex(function(f){return f.id.toString()===l.id});if(d<0)return"continue";d<i&&(i=d),d>r&&(r=d)},s=0,o=e.connectors;s<o.length;s++){var h=o[s];a(h)}i===Number.MAX_SAFE_INTEGER&&(i=-1),r===Number.MIN_SAFE_INTEGER&&(r=-1),e.conditionStartIndex=i,e.conditionEndIndex=r},n.shiftMessages=function(e,t,i){if(i!==0)for(var r=t;r<e.length;r++)e[parseInt(r.toString(),10)].yPosition+=i},n})(),CS=(function(){function n(){}return n.render=function(e,t,i){this.diagram=e,this.model=t,this.settings=i;for(var r=0,a=t.activations;r<a.length;r++){var s=a[r];this.renderActivation(s)}},n.renderActivation=function(e){var t=this.model.messages.find(function(l){var d=ft.getParticipantDetails(l);return l.id!=null&&l.id===e.activateConnectorDetails.id.toString()&&d!=null&&d.sourceParticipantName===e.activateConnectorDetails.source&&d.targetParticipantName===e.activateConnectorDetails.target&&ft.getAnnotation(l)===e.activateConnectorDetails.message}),i=this.model.messages.find(function(l){var d=ft.getParticipantDetails(l);return l.id!=null&&l.id===e.deactivateConnectorDetails.id.toString()&&d!=null&&d.sourceParticipantName===e.deactivateConnectorDetails.source&&d.targetParticipantName===e.deactivateConnectorDetails.target&&ft.getAnnotation(l)===e.deactivateConnectorDetails.message}),r=this.getParticipantByName(e.participantName),a=t?{x:t.sourcePoint.x,y:t.sourcePoint.y}:{x:0,y:0},s=i?{x:i.targetPoint.x,y:i.targetPoint.y}:{x:0,y:0};e.depth=this.calculateActivationDepth(e,a,s);var o=ft.getParticipantDetails(t);o&&(o.sourceParticipantName===o.targetParticipantName?a.y=t.targetPoint.y:o.messageType===qt.Create&&o.targetParticipantName===e.participantName&&(a.y+=r.height/2+(ft.isActor(r)?15:5)));var h=e.node;h.offsetX=r.offsetX+e.depth*(this.settings.activationWidth/4),h.offsetY=a.y+(s.y-a.y)/2,h.width=this.settings.activationWidth,h.height=Math.abs(a.y-s.y),this.diagram.add(h)},n.calculateActivationDepth=function(e,t,i){for(var r=this,a=this.model.activations.filter(function(f){return f.participantName===e.participantName&&f!==e&&r.isOverlapping(e,f)}).sort(function(f,p){return f.activateConnectorDetails.index-p.activateConnectorDetails.index}),s=0,o=0,h=a;o<h.length;o++){var l=h[o],d=this.getStartPoint(l);t.y>d&&s++}return s},n.isOverlapping=function(e,t){var i=this.getStartPoint(e),r=this.getEndPoint(e),a=this.getStartPoint(t),s=this.getEndPoint(t);return i<s&&a<r},n.getStartPoint=function(e){var t=this.model.messages.find(function(i){return i.id.toString()===e.activateConnectorDetails.id.toString()});return t?t.sourcePoint.y:0},n.getEndPoint=function(e){var t=this.model.messages.find(function(i){return i.id.toString()===e.deactivateConnectorDetails.id.toString()});return t?t.targetPoint.y:0},n.getParticipantByName=function(e){return this.model.participants.has(e)?this.model.participants.get(e):null},n})(),PS=(function(){function n(){}return n.render=function(e,t,i){this.diagram=e,this.model=t,this.settings=i;for(var r=0,a=t.fragments;r<a.length;r++){var s=a[r];this.renderFragment(s)}},n.renderFragment=function(e){for(var t=0,i=e.childFragments;t<i.length;t++){var r=i[t];this.renderFragment(r)}switch(e.type){case Ee.Optional:case Ee.Loop:this.renderGeneralFragment(e);break;case Ee.Alternative:this.renderAlternativeFragment(e);break}},n.renderGeneralFragment=function(e){for(var t=0,i=e.conditions;t<i.length;t++){var r=i[t],a=this.calculateFragmentBoundary(r,e);if(a&&a.width!==0&&a.height!==0){this.createFragmentNode(e,r.content,a);var s=e.node;this.diagram.preventNodesUpdate=!0,this.diagram.nodePropertyChange(s,{shape:{type:"Path"}},{shape:s.shape},!0),this.diagram.preventNodesUpdate=!1}}},n.renderAlternativeFragment=function(e){var t=this.calculateAltFragmentBoundary(e);if(t&&t.width!==0&&t.height!==0){this.createFragmentNode(e,e.conditions[0].content,t);var i=e.node;this.updateAlternativeFragmentShape(e,i),this.diagram.preventNodesUpdate=!0,this.diagram.nodePropertyChange(i,{shape:{type:"Path"}},{shape:i.shape},!0),this.diagram.preventNodesUpdate=!1}},n.updateAlternativeFragmentShape=function(e,t){var i=t.wrapper.bounds,r=this.getAlternateFragmentShape(i);r=this.appendConditionDottedLines(e,t,i,r),t.shape={type:"Path",data:r}},n.getAlternateFragmentShape=function(e){var t=e.width,i=e.height,r=40,a=19.7,s=a/2,o=r*.19,h="M "+e.x+" "+e.y+" L "+(e.x+t)+" "+e.y+" L "+(e.x+t)+" "+(e.y+i)+" L "+e.x+" "+(e.y+i)+" Z",l="M "+e.x+" "+e.y+" H "+(e.x+r)+" V "+(e.y+s+a/6)+" C "+(e.x+r-o)+" "+(e.y+a)+" "+(e.x+r)+" "+(e.y+s+a/6)+" "+(e.x+r-o)+" "+(e.y+a)+" H "+e.x+" Z";return h+" "+h+" "+l},n.appendConditionDottedLines=function(e,t,i,r){for(var a=0;a<e.conditions.length-1;a++){var s=e.conditions[parseInt(a.toString(),10)],o=e.conditions[a+1],h=this.calculateCenterYBetweenConditions(s,o);h===0&&(h=i.top+i.height/(e.conditions.length+1)*(a+1)),r+=this.createDashedLinePath(t,i,h),this.addAnnotationForAlternativeCondition(t,h,i,o)}return r},n.createDashedLinePath=function(e,t,i){for(var r="M "+t.x+" "+i+" ",a=5,s=5,o=Math.floor(t.width/(a+s)),h=0;h<o;h++)r+="l "+a+" 0 ",r+="m "+s+" 0 ";return r},n.addAnnotationForAlternativeCondition=function(e,t,i,r){var a=this.calculateAnnotationYOffset(t,e.height,i.y),s=new ae(e,"annotations",{content:"["+r.content+"]",offset:{x:0,y:a},horizontalAlignment:"Left",margin:{left:9,top:15,right:5,bottom:5},style:{bold:!0}});this.diagram.addLabels(e,[s]),this.diagram.protectPropertyChange(!0)},n.calculateAnnotationYOffset=function(e,t,i){var r=e-i,a=Math.max(0,Math.min(r,t));return a/t},n.calculateFragmentBoundary=function(e,t){var i=void 0;if(e.connectors&&e.connectors.length>0){var r=this.getMessagesFromConnectorDetails(e.connectors);i=this.getBoundaryFromMessages(r)}var a=this.calculateChildFragmentBoundary(t),s=this.model.maxParticipantWidth/4;if(!(!i&&!a)){if(!i){var o=new it(a.left-s,a.top-s,a.width+s*2,a.height+s*2);return this.adjustCombinedBoundary(o,i,a)}return a?this.combineBoundaries(i,a):i}},n.getBoundaryFromMessages=function(e){var t=this.getMinCoordinates(e),i=this.getMaxCoordinates(e),r=this.hasCreateMessage(e),a=this.hasSelfMessage(e),s=this.model.maxParticipantWidth/4;r&&(s+=this.model.maxParticipantWidth/3),a&&(s+=this.model.maxParticipantWidth/6);for(var o=this.settings.messageSpacing/3,h=t.x-s,l=t.y-o,d=i.x-t.x+2*s,f=i.y-t.y+2*o,p=0,c=e;p<c.length;p++){var u=c[p];if(u.targetID&&this.diagram.getObject(u.targetID)instanceof M){var g=this.diagram.getObject(u.targetID);if(g&&g instanceof M&&g.wrapper){var v=g.wrapper.bounds,m=v.x+v.width+s,y=v.y+v.height+o;d=Math.max(d,m-h),f=Math.max(f,y-l)}}}var S=e[e.length-1],x=ft.getParticipantDetails(S);return x&&x.messageType===qt.Delete&&(f+=25),new it(h,l,d,f)},n.hasSelfMessage=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t],a=ft.getParticipantDetails(r);if(a&&a.sourceParticipantName===a.targetParticipantName)return!0}return!1},n.hasCreateMessage=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.targetID&&this.diagram.getObject(r.targetID)instanceof M)return!0}return!1},n.calculateChildFragmentBoundary=function(e){if(!(!e.childFragments||e.childFragments.length===0)){for(var t=[],i=0;i<e.childFragments.length;i++){for(var r=e.childFragments[parseInt(i.toString(),10)],a=[],s=0;s<r.conditions.length;s++)for(var o=r.conditions[parseInt(s.toString(),10)].connectors,h=0;h<o.length;h++)a.push(o[parseInt(h.toString(),10)]);var l=this.getMessagesFromConnectorDetails(a),d=this.getBoundaryFromMessages(l),f=this.calculateChildFragmentBoundary(r),p=this.combineBoundaries(d,f);p&&t.push(p)}if(t.length!==0){var c=Math.min.apply(null,t.map(function(m){return m.left})),u=Math.min.apply(null,t.map(function(m){return m.top})),g=Math.max.apply(null,t.map(function(m){return m.right})),v=Math.max.apply(null,t.map(function(m){return m.bottom}));return new it(c,u,g-c,v-u)}}},n.combineBoundaries=function(e,t){if(!t)return e;var i=this.model.maxParticipantWidth/4,r=new it(Math.min(e.left,t.left)-i,Math.min(e.top,t.top)-i,Math.max(e.right,t.right)-Math.min(e.left,t.left)+i*2,Math.max(e.bottom,t.bottom)-Math.min(e.top,t.top)+i*2);return this.adjustCombinedBoundary(r,e,t)},n.adjustCombinedBoundary=function(e,t,i){var r=this.settings.messageSpacing/2;return!t&&i?new it(e.left,e.top-r,e.width,e.height+r):t&&i&&t.top>i.top?new it(e.left,e.top-r,e.width,e.height+r):e},n.getMinCoordinates=function(e){for(var t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,r=0;r<e.length;r++){var a=e[parseInt(r.toString(),10)],s=Math.min(a.sourcePoint.x,a.targetPoint.x),o=Math.min(a.sourcePoint.y,a.targetPoint.y);s<t&&(t=s),o<i&&(i=o)}return{x:t,y:i}},n.getMaxCoordinates=function(e){for(var t=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,r=0;r<e.length;r++){var a=e[parseInt(r.toString(),10)],s=Math.max(a.sourcePoint.x,a.targetPoint.x),o=Math.max(a.sourcePoint.y,a.targetPoint.y);s>t&&(t=s),o>i&&(i=o)}return{x:t,y:i}},n.calculateAltFragmentBoundary=function(e){var t=[].concat.apply([],e.conditions.map(function(h){return h.connectors})),i=void 0;if(t.length>0){var r=this.getMessagesFromConnectorDetails(t);i=this.getBoundaryFromMessages(r)}var a=this.calculateChildFragmentBoundary(e),s=this.model.maxParticipantWidth/4;if(!(!i&&!a)){if(!i){var o=new it(a.x-s,a.y-s,a.width+s*2,a.height+s*2);return this.adjustCombinedBoundary(o,i,a)}return a?this.combineBoundaries(i,a):i}},n.getMessagesFromConnectorDetails=function(e){for(var t=[],i=0;i<e.length;i++){for(var r=e[parseInt(i.toString(),10)],a=[],s=0;s<this.model.messages.length;s++){var o=this.model.messages[parseInt(s.toString(),10)],h=ft.getParticipantDetails(o);o.id!=null&&o.id.toString()===r.id.toString()&&h!=null&&this.stringEquals(h.sourceParticipantName,r.source)&&this.stringEquals(h.targetParticipantName,r.target)&&this.stringEquals(ft.getAnnotation(o),r.message)&&a.push(o)}Array.prototype.push.apply(t,a)}return t},n.stringEquals=function(e,t){return e.toString().toLowerCase()===t.toString().toLowerCase()},n.getMessageFromConnectorDetails=function(e,t,i,r){return this.model.messages.find(function(a){var s=ft.getParticipantDetails(a);return a.id!=null&&a.id.toString().toLowerCase()===e.toLowerCase()&&s!=null&&s.sourceParticipantName.toLowerCase()===t.toLowerCase()&&s.targetParticipantName.toLowerCase()===i.toLowerCase()&&ft.getAnnotation(a).toLowerCase()===r.toLowerCase()})},n.calculateCenterYBetweenConditions=function(e,t){var i=0,r=0;if(e.altBlockDetails.connectors.length>0){var a=e.altBlockDetails.connectors[e.altBlockDetails.connectors.length-1];if(a.inFragment){var s=void 0;a.fragmentIndex!==-1?s=this.diagram.getObject(a.fragmentIndex.toString()+"_Fragment"):s=this.diagram.getObject(a.fragmentID+"_Fragment"),i=s.wrapper.bounds.bottomLeft.y}else{var o=this.getMessageFromConnectorDetails(a.id,a.source,a.target,a.message);o&&(i=o.targetPoint.y)}}if(t.altBlockDetails.connectors.length>0){var h=t.altBlockDetails.connectors[0];if(h.inFragment){var l=void 0;h.fragmentIndex!==-1?l=this.diagram.getObject(h.fragmentIndex.toString()+"_Fragment"):l=this.diagram.getObject(h.fragmentID+"_Fragment"),r=l.wrapper.bounds.topLeft.y}else{var d=this.getMessageFromConnectorDetails(h.id,h.source,h.target,h.message);d&&(r=d.targetPoint.y)}}return i!==0&&r!==0?i+(r-i)/2:i===0&&r!==0?r-20:r===0&&i!==0?i+10:0},n.createFragmentNode=function(e,t,i){var r=this.getFragmentType(e.type),a=Math.max(i.width,this.model.maxParticipantWidth),s=i.height+this.settings.messageSpacing,o=e.index===0?e.id.toString():e.index.toString(),h=i.x+i.width/2,l=i.y+i.height/2-this.settings.messageSpacing/2,d=[this.createAnnotation(r),this.createAnnotation(t?"["+t+"]":"",30)],f=e.node;f?(f.id=o+"_Fragment",this.diagram.addLabels(f,d),this.diagram.protectPropertyChange(!0),f.width=a,f.height=s,f.offsetX=h,f.offsetY=l,f.shape={type:"Path",data:this.getGeneralFragmentShape(a,s)},this.diagram.preventNodesUpdate=!0,this.diagram.nodePropertyChange(f,{},{offsetX:f.offsetX,offsetY:f.offsetY,width:f.width,height:f.height,annotations:f.annotations},!0),this.diagram.preventNodesUpdate=!1):(e.node=new M(this.diagram,"nodes",{id:o+"_Fragment",annotations:d,width:a,height:s,offsetX:h,offsetY:l,shape:{type:"Path",data:this.getGeneralFragmentShape(a,s)},style:{fill:"transparent",strokeColor:"#000000",strokeWidth:1}},!0),e.node=this.diagram.add(e.node))},n.getGeneralFragmentShape=function(e,t){var i=40,r=12,a="M 0,0 L "+e+",0 L "+e+","+t+" L 0,"+t+" Z",s=i*.2,o="M 0,0 H "+i+" V "+r+" C "+(i-s)+" "+(r+s)+" "+i+" "+r+" "+(i-s)+" "+(r+s)+" H 0 Z";return a+" "+a+" "+o},n.getFragmentType=function(e){switch(e){case Ee.Alternative:return"alt";case Ee.Loop:return"loop";case Ee.Optional:return"opt";default:throw new Error("Invalid fragment type")}},n.createAnnotation=function(e,t){return t===void 0&&(t=9),{content:e,offset:{x:0,y:0},horizontalAlignment:"Left",verticalAlignment:"Top",margin:{left:9,top:t,right:5,bottom:5},style:{bold:!0}}},n})(),rr=(function(){function n(){}return n.render=function(e,t,i,r){this.diagram=e,this.model=t,this.settings=r;var a={x:i.offsetX,y:i.offsetY+t.maxParticipantHeight},s={x:a.x,y:a.y+r.initialLifelineLength},o=null;!r.hideFootBox&&t.destroyedParticipants.indexOf(i.id.toString())===-1&&t.destroyAtEndParticipants.indexOf(i.id.toString())===-1&&(o=this.renderFootBoxNode(i),o.offsetX=s.x,o.offsetY=s.y),this.createCenterPort(i),this.createLifelineConnector(i,o,s)},n.createCenterPort=function(e){var t=new Se(this.diagram,"ports",{id:e.id+"_center_port",shape:null});this.diagram.addPorts(e,[t]),this.diagram.protectPropertyChange(!0)},n.createLifelineConnector=function(e,t,i){var r=this.lifelines.get(e.id);if(t&&t.ports&&t.ports.length>0){var a=t.ports[0];r.targetPortID=a.id,r.targetID=t.id;var s=t.height/2;r.targetPadding=-(s+a.height/2),r.targetPoint={x:t.offsetX,y:t.offsetY-s}}else r.targetPoint=i;if(e&&e.ports&&e.ports.length>0){var a=e.ports[0];r.sourcePortID=a.id,r.sourceID=e.id;var o=ft.isActor(e)?e.height/2+e.height/6:e.height/2;r.sourcePadding=o-a.height/2,r.sourcePoint={x:e.offsetX,y:e.offsetY+o}}return r.annotations=null,r.sourceDecorator={shape:"None"},r.targetDecorator={shape:"None"},r.constraints=r.constraints&~(yt.DragSourceEnd|yt.Delete),r},n.renderFootBoxNode=function(e){var t=new M(this.diagram,"nodes",{id:"FootBox_"+e.id,width:e.width,height:e.height,shape:e.shape,annotations:e.annotations,style:e.style,ports:[{id:e.id+"_center_port",shape:null}]},!0);return this.diagram.add(t)},n.updateLifelineLength=function(e,t){var i=this.lifelines.get(e.id);if(this.settings.hideFootBox)i.targetPoint={x:i.targetPoint.x,y:e.offsetY+this.model.maxParticipantHeight+t},this.model.destroyAtEndParticipants.indexOf(e.id.toString())!==-1&&this.model.destroyedParticipants.indexOf(e.id.toString())===-1&&this.updateDestroyMark(i);else{var r=i.targetID,a=e.offsetY+this.model.maxParticipantHeight+t;if(r){var s=this.diagram.nodes.find(function(o){return o.id===r});s.offsetY=a}else this.model.destroyAtEndParticipants.indexOf(e.id.toString())!==-1&&this.model.destroyedParticipants.indexOf(e.id.toString())===-1&&(i.targetPoint={x:i.targetPoint.x,y:a},this.updateDestroyMark(i))}},n.updateLifelinePosition=function(e,t){var i=this.lifelines.get(e.id),r=ft.isActor(e)?e.height/2+e.height/6:e.height/2;i.sourcePoint={x:i.sourcePoint.x,y:t+r}},n.updateLifelineToDestroy=function(e,t,i){var r=this.lifelines.get(e.id);i+=20,r.targetPoint={x:r.targetPoint.x,y:i},this.updateDestroyMark(r)},n.updateDestroyMark=function(e){e.targetDecorator={shape:"Custom",pathData:"M 0,0 L 25,25 M 25,0 L 0,25",pivot:{x:.5,y:.5},style:{fill:"none",strokeColor:"#000000",strokeWidth:1}}},n.clearLifelines=function(){this.lifelines.clear()},n.clearPorts=function(){this.lifelines.forEach(function(e,t){e.ports=[]})},n.lifelines=new Map,n})(),zl="M4.5000001,12.548 L18.5,12.548 C20.709,12.548 22.5,14.335995 22.5,16.542004 L22.5,32.516996 19.5,32.516996 19.5,24.529997 17.5,24.529997 17.5,43.5 12.5,43.5 12.5,35.512999 C12.5,34.960997 12.052002,34.514006 11.5,34.514006 10.947998,34.514006 10.5,34.960997 10.5,35.512999 L10.5,43.5 5.4999996,43.5 5.4999996,24.529997 3.5000001,24.529997 3.5000001,32.516996 0.5,32.516996 0.5,16.542004 C0.50000012,14.335995 2.2910005,12.548 4.5000001,12.548 z M11.499001,0.5 C14.305002,0.5 16.580004,2.795001 16.580004,5.6260009 16.580004,8.4570012 14.305002,10.752001 11.499001,10.752002 8.6939994,10.752001 6.4189988,8.4570012 6.4189988,5.6260009 6.4189988,2.795001 8.6939994,0.5 11.499001,0.5 z",TS="M242,1078L231,1078L231,1067L242,1067z",AS=(function(){function n(e){this.lines=[],this.activationCache=new Map,this.fragmentStack=[],this.currentCondition=null,this.diagram=e,this.sequenceDiagramModel=new Nf(e),this.sequenceDiagramModel.isLoadedFromMermaid=!0}return n.prototype.parse=function(e){this.lines=e.split(/\r?\n/).filter(function(r){return r.trim().length>0});for(var t=1;t<=this.lines.length;t++){var i=this.lines[t-1];this.parseLine(i.trim(),t)}return this.sequenceDiagramModel},n.prototype.parseLine=function(e,t){/^\s*(create|destroy)\b/i.test(e)?this.parseCreateOrDestroyMessage(e,t):/^\s*(participant|actor)\b/i.test(e)?this.parseParticipant(e):/\w+\s*(<<-{1,2}|-{1,2}>>?|<<-{1,2}>>?|-{1,2}\))\s*\w+/i.test(e)?this.parseConnector(e,t):/^(?!\s*(alt|else if|else|opt|loop|end)\b)(?!\w+\s*--?\)\s*\w+\s*:)(?=.*(?:activate|deactivate)\b|.*[+-])/i.test(e)?this.parseActivation(e,t):/^\s*(alt|else if|else|opt|loop|end)(?:\s+(.*))?/i.test(e)&&this.parseFragment(e,t)},n.prototype.parseCreateOrDestroyMessage=function(e,t){var i=/^\s*create\b/i.test(e);if(i){var r=e.match(/create\s+(participant|actor)\s+(\w+)(?:\s+as\s+(.+))?/i);if(!r){console.warn("[WARNING] :: Invalid create syntax: '"+e+"'.");return}var a=r[1],s=r[3]?r[2]:null,o=r[3]||r[2],h=s||o;this.createOrGetParticipant(o,s,a.toLowerCase()==="actor");for(var l=t,d=null;l<this.lines.length&&(d=this.lines[parseInt(l.toString(),10)].trim(),!(d&&!d.startsWith("%%")));)l++;if(l<this.lines.length&&/\w+\s*(-\)|<<-{1,2}|-{1,2}>>?|<<-{1,2}>>?|\(-{1,2}\))\s*\w+\s*:\s*.+/.test(d)){var f=d.match(/(\w+)\s*(-\)|<<-{1,2}|-{1,2}>>?|<<-{1,2}>>?|\(-{1,2}\))\s*(\w+)\s*:\s*(.+)/);if(f){var p=f[1];f[2];var c=f[3],u=f[4];if(p.toLowerCase()===h.toLowerCase()||c.toLowerCase()===h.toLowerCase()){var g=new B(this.diagram,"connectors",{id:(l+1).toString()},!0);ft.addOrUpdateParticipantDetails(g,p,c,qt.Create,h),ft.updateAnnotation(g,u),ft.updateConnectorStyles(g,qt.Create.toString()),this.sequenceDiagramModel.affectedParticipants.push(h),this.sequenceDiagramModel.addMessage(g),this.registerConnectorInCondition(g,l+1)}}}}else{var r=e.match(/destroy\s+(\w+)/i);if(!r){console.warn("[WARNING] :: Invalid destroy syntax: '"+e+"'.");return}var o=r[1];if(!this.sequenceDiagramModel.participants.has(o)){console.warn("[WARNING] :: Participant '"+o+"' not found for destroy.");return}for(var l=t,d=null;l<this.lines.length&&(d=this.lines[parseInt(l.toString(),10)].trim(),!(d&&!d.startsWith("%%")));)l++;if(l<this.lines.length&&/\w+\s*(<<-{1,2}|-{1,2}>>?|\(-{1,2}\)|<<-{1,2}>>?)\s*\w+\s*:\s*.+/.test(d)){var f=d.match(/(\w+)\s*(<<-{1,2}|-{1,2}>>?|\(-{1,2}\)|<<-{1,2}>>?)\s*(\w+)\s*:\s*(.+)/);if(f){var p=f[1];f[2];var c=f[3],u=f[4];if(p.toLowerCase()===o.toLowerCase()||c.toLowerCase()===o.toLowerCase()){var v=new B(this.diagram,"connectors",{id:(l+1).toString()},!0);ft.addOrUpdateParticipantDetails(v,p,c,qt.Delete,o),ft.updateAnnotation(v,u),ft.updateConnectorStyles(v,qt.Delete.toString()),this.sequenceDiagramModel.affectedParticipants.indexOf(o)===-1&&this.sequenceDiagramModel.affectedParticipants.push(o),this.sequenceDiagramModel.destroyedParticipants.push(o),this.sequenceDiagramModel.addMessage(v),this.registerConnectorInCondition(v,l+1)}}}}},n.prototype.parseParticipant=function(e){var t=/^(participant|actor)\s+([A-Za-z0-9._/\-\s]+?)(?:\s+as\s+(.+))?$/i,i=t.exec(e);if(!i){console.warn("[WARNING] :: Invalid participant syntax: '"+e+"'.");return}var r=i[1],a=i[3]?i[2]:null,s=i[3]?i[3]:i[2];this.createOrGetParticipant(s,a,r.toLowerCase()==="actor")},n.prototype.parseConnector=function(e,t){if(!this.sequenceDiagramModel.messages.some(function(d){return d.id.toString()===t.toString()})){e=this.removeActivationSymbols(e);var i=/([\w/.\-_ ]+?)\s*(<<-{1,2}|-{1,2}>>?|\(-{1,2}\)|-{1,2}\)|<<-{1,2}>>?)\s*([\w/.\-_ ]+?)\s*:\s*(.+)/,r=e.match(i);if(!r){console.warn("[WARNING] :: Invalid connector syntax: '"+e+"'.");return}var a=r[1],s=r[2],o=r[3],h=r[4];this.createOrGetParticipant(a),this.createOrGetParticipant(o);var l=new B(this.diagram,"connectors",{id:t.toString()},!0);ft.addOrUpdateParticipantDetails(l,a,o,qt.Synchronous,null),ft.updateAnnotation(l,h),ft.updateConnectorStyles(l,this.getMermaidConnectorTypeFromArrow(s).toString()),this.sequenceDiagramModel.addMessage(l),this.registerConnectorInCondition(l,t)}},n.prototype.parseActivation=function(e,t){var i,r,a,s;if(e.startsWith("activate")||e.startsWith("deactivate")){var o=e.match(/(activate|deactivate)\s+(\w+)/i);if(!o){console.warn("[WARNING] :: Invalid activation syntax: '"+e+"'.");return}var h=o[1].toLowerCase();if(i=o[2],this.createOrGetParticipant(i),t>1)for(var l=t-2;l>=0;){var d=this.lines[parseInt(l.toString(),10)].trim();if(!d||d.startsWith("%%")){l--;continue}var f=d.match(/(\w+)\s*(<<-{1,2}|-{1,2}>>?|\(-{1,2}\)|-{1,2}\)|<<-{1,2}>>?)\s*(\w+)\s*:\s*(.+)/);if(f){r=f[1],a=f[3],s=f[4],t=l+2;break}l--}if(h==="activate")this.activationCache.has(i)||this.activationCache.set(i,[]),this.activationCache.get(i).push(new Xi((t-1).toString(),r,a,s,t));else if(this.activationCache.has(i)&&this.activationCache.get(i).length>0){var p=this.activationCache.get(i).pop(),c=new M(this.diagram,"nodes",{id:i+"_Activation_"+K(),minHeight:10,minWidth:10},!0);ft.updateNodeShape(c,!1),this.sequenceDiagramModel.addActivation(new wo(c,i,p,new Xi((t-1).toString(),r,a,s,t))),this.activationCache.get(i).length===0&&this.activationCache.delete(i)}}else{this.parseConnector(e,t);var o=e.match(/(\w+)\s*(-+>|->>|-->|-->|<<->>|<<-->>|-x|--x|-\)|--\)|-x|--)>\s*(\+|-)\s*(\w+)\s*:\s*(.+)/);if(!o){console.warn("[WARNING] :: Invalid activation syntax: '"+e+"'.");return}r=o[1];var u=o[3];if(a=o[4],s=o[5],i=u==="+"?a:r,this.createOrGetParticipant(r),this.createOrGetParticipant(i),u==="+")this.activationCache.has(i)||this.activationCache.set(i,[]),this.activationCache.get(i).push(new Xi(t.toString(),r,a,s,t));else if(u==="-"&&this.activationCache.has(i)&&this.activationCache.get(i).length>0){var p=this.activationCache.get(i).pop(),c=new M(this.diagram,"nodes",{id:i+"_Activation_"+K(),minHeight:10,minWidth:10},!0);ft.updateNodeShape(c,!1),this.sequenceDiagramModel.addActivation(new wo(c,i,p,new Xi(t.toString(),r,a,s,t))),this.activationCache.get(i).length===0&&this.activationCache.delete(i)}}},n.prototype.parseFragment=function(e,t){var i=this,r=e.match(/(alt|else|opt|loop|end)(?:\s+(.*))?/i),a=r[1].toLowerCase(),s=r[2]||null;if(a==="end"){if(this.fragmentStack.length===0){console.warn("[WARNING] :: Unmatched 'end' found.");return}var o=this.fragmentStack.pop();if(this.currentCondition!==null&&(o.conditions.some(function(p){return p.content===i.currentCondition.content})||o.conditions.push(this.currentCondition),this.currentCondition=null),o.conditions.forEach(function(p){i.populateConditionAltBlockDetails(p,o)}),this.fragmentStack.length>0){var h=this.fragmentStack[this.fragmentStack.length-1];h.childFragments.push(o),h.type===Ee.Alternative&&h.conditions.length>0&&h.conditions[h.conditions.length-1].nestedFragments.push(o)}else this.sequenceDiagramModel.addFragment(o)}else{var l=null;if(this.fragmentStack.length>0&&(l=this.fragmentStack[this.fragmentStack.length-1]),a==="alt"||a==="opt"||a==="loop"){var d=new Xf("",Ee.Optional,[],[],null,t,this.fragmentStack.length);switch(a){case"alt":d.type=Ee.Alternative;break;case"opt":d.type=Ee.Optional;break;case"loop":d.type=Ee.Loop;break}this.fragmentStack.push(d),l=d}if(l&&(a==="alt"||a==="opt"||a==="loop"||a==="else if"||a==="else")){var f=new Yf(s,[],[],new mh);l.conditions.some(function(p){return p.content===f.content})?this.currentCondition=l.conditions.find(function(p){return p.content===f.content})||null:(this.currentCondition=f,l.conditions.push(f))}}},n.prototype.populateConditionAltBlockDetails=function(e,t){for(var i=0,r=e.connectors;i<r.length;i++){var a=r[i];e.altBlockDetails.connectors.push(new ss(a.id,a.source,a.target,a.message,-1,"",!1,-1))}e.altBlockDetails.connectors.sort(function(l,d){return parseInt(l.id,10)-parseInt(d.id,10)});for(var s=0,o=e.nestedFragments;s<o.length;s++){var h=o[s];this.addChildFragmentConnectors(e,h)}},n.prototype.addChildFragmentConnectors=function(e,t){for(var i=0,r=t.conditions;i<r.length;i++){var a=r[i];if(e.nestedFragments.indexOf(t)!==-1){for(var s=0,o=a.connectors;s<o.length;s++){var h=o[s];e.altBlockDetails.connectors.push(new ss(h.id,h.source,h.target,h.message,-1,"",!0,t.index))}for(var l=0,d=t.childFragments;l<d.length;l++){var f=d[l];this.addChildFragmentConnectors(e,f)}}}e.altBlockDetails.connectors.sort(function(p,c){return parseInt(p.id,10)-parseInt(c.id,10)})},n.prototype.registerConnectorInCondition=function(e,t){var i=ft.getParticipantDetails(e);if(this.currentCondition){var r=new Xi(t.toString(),i.sourceParticipantName,i.targetParticipantName,ft.getAnnotation(e),t);this.currentCondition.connectors.push(r)}else if(this.fragmentStack.length>0){var a=this.fragmentStack[this.fragmentStack.length-1];if(a.conditions.length>0){var s=a.conditions[a.conditions.length-1],r=new Xi(t.toString(),i.sourceParticipantName,i.targetParticipantName,ft.getAnnotation(e),t);s.connectors.push(r)}}},n.prototype.createOrGetParticipant=function(e,t,i){if(t===void 0&&(t=""),i===void 0&&(i=!1),!e||e.trim()===""){console.warn("[WARNING] :: Participant name cannot be null or empty.");return}if(!this.sequenceDiagramModel.participants.has(t||e)){var r=new M(this.diagram,"nodes",{id:t||e},!0);ft.updateNodeShape(r,i),ft.updateAnnotation(r,e,i),this.sequenceDiagramModel.addParticipant(r),t&&this.sequenceDiagramModel.addAlias(t,e)}},n.prototype.getMermaidConnectorTypeFromArrow=function(e){switch(e){case"->":return wi.Solid;case"-->":return wi.Dashed;case"->>":return wi.SolidArrow;case"-->>":return wi.DashedArrow;case"<<->>":return wi.Bidirectional;case"<<-->>":return wi.DashedBidirectional;case"-)":return wi.OpenArrow;case"--)":return wi.DashedOpenArrow;default:return wi.SolidArrow}},n.prototype.removeActivationSymbols=function(e){var t=/(->>\s*)(\+|-)(\s*\w+)/g;return e.replace(t,function(i,r,a,s){return r+s})},n})(),bS=(function(){function n(){}return n.prototype.generateMermaidText=function(e){for(var t=`sequenceDiagram
`,i=new Set(e.messages.filter(function(m){return m.type===qt.Create}).map(function(m){return m.toParticipantID})),r=0,a=e.participants;r<a.length;r++){var s=a[r];s.id&&!i.has(s.id)&&(t+="    "+this.getParticipantContent(s)+`
`)}for(var o=this.buildActivationLookup(e.participants,!0),h=this.buildActivationLookup(e.participants,!1),l=[],d=function(m){for(var y=f.getContextChainForMessage(m.id,e.fragments);l.length>y.length;){var S=l.length,x=Array(S*4+1).join(" ");t+=x+`end
`,l.pop()}for(var I=0,C=0;C<l.length&&C<y.length&&l[parseInt(C.toString(),10)].fragment.id.toString()===y[parseInt(C.toString(),10)].fragment.id.toString();){if(l[parseInt(C.toString(),10)].condition.content!==y[parseInt(C.toString(),10)].condition.content){for(;l.length>C+1;){var x=Array(l.length*4+1).join(" ");t+=x+`end
`,l.pop()}var P=Array((C+1)*4+1).join(" ");t+=P+"else "+y[parseInt(C.toString(),10)].condition.content+`
`,l[parseInt(C.toString(),10)]=y[parseInt(C.toString(),10)]}C++}I=C;for(var A=l.length-1;A>=I;A--){var x=Array((A+1)*4+1).join(" ");t+=x+`end
`,l.pop()}for(var A=I;A<y.length;A++){var x=Array((l.length+1)*4+1).join(" ");t+=x+f.getFragmentType(y[parseInt(A.toString(),10)].fragment.type)+" "+y[parseInt(A.toString(),10)].condition.content+`
`,l.push(y[parseInt(A.toString(),10)])}var T=Array((l.length+1)*4+1).join(" ");if(m.toParticipantID&&m.type===qt.Create){var z=e.participants.find(function(R){return R.id.toString()===m.toParticipantID.toString()});z&&(t+=T+"create "+f.getParticipantContent(z)+`
`)}if(m.toParticipantID&&m.type===qt.Delete){var L=e.participants.find(function(R){return R.id.toString()===m.toParticipantID.toString()});L&&(t+=T+"destroy "+L.id+`
`)}t+=T+f.getParticipantContentByID(e,m.fromParticipantID)+f.getArrowType(m.type)+f.getParticipantContentByID(e,m.toParticipantID)+": "+m.content+`
`,t=f.handleActivationsAndDeactivations(t,m,o,h,l.length+1)},f=this,p=0,c=e.messages;p<c.length;p++){var u=c[p];d(u)}for(var g=l.length-1;g>=0;g--){var v=Array((g+1)*4+1).join(" ");t+=v+`end
`}return t},n.prototype.getContextChainForMessage=function(e,t){for(var i=[],r=0;r<t.length;r++)for(var a=t[parseInt(r.toString(),10)],s=0;s<a.conditions.length;s++){var o=a.conditions[parseInt(s.toString(),10)],h=this.isMessageIdInCondition(o,e);if(h)return i.push({fragment:a,condition:o}),i}return i},n.prototype.isMessageIdInCondition=function(e,t){for(var i=0;i<e.messageIds.length;i++){var r=e.messageIds[parseInt(i.toString(),10)];if(r.toString()===t.toString())return!0}return!1},n.prototype.handleActivationsAndDeactivations=function(e,t,i,r,a){a===void 0&&(a=1);var s=" ".repeat(a*4),o=i.get(t.id.toString());o&&o.forEach(function(l){e+=s+"activate "+l+`
`});var h=r.get(t.id.toString());return h&&h.forEach(function(l){e+=s+"deactivate "+l+`
`}),e},n.prototype.buildActivationLookup=function(e,t){var i=new Map;return e.forEach(function(r){r.activationBoxes.forEach(function(a){var s=(t?a.startMessageID:a.endMessageID).toString(),o=r.id.toString();i.has(s)||i.set(s,[]),i.get(s).push(o)})}),i},n.prototype.getArrowType=function(e){switch(e){case qt.Synchronous:case qt.Delete:return"->>";case qt.Asynchronous:case qt.Create:return"-->";case qt.Reply:return"-->>";default:return"->>"}},n.prototype.getFragmentType=function(e){switch(e){case Ee.Alternative:return"alt";case Ee.Loop:return"loop";case Ee.Optional:return"opt";default:throw new Error("Invalid fragment type")}},n.prototype.getParticipantContent=function(e){var t=e.isActor?"actor":"participant";return t+" "+e.id+" as "+e.content},n.prototype.getParticipantContentByID=function(e,t){var i=e.participants.find(function(r){return r.id&&r.id.toString()===t.toString()});return i.id.toString()},n})(),ES=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Q=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},In=function(n,e,t,i){return new(t||(t=Promise))(function(r,a){function s(l){try{h(i.next(l))}catch(d){a(d)}}function o(l){try{h(i.throw(l))}catch(d){a(d)}}function h(l){l.done?r(l.value):new t(function(d){d(l.value)}).then(s,o)}h((i=i.apply(n,e||[])).next())})},xn=function(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,r,a,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(d){return h([l,d])}}function h(l){if(i)throw new TypeError("Generator is already executing.");for(;t;)try{if(i=1,r&&(a=l[0]&2?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[l[0]&2,a.value]),l[0]){case 0:case 1:a=l;break;case 4:return t.label++,{value:l[1],done:!1};case 5:t.label++,r=l[1],l=[0];continue;case 7:l=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(l[0]===6||l[0]===2)){t=0;continue}if(l[0]===3&&(!a||l[1]>a[0]&&l[1]<a[3])){t.label=l[1];break}if(l[0]===6&&t.label<a[1]){t.label=a[1],a=l;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(l);break}a[2]&&t.ops.pop(),t.trys.pop();continue}l=e.call(n,t)}catch(d){l=[6,d],r=0}finally{i=a=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},Xe=(function(n){ES(e,n);function e(t,i){var r=n.call(this,t,i)||this;r.version=17.1,r.checkMenu=!1,r.isServerUpdate=!1,r.oldNodeObjects=[],r.oldDiagramObject={},r.oldConnectorObjects=[],r.preventOverviewRefresh=!1,r.canEnableBlazorObject=!1,r.connectorTable={},r.groupTable={},r.scrollActions=ei.None,r.blazorActions=jt.Default,r.activeLabel={id:"",parentId:"",isGroup:!1,text:void 0},r.textEditing=!1,r.isTriggerEvent=!1,r.preventNodesUpdate=!1,r.preventConnectorsUpdate=!1,r.callBlazorModel=!0,r.isRowHeightUpdate=!1,r.selectionConnectorsList=[],r.deleteVirtualObject=!1,r.canLayout=!0,r.cancelPositionChange=!1,r.isRefreshed=!1,r.swimlaneChildTable={},r.swimlaneZIndexTable={},r.canExpand=!1,r.itemType="PublicMethod",r.changedConnectorCollection=[],r.changedNodesCollection=[],r.previousNodeCollection=[],r.previousConnectorCollection=[],r.crudDeleteNodes=[],r.previousSelectedObjects=[],r.blazorAddorRemoveCollection=[],r.blazorRemoveIndexCollection=[],r.diagramid=88123,r.portCenterPoint=[],r.selectedObject={helperObject:void 0,actualObject:void 0},r.deleteDependentConnector=!0,r.scaleValue=1,r.routedConnectors=[],r.pathDataStorage=new Map,r.isUndo=!1,r.connectorOrRotatedGroups=[],r.connectorFlipInProgress=!1,r.overviewObject=void 0,r.checkUndoRedo=!1,r.activeLayerObjectsSet=new Set,r.isScrollOffsetInverted=!0,r.initNodeTemplate=!1,r.tempTable={},r.deserializing=!1,r.mermaidNodeBaseCollection=[],r.bangShape="M0 0 a15.470625686645507,15.470625686645507 1 0,0 25.78437614440918,-3.7200001525878905 a15.470625686645507,15.470625686645507 1 0,0 25.78437614440918,0 a15.470625686645507,15.470625686645507 1 0,0 25.78437614440918,0 a15.470625686645507,15.470625686645507 1 0,0 25.78437614440918,3.7200001525878905 a15.470625686645507,15.470625686645507 1 0,0 15.470625686645507,12.276000503540038 a12.376500549316406,12.376500549316406 1 0,0 0,12.648000518798828 a15.470625686645507,15.470625686645507 1 0,0 -15.470625686645507,12.276000503540038 a15.470625686645507,15.470625686645507 1 0,0 -25.78437614440918,5.580000228881835 a15.470625686645507,15.470625686645507 1 0,0 -25.78437614440918,0 a15.470625686645507,15.470625686645507 1 0,0 -25.78437614440918,0 a15.470625686645507,15.470625686645507 1 0,0 -25.78437614440918,-5.580000228881835 a15.470625686645507,15.470625686645507 1 0,0 -10.313750457763673,-12.276000503540038 a12.376500549316406,12.376500549316406 1 0,0 0,-12.648000518798828 a15.470625686645507,15.470625686645507 1 0,0 10.313750457763673,-12.276000503540038 H0 V0 Z",r.cloudShape="M0 0 a16.18875045776367,16.18875045776367 0 0,1 26.981250762939453,-10.792500305175782 a37.77375106811523,37.77375106811523 1 0,1 43.17000122070313,-10.792500305175782 a26.981250762939453,26.981250762939453 1 0,1 37.77375106811523,21.585000610351564 a16.18875045776367,16.18875045776367 1 0,1 16.18875045776367,13.020000534057615 a21.585000610351564,21.585000610351564 1 0,1 -16.18875045776367,24.180000991821288 a26.981250762939453,16.18875045776367 1 0,1 -26.981250762939453,16.18875045776367 a37.77375106811523,37.77375106811523 1 0,1 -53.962501525878906,0 a16.18875045776367,16.18875045776367 1 0,1 -26.981250762939453,-16.18875045776367 a16.18875045776367,16.18875045776367 1 0,1 -10.792500305175782,-13.020000534057615 a21.585000610351564,21.585000610351564 1 0,1 10.792500305175782,-24.180000991821288 H0 V0 Z",r.renderTimer=null;var a,s;r.ignoreCollectionWatch=!0;for(var o=0;t&&t.nodes&&o<t.nodes.length;o++)a=t.nodes[parseInt(o.toString(),10)],s=r.nodes[parseInt(o.toString(),10)],a.children&&a.children.length>0&&((!a.style||!a.style.fill)&&(s.style.fill="transparent"),(!a.style||!a.style.strokeColor)&&(s.style.strokeColor="transparent")),a.shape&&a.shape.type==="UmlActivity"&&us(a,s),a.shape&&(a.shape.type==="SwimLane"||a.shape.type==="Container")&&nf(a,s),r.nodeDefaults&&Ti(s,a,r.nodeDefaults),r.updateAnnotationText(s.annotations);if(t&&t.connectors)for(var o=0;t&&t.connectors&&o<t.connectors.length;o++)a=t.connectors[parseInt(o.toString(),10)],s=r.connectors[parseInt(o.toString(),10)],r.connectorDefaults&&Ti(s,a,r.connectorDefaults),r.updateAnnotationText(s.annotations);for(var o=0;t&&t.connectors&&o<t.connectors.length;o++){var h=t.connectors[parseInt(o.toString(),10)],l=r.connectors[parseInt(o.toString(),10)];h.shape&&h.shape.type!=="None"&&af(h,l)}return r}return e.prototype.updateAnnotationText=function(t){},e.prototype.clearCollection=function(t){for(var i=[],r,a=0,s=Object.keys(this.nameTable);a<s.length;a++){var o=s[a];r=this.nameTable[""+o],r&&(t&&r instanceof B||!t&&r instanceof M)&&i.push(r)}this.clearObjects(i)},e.prototype.onPropertyChanged=function(t,i){var r=this;if(this.rotateUsingButton)this.rotateUsingButton=!1;else{var a=!0,s=!1,o=!1,h=void 0;if(this.diagramActions&k.Render){for(var l=0,d=Object.keys(t);l<d.length;l++){var f=d[l];switch(f){case"width":case"height":this.element.style.width=this.getSizeValue(this.width),this.element.style.height=this.getSizeValue(this.height),this.eventHandler.updateViewPortSize(this.element);for(var p=0,c=this.views;p<c.length;p++){var u=c[p],g=this.views[""+u];g instanceof e||g.updateView(g)}break;case"nodes":if(t.nodes.length>0&&i.nodes.length===0)this.clearCollection(),o=!0;else{for(var v=0,m=Object.keys(t.nodes);v<m.length;v++){var y=m[v],S=Number(y),x=this.nodes[parseInt(S.toString(),10)],I=t.nodes[parseInt(S.toString(),10)];t.nodes[parseInt(S.toString(),10)].style&&t.nodes[parseInt(S.toString(),10)].style.gradient&&(this.updateGradient(t.nodes[parseInt(S.toString(),10)],i.nodes[parseInt(S.toString(),10)],this.nodes[parseInt(S.toString(),10)]),this.nodes[parseInt(S.toString(),10)].oldGradientValue=E(t.nodes[parseInt(S.toString(),10)].style.gradient)),s=s||I.excludeFromLayout!==void 0,t.nodes[S]&&t.nodes[S].shape&&t.nodes[S].shape.textAnnotation&&t.nodes[S].shape.textAnnotation.textAnnotationTarget!==""&&(h=E(this.nameTable[x.inEdges[0]])),this.nodePropertyChange(x,i.nodes[parseInt(S.toString(),10)],I,void 0,!0,!0);var C={element:x,cause:this.diagramActions,diagramAction:this.getDiagramAction(this.diagramActions),oldValue:i.nodes[parseInt(S.toString(),10)],newValue:t.nodes[parseInt(S.toString(),10)]};this.triggerEvent(Z.propertyChange,C),a&&(a=!1)}this.mode==="Canvas"&&this.refreshDiagramLayer()}break;case"connectors":if(t.connectors.length>0&&i.connectors.length===0)this.clearCollection(!0),o=!0;else{for(var P=0,A=Object.keys(t.connectors);P<A.length;P++){var y=A[P],S=Number(y),x=this.connectors[parseInt(S.toString(),10)],I=t.connectors[parseInt(S.toString(),10)],T={sourcePoint:{x:x.sourcePoint.x,y:x.sourcePoint.y},targetPoint:{x:x.targetPoint.x,y:x.targetPoint.y}};I&&(I.sourceDecorator||I.targetDecorator)&&(this.diagramActions|=k.DecoratorPropertyChange),this.connectorPropertyChange(x,i.connectors[parseInt(S.toString(),10)],I,!0,!0),t.connectors[parseInt(S.toString(),10)].sourceID&&!t.connectors[parseInt(S.toString(),10)].sourcePoint&&(i.connectors[parseInt(S.toString(),10)].sourcePoint={x:T.sourcePoint.x,y:T.sourcePoint.y},t.connectors[parseInt(S.toString(),10)].sourcePoint={x:x.sourcePoint.x,y:x.sourcePoint.y}),t.connectors[parseInt(S.toString(),10)].targetID&&!t.connectors[parseInt(S.toString(),10)].targetPoint&&(i.connectors[parseInt(S.toString(),10)].targetPoint={x:T.targetPoint.x,y:T.targetPoint.y},t.connectors[parseInt(S.toString(),10)].targetPoint={x:x.targetPoint.x,y:x.targetPoint.y}),I&&(I.sourceDecorator||I.targetDecorator)&&(this.diagramActions=this.diagramActions&~k.DecoratorPropertyChange);var C={element:x,cause:this.diagramActions,diagramAction:this.getDiagramAction(this.diagramActions),oldValue:i.connectors[parseInt(S.toString(),10)],newValue:t.connectors[parseInt(S.toString(),10)]};this.triggerEvent(Z.propertyChange,C),x&&x.parentId&&this.nameTable[x.parentId].shape.type==="UmlClassifier"&&this.updateConnectorEdges(this.nameTable[x.parentId]||x),a&&(a=!1)}this.updateBridging(),this.mode==="Canvas"&&this.refreshDiagramLayer()}break;case"bridgeDirection":this.updateBridging(),this.mode==="Canvas"&&this.refreshDiagramLayer();break;case"backgroundColor":this.intOffPageBackground();break;case"pageSettings":this.validatePageSize(),this.updatePage();break;case"selectedItems":if(t.selectedItems.userHandles&&this.selectedItems.wrapper&&this.selectedItems.userHandles&&this.selectedItems.userHandles.length>0){this.renderSelector(!0);break}if(t.selectedItems.constraints){this.renderSelector(!0);break}break;case"snapSettings":this.updateSnapSettings(t);break;case"commandManager":this.initCommands();break;case"layout":s=!0;break;case"segmentThumbShape":this.updateSelector();break;case"dataSourceSettings":this.clear(),this.layout.type==="None"?o=!0:(this.initObjects(),s=!0);break;case"tooltip":Bh(this);break;case"rulerSettings":this.updateRulerSettings(t);break;case"layers":this.updateLayer(t);break;case"scrollSettings":this.scrollActions|=ei.PropertyChange,this.updateScrollSettings(t,i),this.scrollActions&=~ei.PropertyChange;break;case"locale":t.locale!==i.locale&&n.prototype.refresh.call(this);break;case"contextMenuSettings":if(t.contextMenuSettings.showCustomMenuOnly!==void 0&&(this.contextMenuSettings.showCustomMenuOnly=t.contextMenuSettings.showCustomMenuOnly),t.contextMenuSettings.show!==void 0&&(this.contextMenuSettings.show=t.contextMenuSettings.show),t.contextMenuSettings.items){for(var z=t.contextMenuSettings.items,L=0,R=Object.keys(z);L<R.length;L++){var y=R[L],S=Number(y);this.contextMenuSettings.items[parseInt(S.toString(),10)]=z[parseInt(S.toString(),10)]}this.contextMenuModule?this.contextMenuModule.refreshItems():console.warn('[WARNING] :: Module "DiagramContextMenu" is not available in Diagram component! You either misspelled the module name or forgot to load it.')}break;case"serializationSettings":t.serializationSettings.preventDefaults!==void 0&&(this.serializationSettings.preventDefaults=t.serializationSettings.preventDefaults);break;case"tool":this.eventHandler.updateTool();break;case"constraints":((t.constraints&lt.LineRouting)!==(i.constraints&lt.LineRouting)||(t.constraints&lt.AvoidLineOverlapping)!==(i.constraints&lt.AvoidLineOverlapping))&&this.resetSegments();break}}if(s&&!o){if(i.layout&&i.layout.connectionPointOrigin==="DifferentPoint"&&t.layout.connectionPointOrigin==="SamePoint"||i.layout&&t.layout&&!t.layout.enableRouting&&i.layout.enableRouting){for(var O=0;O<this.nodes.length;O++){var N=this.nodes[parseInt(O.toString(),10)];if(N.ports&&N.ports.length>0){for(var H=[],F=N.ports.length-1;F>=0;F--)N.ports[parseInt(F.toString(),10)].id.split("_")[1]==="LineDistribution"&&H.push(N.ports[parseInt(F.toString(),10)]);this.removePorts(N,H)}}for(var F=0;F<this.connectors.length;F++){var Y=this.connectors[parseInt(F.toString(),10)],et=Y.sourcePortID,at=Y.targetPortID;Y.sourcePortID="",Y.targetPortID="",Y.sourcePortWrapper=void 0,Y.targetPortWrapper=void 0,Y.segments=[],this.connectorPropertyChange(Y,{sourcePortID:et,targetPortID:at},{sourcePortID:"",targetPortID:""})}}this.doLayout(),this.renderReactTemplates()}if(a&&this.propertyChange){var C={element:this,cause:this.diagramActions,diagramAction:this.getDiagramAction(this.diagramActions),oldValue:i,newValue:t};this.triggerEvent(Z.propertyChange,C)}if(!o&&this.canLogChange()&&this.modelChanged(t,i)){var tt=[],nt=[],wt=[],$=void 0,pt=void 0;if(t.nodes&&Object.keys(t.nodes).length>0)for(var rt=0,mt=Object.keys(t.nodes);rt<mt.length;rt++){var y=mt[rt];if($=parseInt(y,10),nt.push(this.nodes[parseInt($.toString(),10)].id),t.nodes[parseInt($.toString(),10)]&&t.nodes[parseInt($.toString(),10)].shape&&t.nodes[parseInt($.toString(),10)].shape.lanes)for(var ct=0,Dt=Object.keys(t.nodes[parseInt($.toString(),10)].shape.lanes);ct<Dt.length;ct++){var Ge=Dt[ct];pt=parseInt(Ge,10)}}if(t.connectors&&Object.keys(t.connectors).length>0)for(var Ce=0,ie=Object.keys(t.connectors);Ce<ie.length;Ce++){var y=ie[Ce],Oe=parseInt(y,10);wt.push(this.connectors[parseInt(Oe.toString(),10)].id)}tt=nt.concat(wt);var ni=wt.filter(function(vi){return r.nameTable[""+vi].isBpmnAnnotationConnector});if(ni.length===0)if(t.nodes&&t.nodes[$]&&t.nodes[$].shape&&t.nodes[$].shape.textAnnotation&&t.nodes[$].shape.textAnnotation.textAnnotationTarget!==""){var Ft=this.nameTable[this.nodes[parseInt($.toString(),10)].inEdges[0]];this.startGroupAction();var ge={type:"ConnectionChanged",undoObject:h,redoObject:E(Ft),category:"Internal"},Ze={type:"PropertyChanged",undoObject:i,redoObject:t,category:"Internal"};this.historyManager&&(this.addHistoryEntry(ge),this.addHistoryEntry(Ze,tt)),this.endGroupAction()}else{var Ze={type:"PropertyChanged",undoObject:i,redoObject:t,category:"Internal"};this.historyManager&&!this.isRowHeightUpdate&&(this.addHistoryEntry(Ze,tt),t.nodes&&t.nodes[$]&&t.nodes[$].shape&&t.nodes[$].shape.lanes&&t.nodes[$].shape.lanes[pt]&&t.nodes[$].shape.lanes[pt].children&&!(this.diagramActions&k.UndoRedo)&&this.endGroupAction()),this.isRowHeightUpdate=!1}}this.resetDiagramActions(),o&&(this.initObjects(!0),this.refreshDiagramLayer(),s&&this.doLayout());var gi=Object.keys(t).length===1&&t.scrollSettings!==void 0;if(!o)for(var Ji=0,Ar=this.views;Ji<Ar.length;Ji++){var g=Ar[Ji],u=this.views[""+g];u instanceof e||(t.scrollSettings&&(t.scrollSettings.currentZoom,i.scrollSettings.currentZoom),gi||this.refreshCanvasDiagramLayer(u))}}}},e.prototype.updateSnapSettings=function(t){(t.snapSettings.constraints!==void 0||t.snapSettings.horizontalGridlines||t.snapSettings.verticalGridlines||t.snapSettings.gridType)&&this.diagramRenderer.updateGrid(this.snapSettings,Mr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)},e.prototype.updateGradient=function(t,i,r){if(r.oldGradientValue)for(var a=r,s=r,o=i.style.gradient,h=i.style.gradient,l=0,d=Object.keys(t.style.gradient);l<d.length;l++){var f=d[l];switch(f){case"type":a.type&&(o.type=a.type);break;case"x1":a.x1&&(o.x1=a.x1);break;case"x2":a.x2&&(o.x2=a.x2);break;case"y1":a.y1&&(o.y1=a.y1);break;case"y2":a.y2&&(o.y2=a.y2);break;case"cx":s.cx&&(h.cx=s.cx);break;case"cy":s.cy&&(h.cy=s.cy);break;case"fx":s.fx&&(h.fx=s.fx);break;case"fy":s.fy&&(h.fy=s.fy);break;case"r":s.r&&(h.r=s.r);break;case"stops":if(r.oldGradientValue.stops){var p=Object.values(E(r.oldGradientValue.stops));p.pop(),i.style.gradient.stops=p}break}}},e.prototype.updateRulerSettings=function(t){t.rulerSettings.dynamicGrid!==void 0&&this.diagramRenderer.updateGrid(this.snapSettings,Mr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),t.rulerSettings.showRulers!==void 0?(this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):(t.rulerSettings.horizontalRuler!==void 0||t.rulerSettings.verticalRuler!==void 0)&&(t.rulerSettings.horizontalRuler.thickness!==void 0||t.rulerSettings.verticalRuler.thickness!==void 0?(vo(this),this.intOffPageBackground(),this.scroller.setSize(),this.renderRulers()):Ja(this)),this.diagramRenderer.updateGrid(this.snapSettings,Mr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler)},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){this.initializePrivateVariables(),this.isProtectedOnChange=!0,this.serviceLocator=new Yy,this.initializeServices(),this.setCulture();var t="measureElement";window[""+t]&&(window[""+t]=null),this.initDiagram(),this.initViews(),this.unWireEvents(),this.wireEvents(),this.element.classList.add("e-diagram")},e.prototype.initializePrivateVariables=function(){if(this.element.id===""){var t=document.getElementsByClassName("e-diagram").length;this.element.id="diagram_"+this.diagramid+"_"+t}this.defaultLocale={Copy:"Copy",Cut:"Cut",Paste:"Paste",Undo:"Undo",Redo:"Redo",SelectAll:"Select All",Grouping:"Grouping",Group:"Group",UnGroup:"Un Group",Order:"Order",BringToFront:"Bring To Front",MoveForward:"Move Forward",SendToBack:"Send To Back",SendBackward:"Send Backward"},this.layerZIndex=-1,this.layerZIndexTable={},this.swimlaneChildTable===void 0&&this.swimlaneZIndexTable===void 0&&(this.swimlaneChildTable={},this.swimlaneZIndexTable={}),this.activeLayerObjectsSet||(this.activeLayerObjectsSet=new Set),this.isScrollOffsetInverted||(this.isScrollOffsetInverted=!0),this.connectorOrRotatedGroups||(this.connectorOrRotatedGroups=[]),this.refreshing&&!this.deserializing&&this.nodes.some(function(i){return i.shape.type==="SwimLane"})&&(this.getSwimlaneChildTable(),this.removeSwimlaneChildOnRefresh()),this.nameTable={},this.pathTable={},this.groupTable={},this.commands={},this.isLoading||(this.views=[]),this.commandHandler=new eS(this),this.eventHandler=new Ky(this,this.commandHandler),this.spatialSearch=new Dl(this.nameTable),this.scroller=new iS(this)},e.prototype.removeSwimlaneChildOnRefresh=function(){var t=hf(this.nodes);lf(t,this),this.nodes.forEach(function(i){var r=i.shape;if(r&&r.lanes&&r.lanes.length>0){var a=i.offsetX-i.wrapper.actualSize.width/2,s=i.offsetY-i.wrapper.actualSize.height/2,o=r.orientation==="Vertical";o&&r.orientation==="Vertical"&&(s+=r.header&&r.hasHeader?r.header.height:0),r.lanes.forEach(function(h){h.children&&h.children.length>0&&h.children.forEach(function(l){var d=l.wrapper.offsetX-l.width/2,f=l.wrapper.offsetY-l.height/2;o?l.margin.top=f-s:l.margin.left=d-a})})}})},e.prototype.initializeServices=function(){this.serviceLocator.register("localization",this.localeObj=new no(this.getModuleName(),this.defaultLocale,this.locale))},e.prototype.setCulture=function(){this.localeObj=new no(this.getModuleName(),this.defaultLocale,this.locale)},e.prototype.getSwimlaneChildTable=function(){for(var t=[],i,r,a,s,o="childTable",h=0;h<this.nodes.length;h++)if(i=this.nodes[parseInt(h.toString(),10)],i.shape.type==="SwimLane"){r=i.wrapper.children[0],a=r[""+o];for(var l=0,d=Object.keys(a);l<d.length;l++){var f=d[l];s=a[""+f],t=Ka(s,t)}for(var p=0;p<t.length;p++)this.nameTable[t[parseInt(p.toString(),10)]]&&(this.swimlaneChildTable[t[parseInt(p.toString(),10)]]=this.nameTable[t[parseInt(p.toString(),10)]].zIndex);this.swimlaneZIndexTable[i.id]=i.zIndex}},e.prototype.render=function(){if(this.refreshing&&this.dataSourceSettings.dataSource&&!this.isLoading&&(this.nodes=[],this.connectors=[]),!this.refreshing){var t={diagram:this,name:"load"};this.trigger("load",t)}this.isRefreshed=!1,this.ignoreCollectionWatch=!0;var i="domTable";window[""+i]={};var r=[];this.dataSourceSettings.crudAction.read&&this.renderInitialCrud(),this.initHistory(),this.diagramRenderer=new on(this.element.id,new ln,this.mode==="SVG"),this.initLayers(),this.initializeDiagramLayers(),this.diagramRenderer.setLayers(),this.initObjects(!0);for(var a=this.nodes,s=0;s<a.length;s++)a[parseInt(s.toString(),10)].isExpanded||r.push(a[parseInt(s.toString(),10)]);if(r.length)for(var s=r.length-1;s>=0;s--)s===0?this.commandHandler.expandNode(r[parseInt(s.toString(),10)],this,!1):this.commandHandler.expandNode(r[parseInt(s.toString(),10)],this,!0);this.canLayout&&this.doLayout(),this.updateFromModel(),this.lineRoutingModule?this.lineRoutingModule.lineRouting(this):this.constraints&lt.LineRouting&&console.warn('[WARNING] :: Module "LineRouting" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),this.validatePageSize(),this.renderPageBreaks(),this.diagramRenderer.renderSvgGridlines(this.snapSettings,Mr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.commandHandler.initSelectorWrapper(),this.notify("initial-load",{}),this.trigger("load"),this.scroller.setSize(),this.scroller.updateScrollOffsets(),this.isRefreshed||this.refreshDiagramLayer(),(this.scrollSettings.verticalOffset>0||this.scrollSettings.horizontalOffset>0)&&this.updateScrollOffset(),vt.isDevice&&(this.tool=Gt.ZoomPan|Gt.SingleSelect),this.notify("initial-end",{}),this.isProtectedOnChange=!1,this.tooltipObject=Bh(this),this.diagramActions=k.Render,this.initCommands();var o=document.getElementsByClassName(this.element.id+"_hiddenUserHandleTemplate");By(this.userHandleTemplate,o,this.selectedItems,this.element.id),this.isLoading=!1,this.refreshRoutingConnectors(),this.renderComplete(),this.updateFitToPage(),this.refreshing&&(this.renderReactTemplates(),this.updateViews())},e.prototype.updateViews=function(){this.overviewObject&&this.overviewObject.view&&this.overviewObject.view instanceof mr&&this.overviewObject.view.setParent(this.element.id)},e.prototype.updateFitToPage=function(){this.pageSettings&&this.pageSettings.fitOptions&&this.pageSettings.fitOptions.canFit&&this.fitToPage(this.pageSettings.fitOptions)},e.prototype.updateTemplate=function(){},e.prototype.renderInitialCrud=function(){var t=this;if(t.dataSourceSettings.crudAction.read){var i=new Ts(t.dataSourceSettings.crudAction.read,"GET");i.onSuccess=function(r){t.dataSourceSettings.dataManager?t.dataSourceSettings.dataManager=JSON.parse(r):t.dataSourceSettings.dataSource=JSON.parse(r),t.dataBind()},i.send().then()}if(t.dataSourceSettings.connectionDataSource.crudAction.read){var i=new Ts(t.dataSourceSettings.connectionDataSource.crudAction.read,"GET");i.onSuccess=function(a){t.dataSourceSettings.connectionDataSource.dataManager=JSON.parse(a),t.dataBind()},i.send().then()}},e.prototype.getModuleName=function(){return"diagram"},e.prototype.getClassName=function(){return"Diagram"},e.prototype.requiredModules=function(){var t=[];return t.push({member:"Bpmn",args:[]}),t.push({member:"ImportAndExportVisio",args:[]}),t.push({member:"Bridging",args:[]}),t.push({member:"ConnectorEditingTool",args:[]}),this.constraints&lt.UndoRedo&&t.push({member:"UndoRedo",args:[]}),(this.layout.type==="OrganizationalChart"||this.layout.type==="HierarchicalTree"||this.layout.enableAnimation)&&t.push({member:"LayoutAnimate",args:[]}),this.snapSettings.constraints&&t.push({member:"Snapping",args:[this]}),t.push({member:"Ej1Serialization",args:[this]}),t.push({member:"PrintandExport",args:[this]}),this.contextMenuSettings.show&&t.push({member:"contextMenu",args:[this,this.serviceLocator]}),(this.layout.type==="OrganizationalChart"||this.layout.type==="HierarchicalTree")&&t.push({member:"OrganizationalChart",args:[this]}),this.layout.type==="ComplexHierarchicalTree"&&t.push({member:"ComplexHierarchicalTree",args:[]}),this.layout.type==="MindMap"&&t.push({member:"MindMapChart",args:[]}),this.layout.type==="RadialTree"&&t.push({member:"RadialTree",args:[]}),this.layout.type==="SymmetricalLayout"&&t.push({member:"SymmetricalLayout",args:[]}),this.layout.type==="Flowchart"&&t.push({member:"FlowchartLayout",args:[]}),(this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource||this.dataSourceSettings.crudAction.read||this.dataSourceSettings.connectionDataSource.crudAction.read)&&t.push({member:"DataBinding",args:[]}),this.constraints&lt.LineRouting&&t.push({member:"LineRouting",args:[]}),this.constraints&lt.AvoidLineOverlapping&&t.push({member:"AvoidLineOverlapping",args:[this]}),(this.layout&&(this.layout.type==="ComplexHierarchicalTree"||this.layout.type==="HierarchicalTree")||this.layout.arrangement==="Linear"||this.layout.enableRouting)&&t.push({member:"LineDistribution",args:[]}),t},e.prototype.removeUserHandlesTemplate=function(){if(this.selectedItems.userHandles.length)for(var t=0;t<this.selectedItems.userHandles.length;t++)for(var i=0,r=this.views;i<r.length;i++){var a=r[i];be(this.selectedItems.userHandles[parseInt(t.toString(),10)].name+"_template_hiddenUserHandle",a)}},e.prototype.destroy=function(){if(clearInterval(this.renderTimer),this.renderTimer=null,this.hRuler&&this.vRuler&&(this.hRuler.destroy(),this.vRuler.destroy()),this.tooltipObject.destroy(),this.droppable.destroy(),this.unWireEvents(),this.notify("destroy",{}),n.prototype.destroy.call(this),this.removeUserHandlesTemplate(),this.clearTemplate(),document.getElementById(this.element.id)){this.element.classList.remove("e-diagram");for(var t=document.getElementsByClassName("e-diagram-tooltip");t.length>0;)t[0].parentNode.removeChild(t[0]);var i=document.getElementById(this.element.id+"content");i&&this.element.removeChild(i);var r="measureElement";if(window[""+r]){window[""+r].usageCount-=1;var a="measureElementCount";window[""+a]--,window[""+a]===0&&(window[""+r].parentNode.removeChild(window[""+r]),window[""+r]=null)}Iy()}var s="domTable";window[""+s]={};for(var o=0;o<this.layers.length;o++){var h=this.layers[parseInt(o.toString(),10)];h.zIndexTable={}}this.diagramActions=void 0},e.prototype.wireEvents=function(){var t=vt.touchStartEvent,i=vt.touchEndEvent,r=vt.touchMoveEvent,a=vt.isPointer?"pointerleave":"mouseleave",s=vt.isPointer,o=vt.info.name==="mozilla"?s?"mousewheel":"DOMMouseScroll":"mousewheel";J.add(this.diagramCanvas,t,this.eventHandler.mouseDown,this.eventHandler),J.add(this.diagramCanvas,r,this.eventHandler.mouseMove,this.eventHandler),J.add(this.diagramCanvas,i,this.eventHandler.mouseUp,this.eventHandler),J.add(this.diagramCanvas,a,this.eventHandler.mouseLeave,this.eventHandler),J.add(this.diagramCanvas,"keydown",this.eventHandler.keyDown,this.eventHandler),J.add(this.diagramCanvas,"keyup",this.eventHandler.keyUp,this.eventHandler),J.add(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick,this.eventHandler),J.add(this.diagramCanvas,"scroll",this.eventHandler.scrolled,this.eventHandler),J.add(this.diagramCanvas,o,this.eventHandler.mouseWheel,this.eventHandler),J.add(window,"resize",this.eventHandler.windowResize,this.eventHandler),this.initDroppables()},e.prototype.unWireEvents=function(){var t=vt.touchStartEvent,i=vt.touchMoveEvent,r=vt.isPointer?"pointerleave":"mouseleave",a=vt.isPointer,s=vt.info.name==="mozilla"?a?"mousewheel":"DOMMouseScroll":"mousewheel",o=vt.touchEndEvent;J.remove(this.diagramCanvas,t,this.eventHandler.mouseDown),J.remove(this.diagramCanvas,i,this.eventHandler.mouseMove),J.remove(this.diagramCanvas,o,this.eventHandler.mouseUp),J.remove(this.diagramCanvas,r,this.eventHandler.mouseLeave),J.remove(this.diagramCanvas,"keydown",this.eventHandler.keyDown),J.remove(this.diagramCanvas,"keyup",this.eventHandler.keyUp),J.remove(this.diagramCanvas,"dblclick",this.eventHandler.doubleClick),J.remove(this.diagramCanvas,"scroll",this.eventHandler.scrolled),J.remove(this.diagramCanvas,s,this.eventHandler.mouseWheel),J.remove(window,"resize",this.eventHandler.windowResize)},e.prototype.select=function(t,i,r){t!=null&&this.commandHandler.selectObjects(t,i,r)},e.prototype.getDiagramAction=function(t){var i;return t===2&&k.Render?i="Render":t&k.UndoRedo?i="UndoRedo":t&k.PublicMethod?i="PublicMethod":t&k.ToolAction?i="ToolAction":t&k.TextEdit?i="TextEdit":t&k.Group?i="Group":t&k.Interactions?i="Interactions":t&k.PreventHistory?i="PreventHistory":t&k.DecoratorPropertyChange?i="DecoratorPropertyChange":t&k.PreventZIndexOnDragging?i="PreventZIndexOnDragging":t&k.isGroupDragging?i="isGroupDragging":t&k.DragUsingMouse&&(i="DragUsingMouse"),i},e.prototype.selectAll=function(){var t=[];t=this.getObjectsOfLayer(this.activeLayer.objects),this.select(t)},e.prototype.unSelect=function(t){t&&Ut(this,t)&&this.commandHandler.unSelect(t)},e.prototype.clearSelection=function(){this.commandHandler.clearSelection(!0)},e.prototype.updateViewPort=function(){var t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.eventHandler.updateViewPortSize(this.element),this.updateBlazorDiagramProperties(t,!0)},e.prototype.cutCommand=function(){this.cut(),this.itemType="PublicMethod"},e.prototype.cut=function(){this.commandHandler.cut()},e.prototype.addProcess=function(t,i){this.bpmnModule&&this.bpmnModule.addProcess(t,i,this)},e.prototype.removeProcess=function(t){this.bpmnModule&&this.bpmnModule.removeProcess(t,this)},e.prototype.pasteCommand=function(){this.paste()},e.prototype.paste=function(t){this.commandHandler.paste(t)},e.prototype.fitToPage=function(t){var i=this.getZoomingAttribute();this.updateBlazorDiagramProperties(i),this.scroller.fitToPage(t),this.updateBlazorDiagramProperties(i,!0)},e.prototype.bringIntoView=function(t){var i=this.getZoomingAttribute();this.updateBlazorDiagramProperties(i),this.scroller.bringIntoView(t,!0),this.updateBlazorDiagramProperties(i,!0)},e.prototype.bringToCenter=function(t){var i=this.getZoomingAttribute();this.updateBlazorDiagramProperties(i),this.scroller.bringToCenter(t),this.updateBlazorDiagramProperties(i,!0)},e.prototype.copyCommand=function(){this.copy()},e.prototype.copy=function(){var t=this.commandHandler.copy();return t},e.prototype.group=function(){var t=[];t=this.selectedItems.nodes,t=t.concat(this.selectedItems.connectors),t.length>1&&(this.callBlazorModel=!1,this.insertBlazorDiagramObjects(this.selectedItems),this.commandHandler.group(),this.callBlazorModel=!0,this.commandHandler.getBlazorOldValues())},e.prototype.unGroup=function(){this.callBlazorModel=!1,this.insertBlazorDiagramObjects(this.selectedItems),this.commandHandler.unGroup(),this.callBlazorModel=!0,this.commandHandler.getBlazorOldValues()},e.prototype.sendToBack=function(){this.commandHandler.sendToBack()},e.prototype.setActiveLayer=function(t){var i=this.commandHandler.getLayer(t);this.activeLayer=i;var r=i.objects;this.activeLayerObjectsSet.clear();for(var a=0,s=r;a<s.length;a++){var o=s[a];this.activeLayerObjectsSet.add(o)}},e.prototype.addLayer=function(t,i){this.commandHandler.addLayer(t,i)},e.prototype.removeLayer=function(t){this.commandHandler.removeLayer(t,tg())},e.prototype.moveObjects=function(t,i){E(this.layers),this.enableServerDataBinding(!1),this.commandHandler.moveObjects(t,i)},e.prototype.layerObjectUpdate=function(){},e.prototype.sendLayerBackward=function(t){this.layerObjectUpdate(),this.commandHandler.sendLayerBackward(t)},e.prototype.bringLayerForward=function(t){this.layerObjectUpdate(),this.commandHandler.bringLayerForward(t)},e.prototype.cloneLayer=function(t){this.commandHandler.cloneLayer(t)},e.prototype.bringToFront=function(){this.commandHandler.bringToFront()},e.prototype.moveForward=function(){this.commandHandler.sendForward()},e.prototype.sendBackward=function(){this.commandHandler.sendBackward()},e.prototype.getObject=function(t){return this.nameTable[""+t]},e.prototype.getNodeObject=function(t){return E(this.nameTable[""+t])},e.prototype.getConnectorObject=function(t){return E(this.nameTable[""+t])},e.prototype.getActiveLayer=function(){return this.activeLayer},e.prototype.nudgeCommand=function(t,i,r){if(this.eventHandler.keyArgs&&this.eventHandler.keyArgs.keyModifiers!==void 0&&this.eventHandler.keyArgs.keyModifiers!==0)return null;if(typeof t!="object"&&(this.selectedItems.nodes.length||this.selectedItems.connectors.length)>0){var a=void 0;i.type&&i.type==="KEYDOWN"&&(a=i.type),this.nudge(t,void 0,void 0,a)}},e.prototype.nudge=function(t,i,r,a){var s=0,o=0,h;t==="Left"||t==="Right"?(h=t==="Left",s=(h?-1:1)*(i||1)):(h=t==="Up",o=(h?-1:1)*(r||1)),a==="KEYDOWN"&&(s*=5,o*=5),this.restrictedDeltaValue={x:0,y:0};var l=this.selectedItems,d=this.selectedItems.wrapper.children[0];if(d instanceof Tt)this.commandHandler.labelDrag(l.nodes[0],d,s,o);else{var f=E(this.selectedItems);this.protectPropertyChange(!0),this.drag(l,s,o),this.protectPropertyChange(!1);var p={type:"PositionChanged",redoObject:E(this.selectedItems),undoObject:f,category:"Internal"};this.addHistoryEntry(p)}this.refreshCanvasLayers()},e.prototype.insertBlazorDiagramObjects=function(t){},e.prototype.drag=function(t,i,r){if(this.insertBlazorDiagramObjects(t),this.bpmnModule&&t instanceof M&&!(this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="Container")){var a=this.bpmnModule.updateAnnotationDrag(t,this,i,r);if(a)return}else if(t instanceof M&&this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="Container"){hy(t,this,i,r);return}if((t instanceof It&&t.wrapper||t&&t.id==="helper"&&t.wrapper)&&this.constraints&lt.RestrictNegativeAxisDragDrop){var s=t.wrapper.bounds;if(s){if(this.restrictedDeltaValue.x>0&&(this.restrictedDeltaValue.x-=i,this.restrictedDeltaValue.x>0?i=0:(i=this.restrictedDeltaValue.x*-1,this.restrictedDeltaValue.x=0)),this.restrictedDeltaValue.y>0&&(this.restrictedDeltaValue.y-=r,this.restrictedDeltaValue.y>0?r=0:(r=this.restrictedDeltaValue.y*-1,this.restrictedDeltaValue.y=0)),s.x+i<0){var o=-(s.x+i);this.restrictedDeltaValue.x+=o,i+=o}if(s.y+r<0){var h=-(s.y+r);this.restrictedDeltaValue.y+=h,r+=h}}}if(t instanceof It){if(this.preventConnectorsUpdate=!0,t.nodes&&t.nodes.length){for(var l=0,d=t.nodes;l<d.length;l++){var f=d[l];if(this.callBlazorModel=!1,this.drag(f,i,r),f.parentId){var p=this.nameTable[f.parentId];if(p.isLane){t.nodes.length>1&&(this.preventConnectorsUpdate=!1);var c=this.nameTable[p.parentId];kr(p,c,f,this)}}}this.callBlazorModel=!0}if(t.connectors&&t.connectors.length){this.callBlazorModel=!1;for(var u=0,g=t.connectors;u<g.length;u++){var v=g[u];this.drag(v,i,r),this.selectionConnectorsList.indexOf(v)===-1&&this.selectionConnectorsList.push(v)}this.callBlazorModel=!0}this.updateSelector(),this.diagramActions&k.DragUsingMouse&&this.updatePage()}else t instanceof M&&this.bpmnModule&&this.bpmnModule.updateAnnotationDrag(t,this,i,r),this.commandHandler.drag(t,i,r);if(t instanceof It){this.preventConnectorsUpdate=!1;for(var m=0,y=this.selectionConnectorsList;m<y.length;m++){var S=y[m];this.updateConnectorProperties(this.nameTable[S.id]),S.shape.type==="Bpmn"&&S.shape.sequence==="Default"&&S.shape.flow==="Sequence"&&this.commandHandler.updatePathElementOffset(S)}this.selectionConnectorsList=[]}this.callBlazorModel&&!(this.blazorActions&jt.interaction)&&!(this.blazorActions&jt.GroupClipboardInProcess)&&this.commandHandler.getBlazorOldValues(),t&&t.shape&&t.shape.type==="Container"&&this.updateChildOffset(t,i,r)},e.prototype.updateChildOffset=function(t,i,r){var a=this,s=t.shape.children;!s||s.length<1||s.forEach(function(o){var h=a.nameTable[""+o];!h||!h.shape||(h.shape.type==="Container"&&a.updateChildOffset(h,i,r),h.offsetX+=i,h.offsetY+=r)})},e.prototype.disableStackContainerPadding=function(t,i){if(t instanceof ah&&(t.considerPadding=i),t.children)for(var r=0,a=t.children;r<a.length;r++){var s=a[r];this.disableStackContainerPadding(s,!1)}},e.prototype.checkSize=function(t,i,r){if(!t||!t.wrapper||!t.wrapper.bounds||t.constraints&&t.constraints&W.AspectRatio)return!0;var a=t.wrapper.bounds,s=a.width,o=a.height,h=s*i,l=o*r;if(t.minWidth!==void 0&&h<t.minWidth||t.minHeight!==void 0&&l<t.minHeight||t.maxWidth!==void 0&&h>t.maxWidth||t.maxHeight!==void 0&&l>t.maxHeight)return!1;if(t.children&&t.children.length>0)for(var d=0,f=t.children;d<f.length;d++){var p=f[d],c=this.nameTable[""+p];if(c&&!this.checkSize(c,i,r))return!1}return!0},e.prototype.scale=function(t,i,r,a){this.disableStackContainerPadding(t.wrapper,!1),this.insertBlazorDiagramObjects(t);var s=!0;if(t.id&&(t=this.nameTable[t.id]||t),(t instanceof It&&t.wrapper||t&&t.id==="helper"&&t.wrapper)&&this.constraints&lt.RestrictNegativeAxisDragDrop){var o=t.wrapper.bounds;if(o){var h=t.wrapper,l=h.offsetX-h.actualSize.width*h.pivot.x,d=h.offsetY-h.actualSize.height*h.pivot.y,f=ts(l,d,h.actualSize.width,h.actualSize.height,h.rotateAngle,h.offsetX,h.offsetY,a),p=xt();Rt(p,-t.rotateAngle,f.x,f.y),Or(p,i,r,f.x,f.y),Rt(p,t.rotateAngle,f.x,f.y);var c={x:o.x+o.width*.5,y:o.y+o.height*.5},u=st(p,c);if(t.rotateAngle%360===0){var g=u.x-o.width*i*.5;g<0&&(i=Math.round(o.width*i+g)/o.width);var v=u.y-o.height*r*.5;v<0&&(r=Math.round(o.height*r+v)/o.height)}else{var m=[{x:o.x,y:o.y},{x:o.x+o.width,y:o.y},{x:o.x,y:o.y+o.height},{x:o.x+o.width,y:o.y+o.height}],y=m.map(function(N){return st(p,N)}),S=Math.min.apply(Math,y.map(function(N){return N.x})),x=Math.min.apply(Math,y.map(function(N){return N.y}));(S<0||x<0)&&(i=1,r=1)}}}if(t instanceof It){if(t.nodes&&t.nodes.length){this.callBlazorModel=!1;for(var I=0,C=t.nodes;I<C.length;I++){var P=C[I];if(!this.checkSize(P,i,r))return!1}for(var A=0,T=t.nodes;A<T.length;A++){var P=T[A];s=this.commandHandler.scale(P,i,r,a,t),this.commandHandler.checkBoundaryConstraints(void 0,void 0,t.wrapper.bounds)||this.commandHandler.scale(P,1/i,1/r,a,t)}this.callBlazorModel=!0}if(t.connectors&&t.connectors.length){this.callBlazorModel=!1;for(var z=0,L=t.connectors;z<L.length;z++){var R=L[z];this.commandHandler.scale(R,i,r,a,t),this.commandHandler.checkBoundaryConstraints(void 0,void 0,t.wrapper.bounds)||this.commandHandler.scale(R,1/i,1/r,a,t)}this.callBlazorModel=!0}var O=this.selectedItems;kn(this,O)||this.updateSelector(),this.refreshCanvasLayers()}else this.commandHandler.scale(t,i,r,a,t.children?t:void 0);return this.callBlazorModel&&!(this.blazorActions&jt.interaction)&&!(this.blazorActions&jt.GroupClipboardInProcess)&&this.commandHandler.getBlazorOldValues(),this.disableStackContainerPadding(t.wrapper,!0),s},e.prototype.rotate=function(t,i,r,a){var s,o=[];if(!a){if(s=E(t),s.nodes&&s.nodes.length>0&&s.nodes[0].children){var h=[];this.fromUndo||(this.rotateUsingButton=!0);for(var l=this.commandHandler.getAllDescendants(s.nodes[0],h),d=0;d<l.length;d++){var f=this.commandHandler.cloneChild(l[parseInt(d.toString(),10)].id);o[l[parseInt(d.toString(),10)].id]=E(f)}}i<0&&(i=(i+360)%360)}this.insertBlazorDiagramObjects(t);var p;if(t.id&&(t=this.nameTable[t.id]||t),t)if(r=r||{x:t.wrapper.offsetX,y:t.wrapper.offsetY},t instanceof It){this.callBlazorModel=!1,t.rotateAngle+=i,t.wrapper.rotateAngle+=i;var c=ze(t.wrapper);if(p=this.commandHandler.checkBoundaryConstraints(void 0,void 0,c),!p||!this.canRotateOnNegativeAxis(t.wrapper))return t.rotateAngle-=i,t.wrapper.rotateAngle-=i,!1;var u=[];u=u.concat(t.nodes),u=u.concat(t.connectors),this.commandHandler.rotateObjects(t,u,i,r),this.callBlazorModel=!0}else this.commandHandler.rotateObjects(t,[t],i,r);if(this.callBlazorModel&&!(this.blazorActions&jt.interaction)&&this.commandHandler.getBlazorOldValues(),!a&&!this.fromUndo&&s.nodes&&s.nodes.length>0&&s.nodes[0].children){var g={type:"RotationChanged",redoObject:E(t),undoObject:E(s),category:"Internal",childTable:o};this.commandHandler.addHistoryEntry(g),this.commandHandler.updateSelector()}return p},e.prototype.canRotateOnNegativeAxis=function(t){return!(this.constraints&lt.RestrictNegativeAxisDragDrop)||ze(t).left>=0&&ze(t).top>=0},e.prototype.dragSourceEnd=function(t,i,r){this.insertBlazorDiagramObjects(t),this.commandHandler.dragSourceEnd(t,i,r),this.callBlazorModel&&this.commandHandler.getBlazorOldValues()},e.prototype.dragTargetEnd=function(t,i,r){this.insertBlazorDiagramObjects(t),this.commandHandler.dragTargetEnd(t,i,r),this.callBlazorModel&&this.commandHandler.getBlazorOldValues()},e.prototype.findObjectsUnderMouse=function(t,i){return this.eventHandler.findObjectsUnderMouse(t,i)},e.prototype.findObjectUnderMouse=function(t,i,r){return this.eventHandler.findObjectUnderMouse(t,i,r)},e.prototype.findTargetObjectUnderMouse=function(t,i,r,a,s){return this.eventHandler.findTargetUnderMouse(t,i,r,a,s)},e.prototype.findElementUnderMouse=function(t,i,r,a){return this.eventHandler.findElementUnderMouse(t,i,r,a)},e.prototype.findActionToBeDone=function(t,i,r,a){return this.eventHandler.findActionToBeDone(t,i,r,a)},e.prototype.updateConnectorPort=function(t){if(t.ports.length)for(var i=void 0,r=0,a=t.ports;r<a.length;r++){var s=a[r];i=this.getWrapper(t.wrapper,s.id),t.initPortWrapper(s,t.intermediatePoints,t.wrapper.bounds,i)}t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize)},e.prototype.getTool=function(t){var i,r=_t(this.getCustomTool);return r&&(i=r(t),i)?i:this.eventHandler.getTool(t)},e.prototype.getCursor=function(t,i){var r,a=_t(this.getCustomCursor);if(a&&(r=a(t,i),r))return r;if(this.customCursor.length){for(var s=0;s<this.customCursor.length;s++)if(this.customCursor[parseInt(s.toString(),10)].action===t)return this.customCursor[parseInt(s.toString(),10)].cursor}return this.eventHandler.getCursor(t)},e.prototype.initHistory=function(){this.undoRedoModule&&this.undoRedoModule.initHistory(this)},e.prototype.addHistoryEntry=function(t,i){if(this.undoRedoModule&&this.constraints&lt.UndoRedo&&(!this.currentSymbol||this.checkCurrentSymbol(this.currentSymbol,t))){if(t.undoObject&&t.undoObject.id==="helper")return;var r=this.undoRedoModule.addHistoryEntry(t,this);t.type!=="StartGroup"&&t.type!=="EndGroup"&&r&&this.historyChangeTrigger(t,"CustomAction",i)}},e.prototype.checkCurrentSymbol=function(t,i){var r=!1;if(i.undoObject&&i.redoObject){var a=i.undoObject,s=i.undoObject;return s.id&&a.id&&s.id!==t.id&&a.id!==t.id?r=!0:r}return r},e.prototype.addCustomHistoryEntry=function(t){},e.prototype.historyChangeTrigger=function(t,i,r){var a={},s="oldValue",o="newValue",h="type",l=[];if(t.category==="Internal"){switch(t&&t.redoObject&&t.redoObject.nodes instanceof Array&&t.redoObject.connectors instanceof Array?l=t.redoObject.nodes.concat(t.redoObject.connectors):t.redoObject&&l.push(t.redoObject),a[""+h]=t.type,t.type){case"PositionChanged":i==="Undo"?(a[""+s]={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY},a[""+o]={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY}):(a[""+s]={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY},a[""+o]={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY});break;case"RotationChanged":i==="Undo"?(a[""+s]={rotateAngle:t.redoObject.rotateAngle},a[""+o]={rotateAngle:t.undoObject.rotateAngle}):(a[""+s]={rotateAngle:t.undoObject.rotateAngle},a[""+o]={rotateAngle:t.redoObject.rotateAngle});break;case"SizeChanged":i==="Undo"?(a[""+s]={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY,width:t.redoObject.width,height:t.redoObject.height},a[""+o]={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY,width:t.undoObject.width,height:t.undoObject.height}):(a[""+s]={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY,width:t.undoObject.width,height:t.undoObject.height},a[""+o]={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY,width:t.redoObject.width,height:t.redoObject.height});break;case"CollectionChanged":a[t.changeType]=l;break;case"ConnectionChanged":i==="Undo"?(a[""+s]={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY},a[""+o]={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY}):(a[""+s]={offsetX:t.undoObject.offsetX,offsetY:t.undoObject.offsetY},a[""+o]={offsetX:t.redoObject.offsetX,offsetY:t.redoObject.offsetY});break}var d=[],f=[];if(r===void 0&&t.type==="PropertyChanged"){for(var p=0;p<Object.keys(t.undoObject).length;p++)if(Object.keys(t.undoObject)[parseInt(p.toString(),10)]==="nodes")for(var c=0,u=Object.keys(t.undoObject.nodes);c<u.length;c++){var g=u[c],v=parseInt(g,10);d.push(this.nodes[parseInt(v.toString(),10)].id)}for(var p=0;p<Object.keys(t.undoObject).length;p++)if(Object.keys(t.undoObject)[parseInt(p.toString(),10)]==="connectors")for(var m=0,y=Object.keys(t.undoObject.connectors);m<y.length;m++){var g=y[m],v=parseInt(g,10);f.push(this.connectors[parseInt(v.toString(),10)].id)}r=d.concat(f)}var S={cause:t.category,source:l,change:a,action:i,sourceId:r};l.length&&this.triggerEvent(Z.historyChange,S)}},e.prototype.startGroupAction=function(){var t={type:"StartGroup",category:"Internal"};this.diagramActions&k.UndoRedo||this.addHistoryEntry(t)},e.prototype.endGroupAction=function(){var t={type:"EndGroup",category:"Internal"};this.diagramActions&k.UndoRedo||this.addHistoryEntry(t)},e.prototype.undo=function(){this.canEnableBlazorObject=!0,this.callBlazorModel=!1,this.undoRedoModule&&this.constraints&lt.UndoRedo?(this.isUndo=!0,this.undoRedoModule.undo(this),this.isUndo=!1):this.constraints&lt.UndoRedo&&console.warn('[WARNING] :: Module "UndoRedo" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1},e.prototype.redo=function(){this.canEnableBlazorObject=!0,this.callBlazorModel=!1,this.undoRedoModule&&this.constraints&lt.UndoRedo?this.undoRedoModule.redo(this):this.constraints&lt.UndoRedo&&console.warn('[WARNING] :: Module "UndoRedo" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1},e.prototype.getBlazorDiagramObjects=function(t){if(t)for(var i=0;i<t.length;i++)this.insertBlazorDiagramObjects(t[parseInt(i.toString(),10)]);else this.insertBlazorDiagramObjects(this.selectedItems);this.callBlazorModel=!1,this.canEnableBlazorObject=!0},e.prototype.align=function(t,i,r){this.getBlazorDiagramObjects(i),i||(i=[],i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|k.PublicMethod,this.commandHandler.align(i,t,r||"Object"),this.commandHandler.getBlazorOldValues(),this.callBlazorModel=!0,this.canEnableBlazorObject=!1},e.prototype.distribute=function(t,i){this.getBlazorDiagramObjects(i);var r=[];i||(i=[],i=i.concat(this.selectedItems.nodes),this.selectedItems.connectors.forEach(function(h){h.sourceWrapper||h.targetWrapper?r.indexOf(h)===-1&&r.push(h):i.indexOf(h)===-1&&i.push(h)})),this.diagramActions=this.diagramActions|k.PublicMethod,this.commandHandler.distribute(i,t);for(var a=0,s=r;a<s.length;a++){var o=s[a];this.updateConnectorProperties(o)}this.commandHandler.getBlazorOldValues(),this.canEnableBlazorObject=!1,this.callBlazorModel=!0},e.prototype.sameSize=function(t,i){this.getBlazorDiagramObjects(i),i||(i=[],i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors)),this.diagramActions=this.diagramActions|k.PublicMethod,this.commandHandler.sameSize(i,t),this.commandHandler.getBlazorOldValues(),this.canEnableBlazorObject=!1,this.callBlazorModel=!0},e.prototype.updateBlazorDiagramProperties=function(t,i){},e.prototype.getZoomingAttribute=function(){var t=[];return t.push("scrollSettings"),t.push("snapSettings"),t},e.prototype.zoom=function(t,i){var r=this.getZoomingAttribute();this.updateBlazorDiagramProperties(r),this.scroller.zoom(t,0,0,i),this.blazorActions&jt.interaction||this.updateBlazorDiagramProperties(r,!0)},e.prototype.zoomTo=function(t){var i=this.getZoomingAttribute();this.updateBlazorDiagramProperties(i);var r=t.zoomFactor?t.zoomFactor:.2;r=t.type==="ZoomOut"?1/(1+r):1+r,this.scroller.zoom(r,0,0,t.focusPoint),this.updateBlazorDiagramProperties(i,!0)},e.prototype.pan=function(t,i,r,a){var s=this.getZoomingAttribute();this.updateBlazorDiagramProperties(s),this.setCursor("grabbing"),this.scroller.zoom(1,t,i,r,a),this.updateBlazorDiagramProperties(s,!0)},e.prototype.reset=function(){var t=this.getZoomingAttribute();this.updateBlazorDiagramProperties(t),this.scroller.zoom(1/this.scroller.currentZoom,-this.scroller.horizontalOffset,-this.scroller.verticalOffset,{x:0,y:0}),this.updateBlazorDiagramProperties(t,!0)},e.prototype.resetSegments=function(){if(this.constraints&lt.LineRouting&&this.lineRoutingModule)this.lineRoutingModule.lineRouting(this);else{this.protectPropertyChange(!0);for(var t=void 0,i=0;i<this.connectors.length;i++)t=this.connectors[parseInt(i.toString(),10)],t.segments=[],this.connectorPropertyChange(t,{},{segments:t.segments}),this.avoidLineOverlappingModule&&this.avoidLineOverlappingModule.removeConnector(t);this.protectPropertyChange(!1)}},e.prototype.setBlazorDiagramProps=function(t){var i=this.getZoomingAttribute();t?this.updateBlazorDiagramProperties(i):this.updateBlazorDiagramProperties(i,!0)},e.prototype.triggerEvent=function(t,i){return In(this,void 0,void 0,function(){var r;return xn(this,function(a){switch(a.label){case 0:return i&&this.updateEventValue(i),[4,this.trigger(Z[""+t],i)];case 1:return r=a.sent(),[2,r]}})})},e.prototype.updateEventValue=function(t){var i=t.element;t.element&&i instanceof It&&i.nodes.length+i.connectors.length===1&&(t.element=i.nodes.length===1?i.nodes[0]:i.connectors[0])},e.prototype.addNodeToLane=function(t,i,r){if(this.nameTable[""+i]){var a=this.nameTable[""+i];if(this.protectPropertyChange(!0),this.undoRedoModule&&this.historyManager.startGroupAction(),this.nameTable[t.id]||(t.offsetX=a.wrapper.bounds.width+a.wrapper.bounds.x,t.offsetY=a.wrapper.bounds.height+a.wrapper.bounds.y,t=this.add(t)),t.parentId="",a.shape.phases.length)for(var o=0;o<a.shape.phases.length;o++){var s=i+r+o;if(this.nameTable[""+s]&&this.nameTable[""+s].isLane){var h=this.nameTable[""+s].wrapper.bounds,l={x:h.x+(h.x-a.wrapper.bounds.x+t.margin.left+t.wrapper.bounds.width/2),y:h.y+a.wrapper.bounds.y-t.margin.top};if(a.shape.orientation==="Horizontal")l.y=h.y;else{l.x=h.x;var d=this.nameTable[""+s].parentId+a.shape.lanes[0].id+"_0_header";l.y=h.y+(a.wrapper.bounds.y-this.nameTable[""+d].wrapper.bounds.height+t.margin.top+t.wrapper.bounds.height/2)}var f=a.shape.phases[parseInt(o.toString(),10)];if(t.margin.left<=f.offset){this.addChildToPhase(t,a,s);break}else if(s===i+r+(a.shape.phases.length-1)||h.containsPoint(l)){this.addChildToPhase(t,a,s);break}}}else{var s=i+r+"0";this.nameTable[""+s]&&(this.commandHandler.updateLaneChildrenZindex(t,this.nameTable[""+s]),zn(this,this.nameTable[""+s],t,void 0,!0),kr(this.nameTable[""+s],a,t,this))}this.undoRedoModule&&this.historyManager.endGroupAction(),this.protectPropertyChange(!1)}this.updateDiagramElementQuad()},e.prototype.addChildToPhase=function(t,i,r){this.commandHandler.updateLaneChildrenZindex(t,this.nameTable[""+r]),zn(this,this.nameTable[""+r],t,void 0,!0),kr(this.nameTable[""+r],i,t,this)},e.prototype.showTooltip=function(t){t&&t.id&&!t.wrapper&&(t=this.nameTable[t.id]);var i=ze(t.wrapper),r={x:0,y:0},a=t.tooltip.content?t.tooltip.content:"X:"+Math.round(i.x)+" Y:"+Math.round(i.y);t&&t.tooltip.openOn==="Custom"&&(t instanceof M?r={x:t.offsetX+t.width/2,y:t.offsetY+t.height/2}:r={x:t.targetPoint.x,y:t.targetPoint.x},this.commandHandler.showTooltip(t,r,a,"SelectTool",!0))},e.prototype.hideTooltip=function(t){t&&t.tooltip.openOn==="Custom"&&this.tooltipObject.close()},e.prototype.addNode=function(t,i){return this.add(t,i)},e.prototype.addChildToGroup=function(t,i){var r=t&&t.shape&&t.shape.type==="Container",a=this.allowServerDataBinding;this.enableServerDataBinding(!1);var s=this.isProtectedOnChange;this.protectPropertyChange(!0),t=this.getObject(t.id);var o=!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.Group)&&!(this.diagramActions&k.PreventHistory);if(r&&!i.id){var h=this.getObject(i);h?i=h:i.id=K()}o&&this.startGroupAction();var l=i.id;if(r)yf(i,t.id,this);else{l=this.addChild(t,i);var d=this.nameTable[i]?this.nameTable[i]:i,f=document.getElementById(d.id+"_groupElement"),p=document.getElementById(t.id+"_groupElement");p&&f&&p.appendChild(f)}if(o){var c={};c[""+l]=E(this.getObject(l));var u={type:"AddChildToGroupNode",changeType:"Insert",undoObject:E(t),redoObject:E(t),category:"Internal",objectId:l,childTable:c};this.addHistoryEntry(u),this.endGroupAction()}this.protectPropertyChange(s),this.enableServerDataBinding(a),this.updateSelector()},e.prototype.removeChildFromGroup=function(t,i){var r=t&&t.shape&&t.shape.type==="Container",a=this.allowServerDataBinding;this.enableServerDataBinding(!1);var s=this.isProtectedOnChange;this.protectPropertyChange(!0),t=this.getObject(t.id);var o=E(t),h=!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.Group)&&!(this.diagramActions&k.PreventHistory),l=i.id||(this.nameTable[i]?this.nameTable[i].id:i);if(h&&this.startGroupAction(),r){if(h){var d={};d[""+l]=E(this.getObject(l));var f={type:"RemoveChildFromGroupNode",changeType:"Remove",undoObject:o,redoObject:E(t),category:"Internal",objectId:l,childTable:d};this.addHistoryEntry(f);var p=i instanceof M?i:this.nameTable[""+l];fy(p,this)}}else{var c=this.removeChild(t,i);if(h){var d={};d[""+c]=E(this.getObject(c));var f={type:"RemoveChildFromGroupNode",changeType:"Remove",undoObject:E(o),redoObject:E(t),category:"Internal",objectId:c,childTable:d};this.addHistoryEntry(f)}var u=this.nameTable[i]?this.nameTable[i]:i,g=u.zIndex,v=this.layers.indexOf(this.commandHandler.getObjectLayer(u.id)),m=this.layers[parseInt(v.toString(),10)].objects[g+1],y=document.getElementById(m+"_groupElement"),S=document.getElementById(u.id+"_groupElement"),x=document.getElementById(t.id+"_groupElement");x&&S&&(m&&y?x.contains(y)?x.insertBefore(S,y):x.parentNode.contains(y)&&y.parentElement===x.parentElement?x.parentNode.insertBefore(S,y):x.parentNode.appendChild(S):x.parentNode.appendChild(S))}h&&this.endGroupAction(),this.protectPropertyChange(s),this.enableServerDataBinding(a),this.updateSelector()},e.prototype.getHistoryStack=function(t){var i=[],r=t?this.historyManager.undoStack:this.historyManager.redoStack;if(this.historyManager.stackLimit!==void 0){for(var a=r.length-1;a>=0;a--)if(i.push(r[parseInt(a.toString(),10)]),i.length>this.historyManager.stackLimit)return i}else i=r;return i},e.prototype.getEdges=function(t){return t.outEdge?this.nameTable[t.id].outEdges:this.nameTable[t.id].inEdges},e.prototype.getParentId=function(t){return this.nameTable[""+t].parentId},e.prototype.addConnector=function(t){return this.add(t)},e.prototype.UpdateBlazorDiagramModelCollection=function(t,i,r,a){},e.prototype.UpdateBlazorDiagramModel=function(t,i,r,a){},e.prototype.UpdateBlazorLabelOrPortObjects=function(t,i,r,a){},e.prototype.addBlazorDiagramObjects=function(){},e.prototype.removeNodeEdges=function(t,i,r){var a=this.nameTable[""+t],s=r?a.outEdges:a.inEdges;if(s.length>0)for(var o=0;o<s.length;o++)s[parseInt(o.toString(),10)]===i&&s.splice(o,1)},e.prototype.insertBlazorConnector=function(t){},e.prototype.add=function(t,i){var r,a=this.isProtectedOnChange;this.protectPropertyChange(!0);var s=!1;if(t){t=E(t);var o=void 0;if(o={element:t,cause:this.diagramActions,diagramAction:this.itemType,state:"Changing",type:"Addition",cancel:!1},this.parentObject&&(o.parentId=this.parentObject.id),t.id!=="helper"&&!(this.diagramActions&k.PreventCollectionChangeOnDragOver)&&this.triggerEvent(Z.collectionChange,o),o.cancel&&this.drawingObject){this.removeElements(o.element),this.tooltipObject.close();var h=this.getObject(o.element.sourceID),l=void 0;if(Fe(o.element)===B){if(o.element.sourceID&&(this.removeNodeEdges(o.element.sourceID,o.element.id,!0),h.ports.length>0)){for(var d=0;d<h.ports.length;d++){var f=h.ports[parseInt(d.toString(),10)];f.id===o.element.sourcePortID&&(f.outEdges.length>0?l=!1:l=!0)}this.removePortEdges(h,o.element.sourcePortID,o.element.id,l)}o.element.targetID&&this.removeNodeEdges(o.element.targetID,o.element.id,!1)}}this.diagramActions=this.diagramActions|k.PublicMethod,t.id=t.id||K();var p=this.activeLayer;if(!o.cancel&&p&&!p.lock){if(p.objects.indexOf(t.id)<0&&!p.lock&&(p.visible||(p.visible=!0,this.dataBind()),p.objects.push(t.id),this.activeLayerObjectsSet.add(t.id)),Fe(t)===B)r=new B(this,"connectors",t,!0),r.status="New",this.nameTable[r.targetID]&&this.nameTable[r.targetID].shape.shape==="TextAnnotation"&&(r.isBpmnAnnotationConnector=!0,r.constraints=r.constraints&~yt.Delete),Ti(r,t,this.connectorDefaults),this.connectors.push(r),this.initObject(r,p),t.visible===!1&&this.updateElementVisibility(r.wrapper,r,t.visible),this.updateEdges(r),this.insertBlazorConnector(r);else{if(r=new M(this,"nodes",t,!0),Ti(r,t,this.nodeDefaults),r.parentId=t.parentId?t.parentId:r.parentId,r.umlIndex=t.umlIndex,r.status="New",s=r.shape.shape==="TextAnnotation",s&&!t.isTextAnnotationCopied&&(r.inEdges=t.inEdges?t.inEdges:r.inEdges),this.nodes.push(r),this.initObject(r,p,void 0,i),s&&this.bpmnModule)for(var d=0;d<this.bpmnModule.bpmnTextAnnotationConnector.length;d++)this.bpmnModule.bpmnTextAnnotationConnector[parseInt(d.toString(),10)].wrapper===null&&this.initConnectors(this.bpmnModule.bpmnTextAnnotationConnector[parseInt(d.toString(),10)],void 0,!0);if(this.updateTemplate(),this.bpmnModule&&r.shape.activity&&r.shape.activity.subProcess.processes&&r.shape.activity.subProcess.processes.length&&this.bpmnModule.updateDocks(r,this),this.lineRoutingModule&&this.constraints&lt.LineRouting)for(var c=this.spatialSearch.findObjects(r.wrapper.outerBounds),d=0;d<c.length;d++){var u=c[parseInt(d.toString(),10)];u instanceof B&&this.connectorPropertyChange(u,{},{sourceID:u.sourceID,targetID:u.targetID,sourcePortID:u.sourcePortID,targetPortID:u.targetPortID,sourcePoint:u.sourcePoint,targetPoint:u.targetPoint})}else this.constraints&lt.LineRouting&&console.warn('[WARNING] :: Module "LineRouting" is not available in Diagram component! You either misspelled the module name or forgot to load it.');if(r.umlIndex>-1&&t.parentId&&this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="UmlClassifier"){var g=this.nameTable[t.parentId];g.children.splice(r.umlIndex,0,r.id),g.wrapper.children.splice(r.umlIndex,0,r.wrapper),g.wrapper.measure(new U),g.wrapper.arrange(g.wrapper.desiredSize),this.updateDiagramObject(g)}}if(o={element:r,cause:this.diagramActions,diagramAction:this.itemType,state:"Changed",type:"Addition",cancel:!1},this.parentObject&&(o.parentId=this.parentObject.id),t.id!=="helper"&&!(this.diagramActions&k.PreventCollectionChangeOnDragOver)&&this.triggerEvent(Z.collectionChange,o),!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.Group)&&!(this.diagramActions&k.PreventHistory)){var v=void 0;t&&t.shape&&t.shape.type==="SwimLane"||t&&t.shape&&t.shape.type==="Bpmn"?v=t:v=r;var m={type:"CollectionChanged",changeType:"Insert",undoObject:E(v),redoObject:E(v),category:"Internal"};this.addHistoryEntry(m)}if(this.parentObject=void 0,this.mode==="SVG"){if(this.updateSvgNodes(r),this.updateTextElementValue(r),this.updateDiagramObject(r),s){var y=this.nameTable[r.inEdges[0]];this.updateDiagramObject(y)}r.shape.activity&&r.shape.activity.subProcess.processes&&r.shape.activity.subProcess.processes.length&&this.updateProcesses(r),this.updateBridging()}}}if(this.protectPropertyChange(a),this.resetDiagramActions(k.PublicMethod),r&&this.layers.length>1&&this.moveNode(r),this.views)for(var S=0,x=this.views;S<x.length;S++){var I=x[S],C=this.views[""+I];C instanceof e||this.refreshCanvasDiagramLayer(C)}return this.renderReactTemplates(),this.itemType="PublicMethod",r},e.prototype.addElements=function(t){for(var i=0;i<t.length;i++)this.add(t[parseInt(i.toString(),10)]);this.pathDataStorage&&this.pathDataStorage.clear()},e.prototype.getPathData=function(t){return this.pathDataStorage||(this.pathDataStorage=new Map),this.pathDataStorage.has(t)?this.pathDataStorage.get(t):[]},e.prototype.setPathData=function(t,i){var r=this.pathDataStorage.get(t)||[];r.length===0&&this.pathDataStorage.set(t,i)},e.prototype.updateSvgNodes=function(t){if(t.children)for(var i=0,r=t.children;i<r.length;i++){var a=r[i];if(this.nameTable[""+a]&&this.nameTable[""+a].parentId){var s=St(a+"_groupElement",this.element.id);s&&s.parentNode.removeChild(s)}}},e.prototype.updateProcesses=function(t){if(this.bpmnModule&&t&&t.shape&&t.shape.activity&&t.shape.activity.subProcess.processes&&t.shape.activity.subProcess.processes.length){var i=t.shape.activity.subProcess.processes;this.moveSvgNode(t.id);for(var r=0,a=i;r<a.length;r++){var s=a[r];this.moveSvgNode(s);var o=[];o=o.concat(this.nameTable[""+s].outEdges,this.nameTable[""+s].inEdges);for(var h=o.length-1;h>=0;h--)this.moveSvgNode(o[parseInt(h.toString(),10)])}for(var l=0,d=i;l<d.length;l++){var s=d[l];this.nameTable[""+s].shape.activity.subProcess.processes&&this.nameTable[""+s].shape.activity.subProcess.processes.length&&this.updateProcesses(this.nameTable[""+s])}}else this.moveSvgNode(t.id)},e.prototype.moveSvgNode=function(t){var i=St(t+"_groupElement",this.element.id),r=i.parentElement;i.parentNode.removeChild(i),r.appendChild(i)},e.prototype.addTextAnnotation=function(t,i){this.bpmnModule&&this.getBPMNTextAnnotation(i,this,t,!0)},e.prototype.spliceConnectorEdges=function(t,i){var r=[],a=i?this.nameTable[t.sourceID]:this.nameTable[t.targetID];if(a){r=i?a.outEdges:a.inEdges;for(var s=r.length-1;s>=0;s--)r[parseInt(s.toString(),10)]===t.id&&r.splice(s,1);for(var o=0;a.ports&&o<a.ports.length;o++){var h=!i;this.removePortEdges(a,a.ports[parseInt(o.toString(),10)].id,t.id,h)}}},e.prototype.removeDependentConnector=function(t){if(t){var i=void 0,r=[];r=r.concat(t.outEdges,t.inEdges);for(var a=r.length-1;a>=0;a--)if(i=this.nameTable[r[parseInt(a.toString(),10)]],i)if(this.connectorTable[i.id]=E(i),i.isBpmnAnnotationConnector){var s=this.nameTable[i.targetID];this.removeObjectsFromLayer(i);var o=this.connectors.indexOf(i);o!==-1&&this.connectors.splice(o,1),this.removeElements(i),this.removeFromAQuad(i),delete this.nameTable[i.id];var h=this.nameTable[i.sourceID];if(h){var l=h.outEdges.indexOf(i.id);l!==-1&&h.outEdges.splice(l,1)}t.id!==i.targetID&&this.remove(s)}else this.remove(i)}},e.prototype.removeObjectsFromLayer=function(t){if(t.children)for(var i=0;i<t.children.length;i++){var r=this.nameTable[t.children[parseInt(i.toString(),10)]];r&&this.removeObjectsFromLayer(r)}var a=this.layers.indexOf(this.commandHandler.getObjectLayer(t.id)),s=this.layers[parseInt(a.toString(),10)].objects,o=s.indexOf(t.id);o>-1&&(Ut(this,t)&&this.unSelect(t),this.layers[parseInt(a.toString(),10)].objects.splice(o,1),this.activeLayerObjectsSet.delete(t.id),delete this.layers[parseInt(a.toString(),10)].zIndexTable[this.nameTable[t.id].zIndex])},e.prototype.removeElements=function(t){if(this.mode==="SVG"||this.mode==="Canvas"&&t.shape.type==="Native"){var i=St(t.id+"_groupElement",this.element.id),r=t;if(r.ports&&r.ports.length>0)for(var a=0;a<r.ports.length;a++){var s=r.ports[parseInt(a.toString(),10)],o=St(r.id+"_"+s.id+"_groupElement",this.element.id);o&&o.parentNode.removeChild(o)}i&&i.parentNode.removeChild(i)}if(this.refreshCanvasLayers(),t.wrapper){var h=t.wrapper.children,l=void 0;if(h){h.length>0&&!(t.wrapper instanceof Ht)&&(h=h[0].children);for(var a=0;a<h.length;a++){if(h[parseInt(a.toString(),10)]instanceof li||h[parseInt(a.toString(),10)].id&&h[parseInt(a.toString(),10)].id.indexOf("icon_content")>0){h[parseInt(a.toString(),10)].id.indexOf("icon_content")>0&&this.mode==="SVG"&&(l=St(h[parseInt(a.toString(),10)].id+"_shape_groupElement",this.element.id),l&&l.parentNode.removeChild(l),l=St(h[parseInt(a.toString(),10)].id+"_rect_groupElement",this.element.id),l&&l.parentNode.removeChild(l));for(var d=0,f=this.views;d<f.length;d++){var p=f[d];be(h[parseInt(a.toString(),10)].id+"_groupElement",p);var c=this.scroller.removeCollection.indexOf(t.id);this.scroller.removeCollection.splice(c,1)}}else if(h[parseInt(a.toString(),10)]instanceof we)for(var u=0,g=this.views;u<g.length;u++){var p=g[u];if(this.views[""+p]instanceof e||!this.preventOverviewRefresh){be(t.id+"_html_element",p),be(h[parseInt(a.toString(),10)].id+"_html_element",p);var v=!0,m=this.nameTable[t.parentId];(this.isAngular||this.isReact||this.isVue)&&(m&&m.isLane||this.constraints&lt.Virtualization)&&(v=!1),v&&(this.clearTemplate(["nodeTemplate_"+t.id]),h[parseInt(a.toString(),10)].annotationId&&this.clearTemplate(["annotationTemplate_"+t.id+h[parseInt(a.toString(),10)].annotationId]))}}ff(h[parseInt(a.toString(),10)].id)}}}},e.prototype.removeCommand=function(){this.itemType="KeyboardDelete",this.remove(),this.itemType="PublicMethod"},e.prototype.remove=function(t){var i=[];i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors);var r,a=!1;if(t){if(t=this.nameTable[t.id],this.insertBlazorConnector(t),t&&(ha(t)||this.diagramActions&k.Clear)&&(r={element:t,cause:this.diagramActions,diagramAction:this.itemType,state:"Changing",type:"Removal",cancel:!1},!(this.diagramActions&k.Clear)&&t.id!=="helper"&&this.triggerEvent(Z.collectionChange,r),!r.cancel)){if(ha(t)&&t&&t.shape&&t.shape.type==="SwimLane"&&cm(this,t),!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.PreventHistory)&&(t instanceof M||t instanceof B)){var s={type:"CollectionChanged",changeType:"Remove",undoObject:E(t),redoObject:E(t),category:"Internal"};this.diagramActions&k.Clear||t.children&&!t.isLane&&!t.isPhase&&t.children.length>0&&this.undoRedoModule&&this.layout.type==="None"&&(this.historyManager.startGroupAction(),a=!0),(t instanceof M||t instanceof B)&&this.deleteDependentConnector&&this.removeDependentConnector(t),!t.isLane&&!t.isPhase&&!(t.isHeader&&this.nameTable[t.parentId].shape.type==="Container")&&!(this.diagramActions&k.Clear)&&!this.isStackChild(t)&&this.addHistoryEntry(s)}t.shape.shape==="TextAnnotation"&&this.removeDependentConnector(t),t.children&&!t.isLane&&!t.isPhase&&(!(this.diagramActions&k.UndoRedo)||!0)&&this.deleteGroup(t),t.parentId&&(this.deleteChild(t,void 0,!0),this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="UmlClassifier"&&(this.updateDiagramObject(this.nameTable[t.parentId]),this.updateConnectorEdges(this.nameTable[t.parentId])));var o=void 0;this.diagramActions=this.diagramActions|k.PublicMethod;var h=this.nameTable[t.id];if(h instanceof M){if(h.shape.type==="Bpmn"&&this.bpmnModule&&this.bpmnModule.removeBpmnProcesses(h,this),(h.parentId&&this.nameTable[h.parentId]&&this.nameTable[h.parentId].shape.type==="Container"||h.shape.type==="Container")&&dy(h,this),h.isLane||h.isPhase||h.shape.type==="SwimLane"){var l=h.isLane||h.isPhase?this.nameTable[h.parentId]:this.nameTable[h.id];l.wrapper.children[0],h.isLane?il(this,h,l):h.isPhase&&nl(this,h,l)}o=this.nodes.indexOf(h),o!==-1&&(this.crudDeleteNodes.push(this.nameTable[h.id]),this.nodes.splice(o,1),this.updateNodeEdges(h))}else o=this.connectors.indexOf(h),o!==-1&&(this.crudDeleteNodes.push(this.nameTable[h.id]),this.connectors.splice(o,1)),this.updateEdges(h),this.spliceConnectorEdges(t,!0),this.spliceConnectorEdges(t,!1);if(!this.isServerUpdate&&!(this.blazorActions&jt.GroupClipboardInProcess)&&this.commandHandler.getBlazorOldValues(),a&&this.historyManager.endGroupAction(),Ut(this,h)&&this.unSelect(h),!h.isPhase){if(this.removeObjectsFromLayer(t),this.currentDrawingObject&&(this.currentDrawingObject.wrapper=void 0),delete this.nameTable[t.id],i.length>0&&i[0].id===h.id&&h.parentId){var d=this.nameTable[h.parentId];if(d&&d.isLane&&this.nameTable[d.parentId].shape.type==="SwimLane"){var l=this.nameTable[d.parentId];Zd(this,l,d,h)}}this.removeElements(h),this.updateBridging(),this.mode!=="SVG"&&this.refreshDiagramLayer(),this.diagramActions&k.Clear||(this.removeFromAQuad(h),r={element:t,cause:this.diagramActions,diagramAction:this.itemType,state:"Changed",type:"Removal",cancel:!1},t.id!=="helper"&&this.triggerEvent(Z.collectionChange,r),this.resetTool())}}var f=this.selectedItems;f.annotation&&this.clearSelection()}else if(i.length>0){this.undoRedoModule&&(this.historyManager.startGroupAction(),this.blazorActions|=jt.GroupingInProgress,a=!0);for(var p=0;p<i.length;p++){var c=i[parseInt(p.toString(),10)],u=this.nameTable[c.parentId];if(this.nameTable[i[parseInt(p.toString(),10)].id])if(u&&u.shape instanceof Br&&!c.isPhase){if(c.isLane){var g=u.shape.header.id?u.shape.header.height:0;(this.selectedItems.wrapper.bounds.x<=u.wrapper.bounds.x&&this.selectedItems.wrapper.bounds.width>=u.wrapper.bounds.width&&u.shape.orientation==="Horizontal"||this.selectedItems.wrapper.bounds.y<=u.wrapper.bounds.y+g&&this.selectedItems.wrapper.bounds.height>=u.wrapper.bounds.height-g&&u.shape.orientation==="Vertical")&&(ha(u)||u.shape.lanes.length>1)&&this.remove(i[parseInt(p.toString(),10)])}}else this.remove(i[parseInt(p.toString(),10)])}a&&(this.blazorActions&=~jt.GroupingInProgress,this.isServerUpdate=!0,this.commandHandler.getBlazorOldValues(),this.UpdateBlazorDiagramModelCollection(void 0,void 0,void 0,!0),this.historyManager.endGroupAction(),this.isServerUpdate=!1),this.clearSelection()}if(!(t&&(ha(t)||this.diagramActions&k.Clear))&&!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.PreventHistory)&&(t instanceof M||t instanceof B)){var s={type:"ConnectionChanged",undoObject:E(t),redoObject:E(t),category:"Internal"};!t.isLane&&!t.isPhase&&!(t.isHeader&&this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="Container")&&!(this.diagramActions&k.Clear)&&!this.isStackChild(t)&&this.addHistoryEntry(s)}if(this.tooltipObject.close(),t&&t.id!=="helper"&&this.lineRoutingModule&&this.constraints&lt.LineRouting&&t instanceof M&&this.layout.type!=="ComplexHierarchicalTree"){var v=40,m=ze(t.wrapper);m.Inflate(v);var y=this.spatialSearch.findObjects(m);this.avoidLineOverlappingModule&&this.avoidLineOverlappingModule.removeConnectors(y),this.lineRoutingModule.renderVirtualRegion(this,!0);for(var S=0,x=y;S<x.length;S++){var I=x[S];I instanceof B&&I.type==="Orthogonal"&&this.lineRoutingModule.refreshConnectorSegments(this,I,!0)}}},e.prototype.isStackChild=function(t){var i,r=this.nameTable[t.parentId];if(t&&t.parentId&&r.container&&r.container.type==="Stack"&&this.nameTable[t.parentId].shape.type!=="UmlClassifier"){i=!0;var a={sourceIndex:r.wrapper.children.indexOf(t.wrapper),source:t,target:void 0,targetIndex:void 0},s={type:"StackChildPositionChanged",redoObject:{sourceIndex:void 0,source:t,target:void 0,targetIndex:void 0},undoObject:a,category:"Internal"};this.diagramActions&k.UndoRedo||this.addHistoryEntry(s)}return i},e.prototype.deleteChild=function(t,i,r){var a;if(i=i?this.nameTable[i.id]:this.nameTable[t.parentId],typeof t=="string"?a=t:a=t.id,i&&i.children){for(var s=0;s<i.children.length;s++)if(i.children[parseInt(s.toString(),10)]===a){i.children.splice(s,1);for(var o=0;o<i.wrapper.children.length;o++)i.wrapper.children[parseInt(o.toString(),10)].id===a&&i.wrapper.children.splice(o,1);if(!r){var h=this.getObject(i.parentId);if(h&&h.shape instanceof Br)for(var l=0;l<h.shape.lanes.length;l++){var d=t.parentId.split(h.id);if(h.shape.lanes[parseInt(l.toString(),10)].id===d[1].slice(0,-1)){for(var f=0;f<h.shape.lanes[parseInt(l.toString(),10)].children.length;f++)if(t.id===h.shape.lanes[parseInt(l.toString(),10)].children[parseInt(f.toString(),10)].id){h.shape.lanes[parseInt(l.toString(),10)].children.splice(f,1);break}}}}}i.wrapper.measure(new U),i.wrapper.arrange(i.wrapper.desiredSize)}},e.prototype.addChild=function(t,i,r){var a,s=this.nameTable[t.id];if(s.children||(s.children=[]),s.children&&(typeof i=="string"?this.nameTable[""+i]&&(a=i):(a=i.id=i.id||K(),this.add(i)),a&&(!i.umlIndex||i.umlIndex===-1))){var o=this.nameTable[""+a];if(o.parentId=s.id,s.container&&s.container.type==="Stack"&&this.updateStackProperty(s,o),r)s.children.splice(r,0,a),s.wrapper.children.splice(r,0,o.wrapper);else{s.children.push(a),s.wrapper.children.push(o.wrapper);var h=this.getObject(t.parentId),l=!1;if(h&&h.shape instanceof Br)for(var d=0;d<h.shape.lanes.length;d++){var f=Zn(s,this);if(h.shape.lanes[parseInt(d.toString(),10)].id===f.id){for(var p=0;p<h.shape.lanes[parseInt(d.toString(),10)].children.length;p++)if(h.shape.lanes[parseInt(d.toString(),10)].children[parseInt(p.toString(),10)].id===o.id){l=!0;break}l||h.shape.lanes[parseInt(d.toString(),10)].children.push(o);break}}}s.wrapper.measure(new U),s.wrapper.arrange(s.wrapper.desiredSize),s.isLane||(this.nameTable[t.id].width=s.wrapper.actualSize.width,this.nameTable[t.id].height=s.wrapper.actualSize.height,this.nameTable[t.id].offsetX=s.wrapper.offsetX,this.nameTable[t.id].offsetY=s.wrapper.offsetY),s.container!==void 0&&(o.offsetX=o.wrapper.offsetX,o.offsetY=o.wrapper.offsetY),(!s.parentId||this.nameTable[s.parentId]&&this.nameTable[s.parentId].shape.type!=="SwimLane")&&this.updateDiagramObject(s)}return a},e.prototype.removeChild=function(t,i){var r,a=this.nameTable[t.id];if(a.children||(a.children=[]),a.children&&(typeof i=="string"?this.nameTable[""+i]&&(r=i):r=i.id=i.id||K(),r&&(!i.umlIndex||i.umlIndex===-1))){var s=this.nameTable[""+r];s.parentId="",a.container&&a.container.type==="Stack"&&this.updateStackProperty(a,s);for(var o=0;o<a.children.length;o++)if(a.children[parseInt(o.toString(),10)]===r){a.children.splice(o,1);for(var h=0;h<a.wrapper.children.length;h++)a.wrapper.children[parseInt(h.toString(),10)]===s.wrapper&&a.wrapper.children.splice(h,1)}a.wrapper.measure(new U),a.wrapper.arrange(a.wrapper.desiredSize),a.isLane||(this.nameTable[t.id].width=a.wrapper.actualSize.width,this.nameTable[t.id].height=a.wrapper.actualSize.height,this.nameTable[t.id].offsetX=a.wrapper.offsetX,this.nameTable[t.id].offsetY=a.wrapper.offsetY),(!a.parentId||this.nameTable[a.parentId]&&this.nameTable[a.parentId].shape.type!=="SwimLane")&&this.updateDiagramObject(a)}return r},e.prototype.clear=function(){this.clearObjects(),this.clearLayers()},e.prototype.clearLayers=function(){for(var t=this.layers.length,i=t-1;i>=0;i--)this.removeLayer(this.layers[parseInt(i.toString(),10)].id);var r={id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}};this.commandHandler.addLayer(r,null,!0),this.setActiveLayer(this.layers[this.layers.length-1].id)},e.prototype.clearObjects=function(t){var i=[];t?i=t:(i=i.concat(this.nodes),i=i.concat(this.connectors)),this.diagramActions=this.diagramActions|k.Clear;for(var r=0,a=i;r<a.length;r++){var s=a[r];this.nameTable[s.id]&&this.remove(s)}this.diagramActions=this.diagramActions&~k.Clear,this.spatialSearch=new Dl(this.nameTable),this.initHistory()},e.prototype.startEditCommad=function(){var t,i=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:void 0;if(i&&i instanceof M){if(i.isLane&&i.parentId)for(var r=this.nameTable[i.parentId],a=r.shape.lanes,s=i.id.slice(r.id.length),o=s.substring(0,s.length-1),h=0;h<a.length;h++)i.isLane&&o===a[parseInt(h.toString(),10)].id&&(t=this.nameTable[a[parseInt(h.toString(),10)].header.id]);else if(i.shape.type==="SwimLane"&&i.shape.header&&i.shape.hasHeader){var l=i.wrapper.children[0].rows[0].cells[0].children[0].id;t=this.nameTable[""+l]}}this.startTextEdit(t)},e.prototype.startTextEdit=function(t,i){if(!vr(this)&&!Un(this)||Yn(this)){this.textEditing=!0;var r=this.scroller.transform,a=Ud(this)?r.scale:1,s=90,o=void 0,h=void 0,l=void 0,d=void 0,f=void 0,p=void 0;if(t||(t=this.selectedItems.nodes[0]?this.selectedItems.nodes[0]:this.selectedItems.connectors[0]),t){t.shape&&t.shape.type==="UmlClassifier"&&!(t instanceof B)&&(t=this.nameTable[t.children[0]]);var c=!1;if(p)c=!0;else{if(t.shape.type!=="Text"&&t.annotations.length===0&&(t.constraints&W.ReadOnly||(this.activeLabel.isGroup=!0,this.startGroupAction(),this.addLabels(t,[{id:K(),content:""}]))),!i&&(t.shape.type!=="Text"&&t.annotations.length>0||t.shape.type==="Text"))if(t.shape.type==="Text")i=t.wrapper.children[0].id.split("_")[1];else for(var u=t.annotations.length-1;u>=0;u--)t.annotations[parseInt(u.toString(),10)].visibility&&(i=t.annotations[parseInt(u.toString(),10)].id);i&&(p=this.getWrapper(t.wrapper,i))}if(t&&p&&!(p instanceof we)&&(!qv(p,t)||c)){var g=p.style,v=void 0;v=p.bounds.width<t.wrapper.bounds.width?p.bounds.width:t.wrapper.bounds.width,v=s>v?s:v;var m=document.getElementById(this.element.id+"_editTextBoxDiv"),y=document.getElementById(this.element.id+"_editBox");if(o=y?y.value:p.content,this.activeLabel.text=o,!m&&!y&&(m=bt("div",{}),y=bt("textarea",{}),this.diagramCanvas.appendChild(m),m.appendChild(y),y.appendChild(document.createTextNode(o))),h=Af(p.style,o,void 0,void 0,v),h.isEmpty()&&(t.shape.type!=="Text"?h=new U(vl(t,p.id.split(t.id+"_")[1]).width||50,p.style.fontSize):h=new U(t.width>50?50:t.width,p.style.fontSize)),t.parentId&&this.nameTable[t.parentId].shape.type==="UmlClassifier"?(h.width=t.wrapper.bounds.width-20,d=(t.wrapper.bounds.center.x+r.tx)*r.scale-h.width/2*a-2.5,f=(t.wrapper.bounds.center.y+r.ty)*r.scale-h.height/2*a-3,p.style.textAlign="Left"):(h.width=Math.max(h.width,50),d=(p.bounds.center.x+r.tx)*r.scale-h.width/2*a-2.5,f=(p.bounds.center.y+r.ty)*r.scale-h.height/2*a-3),p.flippedPoint&&nh(p)){var S=p.flippedPoint.x-p.corners.topLeft.x,x=p.flippedPoint.y-p.corners.topLeft.y;d+=S,f+=x,p.flipTransformOffset={x:S,y:x}}l={id:this.element.id+"_editTextBoxDiv",style:"position: absolute;left:"+d+"px;top:"+f+"px;width:"+(h.width+1)*a+"px;height:"+h.height*a+"px; containerName:"+t.id+";"},bi(m,l),l={"aria-label":o,id:this.element.id+"_editBox",style:"width:"+(h.width+1)*a+"px;height:"+h.height*a+"px;resize: none;outline: none;overflow: hidden;;font-family:"+g.fontFamily+";font-size:"+g.fontSize*a+"px;text-align:"+p.style.textAlign.toLocaleLowerCase()+";",class:"e-diagram-text-edit"},bi(y,l),y.style.fontWeight=g.bold?"bold":"",y.style.fontStyle=g.italic?"italic":"",y.style.lineHeight=(g.fontSize*1.2+"px;").toString(),y.style.textDecoration=g.textDecoration?g.textDecoration:"",this.activeLabel.parentId=t.id,this.activeLabel.id=i,p.visible=!1,this.updateDiagramObject(t),this.diagramActions=this.diagramActions|k.TextEdit,this.isTriggerEvent||(J.add(y,"input",this.eventHandler.inputChange,this.eventHandler),J.add(y,"focusout",this.focusOutEdit,this),y.select())}}}},e.prototype.updateConnectorfixedUserHandles=function(t){if(t.fixedUserHandles.length)for(var i=void 0,r=0,a=t.fixedUserHandles;r<a.length;r++){var s=a[r];i=this.getWrapper(t.wrapper,s.id),t.updateAnnotation(s,t.intermediatePoints,t.wrapper.bounds,i)}t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize)},e.prototype.updateNodeExpand=function(t,i){for(var r=0;r<t.outEdges.length;r++){var a=this.nameTable[t.outEdges[parseInt(r.toString(),10)]],s=this.nameTable[a.targetID];a.visible=i,s&&(i||(this.updateElementVisibility(a.wrapper,a,!1),s.isExpanded=i),this.updateNodeExpand(s,s.isExpanded),s.visible=i,i||this.updateElementVisibility(s.wrapper,s,!1))}},e.prototype.updateConnectorAnnotation=function(t){if(t.annotations.length)for(var i=void 0,r=0,a=t.annotations;r<a.length;r++){var s=a[r];i=this.getWrapper(t.wrapper,s.id),t.updateAnnotation(s,t.intermediatePoints,t.wrapper.bounds,i,this.diagramActions&k.Interactions)}t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize)},e.prototype.removeChildrenFromLayout=function(t){for(var i=[],r,a="parentId",s="processId",o=0;o<t.length;o++)r=t[parseInt(o.toString(),10)],!r[""+a]&&!r[""+s]&&i.push(r);return i},e.prototype.doLayout=function(){var t=!1,i,r=this.layout.type==="ComplexHierarchicalTree"||this.layout.type==="HierarchicalTree",a=this.isProtectedOnChange;this.protectPropertyChange(!0);var s=this.removeChildrenFromLayout(this.nodes),o=this.layout.enableRouting&&this.layout.type==="ComplexHierarchicalTree",h={x:this.scroller.viewPortWidth,y:this.scroller.viewPortHeight},l=!1;if(this.layout.type!=="None"){if(this.organizationalChartModule||this.mindMapChartModule||this.radialTreeModule||this.symmetricalLayoutModule||this.complexHierarchicalTreeModule||this.flowchartLayoutModule){var d={state:"Started",type:this.layout.type};this.triggerEvent(Z.layoutUpdated,d)}if(this.organizationalChartModule)i=this.organizationalChartModule.updateLayout(s,this.nameTable,this.layout,h,this.dataSourceSettings.id,this.diagramActions),t=!0,this.canDistribute(o,r)&&this.lineDistributionModule.initLineDistribution(this.layout,this),this.layoutAnimateModule&&i.rootNode&&!this.diagramActions?this.updateNodeExpand(i.rootNode,i.rootNode.isExpanded):!this.layoutAnimateModule&&i.rootNode&&!i.rootNode.isExpanded&&!this.canExpand&&this.updateNodeExpand(i.rootNode,i.rootNode.isExpanded);else if(this.mindMapChartModule)s&&s.length>0&&this.mindMapChartModule.updateLayout(s,this.nameTable,this.layout,h,this.dataSourceSettings.id,this.dataSourceSettings.root),t=!0;else if(this.radialTreeModule)this.radialTreeModule.updateLayout(s,this.nameTable,this.layout,h),t=!0;else if(this.symmetricalLayoutModule)this.symmetricalLayoutModule.maxIteration=this.layout.maxIteration,this.symmetricalLayoutModule.springLength=this.layout.springLength,this.symmetricalLayoutModule.springFactor=this.layout.springFactor,this.symmetricalLayoutModule.updateLayout(s,this.connectors,this.symmetricalLayoutModule,this.nameTable,this.layout,h),t=!0;else if(this.complexHierarchicalTreeModule){if(this.canDistribute(o,r)){this.lineDistributionModule.diagram=this;var f="obstaclePointCollection";this.connectors.forEach(function(R){R[""+f]=[]})}var p=this.complexHierarchicalTreeModule.getLayoutNodesCollection(this.nodes);p.length>0&&this.complexHierarchicalTreeModule.doLayout(p,this.nameTable,this.layout,h,this),t=!0,this.canDistribute(o,r)&&this.lineDistributionModule.initLineDistribution(this.layout,this)}else if(this.flowchartLayoutModule)this.flowchartLayoutModule.updateLayout(this.nodes,this),t=!0;else{var c=this.layout.type==="OrganizationalChart"?"HierarchicalTree":this.layout.type;console.warn("[WARNING] :: Module "+c+" is not available in Diagram component! You either misspelled the module name or forgot to load it.")}if(t){this.preventDiagramUpdate=!0;for(var u={},g=s,v=0,m=g;v<m.length;v++){var y=m[v],S=y;if(!this.preventNodesUpdate&&(!this.diagramActions||!(this.diagramActions&k.PreventIconsUpdate))&&(this.updateIcon(S),this.updateDefaultLayoutIcons(S)),this.preventNodesUpdate=!0,this.nodePropertyChange(S,{},{offsetX:S.offsetX,offsetY:S.offsetY},!0),this.preventNodesUpdate=!1,S.wrapper.measure(new U(S.wrapper.width,S.wrapper.height)),S.wrapper.arrange(S.wrapper.desiredSize),this.updateDiagramObject(S,!0),S.inEdges.length>0)for(var x=0;x<S.inEdges.length;x++){var I=this.nameTable[S.inEdges[parseInt(x.toString(),10)]];u[I.id]=I}if(S.outEdges.length>0)for(var C=0;C<S.outEdges.length;C++){var P=this.nameTable[S.outEdges[parseInt(C.toString(),10)]];u[P.id]=P}}for(var A=0,T=Object.keys(u);A<T.length;A++){var z=T[A];this.layout.connectionPointOrigin!=="SamePoint"&&this.lineDistributionModule&&o&&this.lineDistributionModule.resetConnectorSegments(this.nameTable[""+z]);var I=u[""+z],L=this.getPoints(I);this.layout.connectionPointOrigin!=="SamePoint"&&this.lineDistributionModule&&o&&this.lineDistributionModule.resetRoutingSegments(I,this,L),Dn(I,L),I.shape.type==="Bpmn"&&I.shape.sequence==="Default"&&I.shape.flow==="Sequence"&&this.commandHandler.updatePathElementOffset(I),I.wrapper.measure(new U(void 0,void 0)),I.wrapper.arrange(I.wrapper.desiredSize),this.updateConnectorAnnotation(I),this.updateConnectorfixedUserHandles(I),this.updateQuad(I),this.updateDiagramObject(I,!0)}(o||this.layout.connectionPointOrigin==="DifferentPoint"&&this.lineDistributionModule&&r)&&(this.layout.enableRouting&&(this.refreshRoutingConnectors(),l=!0),this.layout.connectionPointOrigin!=="SamePoint"&&this.lineDistributionModule&&this.lineDistributionModule.distributeLines(this.layout,this)),this.refreshFlowChartConnectors(),this.preventDiagramUpdate=!1,this.updatePage(),(!(this.diagramActions&k.Render)||this.mode==="Canvas")&&(this.refreshDiagramLayer(),this.isRefreshed=!0)}a||this.protectPropertyChange(a)}if(t&&this.updateDiagramElementQuad(),this.diagramActions&k.Render&&this.layout.enableRouting&&!l&&this.refreshRoutingConnectors(),t){var d={state:"Completed",type:this.layout.type};this.triggerEvent(Z.layoutUpdated,d)}return this.blazorActions&jt.expandNode?i:!0},e.prototype.refreshRoutingConnectors=function(){var t=this.isProtectedOnChange;if(this.isProtectedOnChange=!0,this.routingConnectors)for(var i=0;i<this.routingConnectors.length;i++){var r=this.routingConnectors[parseInt(i.toString(),10)],a=this.nameTable[r.sourceID],s=this.nameTable[r.targetID],o=new lS;a.visible&&s.visible&&(o.renderVirtualRegion(this,!0),o.refreshConnectorSegments(this,r,!0,!0),this.routingConnectors.splice(i,1),i--)}this.isProtectedOnChange=t},e.prototype.refreshFlowChartConnectors=function(){if(this.flowchartLayoutModule){this.flowchartLayoutModule.reRouteFlowChartConnectors(this.layout.flowChartData,this);for(var t=0;t<this.connectors.length;t++){var i=this.connectors[parseInt(t.toString(),10)],r=this.getPoints(i);Dn(i,r),i.wrapper.measure(new U(void 0,void 0)),i.wrapper.arrange(i.wrapper.desiredSize),this.updateConnectorAnnotation(i),this.updateConnectorfixedUserHandles(i),this.updateQuad(i),this.updateDiagramObject(i,!0)}}},e.prototype.canDistribute=function(t,i){var r=this.layout.connectionPointOrigin!=="SamePoint"&&t||this.layout.connectionPointOrigin==="DifferentPoint"&&i||this.layout.arrangement==="Linear"&&this.layout.connectionPointOrigin!=="SamePoint";return this.lineDistributionModule&&r?!0:(r&&console.warn('[WARNING] :: Module "LineDistribution" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),!1)},e.prototype.saveDiagram=function(){for(var t=[],i,r,a,s,o="childTable",h=0;h<this.nodes.length;h++)if(i=this.nodes[parseInt(h.toString(),10)],i.shape.type==="SwimLane"){r=i.wrapper.children[0],a=r[""+o];for(var l=0,d=Object.keys(a);l<d.length;l++){var f=d[l];s=a[""+f],t=Ka(s,t)}for(var p=0;p<t.length;p++)this.nameTable[t[parseInt(p.toString(),10)]]&&(this.swimlaneChildTable[t[parseInt(p.toString(),10)]]=this.nameTable[t[parseInt(p.toString(),10)]].zIndex);this.swimlaneZIndexTable[i.id]=i.zIndex}return I0(this)},e.prototype.loadDiagram=function(t,i){if(i&&this.ej1SerializationModule){var r=JSON.parse(t);t=this.ej1SerializationModule.getSerializedData(r)}else i&&console.warn('[WARNING] :: Module "Ej1Serialization" is not available in Diagram component! You either misspelled the module name or forgot to load it.');return P0(t,this)},e.prototype.saveDiagramAsMermaid=function(){var t="";return this.layout&&this.layout.type==="Flowchart"?t=this.saveFlowDiagramInMermaidFormat():this.layout&&this.layout.type==="MindMap"?t=this.saveMindmapDiagramInMermaidFormat():t=this.saveSequenceDiagramAsMermaid(),t},e.prototype.saveMindmapDiagramInMermaidFormat=function(){var t="",i=[];if(this.layout&&this.layout.type==="MindMap"&&(i.push("mindmap"),this.nodes.length>0)){var r=this.nodes.filter(function(o){return o.inEdges.length===0})[0],a=this.convertMindmapToMermaid(r,0);i.push(a);var s=r.outEdges;this.updateTextDataSource(i,s,1),i=i.filter(function(o){return o.trim()!==""}),t=i.join(`
`)}return t},e.prototype.updateTextDataSource=function(t,i,r){for(var a=0;a<i.length;){var s=this.getObject(i[parseInt(a.toString(),10)]),o=this.getObject(s.targetID),h=this.convertMindmapToMermaid(o,r);t.push(h);var l=o.outEdges;l.length>0&&this.updateTextDataSource(t,l,r+1),a++}},e.prototype.convertMindmapToMermaid=function(t,i){var r=t.id,a=(i+1)*2,s=" ".repeat(a),o=t.annotations.length>0?t.annotations[0].content.replace(/\n/g," "):"",h=s+o,l=s+r;if(t.shape&&t.shape.type==="Basic"){var d=t.shape;d.shape==="Rectangle"?h=l+"["+o+"]":d.shape==="Ellipse"?h=l+"(("+o+"))":d.shape==="Hexagon"&&(h=l+"{{"+o+"}}")}else if(t.shape&&t.shape.type==="Flow"){var f=t.shape;f.shape==="Terminator"&&(h=l+"("+o+")")}else if(t.shape&&t.shape.type==="Path"){var p=t.shape;p.data===this.bangShape?h=l+"))"+o+"((":p.data===this.cloudShape&&(h=l+")"+o+"(")}return h},e.prototype.saveFlowDiagramInMermaidFormat=function(){var t=this,i=[],r=`graph TD
`,a={nodes:this.nodes,edges:this.connectors},s=a.nodes.reduce(function(o,h){return o[h.id]=h.annotations.length?h.annotations[0].content:"",o},{});return a.edges.forEach(function(o){var h=o.sourceID,l=o.targetID;s[""+h],s[""+l];var d=t.nameTable[""+h],f=t.nameTable[""+l],p=t.getNodeShape(d),c=t.getNodeShape(f),u=o.annotations[0]&&o.annotations[0].content!==""?"|"+o.annotations[0].content+"|":"";i.indexOf(h)===-1?i.push(h):p="",i.indexOf(l)===-1?i.push(l):c="";var g=t.arrowType(o);r+="    "+h+p+" "+g+u+" "+l+c+`
`}),a.nodes.forEach(function(o){var h=o.id,l=o.style.fill,d=o.style.strokeColor,f=o.style.strokeWidth+"px";r+="    style "+h+" fill:"+l+",stroke:"+d+",stroke-width:"+f+`;
`}),r},e.prototype.arrowType=function(t){var i=t.targetDecorator.shape,r=t.style.strokeDashArray,a=t.style.strokeWidth,s=t.style.opacity,o="";return s<1?o="~~~":r!==""?o="-.->":i==="Arrow"?o=a>1?"==>":"-->":i==="None"?o="---":o="-->",o},e.prototype.getNodeShape=function(t){var i=t.annotations.length>0?t.annotations[0].content:"",r=t.shape.shape;if(r)switch(r){case"Terminator":return"(["+i+"])";case"Process":return"["+i+"]";case"Decision":return"{"+i+"}";case"Parallelogram":return"[/"+i+"/]";case"Ellipse":return"(("+i+"))";case"PreDefinedProcess":return"[["+i+"]]";default:return"["+i+"]"}else{var a=t.shape.data;return a==="M 0 0 A 1 1 0 0 0 7 0 A 1 1 0 0 0 0 0 M -1 0 A 1 1 0 0 0 8 0 A 1 1 0 0 0 -1 0"?"((("+i+")))":a==="M 0 0 L 1 -1 L 5 -1 L 6 0 L 0 0"?"[/"+i+"\\]":a==="M 0 1 L 0 6 C 2 7 4 7 6 6 L 6 1 C 5 0 1 0 0 1 C 1 2 5 2 6 1"?"[("+i+")]":a==="M 0 0 L 12 0 L 14 2 L 2 2 L 0 0"?"[\\"+i+"\\]":a==="M 0 0 L 5 0 L 4 1 L 1 1 L 0 0"?"[\\"+i+"/]":a==="M 0 0 L 2 -2 L 11 -2 L 13 0 L 11 2 L 2 2 L 0 0"?"{{"+i+"}}":">"+i+"]"}},e.prototype.loadDiagramFromMermaid=function(t){this.layout&&this.layout.type==="Flowchart"&&this.flowchartLayoutModule?this.convertMermaidToFlowChart(t):this.layout&&this.layout.type==="MindMap"&&this.mindMapChartModule?this.convertMermaidToMindmap(t):this.isSequenceDiagram(t)?this.loadSequenceDiagramFromMermaid(t):console.warn('[WARNING] :: Module "FlowchartLayout" or "MindMap" is not available in Diagram component! You either misspelled the module name or forgot to load it.')},e.prototype.countLeadingSpaces=function(t){for(var i=0,r=t.length;i<r&&t.charAt(i)===" ";)i++;return i},e.prototype.convertMermaidToMindmap=function(t){if(t&&this.layout&&this.layout.type==="MindMap"&&this.mindMapChartModule){var i=t.split(/\r?\n/).filter(function(x){return x.trim().length>0});this.clear(),this.mermaidNodeBaseCollection=[];var r=[],a={text:"",children:[],currentLevel:0,branch:"Left"},s=[],o=1,h=!1,l=!1,d=!1;if(i.length>0){for(var f=function(x){var I=i[parseInt(x.toString(),10)],C=0,P="",A=p.countLeadingSpaces(I),T=I.includes('"`');if(l=I.includes('`"'),h=T?!0:h,d=!h&&!d?A===0&&x>0:d,h&&l&&!T)return a.text+=`
`+I,h=!1,"continue";if(!T&&h)return a.text+=`
`+I,"continue";if(h=l?!1:h,I.length>0&&(/\s/.test(I[0])&&x>0||A===0)){var z=s.findIndex(function(Y){return Y.space===A.toString()});if(z!==-1)for(var L=s.length-1;L>=0;L--){var R=s[parseInt(L.toString(),10)],O=parseFloat(R.space);if(O>A)s.splice(L,1);else if(O<A){s.push({space:A.toString(),level:R.level+1}),C=R.level+1;break}else if(O===A){C=R.level;break}}else if(s.length===0)s.push({space:A.toString(),level:o}),C=o;else{for(var L=s.length-1;L>=0;L--){var N=s[parseInt(L.toString(),10)],O=parseFloat(N.space);if(O>A)s.splice(L,1);else{var H=s[s.length-1];s.push({space:A.toString(),level:H.level+1});break}}C=s[s.length-1].level}P=I.trim().replace(/^[+-]/,"")}var F={text:P,branch:void 0,children:[],currentLevel:x===0?0:C-1};if(r.length>0){for(;r.length>=C&&r.length!==0;)r.pop();r.length>0&&r[r.length-1].children.push(F)}r.push(F),a=F},p=this,c=0;c<i.length;c++)f(c);var u=r[0];if(u.text==="mindmap"||d){if(d){var g=this.getNodeDetails(u),v={id:g.nodeId,shape:g.nodeShapeData,annotations:[{content:g.annotationContent}]};this.mermaidNodeBaseCollection.push(v),this.createDataSource(u.children,u,v.id)}else{var m=u.children[0],y=this.getNodeDetails(m),S={id:y.nodeId,shape:y.nodeShapeData,annotations:[{content:y.annotationContent}]};this.mermaidNodeBaseCollection.push(S),this.createDataSource(m.children,m,S.id)}this.addElements(this.mermaidNodeBaseCollection),this.doLayout()}}}},e.prototype.saveSequenceDiagramAsMermaid=function(){var t=this.model;return t.isLoadedFromMermaid?t.mermaidData:t.generateMermaidFromModel()},e.prototype.isSequenceDiagram=function(t){var i=t.split(/\r?\n/).filter(function(r){return r.trim().length>0});return i.length>0&&i[0].trim()==="sequenceDiagram"},e.prototype.loadSequenceDiagramFromMermaid=function(t){this.model={},this.model.parse(t,this),this.initLayerObjects();var i=this.isProtectedOnChange;this.protectPropertyChange(!0),this.model.loadDiagramFromMermaid(t,this),this.refreshDiagramLayer(),i||this.protectPropertyChange(i),this.fitToPage({mode:"Page",region:"Content",margin:{left:10,top:10,right:10,bottom:10},canZoomIn:!0,canZoomOut:!0})},e.prototype.createDataSource=function(t,i,r){for(var a=0;a<t.length;){var s=t[parseInt(a.toString(),10)],o=this.getNodeDetails(s),h={id:o.nodeId,shape:o.nodeShapeData,annotations:[{content:o.annotationContent}]},l={sourceID:r,targetID:h.id};this.mermaidNodeBaseCollection.push(h),this.mermaidNodeBaseCollection.push(l),this.createDataSource(s.children,s,h.id),a++}},e.prototype.getNodeDetails=function(t){var i=/^(.*?)\s*([\\[\\(\\{][\s\S]*?[\]\\)\\}]|[)\\(][\s\S]*|[)\\{][\s\S]*|[)\\(][^{}()\\[\]]*$)/,r=t.text,a=r.match(i),s=K(),o=t.text,h={type:"Basic",shape:"Rectangle"};if(a){s=a[1]?a[1]:s;var l=a[2].trim().replace(/["`]/g,""),d=l.charAt(0);d==="["?o=l.slice(1,-1):d==="("?(l.startsWith("((")?o=l.slice(2,-1):o=l.slice(1,-1),h=l.startsWith("((")?{type:"Basic",shape:"Ellipse"}:{type:"Flow",shape:"Terminator"}):d===")"?(l.startsWith("))")?o=l.slice(2,-2):o=l.slice(1,-1),h=l.startsWith("))")?{type:"Path",data:this.bangShape}:{type:"Path",data:this.cloudShape}):d==="{"&&(o=l.slice(2,-1),h={type:"Basic",shape:"Hexagon"})}return{nodeId:s,annotationContent:o,nodeShapeData:h}},e.prototype.convertMermaidToFlowChart=function(t){var i=[];this.clear(),t=t.replace(/;(?!\s*[\n\r])/g,`;
`);for(var r=t.trim().split(`
`),a=function(h){var l=r[parseInt(h.toString(),10)];l=l.trim(),l.endsWith(";")&&!l.startsWith("style")&&(l=l.slice(0,-1).trim());var d=["%","subgraph","graph","flowchart","end","End"];if(l!==""&&!d.some(function(g){return l.startsWith(g)}))if(l.startsWith("style"))s.parseStyle(l,i);else{var f=s.getLineSplitting(l),p=[f[0],f[1]],c=s.getNodeData(p,i,f[2]);if(c&&c.length>0){var u=c[c.length-1];u.arrowType=f[2],f[3]!==""&&(u.label&&u.label.some(function(g){return g.trim().length>0})?u.label.push(f[3]):(u.label=[],u.label[u.parentId.length-1]=f[3])),c.filter(function(g){return g.parentId&&g.parentId.length===0}).forEach(function(g){g.parentId=null}),i=i.concat(c)}}},s=this,o=1;o<r.length;o++)a(o);this.createFlowChart(i),this.doLayout(),this.clearHistory()},e.prototype.createFlowChart=function(t){for(var i=[],r=0;r<t.length;r++){var a=t[parseInt(r.toString(),10)],s={id:a.id,shape:a.shape,annotations:[{content:a.name}],style:{fill:a.color,strokeColor:a.stroke,strokeWidth:a.strokeWidth}};i.push(s)}for(var o=0;o<t.length;o++){var a=t[parseInt(o.toString(),10)],h=F0(a);if(a.parentId&&a.parentId.length>1)for(var l=0;l<a.parentId.length;l++){var d={id:K(),sourceID:a.parentId[parseInt(l.toString(),10)],targetID:a.id,annotations:[{content:a.label?a.label[parseInt(l.toString(),10)]:""}],style:{strokeWidth:h.strokeWidth?h.strokeWidth:1,strokeDashArray:h.strokeDashArray?h.strokeDashArray:"",opacity:h.opacity!==void 0?h.opacity:1},targetDecorator:{shape:h.targetDecorator}};i.push(d)}else if(a.parentId&&a.parentId.length===1){var d={id:K(),sourceID:a.parentId[0],targetID:a.id,annotations:[{content:a.label?a.label[0]:""}],style:{strokeWidth:h.strokeWidth?h.strokeWidth:1,strokeDashArray:h.strokeDashArray?h.strokeDashArray:"",opacity:h.opacity!==void 0?h.opacity:1},targetDecorator:{shape:h.targetDecorator}};i.push(d)}}this.addElements(i)},e.prototype.getLineSplitting=function(t){var i,r,a,s="",o=/^(.*?)\s*(-->|---|--\s*.*?\s*-->|~~~|==>|===|==\s*.*?\s*==>|\s*-\.\s*->|\s*-\.\s*-|\s*-\.\s*.*?\s*\.\s*->|\s*-\..*?\.\s*->)(.*)$/,h=t.match(o);if(h){i=h[1].trim();var l=h[2].trim();r=h[3].trim();var d=/(-\.|\\-\\-|==|--|~~)(.*?)(\1>|\.->|==>|\\->|~~>)/,f=l.match(d),p=void 0,c="";if(f){var u=f[2].trim()||null,g=f[1]+f[3];p={text:u,arrowType:g}}else p={text:null,arrowType:l};s=p.text!==null?p.text:"",c=p.arrowType,c.includes("-->")?a="single-line-arrow":c.includes("---")?a="single-line":c.includes("==>")?a="double-line-arrow":c.includes("==")?a="double-line":c.includes("~~~")?a="wiggly-arrow":c.includes("-.->")||c.includes(".->")?a="dotted-arrow":c.includes("-.-")||c.includes(".-")?a="dotted":a="single-line-arrow"}else i=t.trim(),r=null;return[i,r,a,s]},e.prototype.parseStyle=function(t,i){var r=/^style\s+(\w+)\s+fill:([^,]+),stroke:([^,]+),stroke-width:(\d+)px;/;if(t.startsWith("style")){var a=t.match(r);if(a){var s=a[1],o=a[2],h=a[3],l=parseInt(a[4],10),d={id:s,fill:o,stroke:h,strokeWidth:l},f=i.filter(function(p){return p.id===d.id});f[0].color=d.fill,f[0].stroke=d.stroke,f[0].strokeWidth=d.strokeWidth}}},e.prototype.getNodeData=function(t,i,r){for(var a=[],s=null,o=null,h=0,l="",d=function(v){var m=t[parseInt(v.toString(),10)];if(m){var y=f.splitNested(m);if(y&&y[0].includes("|")){var S=y[0].match(/\|([^|]*)\|/);S&&(l=S[1]);var x=y[0].split("|");x.length>=3&&(y[0]=x[2].trim())}var I=y[0].trim().replace(/;$/,"");v===0?s=I:o=I;var C=i.find(function(L){return L.id===I});if(C)h++;else{var P=y.length>1?y[1]:y[0],A=f.getShape(P),T=P.replace(/[\\[\]\\(\\)\\{\\}\\{\\}\\/>]/g,""),z={id:I,name:T,shape:A,color:"white",parentId:[]};a.push(z)}}},f=this,p=0;p<t.length;p++)d(p);if(a.length){var c=a[a.length-1];if(c.id!==s)c.parentId.push(s),c.label?c.label.push(l):c.label=[l];else{var u=i.find(function(v){return v.id===o});u&&(u.parentId?u.parentId.push(s):u.parentId=[s],u.label?u.label.push(l):u.label=[l])}}else if(h===2){var g=i.filter(function(v){return v.id===o})[0];g.parentId=g.parentId||[],g.parentId.push(s),g.label=g.label||[],g.label[g.parentId.length-1]=l}if(r){var g=i.filter(function(m){return m.id===o})[0];g&&(g.arrowType=r)}return a},e.prototype.splitNested=function(t){for(var i=[],r="",a=0,s="",o=0,h=t;o<h.length;o++){var l=h[o];l==="["||l==="{"||l==="("||l===">"?a===0?(r.trim().length>0&&i.push(r.trim()),r=l,s=l,a++):(r+=l,a++):l==="]"||l==="}"||l===")"?a===1&&l===s?(r+=l,i.push(r.trim()),r="",a--):a>1?(r+=l,a--):r+=l:r+=l}return r.trim().length>0&&i.push(r.trim()),i},e.prototype.getShape=function(t){var i={};return t.startsWith("(((")?i={type:"Path",data:"M 0 0 A 1 1 0 0 0 7 0 A 1 1 0 0 0 0 0 M -1 0 A 1 1 0 0 0 8 0 A 1 1 0 0 0 -1 0"}:t.startsWith("((")?i={shape:"Ellipse",type:"Basic"}:t.startsWith("([")?i={type:"Flow",shape:"Terminator"}:t.startsWith("(")?i={type:"Flow",shape:"Process"}:t.startsWith("[[")?i={type:"Flow",shape:"PreDefinedProcess"}:t.startsWith("[/")?t.endsWith("/]")?i={type:"Basic",shape:"Parallelogram"}:i={type:"Path",data:"M 0 0 L 1 -1 L 5 -1 L 6 0 L 0 0"}:t.startsWith("[(")?i={type:"Path",data:"M 0 1 L 0 6 C 2 7 4 7 6 6 L 6 1 C 5 0 1 0 0 1 C 1 2 5 2 6 1"}:t.startsWith("[\\")?t.endsWith("\\]")?i={type:"Path",data:"M 0 0 L 12 0 L 14 2 L 2 2 L 0 0"}:i={type:"Path",data:"M 0 0 L 5 0 L 4 1 L 1 1 L 0 0"}:t.startsWith("[")?i={type:"Basic",shape:"Rectangle"}:t.startsWith("{{")?i={type:"Path",data:"M 0 0 L 2 -2 L 11 -2 L 13 0 L 11 2 L 2 2 L 0 0"}:t.startsWith("{")?i={type:"Flow",shape:"Decision"}:t.startsWith(">")&&(i={type:"Path",data:"M 0 0 L 8 0 L 8 2 L 0 2 L 2 1 L 0 0"}),i},e.prototype.getDiagramContent=function(t){if(this.printandExportModule){var i=this.printandExportModule.getDiagramContent(t);return i}else return console.warn('[WARNING] :: Module "PrintAndExport" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),""},e.prototype.exportImage=function(t,i){this.printandExportModule?this.printandExportModule.exportImages(t,i):console.warn('[WARNING] :: Module "PrintAndExport" is not available in Diagram component! You either misspelled the module name or forgot to load it.')},e.prototype.printImage=function(t,i){this.printandExportModule?(i.printOptions=!0,this.printandExportModule.exportImages(t,i)):console.warn('[WARNING] :: Module "PrintAndExport" is not available in Diagram component! You either misspelled the module name or forgot to load it.')},e.prototype.setStackLimit=function(t){this.undoRedoModule&&t&&(this.historyManager.stackLimit=t,this.undoRedoModule.applyLimit(this.historyManager.currentEntry,t,this,!0))},e.prototype.clearHistory=function(){this.undoRedoModule&&this.undoRedoModule.clearHistory(this)},e.prototype.getDiagramBounds=function(){if(this.printandExportModule){var t=this.printandExportModule.getDiagramBounds("",{});return t.width=t.width>this.scrollSettings.viewPortWidth?t.width+(t.x>0?t.x:0):this.scrollSettings.viewPortWidth,t.height=t.height>this.scrollSettings.viewPortHeight?t.height+(t.y>0?t.y:0):this.scrollSettings.viewPortHeight,t.x=t.x>0?0:t.x,t.y=t.y>0?0:t.y,t}else return console.warn('[WARNING] :: Module "PrintAndExport" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),new it},e.prototype.exportDiagram=function(t){if(this.printandExportModule){var i=this.printandExportModule.exportDiagram(t);return i}else return console.warn('[WARNING] :: Module "PrintAndExport" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),""},e.prototype.print=function(t){this.printandExportModule?this.printandExportModule.print(t):console.warn('[WARNING] :: Module "PrintAndExport" is not available in Diagram component! You either misspelled the module name or forgot to load it.')},e.prototype.addPorts=function(t,i){this.protectPropertyChange(!0);var r=!1;if(t=this.nameTable[t.id]||t,!(t instanceof M)&&!(t instanceof B)){this.protectPropertyChange(!1);return}var a;i.length>1&&this.startGroupAction();for(var s=function(l){if(r=t.ports.some(function(m){return m.id===i[parseInt(l.toString(),10)].id}),r)return"continue";if(t instanceof M?(a=new Se(t,"ports",i[parseInt(l.toString(),10)],!0),t.ports.push(a)):t instanceof B&&(a=new ke(t,"ports",i[parseInt(l.toString(),10)],!0),t.ports.push(a)),t.children)for(var d=t.wrapper,f=0;f<d.children.length;f++){var p=d.children[parseInt(f.toString(),10)];if(p.id.match(d.id)){t.initPort(o.getDescription,p,a);break}}else{var c=t.wrapper;if(t instanceof M)c.children.push(t.initPortWrapper(t.ports[t.ports.length-1]));else if(t instanceof B){var u=t.type==="Bezier"?t.intermediatePoints:t.getConnectorPoints(t.type);u=t.clipDecorators(t,u);var g=it.toBounds(u);c.children.push(t.initPort(t.ports[t.ports.length-1],u,g,void 0))}}if(!(o.diagramActions&k.UndoRedo)&&!(o.diagramActions&k.Group)){var v={type:"PortCollectionChanged",changeType:"Insert",undoObject:E(a),redoObject:E(t),category:"Internal"};o.addHistoryEntry(v)}},o=this,h=0;h<i.length;h++)s(h);i.length>1&&this.endGroupAction(),t.wrapper.measure(new U(t.width,t.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateDiagramObject(t),this.protectPropertyChange(!1)},e.prototype.addConstraints=function(t,i){return t|i},e.prototype.removeConstraints=function(t,i){return t&~i},e.prototype.addNodeLabels=function(t,i){this.addLabels(t,i)},e.prototype.addConnectorLabels=function(t,i){this.addLabels(t,i)},e.prototype.addLabels=function(t,i){this.protectPropertyChange(!0),t=this.nameTable[t.id]||t;var r=t.wrapper,a;i.length>1&&this.startGroupAction();for(var s=0;s<i.length;s++){if(t instanceof M)if(a=new ae(t,"annotations",i[parseInt(s.toString(),10)],!0),t.annotations.push(a),t.children){for(var o=t,h=0;h<o.wrapper.children.length;h++)if(o.wrapper.children[parseInt(h.toString(),10)].id===o.id+"group_container"){var l=o.wrapper.children[parseInt(h.toString(),10)];l.children.push(t.initAnnotationWrapper(t.annotations[t.annotations.length-1],this.element.id))}}else r.children.push(t.initAnnotationWrapper(t.annotations[t.annotations.length-1],this.element.id));else if(t instanceof B){a=new Qt(t,"annotations",i[parseInt(s.toString(),10)],!0),t.annotations.push(a);var d=r.children[0],f=new it(d.offsetX-d.width/2,d.offsetY-d.height/2,d.width,d.height);r.children.push(t.getAnnotationElement(t.annotations[t.annotations.length-1],t.intermediatePoints,f,this.getDescription,this.element.id))}if(!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.Group)){var p={type:"LabelCollectionChanged",changeType:"Insert",undoObject:E(a),redoObject:E(t),category:"Internal"};this.addHistoryEntry(p)}}i.length>1&&this.endGroupAction(),t.wrapper.measure(new U(r.width,r.height)),t.wrapper.arrange(r.desiredSize),this.updateDiagramObject(t),this.protectPropertyChange(!1),this.refreshCanvasLayers()},e.prototype.addChildToUmlNode=function(t,i,r){var a,s,o,h,l="NoWrap";t.shape.classifier==="Class"||t.shape.classifier==="Interface"?r==="Method"?(s=new Kn(t,"",i),t.shape.classifier==="Class"?(t.shape.classShape.methods.push(s),a=t.shape.classShape):t.shape.classifier==="Interface"&&(t.shape.interfaceShape.methods.push(s),a=t.shape.interfaceShape),j0(t,this,a,l)):r==="Attribute"&&(o=new fn(t,"",i),t.shape.classifier==="Class"?(t.shape.classShape.attributes.push(o),a=t.shape.classShape):t.shape.classifier==="Interface"&&(t.shape.interfaceShape.attributes.push(o),a=t.shape.interfaceShape),_0(t,this,a,l)):t.shape.classifier==="Enumeration"&&r==="Member"&&(h=new ms(t,"",i),t.shape.enumerationShape.members.push(h),a=t.shape.enumerationShape,J0(t,this,a,l)),this.clearSelection(),this.updateSelector()},e.prototype.addLanes=function(t,i,r){t=this.nameTable[t.id]||t;for(var a=0;a<i.length;a++)am(this,t,i[parseInt(a.toString(),10)],r),r!==void 0&&(r+=1);this.updateDiagramElementQuad()},e.prototype.addPhases=function(t,i){t=this.nameTable[t.id]||t;for(var r=0;r<i.length;r++)this.protectPropertyChange(!0),om(this,t,i[parseInt(r.toString(),10)]),this.protectPropertyChange(!1);this.updateDiagramElementQuad()},e.prototype.removeLane=function(t,i){if(i){var r=this.nameTable[i.header.id];this.diagramActions=this.diagramActions|k.PublicMethod,il(this,r,t),this.updateDiagramElementQuad()}},e.prototype.removePhase=function(t,i){var r=i.header.id,a=this.nameTable[""+r];nl(this,a,t),this.updateDiagramElementQuad()},e.prototype.editSegment=function(t){if(t.connector.type==="Straight"){for(var i=t.connector,r=t&&t.SegmentEditing?t.SegmentEditing:"Toggle",a=t.point,s=void 0,o=void 0,h=0;h<i.segments.length;h++){var l=i.segments[parseInt(h.toString(),10)];if($t(a,l.point,i.hitPadding)){s=!0;break}}(s&&r==="Remove"||!s&&r==="Add")&&(o=!0),i.type==="Straight"&&(o||r==="Toggle")&&this.connectorEditingToolModule.addOrRemoveSegment(i,a,this.commandHandler)}},e.prototype.removelabelExtension=function(t,i,r,a){for(var s=0;s<a.children.length;s++){var o=a.children[parseInt(s.toString(),10)];if((o instanceof Tt||o instanceof we)&&o.id.match("_"+i[parseInt(r.toString(),10)].id+"$")){for(var h=0;h<t.annotations.length;h++)if(o.id.match("_"+t.annotations[parseInt(h.toString(),10)].id+"$")){if(!(this.diagramActions&k.UndoRedo)){var l={type:"LabelCollectionChanged",changeType:"Remove",undoObject:E(t.annotations[parseInt(h.toString(),10)]),redoObject:E(t),category:"Internal"};this.addHistoryEntry(l)}t.annotations.splice(h,1)}if(a.children.splice(s,1),this.mode==="SVG"){var d=St(o.id,this.element.id);if(d){var f=St(o.id,this.element.id);f.parentNode.removeChild(f)}var p=St(o.id+"_text",this.element.id);p&&(d=St(o.id+"_text",this.element.id),d.parentNode.removeChild(d));var c=St(o.id+"_html_element",this.element.id);c&&c.parentNode.removeChild(c)}else this.refreshCanvasLayers()}}},e.prototype.removeLabels=function(t,i){t=this.nameTable[t.id]||t,i.length>1&&this.startGroupAction();for(var r=i.length-1;r>=0;r--)if(t.children&&t.children.length>0){var a=t.wrapper.children.filter(function(s){return s.id===t.id+"group_container"});a&&a.length>0&&this.removelabelExtension(t,i,r,a[0])}else this.removelabelExtension(t,i,r,t.wrapper);i.length>1&&this.endGroupAction(),this.refreshCanvasLayers()},e.prototype.removePortsExtenion=function(t,i,r,a){for(var s=0;s<a.children.length;s++){var o=a.children[parseInt(s.toString(),10)];if(o instanceof Pt&&o.id.match("_"+i[parseInt(r.toString(),10)].id+"$")){for(var h=0;h<t.ports.length;h++)if(o.id.match("_"+t.ports[parseInt(h.toString(),10)].id+"$")){if(!(this.diagramActions&k.UndoRedo)){var l={type:"PortCollectionChanged",changeType:"Remove",undoObject:E(t.ports[parseInt(h.toString(),10)]),redoObject:E(t),category:"Internal"};this.addHistoryEntry(l)}t.ports.splice(h,1)}if(a.children.splice(s,1),this.mode==="SVG"){var d=St(o.id,this.element.id);d&&d.parentNode.removeChild(d)}else this.refreshCanvasLayers()}}},e.prototype.removePorts=function(t,i){t=this.nameTable[t.id]||t;var r=i.length;r>1&&this.startGroupAction();for(var a=i.length-1;a>=0;a--)if(t.children&&t.children.length>0)for(var s=0;s<t.wrapper.children.length;s++){var o=t.wrapper.children[parseInt(s.toString(),10)];o.id.match(t.wrapper.id)&&this.removePortsExtenion(t,i,a,t.wrapper.children[parseInt(s.toString(),10)])}else this.removePortsExtenion(t,i,a,t.wrapper);r>1&&this.endGroupAction()},e.prototype.getSizeValue=function(t,i){var r;return t.toString().indexOf("px")>0?r=t.toString():t.toString().indexOf("%")>0?r=i!==void 0?"100%":t.toString():r=t.toString()+"px",i&&(Mi(this),r="calc("+r+" - "+i+"px)"),r},e.prototype.renderRulers=function(){this.rulerSettings.showRulers?($m(this),ll(this,!0),ll(this,!1)):vo(this)},e.prototype.intOffPageBackground=function(){var t=new U;t=Mi(this);var i=document.getElementById(this.element.id+"content");this.width||(this.width="100%"),this.height||(this.height="100%");var r=this.getSizeValue(this.width,t.width),a=this.getSizeValue(this.height,t.height),s=this.rulerSettings.showRulers?"width:"+r+"; height:"+a+";top:"+t.height+"px;left:"+t.width+"px;overflow: scroll;position:absolute;overflow:auto;":"width:"+r+"; height:"+a+";position:absolute; left:0px;  top:0px;overflow: auto;",o={id:this.element.id+"content",tabindex:"0",style:s};i?(this.diagramCanvas=i,Ui(this.diagramCanvas,s)):(this.diagramCanvas=bt("div",o),this.element.appendChild(this.diagramCanvas)),this.diagramCanvas.style.background=this.backgroundColor},e.prototype.initDiagram=function(){this.intOffPageBackground(),bi(this.element,{style:"width:"+this.getSizeValue(this.width)+"; height:"+this.getSizeValue(this.height)+";position:relative;overflow:hidden;"})},e.prototype.renderHiddenUserHandleTemplateLayer=function(t){var i={class:this.element.id+"_hiddenUserHandleTemplate",style:"width:"+t.width+"px; height:"+t.height+"px;visibility:hidden ;  overflow: hidden;"},r=bt("div",i);this.element.appendChild(r)},e.prototype.renderBackgroundLayer=function(t,i){var r=this.createSvg(this.element.id+"_backgroundLayer_svg",t.width,t.height);Ui(r,i);var a=Nt("g",{id:this.element.id+"_backgroundImageLayer",class:"e-background-image-layer"});r.appendChild(a);var s={id:this.element.id+"_backgroundLayer",class:"e-background-layer"},o=Nt("g",s);r.appendChild(o),this.diagramCanvas.appendChild(r)},e.prototype.renderGridLayer=function(t,i){var r=this.createSvg(this.element.id+"_gridline_svg",t.width,t.height);r.setAttribute("class","e-grid-layer");var a=Nt("g",{id:this.element.id+"_gridline"}),s=Nt("rect",{id:this.element.id+"_grid_rect",x:"0",y:"0",width:"100%",height:"100%"});if(mo()){var o=new URL(window.location.href);o.search!==""?s.setAttribute("fill","url(#"+this.element.id+"_pattern)"):s.setAttribute("fill","url("+location.protocol+"//"+location.host+location.pathname+"#"+this.element.id+"_pattern)")}else s.setAttribute("fill","url(#"+this.element.id+"_pattern)");a.appendChild(s),r.appendChild(a),this.diagramCanvas.appendChild(r),Et(r,{style:i})},e.prototype.renderDiagramLayer=function(t,i){var r={id:this.element.id+"_diagramLayer_div",style:"width:"+t.width+"px; height:"+t.height+"px;"+i};if(this.diagramLayerDiv=bt("div",r),this.mode==="SVG"){var a=this.createSvg(this.element.id+"_diagramLayer_svg",t.width,t.height);a.style["pointer-events"]="none",a.setAttribute("class","e-diagram-layer");var s=Nt("g",{id:this.element.id+"_diagramLayer"}),o=Nt("g",{});this.diagramLayer=s,a.style["pointer-events"]="all",o.appendChild(s),a.appendChild(o),this.diagramLayerDiv.appendChild(a)}else this.diagramLayer=nr.createCanvas(this.element.id+"_diagram",t.width,t.height),Ui(this.diagramLayer,"position:absolute;left:0px;top:0px;"),this.diagramLayerDiv.appendChild(this.diagramLayer);this.diagramCanvas.appendChild(this.diagramLayerDiv)},e.prototype.initLayers=function(){var t="position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",i=document.getElementById(this.element.id),r=i.getBoundingClientRect();this.setScaleFromElement(r,i),this.modifyBounds(r);var a=Hy();this.scroller.scrollerWidth=a,this.scroller.setViewPortSize(r.width,r.height),this.renderRulers();var s="measureElement";if(window[""+s]){window[""+s]=null;var o=document.getElementById("measureElement");o.remove()}Mf(),this.renderBackgroundLayer(r,t),this.renderGridLayer(r,t),this.renderDiagramLayer(r,t),this.renderHTMLLayer(r,t),this.renderPortsExpandLayer(r,t),this.renderNativeLayer(r,t),this.renderAdornerLayer(r,t),this.renderHiddenUserHandleTemplateLayer(r)},e.prototype.setScaleFromElement=function(t,i){var r=t.width/i.clientWidth;this.scaleValue=r},e.prototype.modifyBounds=function(t){var i=this.scaleValue;t.x=t.x/i,t.y=t.y/i,t.width=t.width/i,t.height=t.height/i},e.prototype.modifyClientOffset=function(t,i){var r=this.scaleValue,a=0;return i?a=t*r:a=t/r,a},e.prototype.renderAdornerLayer=function(t,i){var r=bt("div",{id:this.element.id+"_diagramAdornerLayer",style:"width:"+t.width+"px;height:"+t.height+"px;"+i}),a=bt("div",{id:this.element.id+"_diagramUserHandleLayer",style:"width:"+t.width+"px;height:"+t.height+"px;"+i});a.setAttribute("class","e-userHandle-layer"),r.appendChild(a);var s=this.createSvg(this.element.id+"_diagramAdorner_svg",t.width,t.height);s.setAttribute("class","e-adorner-layer"),s.style["pointer-events"]="none",this.adornerLayer=Nt("g",{id:this.element.id+"_diagramAdorner"}),this.adornerLayer.style[" pointer-events"]="all",s.appendChild(this.adornerLayer),r.appendChild(s),this.diagramCanvas.appendChild(r);var o=Nt("g",{id:this.element.id+"_SelectorElement"});this.adornerLayer.appendChild(o),Et(s,{style:"pointer-events:none;"})},e.prototype.renderPortsExpandLayer=function(t,i){var r=this.createSvg(this.element.id+"_diagramPorts_svg",t.width,t.height);r.setAttribute("class","e-ports-expand-layer");var a=Nt("g",{id:this.element.id+"_diagramPorts",class:"e-ports-layer",style:"pointer-events: all;"});r.appendChild(a);var s=Nt("g",{id:this.element.id+"_diagramExpander",class:"e-expand-layer",style:"pointer-events: all;"});r.appendChild(s),this.diagramCanvas.appendChild(r),Et(r,{style:i})},e.prototype.renderHTMLLayer=function(t,i){this.htmlLayer=bt("div",{id:this.element.id+"_htmlLayer",style:"width:"+t.width+"px; height:"+t.height+"px;position:absolute;top:0px;left:0px;overflow:hidden;pointer-events:none;",class:"e-html-layer"});var r=bt("div",{id:this.element.id+"_htmlLayer_div",style:"position:absolute;top:0px;left:0px;pointer-events:all;"});this.htmlLayer.appendChild(r),this.diagramCanvas.appendChild(this.htmlLayer)},e.prototype.renderNativeLayer=function(t,i){var r=this.createSvg(this.element.id+"_nativeLayer_svg",t.width,t.height),a=Nt("g",{id:this.element.id+"_nativeLayer",style:"pointer-events:all;"});r.appendChild(a),this.diagramLayerDiv.appendChild(r),Et(r,{class:"e-native-layer",style:i})},e.prototype.createSvg=function(t,i,r){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");return Et(a,{id:t,width:i,height:r}),a},e.prototype.updateBazorShape=function(){for(var t=0;t<this.nodes.length;t++){var i=this.nodes[parseInt(t.toString(),10)];switch(i.shape.type){case"Bpmn":i.shape.bpmnShape=i.shape.shape;break;case"UmlActivity":i.shape.umlActivityShape=i.shape.shape;break;case"Flow":i.shape.flowShape=i.shape.shape;break;case"Basic":i.shape.basicShape=i.shape.shape;break;case"Text":i.shape.textContent=i.shape.content;break}}},e.prototype.initObjects=function(t){this.updateBazorShape(),this.isLoading||this.initData(),this.initLayerObjects(),this.updateBridging(t)},e.prototype.initLayerObjects=function(){for(var t=this.layers.length>1,i=[],r={},a={},s={},o=[],h=0,l=this.nodes;h<l.length;h++){var d=l[h];d.id=d.id||K(),this.addToLayer(d,t),r[d.id]=d}for(var f=0,p=this.connectors;f<p.length;f++){var d=p[f];d.id=d.id||K(),this.addToLayer(d,t),r[d.id]=d}this.tempTable=r;for(var c=0,u=this.layers;c<u.length;c++){for(var g=u[c],v=0,m=g.objects;v<m.length;v++){var d=m[v];if(r[""+d])if(!(r[""+d]instanceof B))r[""+d].children?o.push(d):r[""+d].shape instanceof fh&&r[""+d].shape.activity.subProcess.processes&&r[""+d].shape.activity.subProcess.processes.length>0?a[r[""+d].id]=d:r[""+d].shape instanceof Sr&&r[""+d].shape.children&&r[""+d].shape.children.length>0?s[r[""+d].id]=d:this.initNodes(r[""+d],g);else{var y=r[""+d];if(y.sourceID&&y.targetID){var S=r[y.sourceID],x=r[y.targetID],I=!0;this.isLoading&&(S&&S.children&&S.children.length>0||x&&x.children&&x.children.length>0)&&(I=!1),S&&S.wrapper&&x&&x.wrapper&&I?this.initConnectors(r[""+d],g):i.push(r[""+d])}else{var S=r[y.sourceID],x=r[y.targetID];S&&S.children&&S.children.length>0||x&&x.children&&x.children.length>0?i.push(r[""+d]):this.initConnectors(r[""+d],g)}}}if(this.pathDataStorage&&this.pathDataStorage.clear(),this.bpmnModule)for(var C=0,P=this.bpmnModule.bpmnTextAnnotationConnector;C<P.length;C++){var d=P[C];this.initConnectors(d,void 0,!0)}}for(var A=0,T=Object.keys(a);A<T.length;A++){var d=T[A];this.initObject(r[""+d]),this.bpmnModule.updateDocks(r[""+d],this)}var z=[];Object.keys(s).length>0&&(z=this.sortContainersTopologically(s,r));for(var L=0,R=z;L<R.length;L++){var d=R[L];this.initObject(r[""+d]),as(r[""+d],this)}for(var O=this.alignGroup(o,r),N=0,H=O;N<H.length;N++){var d=H[N],g=this.commandHandler.getObjectLayer(d);this.initNodes(r[""+d],g)}for(var F=0,Y=i;F<Y.length;F++){var y=Y[F],g=this.commandHandler.getObjectLayer(y.id);this.initConnectors(y,g)}for(var et=0,at=this.connectorOrRotatedGroups;et<at.length;et++){var d=at[et];if(d.children&&d.flip!==G.None&&!this.refreshing){this.groupBounds=d.wrapper.bounds,Ca(d.wrapper,d.wrapper.offsetX,d.wrapper.offsetY,this,d.wrapper.flip,void 0,void 0);for(var tt=0,nt=d.children;tt<nt.length;tt++){var wt=nt[tt],$=this.nameTable[""+wt];$ instanceof B&&$.sourceID&&$.targetID&&this.updateConnectorProperties($)}d.wrapper.measure(new U(d.wrapper.actualSize.width,d.wrapper.actualSize.height)),d.wrapper.arrange(d.wrapper.desiredSize)}}},e.prototype.hasNestingContainer=function(t,i){for(var r=!1,a=0,s=Object.keys(t);a<s.length;a++){var o=s[a],h=i[""+o];if(h&&h.shape instanceof Sr&&Array.isArray(h.shape.children))for(var l=0,d=h.shape.children;l<d.length;l++){var f=d[l];if(t[""+f]){r=!0;break}}if(r)break}return r},e.prototype.sortContainersTopologically=function(t,i){var r=this.hasNestingContainer(t,i);if(!r)return Object.keys(t);for(var a={},s={},o=[],h=0,l=Object.keys(t);h<l.length;h++){var d=l[h];a[""+d]=[],s[""+d]=0}for(var f=0,p=Object.keys(t);f<p.length;f++){var c=p[f],u=i[""+c];if(u&&u.shape instanceof Sr&&Array.isArray(u.shape.children)&&u.shape.children.length>0)for(var g=0,v=u.shape.children;g<v.length;g++){var m=v[g];t[""+m]&&(a[""+c].push(m),s[""+m]=(s[""+m]||0)+1)}}for(var y=[],S=0,x=Object.keys(s);S<x.length;S++){var d=x[S];s[""+d]===0&&y.push(d)}for(;y.length>0;){var I=y.shift();o.push(I);for(var C=0,P=a[""+I];C<P.length;C++){var m=P[C];s[""+m]--,s[""+m]===0&&y.push(m)}}return o.reverse()},e.prototype.alignGroup=function(t,i){var r=[],a=[],s,o,h,l;for(h=0;h<t.length;h++){s=t[parseInt(h.toString(),10)],o=i[""+s];var d=void 0;if(o&&o.children.length)for(l=0;l<o.children.length;l++)d=o.children[parseInt(l.toString(),10)],t.indexOf(d)>-1&&r.indexOf(d)===-1&&a.indexOf(d)===-1&&r.splice(0,0,d);r.indexOf(s)===-1&&a.push(s)}return r=r.concat(a),r},e.prototype.addToLayer=function(t,i){var r;if(i&&(r=this.commandHandler.getObjectLayer(t.id)),(!i||!r)&&(this.activeLayerObjectsSet.has(t.id)||(this.activeLayer.objects.push(t.id),this.activeLayerObjectsSet.add(t.id))),(t instanceof M||t instanceof B)&&(t.shape.type!=="SwimLane"||t.children&&t.children.length>0)){if(t.parentId){var a=this.swimlaneZIndexTable[t.parentId],s=this.swimlaneChildTable[t.id];(a&&a!==-1||s&&s!==-1)&&(t.zIndex=this.swimlaneChildTable[t.id])}t instanceof B&&t.sourceID&&t.targetID?this.activeLayerObjectsSet.has(t.sourceID)&&this.activeLayerObjectsSet.has(t.targetID)&&this.setZIndex(r||this.activeLayer,t):this.setZIndex(r||this.activeLayer,t)}},e.prototype.updateLayer=function(t){for(var i=0,r=Object.keys(t.layers);i<r.length;i++){for(var a=r[i],s=this.layers[""+a].objects,o=0,h=s;o<h.length;o++){var l=h[o],d=this.nameTable[""+l];t.layers[""+a].visible!==void 0?this.updateElementVisibility(d.wrapper,d,t.layers[""+a].visible):t.layers[""+a].lock===!0&&this.unSelect(d)}t.layers[""+a].lock!==void 0&&(this.layers[""+a].lock=t.layers[""+a].lock)}this.mode!=="SVG"&&this.refreshDiagramLayer()},e.prototype.updateScrollSettings=function(t,i){var r=-this.scroller.horizontalOffset+t.scrollSettings.horizontalOffset||0,a=-this.scroller.verticalOffset+t.scrollSettings.verticalOffset||0;this.scrollSettings.horizontalOffset=-this.scroller.horizontalOffset||0,this.scrollSettings.verticalOffset=-this.scroller.verticalOffset||0;var s="Start";this.realActions&Vt.PanInProgress&&(s="Progress");var o;s==="Start"?(o={VerticalOffset:i.scrollSettings.verticalOffset!==void 0?i.scrollSettings.verticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:i.scrollSettings.horizontalOffset!==void 0?i.scrollSettings.horizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:i.scrollSettings.viewPortHeight!==void 0?i.scrollSettings.viewPortHeight:this.scrollSettings.viewPortHeight,ViewportWidth:i.scrollSettings.viewPortWidth!==void 0?i.scrollSettings.viewPortWidth:this.scrollSettings.viewPortWidth,CurrentZoom:i.scrollSettings.currentZoom!==void 0?i.scrollSettings.currentZoom:this.scroller.currentZoom},this.initialScrollValues=o):s==="Progress"&&(o={VerticalOffset:this.currentScrollValues.VerticalOffset,HorizontalOffset:this.currentScrollValues.HorizontalOffset,ViewportHeight:this.currentScrollValues.ViewportHeight,ViewportWidth:this.currentScrollValues.ViewportWidth,CurrentZoom:this.currentScrollValues.CurrentZoom}),(r!==0||a!==0)&&(this.pan(r,a),this.scrollSettings.horizontalOffset=-this.scroller.horizontalOffset||0,this.scrollSettings.verticalOffset=-this.scroller.verticalOffset||0);var h={VerticalOffset:this.scrollSettings.verticalOffset,HorizontalOffset:this.scrollSettings.horizontalOffset,ViewportHeight:this.scrollSettings.viewPortHeight,ViewportWidth:this.scrollSettings.viewPortWidth,CurrentZoom:this.scroller.currentZoom};this.currentScrollValues=h;var l={oldValue:o,newValue:h,source:this,panState:s};this.triggerEvent(Z.scrollChange,l),this.commandHandler.updatePanState(!0),this.mode==="Canvas"&&this.constraints&lt.Virtualization&&this.refreshDiagramLayer()},e.prototype.updateFromModel=function(){if(this.model.participants.length>0){this.model.updateUmlSequenceDiagram(this),this.initLayerObjects();var t=this.isProtectedOnChange;this.protectPropertyChange(!0),this.model.render(),this.refreshDiagramLayer(),(!(this.diagramActions&k.Render)||this.mode==="Canvas")&&(this.isRefreshed=!0),t||this.protectPropertyChange(t),this.fitToPage({mode:"Page",region:"Content",margin:{left:10,top:10,right:10,bottom:10},canZoomIn:!0,canZoomOut:!0})}},e.prototype.initData=function(){var t=this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource,i="adaptorName";if(this.dataBindingModule&&!(this.realActions&Vt.PreventDataInit))if(t&&this.dataSourceSettings.connectionDataSource.dataManager){var r=this.dataSourceSettings.dataManager||this.dataSourceSettings.dataSource;this.nodes=this.generateData(r,!0),this.connectors=this.generateData(this.dataSourceSettings.connectionDataSource.dataManager,!1)}else t&&t.dataSource&&(t.dataSource.url||t[""+i]==="BlazorAdaptor"&&!t.dataSource.url)?this.dataBindingModule.initSource(this.dataSourceSettings,this):this.dataBindingModule.initData(this.dataSourceSettings,this);else t&&!this.dataBindingModule&&console.warn('[WARNING] :: Module "DataBinding" is not available in Diagram component! You either misspelled the module name or forgot to load it.')},e.prototype.generateData=function(t,i){var r=[],a;for(a=0;a<t.length;a++){var s=t[parseInt(a.toString(),10)],o=i?this.makeData(s,!0):this.makeData(s,!1);o&&o.id&&!a0(r,o.id)&&r.push(o)}return r},e.prototype.makeData=function(t,i){var r,a=i?this.dataSourceSettings:this.dataSourceSettings.connectionDataSource,s={};if(s.id=t[a.id]?t[a.id]:K(),a.sourceID&&(s.sourceID=t[a.sourceID]),a.targetID&&(s.targetID=t[a.targetID]),t[a.sourcePointX]&&t[a.sourcePointY]&&(s.sourcePoint={x:Number(t[a.sourcePointX]),y:Number(t[a.sourcePointY])}),t[a.targetPointX]&&t[a.targetPointY]&&(s.targetPoint={x:Number(t[a.targetPointX]),y:Number(t[a.targetPointY])}),a.crudAction.customFields&&a.crudAction.customFields.length>0)for(r=0;r<a.crudAction.customFields.length;r++)s[a.crudAction.customFields[parseInt(r.toString(),10)]]=t[a.crudAction.customFields[parseInt(r.toString(),10)]];return s},e.prototype.initNodes=function(t,i){this.preventDiagramUpdate=!0,this.initObject(t,i),this.preventDiagramUpdate=!1},e.prototype.initConnectors=function(t,i,r){this.preventDiagramUpdate=!0,this.initObject(t,i,r),this.updateEdges(t),this.preventDiagramUpdate=!1},e.prototype.setZIndex=function(t,i){var r=t;if(i.zIndex===Number.MIN_VALUE){for(;r.zIndexTable[r.objectZIndex+1];)t.objectZIndex++;this.setIndex(t,i)}else{var a=i.zIndex!==null?i.zIndex:r.objectZIndex+1;if(r.zIndexTable[parseInt(a.toString(),10)]){for(var s=Object.keys(r.zIndexTable).length,o=0;o<s;o++)if(o===a){for(var h=s;h>a;h--)r.zIndexTable[parseInt(h.toString(),10)]=r.zIndexTable[h-1],this.nameTable[r.zIndexTable[parseInt(h.toString(),10)]]&&(this.nameTable[r.zIndexTable[parseInt(h.toString(),10)]].zIndex=h);r.zIndexTable[parseInt(o.toString(),10)]=i.id}}}},e.prototype.setIndex=function(t,i){var r=this,a=function(d){if(d.zIndex=++t.objectZIndex,d.shape.type==="Bpmn"&&d.shape.activity&&d.shape.activity.subProcess&&d.shape.activity.subProcess.processes&&d.shape.activity.subProcess.processes.length){var f=d.shape.activity.subProcess.processes;f.forEach(function(p){var c=r.nameTable[""+p];c&&(c.zIndex=++t.objectZIndex)})}},s=function(d){var f=r.nodes.find(function(c){return c.id===d}),p=r.connectors.find(function(c){return c.id===d});f?f.children&&f.children.length>0||f.shape.activity&&f.shape.activity.subProcess&&f.shape.activity.subProcess.processes&&f.shape.activity.subProcess.processes.length>0?r.setIndex(t,f):a(f):p&&a(p)},o=t.objects.indexOf(i.id)!==-1;if(o)if(i instanceof M){if(a(i),i.shape.type!=="SwimLane"&&i.children&&i.children.length>0)for(var h=0;h<i.children.length;h++)s(i.children[parseInt(h.toString(),10)]);else if(i.shape.activity&&i.shape.activity.subProcess&&i.shape.activity.subProcess.processes&&i.shape.activity.subProcess.processes.length>0)for(var l=0;l<i.shape.activity.subProcess.processes.length;l++)s(i.shape.activity.subProcess.processes[parseInt(l.toString(),10)])}else a(i)},e.prototype.initializeDiagramLayers=function(){for(var t=0;t<this.layers.length;t++)if(this.layers[parseInt(t.toString(),10)].zIndex!==-1){var i=this.layers[parseInt(t.toString(),10)];this.layers[parseInt(t.toString(),10)]=this.layers[this.layers[parseInt(t.toString(),10)].zIndex],this.layers[i.zIndex]=i}for(var r=0,a=this.layers;r<a.length;r++){var s=a[r];s.zIndex=s.zIndex!==-1?s.zIndex:this.layers.indexOf(s),this.layerZIndexTable[s.zIndex]=s.id}for(var t=0;t<this.layers.length;t++)for(var o=t+1;o<this.layers.length;o++)if(this.layers[parseInt(t.toString(),10)].zIndex>this.layers[parseInt(o.toString(),10)].zIndex){var i=this.layers[parseInt(t.toString(),10)];this.layers[parseInt(t.toString(),10)]=this.layers[parseInt(o.toString(),10)],this.layers[parseInt(o.toString(),10)]=i}if(this.layers.length>0){var h=this.activeLayer?this.activeLayer.id:void 0;if(h!=="default_layer"){var l=this.layers.flatMap(function(v){return v.objects}),d=[].concat(this.nodes,this.connectors),f=d.filter(function(v){return!l.includes(v.id)});if(f.length>0){var p=f.map(function(v){return v.id}),c={id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}};this.commandHandler.addLayer(c,null,!0);var u=this.layers.findIndex(function(v){return v.id==="default_layer"});if(u!==-1){var g=this.layers.splice(u,1)[0];this.layers.unshift(g),g.objects=p}}}}if(this.layers.length===0){var c={id:"default_layer",visible:!0,lock:!1,objects:[],zIndex:0,objectZIndex:-1,zIndexTable:{}};this.commandHandler.addLayer(c,null,!0)}this.setActiveLayer(this.layers[this.layers.length-1].id)},e.prototype.resetTool=function(){this.eventHandler.resetTool()},e.prototype.initObjectExtend=function(t,i,r){if(r){var a=this.commandHandler.checkBoundaryConstraints(void 0,void 0,t.wrapper.bounds,!0);if(t.shape.type==="SwimLane")for(var s=0,o=Object.keys(i.zIndexTable);s<o.length;s++)i.zIndexTable[o[parseInt(s.toString(),10)]]&&i.zIndexTable[o[parseInt(s.toString(),10)]]===t.id&&delete i.zIndexTable[o[parseInt(s.toString(),10)]];if(i.zIndexTable[t.zIndex]=t.id,!a){for(var h=t instanceof M?this.nodes:this.connectors,s=0;s<=h.length;s++)h[parseInt(s.toString(),10)]&&t.id===h[parseInt(s.toString(),10)].id&&h.splice(s,1);delete i.zIndexTable[t.zIndex]}}},e.prototype.initObject=function(t,i,r,a){if(r===void 0&&(r=!0),t!==void 0){if(r&&(i||(this.addToLayer(t,!1),i=this.activeLayer),(t instanceof M||t instanceof B)&&(t.shape.type!=="SwimLane"||t.children&&t.children.length>0)&&this.setZIndex(i,t)),t instanceof M){if(r){if(t.id!=="helper"&&!(this.diagramActions&k.UndoRedo)){var s=_t(this.getNodeDefaults);if(s){var o=s(t,this);if(o&&o.ports)for(var h=0;h<o.ports.length;h++)o.ports[parseInt(h.toString(),10)].inEdges=[],o.ports[parseInt(h.toString(),10)].outEdges=[];o&&o!==t&&Ma(o,t)}}this.initNode(t,this.element.id)}}else if(t instanceof B){var s=_t(this.getConnectorDefaults);if(s){var o=s(t,this);o&&o!==t&&Ma(o,t),t.segments.length&&t.type!==t.segments[0].type&&(t.segments=[])}var l=this.nameTable[t.sourceID],d=this.nameTable[t.targetID],f=this.getConnectedPort(l,t,!0),p=this.getConnectedPort(d,t),c=this.findInOutConnectPorts(l,!1),u=this.findInOutConnectPorts(d,!0);if((l!==void 0&&Di(l)||t.sourcePortID!==""&&ar(c))&&(t.sourceWrapper=this.getEndNodeWrapper(l,t,!0),t.sourcePortID&&f&&f.constraints&&!(f.constraints&Ct.None)&&f.constraints&Ct.OutConnect&&(t.sourcePortWrapper=this.getWrapper(l.wrapper,t.sourcePortID))),(d!==void 0&&ii(d)||t.targetPortID!==""&&Li(u))&&(t.targetWrapper=this.getEndNodeWrapper(d,t,!1),t.targetPortID&&p&&p.constraints&&!(p.constraints&Ct.None)&&p.constraints&Ct.InConnect&&(t.targetPortWrapper=this.getWrapper(d.wrapper,t.targetPortID))),!r){var g=t.getConnectorPoints(t.type);Dn(t,g)}r&&t.init(this);for(var v=0;v<t.wrapper.children.length;v++)this.pathTable[t.wrapper.children[parseInt(v.toString(),10)].data]&&(t.wrapper.children[parseInt(v.toString(),10)].absoluteBounds=this.pathTable[t.wrapper.children[parseInt(v.toString(),10)].data].absoluteBounds);t.wrapper.measure(new U(void 0,void 0)),t.wrapper.arrange(t.wrapper.desiredSize),t instanceof B&&t.type==="Bezier"&&(this.updateConnectorAnnotation(t),this.updateConnectorfixedUserHandles(t));for(var m=0;m<t.wrapper.children.length;m++)this.pathTable[t.wrapper.children[parseInt(m.toString(),10)].data]={},this.pathTable[t.wrapper.children[parseInt(m.toString(),10)].data].absoluteBounds=t.wrapper.children[parseInt(m.toString(),10)].absoluteBounds}if(t instanceof M&&t.children&&t.container)for(var h=0;h<t.children.length;h++)this.nameTable[t.children[parseInt(h.toString(),10)]].offsetX=this.nameTable[t.children[parseInt(h.toString(),10)]].wrapper.offsetX,this.nameTable[t.children[parseInt(h.toString(),10)]].offsetY=this.nameTable[t.children[parseInt(h.toString(),10)]].wrapper.offsetY;if(t instanceof M&&t.shape&&t.shape.shape==="Activity"&&t.shape.activity.activity==="SubProcess"&&t.shape.activity.subProcess.processes)for(var y=t.shape.activity.subProcess.processes,h=0;h<y.length;h++)this.nameTable[y[parseInt(h.toString(),10)]]&&(this.nameTable[y[parseInt(h.toString(),10)]].offsetX=this.nameTable[y[parseInt(h.toString(),10)]].wrapper.offsetX,this.nameTable[y[parseInt(h.toString(),10)]].offsetY=this.nameTable[y[parseInt(h.toString(),10)]].wrapper.offsetY,this.updateQuad(this.nameTable[y[parseInt(h.toString(),10)]]));if(this.initObjectExtend(t,i,r),this.nameTable[t.id]=t,!this.refreshing&&t.shape.annotations&&t.shape.annotations.length>0)for(var h=0;h<t.shape.annotations.length&&t.shape.annotations[parseInt(h.toString(),10)].text;h++)this.getBPMNTextAnnotation(t,this,t.shape.annotations[parseInt(h.toString(),10)],!1);if(t instanceof M&&t.children){this.preventNodesUpdate=!0,this.preventConnectorsUpdate=!0,!a&&!t.container&&this.updateGroupOffset(t,!0),this.groupTable[t.id]=t.children;for(var h=0;h<t.children.length;h++){var S=this.nameTable[t.children[parseInt(h.toString(),10)]];S&&(S.parentId=t.id)}!this.isLoading&&t.rotateAngle&&!t.container&&!this.isUndo&&this.commandHandler.rotateObjects(t,[t],t.rotateAngle,{x:t.offsetX,y:t.offsetY},!1),this.preventNodesUpdate=!1,this.preventConnectorsUpdate=!1}this.enterObject===void 0&&this.updateQuad(t)}t.visible===!1&&this.updateElementVisibility(t.wrapper,t,!1)},e.prototype.getConnectedPort=function(t,i,r){if(t&&t.ports)for(var a=0,s=t.ports;a<s.length;a++){var o=s[a];if(o.id===i.sourcePortID&&r)return o;if(o.id===i.targetPortID&&!r)return o}return null},e.prototype.scaleObject=function(t,i,r){var a=r?t.wrapper.actualSize.width:t.wrapper.actualSize.height,s=r?1+(i-a)/a:1,o=r?1:1+(i-a)/a;this.realActions|=Vt.PreventDrag,this.scale(t,s,o,{x:.5,y:.5}),this.realActions&=~Vt.PreventDrag},e.prototype.updateDefaultLayoutIcons=function(t){(this.layout.type==="OrganizationalChart"||this.layout.type==="HierarchicalTree"||this.layout.type==="ComplexHierarchicalTree")&&(this.updateDefaultLayoutIcon(t,t.expandIcon),this.updateDefaultLayoutIcon(t,t.collapseIcon))},e.prototype.updateDefaultLayoutIcon=function(t,i){if(i.shape!=="None"&&i.horizontalAlignment==="Auto"&&i.verticalAlignment==="Auto"&&i.offset.x===.5&&i.offset.y===1){var r=this.getWrapper(t.wrapper,"icon_content"),a=void 0,s=void 0;this.layout.orientation==="TopToBottom"||this.layout.orientation==="BottomToTop"?(a=.5,s=this.layout.orientation==="TopToBottom"?1:0):(this.layout.orientation==="RightToLeft"||this.layout.orientation==="LeftToRight")&&(a=this.layout.orientation==="LeftToRight"?1:0,s=.5),r.setOffsetWithRespectToBounds(a,s,"Fraction"),r.horizontalAlignment="Center",r.verticalAlignment="Center",t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize)}},e.prototype.updateGroupOffset=function(t,i){if(t.children&&t.children.length>0&&!t.container||t.processId||t.parentId&&this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="Container"){var r=this.nameTable[t.id];if(!(this.realActions&Vt.PreventScale)&&!(this.realActions&Vt.PreventDrag)){if(r.offsetX&&(this.realActions&Vt.EnableGroupAction||!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.ToolAction)&&!(this.diagramActions&k.PublicMethod)&&!t.processId)){this.realActions|=Vt.PreventScale;var a=r.offsetX-t.wrapper.offsetX;r.offsetX=t.wrapper.offsetX;var s=r.offsetY-t.wrapper.offsetY;r.offsetY=t.wrapper.offsetY,a+s!==0&&this.drag(r,a,s),this.realActions&=~Vt.PreventScale}else r.offsetX=t.wrapper.offsetX;if(r.offsetY&&(this.realActions&Vt.EnableGroupAction||!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.ToolAction)&&!(this.diagramActions&k.PublicMethod)&&!t.processId)){this.realActions|=Vt.PreventScale;var s=r.offsetY-t.wrapper.offsetY;r.offsetY=t.wrapper.offsetY,this.drag(r,0,s),this.realActions&=~Vt.PreventScale}else r.offsetY=t.wrapper.offsetY;this.diagramActions&&(r.width=t.wrapper.actualSize.width,r.height=t.wrapper.actualSize.height)}}t&&t.annotations&&t.annotations.length>0&&(t.wrapper.children.forEach(function(o){o instanceof Ht&&o.children.forEach(function(h){h&&h instanceof Tt&&h.refreshTextElement()})}),t.wrapper.measure(new U(t.width,t.height),t.id,this.onLoadImageSize.bind(this)),t.wrapper.arrange(t.wrapper.desiredSize)),i&&t.children&&t.children.length>0&&(this.nameTable[t.id].width!==void 0?this.scaleObject(t,this.nameTable[t.id].width,!0):this.nameTable[t.id].width=t.wrapper.actualSize.width,this.nameTable[t.id].height!==void 0?this.scaleObject(t,this.nameTable[t.id].height,!1):this.nameTable[t.id].height=t.wrapper.actualSize.height)},e.prototype.initNode=function(t,i,r){var a=this,s=t.initContainer(),o=new Ht,h;if(this.diagramSettings.inversedAlignment||(s.inversedAlignment=!1),s.children||(s.children=[]),t.children){if(s.measureChildren=!1,o.id=t.id+"group_container",t.shape&&t.shape.type==="SwimLane"?o.style.fill=t.style.fill:o.style.fill="none",o.style.strokeColor="none",o.horizontalAlignment="Stretch",o.verticalAlignment="Stretch",o.pivot=t.pivot,s.style=t.style,t.shape&&t.shape.type==="Basic"&&(s.cornerRadius=t.shape.cornerRadius),s.padding.left=t.padding.left,s.padding.right=t.padding.right,s.padding.top=t.padding.top,s.padding.bottom=t.padding.bottom,o.children=[],o.preventContainer=!0,t.container&&(o.relativeMode="Object"),t.container&&t.container.type==="Grid")for(var l=0;l<t.children.length;l++){var d=new Ht,f=this.nameTable[t.children[l]];d.children=[],d.children.push(f.wrapper),f&&s.addObject(f.wrapper,f.rowIndex,f.columnIndex,f.rowSpan,f.columnSpan)}else for(var l=0;l<t.children.length;l++)if(this.nameTable[t.children[l]]){var f=this.nameTable[t.children[l]];this.updateStackProperty(t,f,l),s.children.push(f.wrapper),s.elementActions=s.elementActions|le.ElementIsGroup,f.wrapper.flip=f.wrapper.flip^=t.wrapper.flip}(V(t.container)||t.container&&t.container.type!=="Grid")&&s.children.push(o)}else{var p=_t(this.setNodeTemplate);p&&t.id!=="helper"&&(h=p(t,this)),h||(h=t.init(this)),s.children.push(h)}var c;c=_t(this.getDescription),c?(t.children?s:h).description=c:(t.children?s:h).description=t.annotations.length?t.annotations[0].content:t.id;var u=t.children?o:s;t.initAnnotations(this.getDescription,u,this.element.id,!!Le(this),this.annotationTemplate),t.initPorts(this.getDescription,u),t.initIcons(this.getDescription,this.layout,u,i);for(var l=0;t.fixedUserHandles,l<t.fixedUserHandles.length;l++){var g=t.initFixedUserHandles(t.fixedUserHandles[l],this.fixedUserHandleTemplate,this.element.id);u.children.push(g)}if(t.shape.type==="SwimLane"&&t.wrapper&&t.wrapper.children.length>0&&t.wrapper.children[0]instanceof Fn?(this.setZIndex(this.activeLayer,t),ta(t),em(this,t),this.updateLaneAfterAddChild(t),t.shape.lanes.forEach(function(C){C.children&&C.children.length>0&&C.children.forEach(function(P){a.updateQuad(P)})}),this.updateDiagramElementQuad()):(s.measure(new U(t.width,t.height),t.id,this.onLoadImageSize.bind(this)),s instanceof Fn?s.arrange(s.desiredSize,!0):s.arrange(s.desiredSize)),t.shape.type==="Container"&&this.updateDiagramElementQuad(),t.wrapper.flip!==G.None&&this.isNotContainerOrSubProcess(t))if(t.children&&t.children.length>0){for(var v=!1,l=0;l<t.children.length;l++){var m=this.nameTable[t.children[l]];(m instanceof B||t.rotateAngle!==0)&&(v=!0,this.connectorOrRotatedGroups.indexOf(t)==-1&&this.connectorOrRotatedGroups.push(t)),m&&(!this.refreshing&&!this.commandHandler.cloningInProgress&&!(this.diagramActions&k.UndoRedo)&&(m.flip^=t.flip,m.flipMode=t.flipMode),m.flipMode!=="None"&&m.flipMode!=="Label"&&m.flipMode!=="LabelText"&&m.flipMode!=="LabelAndLabelText"?this.updatePorts(m,m.flip):this.updatePorts(m,G.None),this.applyWrapperFlip(m),m.wrapper.measure(new U(m.wrapper.bounds.width,m.wrapper.bounds.height),m.id,this.onLoadImageSize.bind(this)),m.wrapper.arrange(m.wrapper.desiredSize))}var y=t.wrapper.children[t.wrapper.children.length-1];y.flip=t.wrapper.flip,y.flipMode=t.wrapper.flipMode;for(var S=0;S<y.children.length;S++){var x=y.children[S];x instanceof Tt&&t.flipMode!=="Port"&&t.flipMode!=="None"&&(x.flip=t.wrapper.flip,x.flipMode=t.wrapper.flipMode)}!v&&!this.refreshing&&!this.commandHandler.cloningInProgress&&!(this.diagramActions&k.UndoRedo)&&Ca(t.wrapper,t.wrapper.offsetX,t.wrapper.offsetY,this,t.wrapper.flip,void 0,void 0,!0)}else this.applyWrapperFlip(t);if(t.shape.type==="Bpmn"&&t.shape.shape==="TextAnnotation"){for(var I=!1,l=0;l<this.connectors.length;l++)if(this.connectors[parseInt(l.toString(),10)].id===t.id+"_connector"){this.connectors[parseInt(l.toString(),10)].isBpmnAnnotationConnector=!0,I=!0;break}I||this.addBpmnAnnotationConnector(t,s)}t instanceof M&&t.container&&(t.width<s.outerBounds.width||t.height<s.outerBounds.height)&&s.bounds.x<=s.outerBounds.x&&s.bounds.y<=s.outerBounds.y&&(t.width=s.width=s.outerBounds.width,t.height=s.height=s.outerBounds.height,s.measure(new U(t.width,t.height)),s.arrange(s.desiredSize)),t.container&&t.container.type==="Grid"&&t.children&&t.children.length>0&&this.updateChildPosition(t)},e.prototype.isNotContainerOrSubProcess=function(t){return t.shape.type!=="Container"&&!(t.shape.type==="Bpmn"&&t.shape.shape==="Activity"&&t.shape.activity.activity==="SubProcess"&&t.shape.activity.subProcess.collapsed===!1)},e.prototype.isNotSwimlaneObject=function(t){return t.shape.type!=="SwimLane"&&!t.isLane&&!t.isPhase&&!t.isHeader},e.prototype.updateLaneAfterAddChild=function(t){for(var i=0;i<this.nodes.length;i++){var r=this.nodes[parseInt(i.toString(),10)];r.parentId===t.id&&!t.shape.hasHeader&&(r.width=r.wrapper.width,r.height=r.wrapper.height)}},e.prototype.applyWrapperFlip=function(t){if(t instanceof M){t.wrapper.flip=t.flip,t.wrapper.flipMode=t.flipMode,t.wrapper.children[0].flip=t.flip,t.wrapper.children[0].flipMode=t.flipMode;for(var i=0;i<t.wrapper.children.length;i++){var r=t.wrapper.children[i];r instanceof Ht?this.applyWrapperCanvasFlip(r,t):(r.flip=t.flip,r.flipMode=t.flipMode)}}},e.prototype.applyWrapperCanvasFlip=function(t,i){for(var r=0;r<t.children.length;r++){var a=t.children[parseInt(r.toString(),10)];a instanceof Ht?this.applyWrapperCanvasFlip(a,i):i.flipMode!=="None"&&(a.flip=i.flip,a.flipMode=i.flipMode)}},e.prototype.addBpmnAnnotationConnector=function(t,i){if(t.parentObj instanceof e||t.parentObj instanceof Fr){var r=t.shape,a=r.textAnnotation.textAnnotationDirection,s=r.textAnnotation.textAnnotationTarget!==""&&this.nameTable[r.textAnnotation.textAnnotationTarget],o=s?this.nameTable[r.textAnnotation.textAnnotationTarget]:null,h=o!=null?o.wrapper:null,l=t.ports[0],d={x:0,y:0};switch(a){case"Left":l.offset={x:0,y:.5},d.x=i.bounds.left-40,d.y=i.bounds.bottom+30;break;case"Right":l.offset={x:1,y:.5},d.x=i.bounds.right+40,d.y=i.bounds.bottom+30;break;case"Top":l.offset={x:.5,y:0},d.x=i.bounds.right+30,d.y=i.bounds.top-40;break;case"Bottom":l.offset={x:.5,y:1},d.x=i.bounds.right+30,d.y=i.bounds.bottom+40;break;default:l.offset={x:0,y:.5},d.x=i.bounds.left-40,d.y=i.bounds.bottom+30,s&&i!=null&&h!=null&&(i.bounds.left>h.bounds.right?l.offset={x:0,y:.5}:i.bounds.right<h.bounds.left?l.offset={x:1,y:.5}:i.bounds.bottom>h.bounds.top?l.offset={x:.5,y:0}:i.bounds.top<h.bounds.bottom&&(l.offset={x:.5,y:1}));break}var f=new B(this,"connectors",{id:t.id+"_connector",targetID:t.id,targetPortID:l.id,type:"Straight",shape:{type:"Bpmn",flow:"Association"},constraints:yt.Default&~(yt.DragTargetEnd|yt.Delete),isBpmnAnnotationConnector:!0},!0);s?f.sourceID=r.textAnnotation.textAnnotationTarget:f.sourcePoint=d;var p=this.isProtectedOnChange;this.isProtectedOnChange=!0,t.constraints|=W.InConnect,this.connectors.push(f),this.bpmnModule.bpmnTextAnnotationConnector||(this.bpmnModule.bpmnTextAnnotationConnector=[]),this.bpmnModule.bpmnTextAnnotationConnector.push(f);var c=(t.constraints&W.Shadow)!==0,u=(t.constraints&W.AllowMovingOutsideLane)!==0;t.constraints=W.Default&~(W.OutConnect|W.InConnect),c&&(t.constraints|=W.Shadow),u&&(t.constraints|=W.AllowMovingOutsideLane),this.isProtectedOnChange=p}},e.prototype.getBPMNTextAnnotation=function(t,i,r,a){var s={id:r.id||K(),height:r.height||100,width:r.width||100,annotations:[{id:(r.id?r.id:K())+r.text,content:r.text}],offsetX:t.offsetX+r.length*Math.cos(r.angle*(Math.PI/180)),offsetY:t.offsetY+r.length*Math.sin(r.angle*(Math.PI/180)),shape:{type:"Bpmn",shape:"TextAnnotation",textAnnotation:{textAnnotationDirection:"Auto",textAnnotationTarget:t.id}},constraints:W.Default&~(W.OutConnect|W.InConnect)},o=t.wrapper.bounds,h={x:s.offsetX,y:s.offsetY},l=ui(h,o,o),d;switch(l){case"Right":d={x1:o.right,y1:o.top,x2:o.right,y2:o.bottom};break;case"Left":d={x1:o.left,y1:o.top,x2:o.left,y2:o.bottom};break;case"Bottom":d={x1:o.right,y1:o.bottom,x2:o.left,y2:o.bottom};break;case"Top":d={x1:o.right,y1:o.top,x2:o.left,y2:o.top};break}var f=o.center,p=b.transform(h,r.angle,Math.max(o.width,o.height)),c=Fo(d,[f,p],!1,f);if(r.length!==void 0&&r.angle!==void 0&&c&&(c=b.transform(c,r.angle,r.length),s.offsetX=c.x,s.offsetY=c.y),l==="Right"?s.offsetX+=s.width/2:l==="Left"?s.offsetX-=s.width/2:l==="Bottom"?s.offsetY+=s.height/2:s.offsetY-=s.height/2,a)this.add(s);else{var u=new M(this,"nodes",s,!0);i.initObject(u,void 0,void 0,!0),i.nodes.push(u)}},e.prototype.updateDiagramElementQuad=function(){for(var t=0;t<this.nodes.length;t++)this.nodes[parseInt(t.toString(),10)].wrapper&&this.nodes[parseInt(t.toString(),10)].wrapper instanceof Je&&this.updateQuad(this.nodes[parseInt(t.toString(),10)])},e.prototype.onLoadImageSize=function(t,i){var r=this.getObject(t),a=document.getElementById(t+"sf-imageNode");a&&a.parentNode.removeChild(a),this.nodePropertyChange(r,{},{width:i.width,height:i.height});var s={element:E(r),size:i};this.triggerEvent(Z.onImageLoad,s)},e.prototype.updateChildPosition=function(t){for(var i=0;i<t.children.length;i++){var r=this.getObject(t.children[parseInt(i.toString(),10)]);r.offsetX=r.wrapper.offsetX,r.offsetY=r.wrapper.offsetY,r.children&&r.children.length>0&&this.updateChildPosition(r)}},e.prototype.canExecute=function(){return!0},e.prototype.updateStackProperty=function(t,i,r){t.container&&t.container.type==="Stack"&&(i.width||(i.wrapper.horizontalAlignment="Stretch",i.horizontalAlignment="Stretch"),i.height||(i.verticalAlignment="Stretch",i.wrapper.verticalAlignment="Stretch"),r&&t.shape.type==="UmlClassifier"&&(i.umlIndex=r))},e.prototype.initViews=function(){this.isLoading||(this.views.push(this.element.id),this.views[this.element.id]=this)},e.prototype.initCommands=function(){var t=this.commandManager.commands,i={copy:{execute:this.copyCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.C,keyModifiers:dt.Control}},paste:{execute:this.pasteCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.V,keyModifiers:dt.Control}},cut:{execute:this.cutCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.X,keyModifiers:dt.Control}},delete:{execute:this.removeCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.Delete}},selectAll:{execute:this.selectAll.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.A,keyModifiers:dt.Control}},undo:{execute:this.undo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.Z,keyModifiers:dt.Control}},redo:{execute:this.redo.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.Y,keyModifiers:dt.Control}},nudgeUp:{execute:this.nudgeCommand.bind(this,"Up"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Up},parameter:"up"},nudgeRight:{execute:this.nudgeCommand.bind(this,"Right"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Right},parameter:"right"},nudgeDown:{execute:this.nudgeCommand.bind(this,"Down"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Down},parameter:"down"},nudgeLeft:{execute:this.nudgeCommand.bind(this,"Left"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Left},parameter:"left"},startEdit:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.F2}},endEdit:{execute:this.endEditCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.Escape}},focusToNextItem:{execute:this.navigateItems.bind(this,!0),canExecute:this.canExecute.bind(this),gesture:{key:ut.Tab}},focusToPreviousItem:{execute:this.navigateItems.bind(this,!1),canExecute:this.canExecute.bind(this),gesture:{key:ut.Tab,keyModifiers:dt.Shift}},selectFocusedItem:{execute:this.startEditCommad.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.Enter}},bold:{execute:this.fontStyleCommand.bind(this,"bold"),canExecute:this.canExecute.bind(this),gesture:{key:ut.B,keyModifiers:dt.Control}},italic:{execute:this.fontStyleCommand.bind(this,"italic"),canExecute:this.canExecute.bind(this),gesture:{key:ut.I,keyModifiers:dt.Control}},underline:{execute:this.fontStyleCommand.bind(this,"underline"),canExecute:this.canExecute.bind(this),gesture:{key:ut.U,keyModifiers:dt.Control}},duplicate:{execute:this.duplicateCommand.bind(this),canExecute:this.canExecute.bind(this),gesture:{key:ut.D,keyModifiers:dt.Control}},group:{execute:this.groupCommand.bind(this,"group"),canExecute:this.canExecute.bind(this),gesture:{key:ut.G,keyModifiers:dt.Control}},ungroup:{execute:this.groupCommand.bind(this,"ungroup"),canExecute:this.canExecute.bind(this),gesture:{key:ut.U,keyModifiers:dt.Control|dt.Shift}},rotateClockwise:{execute:this.rotateCommand.bind(this,"clockwise"),canExecute:this.canExecute.bind(this),gesture:{key:ut.R,keyModifiers:dt.Control}},rotateAntiClockwise:{execute:this.rotateCommand.bind(this,"antiClockwise"),canExecute:this.canExecute.bind(this),gesture:{key:ut.L,keyModifiers:dt.Control}},flipHorizontal:{execute:this.flipCommand.bind(this,"horizontal"),canExecute:this.canExecute.bind(this),gesture:{key:ut.H,keyModifiers:dt.Control}},flipVertical:{execute:this.flipCommand.bind(this,"vertical"),canExecute:this.canExecute.bind(this),gesture:{key:ut.J,keyModifiers:dt.Control}},pointerTool:{execute:this.toolCommand.bind(this,"pointer"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number1,keyModifiers:dt.Control}},textTool:{execute:this.toolCommand.bind(this,"text"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number2,keyModifiers:dt.Control}},connectTool:{execute:this.toolCommand.bind(this,"connect"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number3,keyModifiers:dt.Control}},freeForm:{execute:this.toolCommand.bind(this,"freeForm"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number5,keyModifiers:dt.Control}},lineTool:{execute:this.toolCommand.bind(this,"line"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number6,keyModifiers:dt.Control}},rectangleTool:{execute:this.toolCommand.bind(this,"rectangle"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number8,keyModifiers:dt.Control}},ellipseTool:{execute:this.toolCommand.bind(this,"ellipse"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Number9,keyModifiers:dt.Control}},zoomIn:{execute:this.zoomCommand.bind(this,"zoomIn"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Plus,keyModifiers:dt.Control}},zoomOut:{execute:this.zoomCommand.bind(this,"zoomOut"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Minus,keyModifiers:dt.Control}},shiftUp:{execute:this.shiftCommand.bind(this,"Up"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Up,keyModifiers:dt.Shift}},shiftDown:{execute:this.shiftCommand.bind(this,"Down"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Down,keyModifiers:dt.Shift}},shiftLeft:{execute:this.shiftCommand.bind(this,"Left"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Left,keyModifiers:dt.Shift}},shiftRight:{execute:this.shiftCommand.bind(this,"Right"),canExecute:this.canExecute.bind(this),gesture:{key:ut.Right,keyModifiers:dt.Shift}},alignTextCenter:{execute:this.alignCommand.bind(this,"center"),canExecute:this.canExecute.bind(this),gesture:{key:ut.C,keyModifiers:dt.Control|dt.Shift}},alignTextLeft:{execute:this.alignCommand.bind(this,"right"),canExecute:this.canExecute.bind(this),gesture:{key:ut.L,keyModifiers:dt.Control|dt.Shift}},alignTextRight:{execute:this.alignCommand.bind(this,"left"),canExecute:this.canExecute.bind(this),gesture:{key:ut.R,keyModifiers:dt.Control|dt.Shift}},alignTextTop:{execute:this.alignCommand.bind(this,"top"),canExecute:this.canExecute.bind(this),gesture:{key:ut.E,keyModifiers:dt.Control|dt.Shift}},alignTextCenterVertical:{execute:this.alignCommand.bind(this,"centerVertical"),canExecute:this.canExecute.bind(this),gesture:{key:ut.M,keyModifiers:dt.Control|dt.Shift}},alignTextBottom:{execute:this.alignCommand.bind(this,"bottom"),canExecute:this.canExecute.bind(this),gesture:{key:ut.V,keyModifiers:dt.Control|dt.Shift}},alignJustify:{execute:this.alignCommand.bind(this,"justify"),canExecute:this.canExecute.bind(this),gesture:{key:ut.J,keyModifiers:dt.Control|dt.Shift}},sendToBack:{execute:this.orderCommand.bind(this,"sendToBack"),canExecute:this.canExecute.bind(this),gesture:{key:ut.B,keyModifiers:dt.Control|dt.Shift}},bringToFront:{execute:this.orderCommand.bind(this,"bringToFront"),canExecute:this.canExecute.bind(this),gesture:{key:ut.F,keyModifiers:dt.Control|dt.Shift}},sendBackward:{execute:this.orderCommand.bind(this,"sendBackward"),canExecute:this.canExecute.bind(this),gesture:{key:ut.BracketLeft,keyModifiers:dt.Control}},bringForward:{execute:this.orderCommand.bind(this,"bringForward"),canExecute:this.canExecute.bind(this),gesture:{key:ut.BracketRight,keyModifiers:dt.Control}}};this.initCommandManager(t,i)},e.prototype.overrideCommands=function(t,i){for(var r,a=0,s=Object.keys(i);a<s.length;a++){var o=s[a];if(r=i[""+o],t.gesture.key===r.gesture.key&&t.gesture.keyModifiers===r.gesture.keyModifiers){delete i[""+o];break}}},e.prototype.initCommandManager=function(t,i){var r=0;if(t)for(r=0;r<t.length;r++)i[t[parseInt(r.toString(),10)].name]&&t[parseInt(r.toString(),10)]?(t[parseInt(r.toString(),10)].canExecute&&(i[t[parseInt(r.toString(),10)].name].canExecute=t[parseInt(r.toString(),10)].canExecute),t[parseInt(r.toString(),10)].execute&&(i[t[parseInt(r.toString(),10)].name].execute=t[parseInt(r.toString(),10)].execute),(t[parseInt(r.toString(),10)].gesture.key||t[parseInt(r.toString(),10)].gesture.keyModifiers)&&(i[t[parseInt(r.toString(),10)].name].gesture=t[parseInt(r.toString(),10)].gesture),t[parseInt(r.toString(),10)].parameter!==""&&(i[t[parseInt(r.toString(),10)].name].parameter=t[parseInt(r.toString(),10)].parameter)):(this.overrideCommands(t[parseInt(r.toString(),10)],i),i[t[parseInt(r.toString(),10)].name]={execute:t[parseInt(r.toString(),10)].execute,canExecute:t[parseInt(r.toString(),10)].canExecute,gesture:t[parseInt(r.toString(),10)].gesture,parameter:t[parseInt(r.toString(),10)].parameter});this.commands=i},e.prototype.updateNodeEdges=function(t){for(var i=0,r=t.inEdges;i<r.length;i++){var a=r[i];this.nameTable[""+a]&&(this.nameTable[""+a].targetID="")}for(var s=0,o=t.outEdges;s<o.length;s++){var a=o[s];this.nameTable[""+a]&&(this.nameTable[""+a].sourceID="")}t.inEdges=[],t.outEdges=[]},e.prototype.updateIconVisibility=function(t,i){for(var r=t.id+"_icon",a=0,s=t.wrapper.children;a<s.length;a++){var o=s[a];o.id&&o.id.startsWith(r)&&(o.visible=i,this.updateDiagramContainerVisibility(o,i))}},e.prototype.updateEdges=function(t){if(t.sourceID!==void 0&&t.sourceID!==""){var i=this.nameTable[t.sourceID];i&&i.outEdges&&i.outEdges.length===0&&(i.outEdges=[]),i&&i.outEdges&&i.outEdges.indexOf(t.id)===-1&&i.outEdges.push(t.id),this.updatePortEdges(i,t,!1)}if(t.targetID!==void 0&&t.targetID!==""){var r=this.nameTable[t.targetID];if(r&&r.inEdges&&r.inEdges.length===0&&(r.inEdges=[]),r&&r.inEdges&&r.inEdges.indexOf(t.id)===-1&&r.inEdges.push(t.id),this.updatePortEdges(r,t,!0),r&&r.visible&&r.outEdges){var a=r.outEdges.length!==0;this.updateIconVisibility(r,a)}}},e.prototype.updatePortEdges=function(t,i,r){if(t)for(var a=0;a<t.ports.length;a++){var s=t.ports[parseInt(a.toString(),10)],o=r?i.targetPortID:i.sourcePortID;if(s.id===o){var h=r?s.inEdges:s.outEdges;h.indexOf(i.id)===-1&&h.push(i.id)}}},e.prototype.refreshDiagram=function(){this.initLayerObjects(),this.doLayout(),this.updateBridging(),this.scroller.setSize(),this.addBlazorDiagramObjects(),this.updateFitToPage()},e.prototype.updateCanupdateStyle=function(t,i){for(var r=0;r<t.length;r++)t[parseInt(r.toString(),10)].children&&this.updateCanupdateStyle(t[parseInt(r.toString(),10)].children,i),t[parseInt(r.toString(),10)].canApplyStyle=i},e.prototype.getZindexPosition=function(t,i){var r=[],a=void 0;r=r.concat(this.nodes),r=r.concat(this.connectors);var s,o;if(t.children?o=this.commandHandler.findMaxZIndex(t):o=t.zIndex,t.zIndex!==Number.MIN_VALUE){for(var h=0;h<r.length;h++)if(r[parseInt(h.toString(),10)].zIndex>o){(t.shape.type==="HTML"||t.shape.type==="Native")&&(s=t.shape.type==="HTML"?"html":"native"),a=Ly(i,r[parseInt(h.toString(),10)].id,s);break}}return a},e.prototype.updateDiagramObject=function(t,i,r){for(var a,s="domTable",o=0,h=this.views;o<h.length;o++){var l=h[o];if(a=this.views[""+l],this.diagramActions&&a.mode==="SVG"){var d=this.layers.length>1,f=void 0;if(d&&(f=this.commandHandler.getObjectLayer(t.id)),f===void 0||f&&f.visible||r){var p=ti(this.element.id);window[""+s][a.element.id+"_diagramLayer"]||(window[""+s][a.element.id+"_diagramLayer"]=document.getElementById(a.element.id+"_diagramLayer"));var c=window[""+s][a.element.id+"_diagramLayer"];this.diagramActions&k.Interactions&&this.updateCanupdateStyle(t.wrapper.children,!0);var u=this.getMidPoint(t);this.diagramRenderer.updateNode(t.wrapper,c,p,void 0,i?void 0:this.getZindexPosition(t,a.element.id),u,this.portCenterPoint),this.updateCanupdateStyle(t.wrapper.children,!0)}}}},e.prototype.applyMarginBezier=function(t,i){i.cx=i.cx+t.margin.left,i.cx=i.cx-t.margin.right,i.cy=i.cy+t.margin.top,i.cy=i.cy-t.margin.bottom},e.prototype.getMidPoint=function(t){var i;if(t instanceof B&&t.type==="Bezier"){i=[];for(var r=this.getBezierPoints(t),a=b.getLengthFromListOfPoints(r),s=0;s<t.annotations.length;s++)for(var o=t.annotations[parseInt(s.toString(),10)].offset,h=o*a,l=this.commandHandler.getPointAtLength(h,r,0),d={cx:l.x,cy:l.y},f=0;f<t.wrapper.children.length;f++)t.wrapper&&t.wrapper.children[parseInt(f.toString(),10)]instanceof Tt&&t.wrapper.children[parseInt(f.toString(),10)].id===t.id+"_"+t.annotations[parseInt(s.toString(),10)].id&&(this.applyMarginBezier(t.wrapper.children[parseInt(f.toString(),10)],d),i[t.id+"_"+t.annotations[parseInt(s.toString(),10)].id]=this.applyAlignment(t.wrapper.children[parseInt(f.toString(),10)],d,t.annotations[parseInt(s.toString(),10)].displacement));for(var s=0;s<t.ports.length;s++)for(var p=t.ports[parseInt(s.toString(),10)].offset,c=p*a,u=this.commandHandler.getPointAtLength(c,r,0),g={cx:u.x,cy:u.y},f=0;f<t.wrapper.children.length;f++)t.wrapper&&t.wrapper.children[parseInt(f.toString(),10)]instanceof Pt&&t.wrapper.children[parseInt(f.toString(),10)].isPathPort&&t.wrapper.children[parseInt(f.toString(),10)].id===t.id+"_"+t.ports[parseInt(s.toString(),10)].id&&(this.applyMarginBezier(t.wrapper.children[parseInt(f.toString(),10)],g),this.portCenterPoint[t.id+"_"+t.ports[parseInt(s.toString(),10)].id]=this.applyAlignment(t.wrapper.children[parseInt(f.toString(),10)],g,t.ports[parseInt(s.toString(),10)].displacement))}return i},e.prototype.applyAlignment=function(t,i,r){switch(t.horizontalAlignment){case"Auto":case"Left":i.cx=t.inversedAlignment?i.cx:i.cx-t.desiredSize.width,i.cx+=r.x;break;case"Stretch":case"Center":i.cx-=t.desiredSize.width*t.pivot.x;break;case"Right":i.cx=t.inversedAlignment?i.cx-t.desiredSize.width:i.cx,i.cx-=r.x;break}switch(t.verticalAlignment){case"Auto":case"Top":i.cy=t.inversedAlignment?i.cy:i.cy-t.desiredSize.height,i.cy+=r.y;break;case"Stretch":case"Center":i.cy-=t.desiredSize.height*t.pivot.y;break;case"Bottom":i.cy=t.inversedAlignment?i.cy-t.desiredSize.height:i.cy,i.cy-=r.y;break}return i},e.prototype.getBezierPoints=function(t){var i=[],r,a={x:t.sourcePoint.x,y:t.sourcePoint.y};for(i.push(a),r=0;r<t.segments.length;r++){var s=t.segments[parseInt(r.toString(),10)].getPoints(t.segments[parseInt(r.toString(),10)],a);i.push.apply(i,s),a=i[i.length-1]}return i},e.prototype.updateGridContainer=function(t){for(var i,r=ti(this.element.id),a=0,s=this.views;a<s.length;a++){var o=s[a];if(i=this.views[""+o],i.mode==="SVG"&&this.diagramActions){var h=document.getElementById(i.element.id+"_diagramLayer");this.diagramRenderer.updateNode(t,h,r,void 0)}else this.refreshCanvasDiagramLayer(i)}},e.prototype.getObjectsOfLayer=function(t){for(var i=[],r=0,a=t;r<a.length;r++){var s=a[r];this.nameTable[""+s]&&i.push(this.nameTable[""+s])}return i},e.prototype.refreshDiagramLayer=function(){for(var t,i=0,r=this.views;i<r.length;i++){var a=r[i];switch(t=this.views[""+a],t.mode){case"SVG":this.refreshSvgDiagramLayer(t);break;case"Canvas":this.refreshCanvasLayers(t);break}}},e.prototype.refreshCanvasLayers=function(t){if(t)this.refreshCanvasDiagramLayer(t);else for(var i=0,r=this.views;i<r.length;i++){var a=r[i],s=this.views[""+a];this.refreshCanvasDiagramLayer(s)}},e.prototype.renderBasicElement=function(t){for(var i=ti(t.element.id),r=0;r<this.basicElements.length;r++){var a=this.basicElements[parseInt(r.toString(),10)];a instanceof Je&&(a.prevRotateAngle=0),a.measure(new U(a.width,a.height)),a.arrange(a.desiredSize),t.diagramRenderer.renderElement(a,t.diagramLayer,i)}},e.prototype.refreshElements=function(t){var i=!1;if(!this.isDestroyed){if(this.clearCanvas(t),t instanceof e)t.diagramLayer.getContext("2d").setTransform(t.scroller.currentZoom,0,0,t.scroller.currentZoom,0,0),t.diagramLayer.getContext("2d").scale(1.5,1.5);else{i=!0;var r=document.getElementById(t.element.id+"_nativeLayer");r.children.length>0&&t.updateView(t)}var a=ti(t.element.id);this.renderDiagramElements(t.diagramLayer,t.diagramRenderer,a,void 0,void 0,i);for(var s=0;s<this.basicElements.length;s++){var r=this.basicElements[parseInt(s.toString(),10)];r.measure(new U(r.width,r.height)),r.arrange(r.desiredSize),t.diagramRenderer.renderElement(r,t.diagramLayer,a)}t instanceof e&&(t.diagramLayer.style.transform="scale("+2/3+")",t.diagramLayer.style.transformOrigin="0 0"),this.renderTimer=null}},e.prototype.refreshCanvasDiagramLayer=function(t){var i=this;t.mode!=="SVG"&&!this.isDestroyed&&(this.basicElements.length>0&&this.renderBasicElement(t),this.preventOverviewRefresh||(!this.diagramActions||(this.diagramActions&k.Render)===0||k.ToolAction&this.diagramActions||Le(this)||this.scroller.currentZoom!==1?this.refreshElements(t):this.renderTimer||(this.renderTimer=setTimeout(function(){i.refreshElements(t)},40))))},e.prototype.updatePortVisibility=function(t,i,r){var a,s=!(this.drawingObject&&this.drawingObject.shape);if((t instanceof M||t instanceof B)&&s&&Qe(t)){for(var o=t.ports,h=!1,l=0;l<o.length;l++)a=this.getWrapper(t.wrapper,o[parseInt(l.toString(),10)].id),(i&zt.Hover||i&zt.Connect)&&ci(o[parseInt(l.toString(),10)],i)&&(a.visible=!r,h=!0);h&&this.updateDiagramObject(t),this.mode==="Canvas"&&this.refreshCanvasLayers()}},e.prototype.refreshSvgDiagramLayer=function(t){var i,r=document.getElementById(t.element.id+"_diagramLayer"),a=ti(t.element.id);if(Le(this))this.scroller.virtualizeElements();else{for(var s=0;s<this.basicElements.length;s++)i=this.basicElements[parseInt(s.toString(),10)],i.measure(new U(i.width,i.height)),i.arrange(i.desiredSize,!(this.diagramActions&k.Render)),this.diagramRenderer.renderElement(i,r,a);this.renderDiagramElements(r,this.diagramRenderer,a)}},e.prototype.removeVirtualObjects=function(t){if(this.deleteVirtualObject){this.preventOverviewRefresh=!0;for(var i=0;i<this.scroller.removeCollection.length;i++){var r=this.nameTable[this.scroller.removeCollection[parseInt(i.toString(),10)]];r!==void 0&&this.removeElements(r)}this.deleteVirtualObject=!1,this.preventOverviewRefresh=!1}clearInterval(t)},e.prototype.updateTextElementValue=function(t){for(var i=0;i<t.wrapper.children.length;i++){var r=t.wrapper.children[parseInt(i.toString(),10)];if(r instanceof Tt){r.canMeasure=!0;var a=this.scroller.viewPortHeight,s=this.scroller.viewPortWidth,o=!1;t.offsetX<s&&t.offsetY<a&&(o=!0),o&&Le(this)&&r.actualSize.height===void 0&&r.actualSize.width===void 0&&(t.wrapper.measure(new U(t.width,t.height),t.id,this.onLoadImageSize.bind(this)),t.wrapper.arrange(t.wrapper.desiredSize)),r.measure(new U(t.width,t.height)),r.arrange(r.desiredSize)}}},e.prototype.updateVirtualObjects=function(t,i,r){var a=document.getElementById(this.element.id+"_diagramLayer"),s=ti(this.element.id);if(this.mode==="SVG"){for(var o=0;o<t.length;o++){var h=this.scroller.removeCollection.indexOf(t[parseInt(o.toString(),10)]);h>=0&&this.scroller.removeCollection.splice(h,1);var l=this.nameTable[t[parseInt(o.toString(),10)]];this.updateTextElementValue(l),this.diagramRenderer.renderElement(l.wrapper,a,s,void 0,void 0,void 0,void 0,l.zIndex)}for(var d=0;d<r.length;d++)this.scroller.removeCollection.push(r[parseInt(d.toString(),10)]);this.scroller.currentZoom!==1&&this.eventHandler.updateVirtualization()}else this.diagramActions&&this.refreshDiagramLayer()},e.prototype.renderDiagramElements=function(t,i,r,a,s,o,h){a===void 0&&(a=!0);var l=this.scroller.getPageBounds();l.x*=this.scroller.currentZoom,l.y*=this.scroller.currentZoom,l.width*=this.scroller.currentZoom,l.height*=this.scroller.currentZoom;for(var d=-this.scroller.horizontalOffset-l.x,f=-this.scroller.verticalOffset-l.y,p,c=0,u=Object.keys(this.layerZIndexTable);c<u.length;c++){var g=u[c],v=this.commandHandler.getLayer(this.layerZIndexTable[""+g]),m=void 0,y=void 0;this.mode==="Canvas"&&Le(this)&&!this.diagramActions&&this.scroller.virtualizeElements();var S=this.mode==="Canvas"&&Le(this)&&this.scroller.oldCollectionObjects.length>0?this.scroller.oldCollectionObjects:void 0,x=Object.keys(S||v.zIndexTable);x.sort(function(N,H){return parseInt(""+N,10)-parseInt(""+H,10)});for(var I=0,C=x;I<C.length;I++){var P=C[I],A=S?this.nameTable[S[""+P]]:this.nameTable[v.zIndexTable[""+P]];if(A&&!A.parentId&&v.visible&&(!A.processId||this.refreshing)){var T=void 0;if(this.scroller.currentZoom<1&&this.mode==="SVG"?T={tx:-l.x/this.scroller.currentZoom,ty:-l.y/this.scroller.currentZoom,scale:this.scroller.transform.scale}:T={tx:this.scroller.transform.tx,ty:this.scroller.transform.ty,scale:this.scroller.transform.scale},(o||h)&&(T={tx:-l.x/this.scroller.currentZoom,ty:-l.y/this.scroller.currentZoom,scale:this.scroller.transform.scale}),Le(this)){if(this.scroller.currentZoom<1){if(l.x<0||this.scroller.horizontalOffset<0){var z=this.scroller.verticalOffset<0?this.scroller.verticalOffset:0;m=(d>0?d:0)+"px",y=(this.realActions&Vt.vScrollbarMoved?0:-z)+"px"}else m="0px",y="0px";this.realActions&Vt.hScrollbarMoved&&(this.realActions=this.realActions&~Vt.hScrollbarMoved),this.realActions&Vt.vScrollbarMoved&&(this.realActions=this.realActions&~Vt.vScrollbarMoved)}else m=(l.x<0?d:-this.scroller.horizontalOffset)+"px",y=(l.y<0?f:-this.scroller.verticalOffset)+"px";this.diagramLayer.style.left=m,this.diagramLayer.style.top=y,T.tx=-l.x/T.scale,T.ty=-l.y/T.scale}var L=!0;if(s&&(L=!1),this.updateTextElementValue(A),this.refreshing&&A.shape.activity&&A.shape.activity.subProcess&&A.shape.activity.subProcess.processes){for(var R=0;R<A.shape.activity.subProcess.processes.length;R++){var O=A.shape.activity.subProcess.processes[parseInt(R.toString(),10)];A.wrapper.children.push(this.nameTable[""+O].wrapper)}A.wrapper.measure(new U(A.wrapper.bounds.width,A.wrapper.bounds.height)),A.wrapper.arrange(A.wrapper.desiredSize)}A instanceof B&&A.type==="Bezier"?(p=this.getMidPoint(A),this.mode==="Canvas"&&a&&(p.cx+=T.tx,p.cy+=T.ty)):p=null,i.renderElement(A.wrapper,t,r,!i.isSvgMode&&a?T:void 0,void 0,void 0,L&&(!this.diagramActions||h),void 0,void 0,p,this.portCenterPoint)}}}},e.prototype.updateBridging=function(t){if(this.bridgingModule)for(var i=0;i<this.connectors.length;i++){var r=this.connectors[parseInt(i.toString(),10)];this.bridgingModule.updateBridging(r,this);var a=this.connectors[parseInt(i.toString(),10)].wrapper;if(a&&a.children&&a.children.length>0){var s=a.children[0],o=s.data;(r.isBezierEditing&&this.selectedItems.connectors[0].id===r.id||r.type!=="Bezier")&&(this.updateQuad(r),r.getSegmentElement(r,s,this.layout.type==="ComplexHierarchicalTree"||this.layout.type==="HierarchicalTree"?this.layout.orientation:void 0,void 0,!1)),s.data!==o&&(a.measure(new U),a.arrange(a.desiredSize),this.mode==="SVG"&&!t&&this.updateDiagramObject(r))}}else this.constraints&lt.Bridging&&console.warn('[WARNING] :: Module "ConnectorBridging" is not available in Diagram component! You either misspelled the module name or forgot to load it.')},e.prototype.setCursor=function(t){this.diagramRenderer.setCursor(this.diagramCanvas,t)},e.prototype.clearCanvas=function(t){var i=t.contentWidth||t.diagramLayer.width/this.scroller.currentZoom,r=t.contentHeight||t.diagramLayer.height/this.scroller.currentZoom;if(t.mode!=="SVG"){var a=nr.getContext(t.diagramLayer);a.clearRect(0,0,i,r)}},e.prototype.updateScrollOffset=function(){this.scroller.setScrollOffset(this.diagramCanvas.scrollLeft,this.diagramCanvas.scrollTop),Ja(this),Le(this)&&this.scroller.virtualizeElements()},e.prototype.setOffset=function(t,i){var r=this.element.id+"content",a=window.domTable;if(!a[""+r]){var s=document.getElementById(r);s&&(a[""+r]=s)}var o=a[""+r];o&&(o.scrollLeft!==t&&(o.scrollLeft=t),o.scrollTop!==i&&(o.scrollTop=i))},e.prototype.setSize=function(t,i){if(this.diagramLayer&&!this.preventDiagramUpdate){var r=Mi(this);t-=r.width,i-=r.height;var a=this.spatialSearch.getPageBounds();a.x*=this.scroller.currentZoom,a.y*=this.scroller.currentZoom,a.width*=this.scroller.currentZoom,a.height*=this.scroller.currentZoom;var s=this.mode==="SVG"?1:1.5,o=this.mode==="SVG"?Ef(this.element.id):this.diagramLayer,h=this.mode==="Canvas"&&this.constraints&lt.Virtualization?this.scroller.viewPortWidth:t,l=this.mode==="Canvas"&&this.constraints&lt.Virtualization?this.scroller.viewPortHeight:i;o.setAttribute("width",(s*h).toString()),o.setAttribute("height",(s*l).toString());var d=document.getElementById(this.element.id+"_diagramUserHandleLayer");d&&(d.style.width=t+"px",d.style.height=i+"px");var f={width:t.toString(),height:i.toString()};this.diagramLayerDiv.style.width=t+"px",this.diagramLayerDiv.style.height=i+"px",Et(Df(this.element.id),f),Et(zy(this.element.id),f);var p=Vi(this.element.id);Et(p,f),p.parentNode.style.width=t+"px",p.parentNode.style.height=i+"px";var c=Mr(this.element.id);Et(c,f),this.diagramRenderer.updateGrid(this.snapSettings,c,this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),Et(gh(this.element.id),f),this.htmlLayer.style.width=t+"px",this.htmlLayer.style.height=i+"px",this.mode!=="SVG"&&!Le(this)&&this.refreshDiagramLayer(),this.mode==="SVG"&&Le(this)&&this.scroller.virtualizeElements()}},e.prototype.transformLayers=function(){var t=this.spatialSearch.getPageBounds();t.x*=this.scroller.currentZoom,t.y*=this.scroller.currentZoom,t.width*=this.scroller.currentZoom,t.height*=this.scroller.currentZoom,this.diagramRenderer.updateGrid(this.snapSettings,Mr(this.element.id),this.scroller.transform,this.rulerSettings,this.hRuler,this.vRuler),this.diagramRenderer.transformLayers(this.scroller.transform,this.mode==="SVG"),this.diagramActions&k.DragUsingMouse||this.updateSelector(),this.renderPageBreaks(t)},e.prototype.removePageBreaks=function(){if(this.diagramLayer){var t=Cl(this.element.id);if(t&&t.childNodes)for(var i=t.childNodes.length,r=0;r<i;r++)t.removeChild(t.childNodes[0])}},e.prototype.renderPageBreaks=function(t){this.removePageBreaks();var i=Cl(this.element.id);if(i){var r=0;t=this.scroller.getPageBounds(!0);var a=(this.scroller.transform.tx+t.x)*this.scroller.currentZoom,s=(this.scroller.transform.ty+t.y)*this.scroller.currentZoom,o=t.height*this.scroller.currentZoom,h=t.width*this.scroller.currentZoom;on.renderSvgBackGroundImage(this.pageSettings.background,this.element,a,s,h,o);var l={id:i.id+"rect",x:a,y:s,height:o,width:h,angle:0,stroke:"",strokeWidth:1,fill:this.pageSettings.background.color,opacity:1,pivotX:0,pivotY:0,visible:!0,dashArray:"0"};if(this.diagramRenderer.drawRect(i,l),this.pageSettings.showPageBreaks){var d=this.scroller.getPageBreak(t);for(r=0;r<d.length;r++)this.diagramRenderer.drawLine(i,{class:"e-diagram-page-break",fill:"none",stroke:"#aaaaaa",strokeWidth:1,dashArray:"10 10",opacity:2,x:0,y:0,width:0,height:0,angle:0,pivotX:0,pivotY:0,visible:!0,startPoint:{x:(d[parseInt(r.toString(),10)].x1+this.scroller.transform.tx)*this.scroller.currentZoom,y:(d[parseInt(r.toString(),10)].y1+this.scroller.transform.ty)*this.scroller.currentZoom},endPoint:{x:(d[parseInt(r.toString(),10)].x2+this.scroller.transform.tx)*this.scroller.currentZoom,y:(d[parseInt(r.toString(),10)].y2+this.scroller.transform.ty)*this.scroller.currentZoom},id:d[parseInt(r.toString(),10)].y1===d[parseInt(r.toString(),10)].y2?"HorizontalLines":"VerticalLines"})}}},e.prototype.validatePageSize=function(){var t=0;this.pageSettings.orientation==="Portrait"?this.pageSettings.width>this.pageSettings.height&&(t=this.pageSettings.height,this.pageSettings.height=this.pageSettings.width,this.pageSettings.width=t):this.pageSettings.height>this.pageSettings.width&&(t=this.pageSettings.width,this.pageSettings.width=this.pageSettings.height,this.pageSettings.height=t)},e.prototype.setOverview=function(t,i){if(t)t&&(this.views.push(t.id),this.views[t.id]=t,this.overviewObject={id:t.id,view:t},t.renderDocument(t),t.diagramRenderer.setLayers(),t.initializeOverviewLayers(),t.updateView(t),this.renderNodes(t));else{for(var r=0;r<this.views.length;r++)this.views[parseInt(r.toString(),10)]===i&&(t=this.views[""+i]);this.views[""+i]=void 0;var a=this.views.indexOf(i);a>=0&&this.views.splice(a,1)}},e.prototype.renderNodes=function(t){if(t){var i=new on(t.id,new ln,!1),r=document.getElementById(t.element.id+"_diagramLayer"),a=ti(t.element.id);this.renderDiagramElements(r,t.diagramRenderer||i,a,void 0,void 0,void 0,!0)}},e.prototype.updateThumbConstraints=function(t,i,r){for(var a=t.length,s=0;s<a;s++){var o=t[parseInt(s.toString(),10)],h=!1,l=!1,d=i.thumbsConstraints,f=!1;if(this.nameTable[o.parentId]){var p=this.nameTable[o.parentId];f=p.isLane}o instanceof M?(h=o.shape.type==="Bpmn"&&o.shape.shape==="Activity"&&o.shape.activity.subProcess.collapsed===!1||o.shape.type==="SwimLane"||f,(!Va(o)||!(d&gt.Rotate)||h)&&(d=d&~gt.Rotate),(!Wi(o,"SouthEast")||!(d&gt.ResizeSouthEast)||l)&&(d=d&~gt.ResizeSouthEast),(!Wi(o,"NorthWest")||!(d&gt.ResizeNorthWest)||l)&&(d=d&~gt.ResizeNorthWest),(!Wi(o,"East")||!(d&gt.ResizeEast)||l)&&(d=d&~gt.ResizeEast),(!Wi(o,"West")||!(d&gt.ResizeWest)||l)&&(d=d&~gt.ResizeWest),(!Wi(o,"North")||!(d&gt.ResizeNorth)||l)&&(d=d&~gt.ResizeNorth),(!Wi(o,"South")||!(d&gt.ResizeSouth)||l)&&(d=d&~gt.ResizeSouth),(!Wi(o,"NorthEast")||!(d&gt.ResizeNorthEast)||l)&&(d=d&~gt.ResizeNorthEast),(!Wi(o,"SouthWest")||!(d&gt.ResizeSouthWest)||l)&&(d=d&~gt.ResizeSouthWest)):o instanceof B?(r||(d=d|gt.Default),Ya(o)?d=d|gt.ConnectorSource:d=d&~gt.ConnectorSource,Ua(o)?d=d|gt.ConnectorTarget:d=d&~gt.ConnectorTarget):(r||(d=d|gt.Default),Wi(o)||(d=d&~(gt.ResizeSouthEast|gt.ResizeSouthWest|gt.ResizeSouth|gt.ResizeEast|gt.ResizeWest|gt.ResizeNorth|gt.ResizeNorthEast|gt.ResizeNorthWest)),Va(o)||(d=d&~gt.Rotate)),i.thumbsConstraints=d}},e.prototype.renderSelector=function(t,i,r){var a=this.isProtectedOnChange,s=new U,o=this.selectedItems;o.constraints;var h=this.diagramRenderer.rendererActions;if(document.getElementsByClassName("blazor-inner-template"),this.diagramRenderer.rendererActions=this.currentSymbol?this.addConstraints(h,fi.DrawSelectorBorder):this.removeConstraints(h,fi.DrawSelectorBorder),this.clearSelectorLayer(),this.commandHandler.hasSelection()){if(o.nodes.length===1&&o.connectors.length===0&&(o.rotateAngle=o.nodes[0].rotateAngle,o.pivot=o.nodes[0].pivot),o.wrapper.measure(s),o.wrapper.arrange(o.wrapper.desiredSize),o.width=o.wrapper.actualSize.width,o.height=o.wrapper.actualSize.height,o.offsetX=o.wrapper.offsetX,o.offsetY=o.wrapper.offsetY,o.rotateAngle!==0){for(var l=0,d=o.nodes;l<d.length;l++){var f=d[l];f.offsetX=f.wrapper.offsetX,f.offsetY=f.wrapper.offsetY}for(var p=0,c=o.connectors;p<c.length;p++)c[p]}this.spatialSearch.getPageBounds();var u=Ln(this.element.id),g=$s(this.element.id);if(o.thumbsConstraints=gt.Default,o.annotation?this.updateThumbConstraints([o.annotation],o):(this.updateThumbConstraints(o.nodes,o),this.updateThumbConstraints(o.connectors,o,!0)),o.annotation)this.renderSelectorForAnnotation(o,u);else if(o.nodes.length+o.connectors.length===1||this.nameTable.helper){if(o.nodes[0]instanceof M){var v=o.nodes[0];ne(this,v)&&!i&&v.shape.type!=="UmlClassifier"&&!(v.parentId&&this.nameTable[v.parentId]&&this.nameTable[v.parentId].shape.type==="UmlClassifier")&&(o.thumbsConstraints&=~gt.Rotate);var m=i?!0:!!(v.constraints&W.HideThumbs),y=!!(v.shape.type==="SwimLane"||v.isLane||v.isPhase||i);this.diagramRenderer.renderResizeHandle(i?r:o.wrapper.children[0],u,o.thumbsConstraints,this.scroller.currentZoom,o.constraints,this.scroller.transform,void 0,Qe(v),m,y,o.handleSize)}else if(o.connectors[0]instanceof B&&Za(this.diagramRenderer.rendererActions)){var S=o.connectors[0];this.diagramRenderer.renderEndPointHandle(S,u,o.thumbsConstraints,o.constraints,this.scroller.transform,S.sourceWrapper!==void 0,S.targetWrapper!==void 0,!!(this.connectorEditingToolModule&&Fa(S)),!!this.connectorEditingToolModule,o.handleSize)}}else this.diagramRenderer.renderResizeHandle(o.wrapper,u,o.thumbsConstraints,this.scroller.currentZoom,o.constraints,this.scroller.transform,void 0,Qe(o),null,null,o.handleSize);!o.annotation&&!this.currentSymbol&&this.diagramRenderer.renderUserHandler(o,u,this.scroller.transform,g,this.eventHandler.currentAction,this.eventHandler.inAction)}this.selectedItems.selectedObjects.length>1&&this.updateSelectionRectangle(),this.isProtectedOnChange=a},e.prototype.updateSelectionRectangle=function(){for(var t=Ln(this.element.id),i=!1,r=0;r<this.selectedItems.selectedObjects.length;r++)i=r===0,Fe(this.selectedItems.selectedObjects[parseInt(r.toString(),10)])===B?this.diagramRenderer.renderSelectionLine(this.selectedItems.selectedObjects[parseInt(r.toString(),10)].wrapper.children[0],t,this.scroller.transform,i):this.diagramRenderer.renderSelectionRectangle(this.selectedItems.selectedObjects[parseInt(r.toString(),10)].wrapper,t,this.scroller.transform,i)},e.prototype.updateSelector=function(){var t=this.allowServerDataBinding;this.enableServerDataBinding(!1);var i=new U,r=this.selectedItems,a=r.constraints;if(document.getElementsByClassName("blazor-inner-template"),!(this.diagramActions&k.ToolAction)&&this.selectedItems.nodes.length===1&&(this.selectedItems.rotateAngle=this.selectedItems.nodes[0].rotateAngle,this.selectedItems.wrapper.rotateAngle=this.selectedItems.nodes[0].rotateAngle),this.selectedItems!==void 0&&(this.clearSelectorLayer(),r.wrapper!==null&&r.wrapper.children&&r.wrapper.children.length)){var s=!0,o=!0;if(r.wrapper.rotateAngle=r.rotateAngle,kn(this,r)){var h="eventHandler",l=this[""+h].action,d=l.includes("Rotate"),f=l.includes("None")||l.includes("Select")||l.includes("Drag");(d||f)&&(o=!1),f||(s=!1)}if(s&&(r.wrapper.measure(i),r.wrapper.arrange(r.wrapper.desiredSize)),r.rotateAngle!==0||r.rotateAngle!==r.wrapper.prevRotateAngle)for(var p=0,c=r.nodes;p<c.length;p++){var u=c[p];u.offsetX=u.wrapper.offsetX,u.offsetY=u.wrapper.offsetY}r.width=r.wrapper.actualSize.width,r.height=r.wrapper.actualSize.height,r.offsetX=r.wrapper.offsetX,r.offsetY=r.wrapper.offsetY;var g=Ln(this.element.id),v=$s(this.element.id),m=this.eventHandler.canHideResizers();if(r.thumbsConstraints=gt.Default,r.annotation?this.updateThumbConstraints([r.annotation],r):(this.updateThumbConstraints(r.nodes,r),this.updateThumbConstraints(r.connectors,r,!0)),this.selectedItems.constraints&Ae.UserHandle&&!r.annotation&&!this.currentSymbol&&this.diagramRenderer.renderUserHandler(r,g,this.scroller.transform,v,this.eventHandler.currentAction,this.eventHandler.inAction),r.annotation)this.renderSelectorForAnnotation(r,g);else if(r.nodes.length+r.connectors.length===1){if(r.connectors[0]instanceof B&&Za(this.diagramRenderer.rendererActions)){var y=r.connectors[0];this.diagramRenderer.renderEndPointHandle(y,g,r.thumbsConstraints,a,this.scroller.transform,y.sourceWrapper!==void 0,y.targetWrapper!==void 0,!!(this.connectorEditingToolModule&&Fa(y)),!!this.connectorEditingToolModule,r.handleSize)}else if(r.nodes[0]instanceof M){var S=r.nodes[0];ne(this,r.nodes[0])&&S.shape.type!=="UmlClassifier"&&!(S.parentId&&this.nameTable[S.parentId]&&this.nameTable[S.parentId].shape.type==="UmlClassifier")&&(r.thumbsConstraints&=~gt.Rotate);var x=!!(S.shape.type==="SwimLane"||S.isLane||S.isPhase);this.diagramRenderer.renderResizeHandle(r.wrapper.children[0],g,r.thumbsConstraints,this.scroller.currentZoom,r.constraints,this.scroller.transform,m,Qe(r.nodes[0]),!!(r.nodes[0].constraints&W.HideThumbs),x,r.handleSize)}}else this.diagramActions&k.Interactions&&(this.diagramRenderer.rendererActions=this.diagramRenderer.rendererActions|fi.PreventRenderSelector),kn(this,r)&&o||this.diagramRenderer.renderResizeHandle(r.wrapper,g,r.thumbsConstraints,this.scroller.currentZoom,r.constraints,this.scroller.transform,m,Qe(r),null,null,r.handleSize),this.diagramRenderer.rendererActions=this.diagramRenderer.rendererActions&~fi.PreventRenderSelector}this.selectedItems.selectedObjects.length>1&&this.updateSelectionRectangle(),this.enableServerDataBinding(t)},e.prototype.renderSelectorForAnnotation=function(t,i){this.diagramRenderer.renderResizeHandle(t.wrapper.children[0],i,t.thumbsConstraints,this.scroller.currentZoom,t.constraints,this.scroller.transform,void 0,Qe(t.annotation),void 0,void 0,t.handleSize)},e.prototype.drawSelectionRectangle=function(t,i,r,a){this.clearSelectorLayer(),this.diagramRenderer.drawSelectionRectangle(t,i,r,a,this.adornerLayer,this.scroller.transform)},e.prototype.renderHighlighter=function(t){var i=Vi(this.element.id);this.diagramRenderer.renderHighlighter(t,i,this.scroller.transform)},e.prototype.clearHighlighter=function(){var t=Vi(this.element.id),i=t.getElementById(t.id+"_highlighter");i&&i.parentNode.removeChild(i)},e.prototype.getNodesConnectors=function(t){for(var i=0;i<this.nodes.length;i++){var r=this.nodes[parseInt(i.toString(),10)];t.push(r)}for(var i=0;i<this.connectors.length;i++){var a=this.connectors[parseInt(i.toString(),10)];t.push(a)}return t},e.prototype.clearSelectorLayer=function(){var t=Vi(this.element.id);document.getElementsByClassName("blazor-inner-template");var i;if(this.currentSymbol){var d=t.getElementById("borderRect_symbol");d&&d.parentNode.removeChild(d)}else{var r=t.getElementById(this.adornerLayer.id+"_selected_region");r&&r.parentNode.removeChild(r),this.clearHighlighter();var a=Ln(this.element.id).childNodes,s=void 0,o=this.eventHandler.touchArgs?this.eventHandler.touchArgs.target.id:void 0;o&&o.includes("bezierLine")&&(o=void 0);for(var h=a.length;h>0;h--)this.eventHandler&&this.eventHandler.touchArgs&&this.eventHandler.touchArgs.type==="touchmove"?(this.diagramRenderer.touchMove=!0,o&&o===a[h-1].id||(s=a[h-1],s.parentNode.removeChild(s))):(s=a[h-1],s.parentNode.removeChild(s));{var l=$s(this.element.id).childNodes;for(i=l.length;i>0;i--)l[i-1].parentNode.removeChild(l[i-1])}}},e.prototype.getWrapper=function(t,i){var r;i=t.id+"_"+i;for(var a=t instanceof Ht?t:this.getPortContainer(this.nameTable[t.id]),s=0;s<a.children.length;s++)i===a.children[parseInt(s.toString(),10)].id&&(r=a.children[parseInt(s.toString(),10)]);return r},e.prototype.getEndNodeWrapper=function(t,i,r){if(t.shape.type==="Bpmn"&&t.wrapper.children[0]instanceof Ht){if(t.shape.shape==="Activity"){if(r&&t.shape.activity.subProcess.type==="Transaction"&&i.sourcePortID){var a=i.sourcePortID,s=t.wrapper.children[0].children[0].children[2];if(s.children)for(var o=0,h=s.children;o<h.length;o++){var l=h[o];if(l.visible&&l.id===t.id+"_"+a)return l.children[0]}}return t.wrapper.children[0].children[0].children[0]}return t.shape.shape==="Group"?t.wrapper.children[0]:t.wrapper.children[0].children[0]}var d=t.wrapper.children[0];return d&&!this.containsMargin(d)&&(!t.children||t.children.length===0)?d:t.wrapper},e.prototype.containsMargin=function(t){return t.margin&&(t.margin.left!==0||t.margin.top!==0||t.margin.right!==0||t.margin.bottom!==0)},e.prototype.focusOutEdit=function(){this.endEdit(),this.mode==="Canvas"&&this.scroller.currentZoom!==1&&this.refreshDiagramLayer()},e.prototype.endEditCommand=function(){this.endEdit(),this.textEditing=!1,this.mode==="Canvas"&&this.scroller.currentZoom!==1&&this.refreshDiagramLayer()},e.prototype.fontStyleCommand=function(t){for(var i=0;i<this.selectedItems.nodes.length;i++){var r=this.selectedItems.nodes[parseInt(i.toString(),10)];if(r.shape.type==="SwimLane"&&r.shape.hasHeader&&this.applyStyleText(t,r.shape.header.annotation),r.isLane){var a=this.getObject(r.shape.header[0].id);this.applyStyle(t,a.annotations)}if(r.shape.type==="Text"){var s=r;this.applyStyleText(t,s)}if(r.annotations.length>0){var o=r.annotations;this.applyStyle(t,o)}}for(var i=0;i<this.selectedItems.connectors.length;i++)if(this.selectedItems.connectors[parseInt(i.toString(),10)].annotations.length>0){var o=this.selectedItems.connectors[parseInt(i.toString(),10)].annotations;this.applyStyle(t,o)}},e.prototype.applyStyle=function(t,i){for(var r=0;r<i.length;r++)switch(t){case"bold":i[parseInt(r.toString(),10)].style.bold=!i[parseInt(r.toString(),10)].style.bold;break;case"italic":i[parseInt(r.toString(),10)].style.italic=!i[parseInt(r.toString(),10)].style.italic;break;case"underline":i[parseInt(r.toString(),10)].style.textDecoration==="None"?i[parseInt(r.toString(),10)].style.textDecoration="Underline":i[parseInt(r.toString(),10)].style.textDecoration==="Underline"&&(i[parseInt(r.toString(),10)].style.textDecoration="None");break}this.dataBind()},e.prototype.applyStyleText=function(t,i){switch(t){case"bold":i.style.bold=!i.style.bold;break;case"italic":i.style.italic=!i.style.italic;break;case"underline":i.style.textDecoration==="None"?i.style.textDecoration="Underline":i.style.textDecoration==="Underline"&&(i.style.textDecoration="None");break}this.dataBind()},e.prototype.duplicateCommand=function(){var t=[];t=t.concat(this.selectedItems.nodes,this.selectedItems.connectors),this.copy(),this.paste()},e.prototype.groupCommand=function(t){switch(t){case"group":this.group();break;case"ungroup":this.unGroup();break}},e.prototype.rotateCommand=function(t){var i=this.selectedItems;switch(t){case"clockwise":this.rotate(i,90);break;case"antiClockwise":this.rotate(i,-90);break}},e.prototype.flipCommand=function(t){var i=[];i=i.concat(this.selectedItems.nodes,this.selectedItems.connectors);for(var r=0;r<i.length;r++)switch(t){case"horizontal":i[parseInt(r.toString(),10)].flip=G.Horizontal;break;case"vertical":i[parseInt(r.toString(),10)].flip=G.Vertical;break}this.dataBind()},e.prototype.toolCommand=function(t){switch(t){case"pointer":{this.tool=Gt.Default,this.dataBind();break}case"text":{var i={shape:{type:"Text"}};this.drawingObject=i,this.tool=Gt.DrawOnce,this.dataBind();break}case"connect":{var r={id:"connector1",type:"Straight"};this.drawingObject=r,this.tool=Gt.DrawOnce,this.dataBind();break}case"freeForm":{var a={id:"connector1",type:"Freehand"};this.drawingObject=a,this.tool=Gt.DrawOnce,this.dataBind();break}case"line":{var s={id:"connector1",type:"Polyline"};this.drawingObject=s,this.tool=Gt.DrawOnce,this.dataBind();break}case"rectangle":{var o={type:"Basic",shape:"Rectangle"},h={shape:o};this.drawingObject=h,this.tool=Gt.DrawOnce,this.dataBind();break}case"ellipse":{var l={type:"Basic",shape:"Ellipse"},d={shape:l};this.drawingObject=d,this.tool=Gt.DrawOnce,this.dataBind();break}}},e.prototype.zoomCommand=function(t){switch(t){case"zoomIn":this.zoomTo({type:"ZoomIn",zoomFactor:.2});break;case"zoomOut":this.zoomTo({type:"ZoomOut",zoomFactor:.2});break}},e.prototype.shiftCommand=function(t){if(this.eventHandler.keyArgs&&this.eventHandler.keyArgs.keyModifiers!==void 0&&this.eventHandler.keyArgs.keyModifiers!==4)return null;if(this.selectedItems instanceof It&&this.selectedItems.wrapper&&this.constraints&lt.RestrictNegativeAxisDragDrop){var i=this.selectedItems.wrapper.bounds;if(i&&(t==="Left"&&i.x-5<0||t==="Top"&&i.y-5<0))return}var r=0,a=0,s=5,o;t==="Left"||t==="Right"?(o=t==="Left",r=o?-s:s):(o=t==="Up",a=o?-s:s);var h=this.selectedItems,l=this.selectedItems.wrapper.children[0];l instanceof Tt?this.commandHandler.labelDrag(h.nodes[0],l,r,a):this.drag(h,r,a);for(var d=0;d<this.selectedItems.connectors.length;d++){var f=this.selectedItems;t==="Up"?this.drag(f,0,-5):t==="Down"?this.drag(f,0,5):t==="Left"?this.drag(f,-5,0):t==="Right"&&this.drag(f,5,0)}},e.prototype.alignCommand=function(t){if(this.selectedItems.nodes.length>0)for(var i=0;i<this.selectedItems.nodes.length;i++)this.updateNodesAndConnectorAnnotation(this.selectedItems.nodes[parseInt(i.toString(),10)],t)},e.prototype.updateNodesAndConnectorAnnotation=function(t,i){for(var r,a=0;a<t.annotations.length;a++){switch(r=t.annotations[parseInt(a.toString(),10)],i){case"left":r.horizontalAlignment="Left";break;case"center":r.horizontalAlignment="Center";break;case"right":r.horizontalAlignment="Right";break;case"justify":r.style.textAlign="Justify";break;case"top":r.verticalAlignment="Top";break;case"centerVertical":r.verticalAlignment="Center";break;case"bottom":r.verticalAlignment="Bottom";break}this.dataBind()}},e.prototype.orderCommand=function(t){switch(t){case"sendToBack":this.sendToBack();break;case"bringToFront":this.bringToFront();break;case"sendBackward":this.sendBackward();break;case"bringForward":this.moveForward();break}},e.prototype.navigateItems=function(t){var i=0,r=this.activeLayer.objectZIndex,a=[],s=[];a=a.concat(this.selectedItems.nodes,this.selectedItems.connectors),s=s.concat(this.nodes,this.connectors),a.length>0?i=a[0].zIndex+(t?1:-1):i=t?0:r,i<0?i=r:i>r&&(i=0);var o=!1;do{for(var h=0;h<s.length;h++){var l=s[parseInt(h.toString(),10)];if(i===l.zIndex){this.clearSelection(),this.select([l]),o=!0;break}}o||(t?i++:i--)}while(!o&&s.length>0)},e.prototype.endEdit=function(){return In(this,void 0,void 0,function(){var t,i,r,a,s,o,h,l,d,f,u,p,c,u,g,v,m,y,S,x,I,C,P,A,T;return xn(this,function(z){if(this.diagramActions&k.TextEdit){t=void 0,i=void 0,r={},this.enableServerDataBinding(!1),a=document.getElementById(this.element.id+"_editBox");{if(s=a.value,J.remove(a,"input",this.eventHandler.inputChange),J.remove(a,"focusout",this.focusOutEdit),o=document.getElementById(this.element.id+"_editTextBoxDiv"),h=void 0,h=this.nameTable[this.activeLabel.parentId],l=vl(h,this.activeLabel.id),d={oldValue:this.activeLabel.text,newValue:s,cancel:!1,element:h,annotation:l},o.parentNode.removeChild(o),f=void 0,l&&!(l instanceof Ur)?(u=ja(h,l.id,!0),r[""+u]={content:l.content},t={annotations:r}):t={shape:{content:h.shape.content}},p=!1,this.eventHandler.currentAction==="Draw"&&(p=this.eventHandler.isAddTextNode(h,!0)),!p&&(o.textContent!==s||s!==this.activeLabel.text)&&this.triggerEvent(Z.textEdit,d),f||(f=this.getWrapper(h.wrapper,this.activeLabel.id)),c=!1,l&&l.content!==s&&!d.cancel&&(c=!0,this.activeLabel.isGroup||this.startGroupAction(),h.parentId&&this.nameTable[h.parentId].shape.type==="UmlClassifier"&&s.indexOf("+")===-1&&s.indexOf("-")===-1&&s.indexOf("#")===-1&&s.indexOf("~")===-1&&h.id.indexOf("_umlClass_header")===-1&&(s=" + "+s),(h.isLane||h.isPhase)&&this.protectPropertyChange(!0),l instanceof Ur?i={shape:{content:s}}:(u=ja(h,l.id,!0),g={},g[""+u]={content:s},i={annotations:g}),v=this.getIndex(h,h.id),v&&(m={},m[""+v]=t,y={},y[""+v]=i,Fe(h)===M?this.onPropertyChanged({nodes:y},{nodes:m}):this.onPropertyChanged({connectors:y},{connectors:m})),this.protectPropertyChange(!0),l.content=s,this.protectPropertyChange(!1),this.updateSelector(),(h.isLane||h.isPhase)&&this.protectPropertyChange(!1)),p&&(this.removeObjectsFromLayer(h),this.removeFromAQuad(h),delete this.nameTable[this.activeLabel.parentId],s!==""&&(this.clearSelection(),S=E(h),h=this.add(S),this.updateDiagramObject(h),this.commandHandler.oldSelectedObjects=es(this),this.commandHandler.select(this.nameTable[h.id]))),this.selectedItems.nodes.length){if(x=this.nameTable[this.activeLabel.parentId],I=this.nameTable[x.parentId],I&&I.shape.type==="SwimLane"||x.shape.type==="SwimLane")if(C="LaneHeaderParent",P="PhaseHeaderParent",x.shape.type==="SwimLane"&&(I=this.nameTable[this.activeLabel.parentId],x=h),x.isLane||x.isPhase)for(A=x.isLane?I.shape.lanes:I.shape.phases,T=0;T<A.length;T++)A[parseInt(T.toString(),10)].id===(x[""+C]||x[""+P])&&(A[parseInt(T.toString(),10)].header.annotation.content=x.annotations[0].content);else x.isHeader&&I.shape.hasHeader&&(I.shape.header.annotation.content=x.annotations[0].content);this.dataBind()}f.visible=!0,this.updateDiagramObject(h),this.diagramActions=this.diagramActions&~k.TextEdit,(this.activeLabel.isGroup||c)&&this.endGroupAction(),this.activeLabel={id:"",parentId:"",isGroup:!1,text:void 0},this.commandHandler.getBlazorOldValues(),this.enableServerDataBinding(!0)}}return[2]})})},e.prototype.getIndex=function(t,i){for(var r=Fe(t)===M?this.nodes:this.connectors,a=0;a<r.length;a++)if(r[parseInt(a.toString(),10)].id.toString()===i.toString())return a.toString();return null},e.prototype.canLogChange=function(){return!!(this.diagramActions&k.Render&&!(this.diagramActions&k.ToolAction)&&!(this.diagramActions&k.UndoRedo)&&!(this.diagramActions&k.PublicMethod))},e.prototype.modelChanged=function(t,i){return!!(t.connectors||i.connectors||t.nodes||i.connectors||t.pageSettings||i.pageSettings||t.bridgeDirection||i.bridgeDirection)},e.prototype.resetDiagramActions=function(t){var i=!!t;this.diagramActions&k.UndoRedo&&(!i||t===k.UndoRedo)&&(this.diagramActions=this.diagramActions&~k.UndoRedo),this.diagramActions&k.PublicMethod&&(!i||t===k.PublicMethod)&&(this.diagramActions=this.diagramActions&~k.PublicMethod)},e.prototype.removeNode=function(t,i){this.removeObjectsFromLayer(t),this.removeFromAQuad(this.nameTable[t.id]);var r=document.getElementById(t.id+"_groupElement");if(delete this.nameTable[t.id],t.children&&delete this.groupTable[t.id],this.nodes.splice(this.nodes.indexOf(t),1),r&&r.children&&r.children.length>0)for(var a=void 0,s=r.children.length-1;s>=0;s--){var o=r.children[parseInt(s.toString(),10)];i.length>0&&i.indexOf(o.id.split("_groupElement")[0])!==-1&&(a?r.parentNode.insertBefore(o,a):r.parentNode.insertBefore(o,r),a=o)}r&&r.parentNode.removeChild(r)},e.prototype.deleteGroup=function(t){var i=[],r=[];t.children&&(r=this.commandHandler.getChildren(t,i)),this.UpdateBlazorDiagramModelCollection(t);for(var a=0,s=r;a<s.length;a++){var o=s[a];o&&this.nameTable[o.id]&&this.remove(o)}},e.prototype.updateObject=function(t,i,r){if(!(this.diagramActions&k.ToolAction)){var a=t.wrapper.children[0].bounds,s=this.commandHandler.checkBoundaryConstraints(void 0,void 0,a,!0);if(!s)if(t instanceof M){for(var o=i,h=0,l=Object.keys(r);h<l.length;h++){var d=l[h];switch(d){case"width":t.width=o.width;break;case"height":t.height=o.height;break;case"offsetX":t.offsetX=o.offsetX;break;case"offsetY":t.offsetY=o.offsetY;break;case"rotateAngle":t.rotateAngle=o.rotateAngle;break}}this.nodePropertyChange(t,r,i)}else{for(var f=0,p=Object.keys(r);f<p.length;f++){var d=p[f],c=i,u=t.sourcePoint,g=t.targetPoint;switch(d){case"sourcePoint":u.x=c.sourcePoint.x||u.x,u.y=c.sourcePoint.y||u.y;break;case"targetPoint":g.x=c.targetPoint.x||g.x,g.y=c.targetPoint.y||g.y}}this.connectorPropertyChange(t,r,i)}}},e.prototype.nodePropertyChangeExtend=function(t,i,r,a){return r.style!==void 0&&t.shape.type!=="Bpmn"&&(ua(r.style,t.wrapper.children[0]),a=!0),r.shadow!==void 0&&(this.updateShadow(t.shadow,r.shadow),a=!0),r.constraints!==void 0&&(i.constraints&W.Select&&!(r.constraints&W.Select)&&Ut(this,t)?this.clearSelection():(this.updateThumbConstraints(this.selectedItems.nodes,this.selectedItems),this.updateSelector(),a=!0)),this.updateTextAnnotationInSwimlane(t,r),this.swimLaneNodePropertyChange(t,i,r,a),a},e.prototype.updateTextAnnotationInSwimlane=function(t,i){if(t.hasTextAnnotation&&this.isPositionUndo)for(var r=0;r<t.outEdges.length;r++){var a=this.nameTable[t.outEdges[parseInt(r.toString(),10)]];if(a.isBpmnAnnotationConnector){var s=this.nameTable[a.targetID];if(this.isProtectedOnChange=!0,t.laneMargin&&s){var o=t.margin.left-t.laneMargin.left,h=t.margin.top-t.laneMargin.top;s.margin.left+=o,s.margin.top+=h,s.offsetX+=o,s.offsetY+=h,s.wrapper.offsetX+=o,s.wrapper.offsetY+=h,s.wrapper.measure(new U(s.wrapper.width,s.wrapper.height)),s.wrapper.arrange(s.wrapper.desiredSize),this.updateDiagramObject(s)}this.isProtectedOnChange=!1}}},e.prototype.swimLaneNodePropertyChange=function(t,i,r,a){if((t.shape.type==="SwimLane"||t.shape.type==="Container")&&!this.currentSymbol){if(i.shape){var s=r.shape,o=t.shape,h=o.orientation==="Horizontal",l=o.padding,d=i.shape,f=t.wrapper.children[0],p=void 0,c=void 0,u=void 0;if(d.lanes||d.phases){if(d.lanes)for(var g=0,v=Object.keys(s.lanes);g<v.length;g++){var m=v[g],y=Number(m),S=d.lanes[parseInt(y.toString(),10)],x=void 0,I=s.lanes[parseInt(y.toString(),10)];if(I&&I.header&&(u=o.lanes[parseInt(y.toString(),10)].header.id,p=S.header,c=I.header,c.annotation&&c.annotation.content&&(this.nameTable[""+u].annotations[0].content=c.annotation.content),c.annotation&&c.annotation.style&&(this.nameTable[""+u].annotations[0].style=c.annotation.style),c.annotation&&c.annotation.offset&&(this.nameTable[""+u].annotations[0].offset=c.annotation.offset),this.nodePropertyChange(this.nameTable[""+u],p,c)),S.children){for(var C=0,P=Object.keys(S.children);C<P.length;C++){var A=P[C];u=o.lanes[parseInt(y.toString(),10)].children[Number(A)].id;var T=this.nameTable[""+u];p=S.children[Number(A)],c=I.children[Number(A)],this.nodePropertyChange(T,p,c);var z=this.nameTable[T.parentId];this.diagramActions&k.UndoRedo||(this.startGroupAction(),kr(z,t,T,this))}this.updateSelector()}S.width&&!h&&(x=o.phases&&o.phaseSize?y+1:y,f.updateColumnWidth(x,I.width,!0,l),this.updateDiagramElementQuad()),S.height&&h&&(x=o.header&&o.hasHeader?y+1:y,x+=o.phases&&o.phaseSize?1:0,f.updateRowHeight(x,I.height,!0,l),this.updateDiagramElementQuad())}if(s.phases)for(var L=0,R=Object.keys(s.phases);L<R.length;L++){var O=R[L],y=Number(O),N=s.phases[parseInt(y.toString(),10)],H=void 0,F=o.header&&o.hasHeader?1:0;if(N&&N.header&&(u=o.phases[parseInt(y.toString(),10)].header.id,p=d.phases[parseInt(y.toString(),10)].header,c=N.header,c.annotation&&c.annotation.content&&(this.nameTable[""+u].annotations[0].content=c.annotation.content),c.annotation&&c.annotation.style&&(this.nameTable[""+u].annotations[0].style=c.annotation.style),c.annotation&&c.annotation.offset&&(this.nameTable[""+u].annotations[0].offset=c.annotation.offset),this.nodePropertyChange(this.nameTable[""+u],p,c)),N.offset){if(y===0)H=N.offset;else{var Y=o.phases[y-1];H=N.offset-Y.offset,H<=0&&(H=N.offset)}h?(f.updateColumnWidth(y,H,!0,l),$a(t,this,f.rows[parseInt(F.toString(),10)].cells[parseInt(y.toString(),10)],y)):f.updateRowHeight(F+y,H,!0,l)}}}if(s.phaseSize!==void 0&&o.phases.length)if(s.phaseSize===0||d.phaseSize===0)if(d.phaseSize)h?(f.removeRow(o.header&&o.hasHeader?1:0),t.height=t.wrapper.height=f.height):(o.header&&o.hasHeader&&(f.rows[0].cells[1].children=f.rows[0].cells[0].children,f.rows[0].cells[1].columnSpan=f.rows[0].cells[0].columnSpan-1,f.rows[0].cells[0].children=[]),f.removeColumn(0));else{if(h){var et=new jn;et.height=s.phaseSize,f.addRow(o.header&&o.hasHeader?1:0,et,!0),t.height=t.wrapper.height+=s.phaseSize}else{var at=new Nr;at.width=s.phaseSize,f.addColumn(0,at,!0),o.header&&o.hasHeader&&(f.rows[0].cells[0].children=f.rows[0].cells[1].children,f.rows[0].cells[1].children=[],f.rows[0].cells[1].columnSpan=1,f.rows[0].cells[1].minWidth=void 0,f.rows[0].cells[0].columnSpan=o.lanes.length+1)}for(var tt=0;tt<o.phases.length;tt++)o.phases[parseInt(tt.toString(),10)].id===""&&(o.phases[parseInt(tt.toString(),10)].id=K()),qo(f,this,t,o.header&&o.hasHeader?1:0,h,tt)}else h?f.updateRowHeight(o.header&&o.hasHeader?1:0,s.phaseSize,!1):f.updateColumnWidth(0,s.phaseSize,!1);if(o.header&&o.hasHeader&&d.header){var nt;t.shape.type==="SwimLane"?nt=f.rows[0].cells[0].children[0].id:t.shape.type==="Container"&&(nt=f.children[1].id),c=s.header,p=d.header,c.annotation&&c.annotation.offset&&(this.nameTable[""+nt].annotations[0].offset=c.annotation.offset),this.nodePropertyChange(this.nameTable[""+nt],p,c)}t.height=f.height,t.width=f.width,t.shape.type==="SwimLane"&&(t.wrapper.height=f.height,t.wrapper.width=f.width)}else if(i.constraints){var wt=i.constraints&W.Select,$=r.constraints&W.Select;if(wt!==$){var s=t.shape,pt=this.nameTable[t.id+s.header.id];pt.constraints=$?pt.constraints|W.Select:pt.constraints&~W.Select;var rt=void 0;if(s.phaseSize>0)for(var mt=0;mt<s.phases.length;mt++)rt=this.nameTable[t.id+s.phases[parseInt(mt.toString(),10)].id+"_header"],rt.constraints=$?rt.constraints|W.Select:rt.constraints&~W.Select;for(var ct=void 0,Dt=void 0,Ge=s.phases.length||1,mt=0;mt<s.lanes.length;mt++)for(var Ce=0;Ce<Ge;Ce++)ct=this.nameTable[t.id+s.lanes[parseInt(mt.toString(),10)].id+Ce],ct.constraints=$?ct.constraints|W.Select:ct.constraints&~W.Select,Ce===0&&(Dt=this.nameTable[t.id+s.lanes[parseInt(mt.toString(),10)].id+"_"+Ce+"_header"],Dt.constraints=$?Dt.constraints|W.Select:Dt.constraints&~W.Select)}}a=!0}return a},e.prototype.insertValue=function(t,i){if(!(this.blazorActions&jt.GroupClipboardInProcess)){for(var r=void 0,a=i?this.oldNodeObjects:this.oldConnectorObjects,s=0;s<a.length;s++)a[parseInt(s.toString(),10)].id===t.id&&(r=!0);r||(i?this.oldNodeObjects.push(t):this.oldConnectorObjects.push(t))}},e.prototype.nodePropertyChange=function(t,i,r,a,s,o){var h=this;if(this.canEnableBlazorObject&&t.id!=="helper"){var l=E(t);this.insertValue(l,!0)}var d=t.wrapper.outerBounds,f=t.wrapper.bounds,p=!1,c,u,g=0,v=0,m=0,y=0,S=!1,x=!1,I=!1;if(r.width!==void 0&&(t.children?t.container?t.wrapper.width=r.width:this.scaleObject(t,r.width,!0):(t.wrapper.children[0].width=r.width,u=!0,p=!0,t.shape.type==="SwimLane"&&(t.wrapper.width=r.width)),S=!0),r.height!==void 0){if(t.children)t.container?t.wrapper.height=r.height:this.scaleObject(t,r.height,!1);else if(t.wrapper.children[0].height=r.height,u=!0,p=!0,t.shape.type==="SwimLane"&&(t.wrapper.height=r.height,t.shape.type==="SwimLane"&&this.isUndo)){var C=t.shape;if(C.header&&C.hasHeader){var P=t.wrapper.children[0],A=C.padding,T=i.height-r.height,z=P.rowDefinitions(),L=z.length-1,R=z[parseInt(L.toString(),10)].height-T;P.updateRowHeight(L,R,!0,A,!0)}}S=!0}if(u=this.nodePropertyChangeExtend(t,i,r,u),r.constraints!==void 0&&Ia(i)!==Ia(r)&&(t.wrapper.children[0].shadow=Ia(t)?t.shadow:null),r.offsetX!==void 0){if(g=i.offsetX,v=r.offsetX,t.wrapper.flip!==G.None)if(t.offsetX!==t.wrapper.offsetX&&i.offsetX!==void 0){var O=r.offsetX-i.offsetX;t.wrapper.offsetX=t.wrapper.offsetX+O,this.updateFlipOffset(t.wrapper,O,0,t.wrapper.flip)}else t.wrapper.offsetX=r.offsetX;else t.wrapper.offsetX=r.offsetX;u=!0,p=!0,x=!0}if(r.offsetY!==void 0){if(m=i.offsetY,y=r.offsetY,t.wrapper.flip!==G.None)if(t.offsetY!==t.wrapper.offsetY&&i.offsetY!==void 0){var N=r.offsetY-i.offsetY;t.wrapper.offsetY=t.wrapper.offsetY+N,this.updateFlipOffset(t.wrapper,0,N,t.wrapper.flip)}else t.wrapper.offsetY=r.offsetY;else t.wrapper.offsetY=r.offsetY;u=!0,p=!0,x=!0}if(r.padding!==void 0&&(t.wrapper.padding.left=r.padding.left!==void 0?r.padding.left:t.wrapper.padding.left,t.wrapper.padding.right=r.padding.right!==void 0?r.padding.right:t.wrapper.padding.right,t.wrapper.padding.top=r.padding.top!==void 0?r.padding.top:t.wrapper.padding.top,t.wrapper.padding.bottom=r.padding.bottom!==void 0?r.padding.bottom:t.wrapper.padding.bottom,u=!0),r.pivot!==void 0&&(t.wrapper.pivot=r.pivot,u=!0),r.minWidth!==void 0&&(t.wrapper.minWidth=t.wrapper.children[0].minWidth=r.minWidth,u=!0,p=!0,S=!0),r.minHeight!==void 0&&(t.wrapper.minHeight=t.wrapper.children[0].minHeight=r.minHeight,u=!0,p=!0,S=!0),r.maxWidth!==void 0&&(t.wrapper.maxWidth=r.maxWidth,u=!0,p=!0,S=!0),r.maxHeight!==void 0&&(t.wrapper.maxHeight=r.maxHeight,u=!0,p=!0,S=!0),this.isNotContainerOrSubProcess(t)&&this.isNotSwimlaneObject(t)){if(r.flip!==void 0){var H=(r.flip&G.Horizontal^t.wrapper.flip&G.Horizontal)===G.Horizontal,F=(r.flip&G.Vertical^t.wrapper.flip&G.Vertical)===G.Vertical;if(H&&(t.wrapper.flip^=G.Horizontal),F&&(t.wrapper.flip^=G.Vertical),u=!0,p=!0,t.children){var Y=t.children.filter(function(Sh){return h.nameTable[""+Sh]&&h.nameTable[""+Sh]instanceof B});Y&&Y.length>0?this.groupBounds=t.wrapper.bounds:this.groupBounds=null}else this.groupBounds=null;Ca(t.wrapper,t.offsetX,t.offsetY,this,void 0,H,F),H!==F&&X0(t,this),this.updateWrapperChildFlip(t)}if(r.flipMode!==void 0){var et="";et=t.wrapper.flipMode=r.flipMode,u=!0,p=!0,this.updateWrapperChildFlip(t,et)}}if(r.rotateAngle!==void 0&&t.constraints&W.Rotate&&(t.children&&s&&this.commandHandler.rotateObjects(t,[t],t.rotateAngle-t.wrapper.rotateAngle,{x:t.offsetX,y:t.offsetY},!1),t.wrapper.rotateAngle=r.rotateAngle,u=!0,p=!0,I=!0,t.processId||t.parentId&&this.nameTable[t.parentId].shape.type==="Container")){var at=E(t),tt=void 0;t.processId?tt=this.nameTable[t.processId]:tt=this.nameTable[t.parentId],at.margin.top=t.offsetY-t.actualSize.height/2-(tt.offsetY-tt.actualSize.height/2),at.margin.left=t.offsetX-t.actualSize.width/2-(tt.offsetX-tt.actualSize.width/2),(at.margin.left!==t.margin.left||at.margin.top!==t.margin.top)&&this.updateMargin(t,at)}if(r.backgroundColor!==void 0&&(t.wrapper.style.fill=r.backgroundColor),r.visible!==void 0&&this.updateElementVisibility(t.wrapper,t,t.visible),r.shape!==void 0&&t.shape.type!=="Bpmn"&&(u=!0,D0(r,t,i,this),p=!0),r.margin&&(u=!0,this.updateMargin(t,r),t.parentId&&this.nameTable[t.parentId].shape.type==="Container"&&ly(t,this),p=!0,x=!0),(r.shape!==void 0&&r.shape.type===void 0||r.width!==void 0||r.maxWidth!==void 0||r.minWidth!==void 0||r.maxHeight!==void 0||r.minHeight!==void 0||r.height!==void 0||r.style!==void 0)&&t.shape.type==="Bpmn"&&this.bpmnModule&&(u=!0,p=!0,this.bpmnModule.updateBPMN(r,i,t,this)),(r.width!==void 0||r.height!==void 0)&&t.shape.type==="Container"&&(u=!0,ay(r,i,t,t.wrapper.children[0],this)),r.style!==void 0&&t.shape.type==="Container"&&(u=!0,ua(r.style,t.wrapper.children[0].children[0])),t.shape.type==="UmlActivity"&&t.shape.shape==="FinalNode"&&(u=!0,p=!0,this.updateUMLActivity(r,i,t,this)),(t.shape&&t.shape.type==="UmlClassifier"||t.parentId&&this.nameTable[t.parentId]&&this.nameTable[t.parentId].shape.type==="UmlClassifier")&&(u=!0,p=!0),r.ports!==void 0)for(var nt=0,wt=Object.keys(r.ports);nt<wt.length;nt++){var $=wt[nt],pt=Number($);u=!0;var rt=r.ports[""+$],mt=t.ports[parseInt(pt.toString(),10)];this.updatePort(rt,mt,t.wrapper),t.flip!==G.None&&(t.flipMode==="Port"||t.flipMode==="PortAndLabel"||t.flipMode==="PortAndLabelText"||t.flipMode==="All")&&this.updatePorts(t,t.flip),p=!0}if(r.annotation!==void 0||r.annotations!==void 0||r.width!==void 0)for(var ct=0,Dt=Object.keys(r.annotations||t.annotations);ct<Dt.length;ct++){var $=Dt[ct],pt=Number($);u=!0;var rt=void 0;r.annotation?rt=r.annotation:rt=r.annotations?r.annotations[""+$]:t.annotations;var Ge=t.annotations[parseInt(pt.toString(),10)];if(Ge){var Ce=!!t.width;this.updateAnnotation(rt,Ge,t.wrapper,t,Ce);var ie=this.nameTable[t.parentId];if(ie&&ie.shape.type==="SwimLane"){var Oe="LaneHeaderParent",ni="PhaseHeaderParent";if(t.isLane||t.isPhase){for(var Ft=t.isLane?ie.shape.lanes:ie.shape.phases,ge=0;ge<Ft.length;ge++)if(Ft[parseInt(ge.toString(),10)].id===(t[""+Oe]||t[""+ni])){Ft[parseInt(ge.toString(),10)].header.annotation.content=t.annotations[0].content,Ft[parseInt(ge.toString(),10)].header.annotation.style=t.annotations[0].style,Ft[parseInt(ge.toString(),10)].header.annotation.offset.x=t.annotations[0].offset.x,Ft[parseInt(ge.toString(),10)].header.annotation.offset.y=t.annotations[0].offset.y,Ft[parseInt(ge.toString(),10)].header.annotation.width=t.annotations[0].width,Ft[parseInt(ge.toString(),10)].header.annotation.height=t.annotations[0].height;break}}else t.isHeader&&(ie.shape.header.annotation.offset.x=t.annotations[0].offset.x,ie.shape.header.annotation.offset.y=t.annotations[0].offset.y,ie.shape.header.annotation.rotateAngle=t.annotations[0].rotateAngle,ie.shape.header.annotation.width=t.annotations[0].width,ie.shape.header.annotation.height=t.annotations[0].height)}else if(ie&&ie.shape.type==="Container"&&t.isHeader){var Ze=ie.shape.header;Ze.annotation.content=t.annotations[0].content,Ze.annotation.offset=t.annotations[0].offset,Ze.annotation.width=t.annotations[0].width,Ze.annotation.height=t.annotations[0].height,Ze.annotation.rotateAngle=t.annotations[0].rotateAngle}}}if((r.expandIcon!==void 0||r.collapseIcon!==void 0||r.isExpanded!==void 0)&&(this.updateIcon(t),this.updateDefaultLayoutIcons(t),r.isExpanded!==void 0&&(this.canExpand=!0,this.diagramActions|=k.PreventIconsUpdate,this.commandHandler.expandNode(t,this),this.diagramActions=this.diagramActions&~k.PreventIconsUpdate),u=!0,this.canExpand=!1),r.fixedUserHandles!==void 0)for(var pt=void 0,rt=void 0,gi=void 0,Ji=0,Ar=Object.keys(r.fixedUserHandles);Ji<Ar.length;Ji++){var $=Ar[Ji];pt=Number($),u=!0,r.fixedUserHandles[parseInt(pt.toString(),10)]&&(rt=r.fixedUserHandles[parseInt(pt.toString(),10)]),gi=t.fixedUserHandles[parseInt(pt.toString(),10)],gi&&this.updateNodefixedUserHandle(rt,gi,t.wrapper,t)}if(r.tooltip!==void 0&&this.updateTooltip(t,r),u){if(this.bpmnModule!==void 0&&(x&&!S&&!this.sizeUndo||S&&t.shape.type==="Bpmn"&&t.shape.shape!=="TextAnnotation")&&!I&&this.updateBpmnAnnotationPosition(g,m,v,y,t,t.wrapper,t.shape,t.shape.shape==="TextAnnotation",i,S,this.sizeUndo),this.checkSelectedItem(t)&&t.wrapper.children[0]instanceof Tt&&t.wrapper.children[0].refreshTextElement(),t.wrapper.measure(new U(t.wrapper.bounds.width,t.wrapper.bounds.height),t.id,this.onLoadImageSize.bind(this)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateObject(t,i,r),t.shape.type==="SwimLane"&&!this.currentSymbol&&!(this.diagramActions&k.ToolAction)){Tr(this,t);var P=t.wrapper.children[0],vi=t.shape,_i=P.columnDefinitions().length;if(vi.orientation==="Horizontal"){var pt=vi.header&&vi.hasHeader?1:0;$a(t,this,P.rows[parseInt(pt.toString(),10)].cells[_i-1],_i-1)}t.wrapper.measure(new U(t.wrapper.bounds.width,t.wrapper.bounds.height)),t.wrapper.arrange(t.wrapper.desiredSize)}if((!(this.diagramActions&k.ToolAction)||this.diagramActions&k.UndoRedo)&&this.checkSelectedItem(t)&&this.updateSelector(),d.equals(d,t.wrapper.outerBounds)===!1&&(this.updateQuad(t),t.parentId&&this.nameTable[t.parentId])){var xs=this.nameTable[t.parentId];this.updateQuad(xs)}if(a?t&&t.visible&&t.outEdges&&this.updateIconVisibility(t,t.outEdges.length!==0):this.commandHandler.connectorSegmentChange(t,f,r.rotateAngle!==void 0),this.bpmnModule!==void 0&&this.bpmnModule.updateDocks(t,this),t.shape instanceof Sr&&as(t,this),(!r.annotations&&!t.isHeader||!t.processId&&!(t.parentId&&this.nameTable[t.parentId].shape.type==="Container"))&&r.flip===void 0&&this.updateGroupOffset(t),t.parentId&&this.nameTable[t.parentId]){var or=this.nameTable[t.parentId];or.wrapper.measure(new U(or.wrapper.width,t.wrapper.height)),or.wrapper.arrange(or.wrapper.desiredSize),or.offsetX=or.wrapper.offsetX,or.offsetY=or.wrapper.offsetY}else if(t.children)for(c=0;c<t.children.length;c++){var Cs=this.nameTable[t.children[parseInt(c.toString(),10)]];if(Cs&&Cs.children&&Cs.children.length>0){t.offsetX=t.wrapper.offsetX,t.offsetY=t.wrapper.offsetY;break}}if(f.equals(f,t.wrapper.bounds)===!1&&(this.eventHandler.currentAction!=="Drag"&&this.updateGroupSize(t),t.children&&this.updateGroupOffset(t)),t.shape.type==="SwimLane"&&!this.currentSymbol&&this.diagramActions&k.Render){var rp=sr(this,t.wrapper.children[0]);Pr(rp,this)}if(!this.preventNodesUpdate){if((!Le(this)||Le(this)&&this.scroller.oldCollectionObjects.indexOf(t.id)>-1)&&(this.diagramActions&k.PreventZIndexOnDragging?this.updateDiagramObject(t,!0):this.updateDiagramObject(t),t.parentId)){var ra=this.nameTable[t.parentId];ra.shape.type!=="BPMN"&&!(this.diagramActions&k.isGroupDragging)&&(this.diagramActions&k.PreventZIndexOnDragging?this.updateDiagramObject(ra,!0):ra.isLane||this.updateDiagramObject(ra))}if(!a&&p&&(this.lineRoutingModule&&this.diagramActions&&this.constraints&lt.LineRouting&&t.id!=="helper"?this.diagramActions&k.ToolAction||this.lineRoutingModule.renderVirtualRegion(this,!0):this.diagramActions&&this.constraints&lt.LineRouting&&t.id!=="helper"&&console.warn('[WARNING] :: Module "LineRouting" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),this.updateConnectorEdges(t),t.id!=="helper"&&!(this.diagramActions&k.ToolAction)))for(var Ps=this.spatialSearch.findObjects(t.wrapper.outerBounds),na=0;na<Ps.length;na++){var br=Ps[parseInt(na.toString(),10)];br instanceof B&&this.connectorPropertyChange(Ps[parseInt(na.toString(),10)],{},{sourceID:br.sourceID,targetID:br.targetID,sourcePortID:br.sourcePortID,targetPortID:br.targetPortID,sourcePoint:br.sourcePoint,targetPoint:br.targetPoint})}}t.status!=="New"&&this.diagramActions&&(t.status="Update")}if(!o){var np=t,ap={element:np,cause:this.diagramActions,diagramAction:this.getDiagramAction(this.diagramActions),oldValue:i,newValue:r};this.triggerEvent(Z.propertyChange,ap)}},e.prototype.hasSelectedConnector=function(t){var i=(this.selectedItems.connectors||[]).map(function(a){return a.id}),r=(t.outEdges||[]).concat(t.inEdges||[]);return!!r.some(function(a){return i.indexOf(a)!==-1})},e.prototype.updateWrapperChildFlip=function(t,i){if(t&&t.children&&t.children.length>0)for(var r=0;r<t.children.length;r++){var a=t.children[parseInt(r.toString(),10)],s=this.nameTable[""+a],o="";i?(o=i,s.wrapper.flipMode=o,s.flipMode=o):o=s.flipMode,o==="None"||o==="Label"||o==="LabelText"||o==="LabelAndLabelText"?this.updatePorts(s,G.None):this.updatePorts(s,s.wrapper.flip),this.updateWrapperFlip(s.wrapper,s)}i=t.flipMode,i==="None"||i==="Label"||i==="LabelText"||i==="LabelAndLabelText"?this.updatePorts(t,G.None):this.updatePorts(t,t.wrapper.flip);var h;t.children?h=t.wrapper.children[t.wrapper.children.length-1]:h=t.wrapper,h.flip=t.wrapper.flip,h.flipMode=t.flipMode,this.updateWrapperFlip(h,t)},e.prototype.updateWrapperFlip=function(t,i){for(var r=0;r<t.children.length;r++){var a=t.children[parseInt(r.toString(),10)];a instanceof Tt?i.flipMode!=="None"&&i.flipMode!=="Port"?(a.flip=i.wrapper.flip,a.flipMode=i.flipMode):a.flip=G.None:a instanceof Ht&&this.applyWrapperCanvasFlip(a,i)}},e.prototype.getResizeHandle=function(t,i,r,a,s,o,h,l){var d=s-t,f=o-i,p=h-r,c=l-a;return c===0&&(d>0&&p>0||d<0&&p<0)?"ResizeEast":c===0&&(d>0&&p<0||d<0&&p>0)?"ResizeWest":p===0&&(f>0&&c<0||f<0&&c>0)?"ResizeNorth":p===0&&(f>0&&c>0||f<0&&c<0)?"ResizeSouth":(d>0&&p>0||d<0&&p<0)&&(f>0&&c>0||f<0&&c<0)?"ResizeSouthEast":(d>0&&p<0||d<0&&p>0)&&(f>0&&c>0||f<0&&c<0)?"ResizeSouthWest":(d>0&&p>0||d<0&&p<0)&&(f>0&&c<0||f<0&&c>0)?"ResizeNorthEast":(d>0&&p<0||d<0&&p>0)&&(f>0&&c<0||f<0&&c>0)?"ResizeNorthWest":null},e.prototype.getTextAnnotationOffset=function(t,i,r,a,s){var o=t.width-r.width,h=t.height-r.height,l=this.getTextAnnotationQuadrant(t,i),d=this.getResizeHandle(r.offsetX,r.offsetY,r.width,r.height,t.offsetX,t.offsetY,t.width,t.height),f=0,p=0,c=function(g){return d==="ResizeEast"||d==="ResizeNorthEast"||d==="ResizeSouthEast"?g.includes("East"):d==="ResizeWest"||d==="ResizeNorthWest"||d==="ResizeSouthWest"?g.includes("West"):!1},u=function(g){return d==="ResizeSouth"||d==="ResizeSouthWest"||d==="ResizeSouthEast"?g.includes("South"):d==="ResizeNorth"||d==="ResizeNorthWest"||d==="ResizeNorthEast"?g.includes("North"):!1};return c(l)&&(f=d.includes("West")?-o:o),u(l)&&(p=d.includes("North")?-h:h),{x:a+f,y:s+p}},e.prototype.getTextAnnotationQuadrant=function(t,i){var r=t.wrapper.bounds.left,a=t.wrapper.bounds.right,s=t.wrapper.bounds.top,o=t.wrapper.bounds.bottom,h=i.wrapper.bounds.center.x,l=i.wrapper.bounds.center.y;if(h>=r&&h<=a){if(l<s)return"North";if(l>o)return"South"}if(l>=s&&l<=o){if(h<r)return"West";if(h>a)return"East"}return h<r&&l<s?"NorthWest":h>a&&l<s?"NorthEast":h<r&&l>o?"SouthWest":h>a&&l>o?"SouthEast":""},e.prototype.updateBpmnAnnotationPosition=function(t,i,r,a,s,o,h,l,d,f,p){var c=r>t?Math.abs(r-t):Math.abs(t-r),u=a>i?Math.abs(a-i):Math.abs(i-a),g,v;(c===0&&u===0||Number.isNaN(c)&&Number.isNaN(u))&&s.laneMargin&&(g=s.margin.left-s.laneMargin.left,v=s.margin.top-s.laneMargin.top);var m=s.width,y=s.height,S=new it(0,0,0,0);if(m!==0&&y!==0&&(S=new it((r!==0?r:s.offsetX)-m/2,(a!==0?a:s.offsetY)-y/2,m,y)),l){var x=h,I=x.textAnnotation.textAnnotationTarget!==""&&this.nameTable[x.textAnnotation.textAnnotationTarget],C=this.selectedItems.nodes?this.selectedItems.nodes[0]:void 0,P=C&&C.shape&&C.shape.shape==="TextAnnotation";if(I)if(s.parentId===""||P){if(x.textAnnotation.textAnnotationDirection==="Auto"&&o.children[0]instanceof Ht&&o.children[0].children[0]instanceof Pt){var A=o.children[0],T=document.getElementById(A.id+"_groupElement"),z=document.getElementById(A.children[0].id+"_groupElement");T.removeChild(z),A.children.splice(0,1),this.isProtectedOnChange=!0,this.bpmnModule.setAnnotationPath(S,A,s,x,x.textAnnotation.textAnnotationDirection,this),this.isProtectedOnChange=!1}}else this.isPositionUndo=!0,this.updateTextAnnotationInSwimlane(s,s),this.isPositionUndo=!1;else if(s.inEdges.length>0){var L=s.inEdges[0],R=this.nameTable[""+L];R&&R.isBpmnAnnotationConnector&&(R.sourcePoint={x:r>t?R.sourcePoint.x+c:R.sourcePoint.x-c,y:a>i?R.sourcePoint.y+u:R.sourcePoint.y-u})}var O={ports:[{offset:s.ports[0].offset}]};this.nodePropertyChange(s,{},O)}else for(var N=0,H=s.outEdges;N<H.length;N++){var F=H[N],R=this.nameTable[""+F];if(R&&R.isBpmnAnnotationConnector){var Y=this.nameTable[R.targetID],et=Y.shape.textAnnotation.textAnnotationTarget,at=this.nameTable[""+et];if(f&&!p){var tt=this.getTextAnnotationOffset(s,Y,d,t,i);r=tt.x,a=tt.y,c=r>t?Math.abs(r-t):Math.abs(t-r),u=a>i?Math.abs(a-i):Math.abs(i-a)}if(Y.shape.shape==="TextAnnotation"&&!Ut(this,Y)&&Ut(this,at)){var nt=void 0,O=void 0;if(s.isResized){nt={margin:{left:Y.margin.left,top:Y.margin.top}};var wt=s.resizeDif[Y.id];wt&&(Y.margin.left+=wt.x,Y.margin.top+=wt.y,O={margin:{left:Y.margin.left,top:Y.margin.top}})}else g!==void 0&&v!==void 0?Y.parentId?(nt={margin:{left:Y.margin.left,top:Y.margin.top}},Y.margin.left+=g,Y.margin.top+=v,O={margin:{left:Y.margin.left,top:Y.margin.top}}):(nt={offsetX:Y.offsetX,offsetY:Y.offsetY},Y.offsetX+=g,Y.offsetY+=v,O={offsetX:Y.offsetX,offsetY:Y.offsetY}):(nt={offsetX:Y.offsetX,offsetY:Y.offsetY},Y.offsetX=r>t?Y.offsetX+c:Y.offsetX-c,Y.offsetY=a>i?Y.offsetY+u:Y.offsetY-u,O={offsetX:Y.offsetX,offsetY:Y.offsetY});this.nodePropertyChange(Y,nt,O)}}}},e.prototype.updatePorts=function(t,i){if(t&&t.ports.length>0)for(var r=0,a=Object.keys(t.ports);r<a.length;r++){var s=a[r],o=Number(s),h=t.ports[parseInt(o.toString(),10)],l=this.getWrapper(t.wrapper,h.id);l=qn(l,i,h),l.relativeMode="Point",t.wrapper.measureChildren===void 0&&(t.wrapper.measureChildren=!1),l.measure(new U(l.width,l.height)),l.arrange(l.desiredSize)}},e.prototype.updateFlipOffset=function(t,i,r,a){if(t.hasChildren())for(var s=0,o=t.children;s<o.length;s++){var h=o[s];(a===G.Horizontal||a===G.Both)&&(h.flipOffset.x=h.flipOffset.x+i),(a===G.Vertical||a===G.Both)&&(h.flipOffset.y=h.flipOffset.y+r),(h instanceof Ht||h instanceof Je)&&this.updateFlipOffset(h,i,r,a)}},e.prototype.updateUMLActivity=function(t,i,r,a){var s=t.width!==void 0||t.height!==void 0;if(s){var o=r.wrapper.children[0].children[0];o.width=t.width,o.height=t.height;var h=r.wrapper.children[0].children[1];h.width=t.width/1.5,h.height=t.height/1.5}},e.prototype.updateConnectorProperties=function(t){if(t)if(this.preventConnectorsUpdate){var i=this.selectionConnectorsList.indexOf(t);i===-1&&t&&this.selectionConnectorsList.push(t)}else{var r={sourcePoint:t.sourcePoint,targetPoint:t.targetPoint,sourceID:t.sourceID,targetID:t.targetID,sourcePortID:t.sourcePortID,targetPortID:t.targetPortID};this.connectorPropertyChange(t,{},r,void 0,!0)}},e.prototype.updateConnectorEdges=function(t){var i=(this.selectedItems.connectors||[]).map(function(h){return h.id});if(t.inEdges.length>0)for(var r=0;r<t.inEdges.length;r++){var a=t.inEdges[parseInt(r.toString(),10)];if(this.eventHandler.currentAction!=="Drag"||i.indexOf(a)===-1)if(t&&t.id!==a&&this.nameTable[""+a])this.updateConnectorProperties(this.nameTable[""+a]);else return}if(t.outEdges.length>0)for(var s=0;s<t.outEdges.length;s++){var o=t.outEdges[parseInt(s.toString(),10)];if(this.eventHandler.currentAction!=="Drag"||i.indexOf(o)===-1)if(t&&t.id!==o&&this.nameTable[""+o])this.updateConnectorProperties(this.nameTable[""+o]);else return}!(t instanceof B)&&t.parentId&&this.nameTable[t.parentId]&&this.updateConnectorEdges(this.nameTable[t.parentId])},e.prototype.connectorProprtyChangeExtend=function(t,i,r,a){return r.type!==void 0&&r.type!==i.type&&t.segments.length>0&&r.segments===void 0&&(t.segments=[]),r.shape!==void 0&&t.shape!==void 0&&t.shape&&t.shape.type==="Bpmn"&&this.bpmnModule&&this.bpmnModule.updateBPMNConnector(t,i,r,this),t.constraints!==void 0?(this.updateThumbConstraints(this.selectedItems.connectors,this.selectedItems,!0),a=!0):a},e.prototype.connectorPropertyChange=function(t,i,r,a,s){if(this.canEnableBlazorObject){var o=E(t);this.insertValue(o,!1)}var h;if(t&&t.wrapper!==void 0)h=t.wrapper.bounds;else return;var l=!1,d=[];l=this.connectorProprtyChangeExtend(t,i,r,l);var f,p,c,u;if(r.visible!==void 0&&this.updateElementVisibility(t.wrapper,t,t.visible),r.sourcePoint!==void 0||r.targetPoint!==void 0||r.sourceID!==void 0||r.targetID!==void 0||r.targetPadding!==void 0||r.sourcePortID!==void 0||r.targetPortID!==void 0||r.sourcePadding!==void 0||r.type!==void 0||r.segments!==void 0||r.flip!==void 0){if(r.sourceID!==void 0&&r.sourceID!==i.sourceID||r.sourcePortID){var g=this.nameTable[t.sourceID];if(p=this.findInOutConnectPorts(g,!1),(!g||Di(g)||t.sourcePortID!==""&&ar(p))&&(t.sourceWrapper=g?this.getEndNodeWrapper(g,t,!0):void 0,t.sourcePortID&&r.sourcePortID===void 0&&(t.sourcePortWrapper=g?this.getWrapper(g.wrapper,t.sourcePortID):void 0),this.removePortEdges(this.nameTable[i.sourceID]||g,i.sourcePortID||t.sourcePortID,t.id,!1)),r.sourceID!==void 0&&i.sourceID!==void 0&&i.sourceID!==""){var v=this.nameTable[i.sourceID];v!==void 0&&v.outEdges&&v.outEdges.indexOf(t.id)!==-1&&Zs(v.outEdges,t.id)}this.updateEdges(t)}if(r.targetID!==void 0&&r.targetID!==i.targetID){var m=this.nameTable[r.targetID];if(f=this.findInOutConnectPorts(m,!0),(!m||ii(m)||t.targetPortID!==""&&Li(f))&&(t.targetWrapper=m?this.getEndNodeWrapper(m,t,!1):void 0,t.targetPortID&&r.targetPortID===void 0&&(t.targetPortWrapper=m?this.getWrapper(m.wrapper,t.targetPortID):void 0),this.removePortEdges(this.nameTable[i.targetID]||m,i.targetPortID||t.targetPortID,t.id,!0)),i!==void 0&&i.targetID!==void 0&&i.targetID!==""){var y=this.nameTable[i.targetID];y!==void 0&&y.inEdges&&y.inEdges.indexOf(t.id)!==-1&&Zs(y.inEdges,t.id)}this.updateEdges(t)}if(r.sourcePortID!==void 0&&r.sourcePortID!==i.sourcePortID){t.sourceID&&this.nameTable[t.sourceID]&&(c=this.nameTable[t.sourceID].wrapper);var g=this.nameTable[t.sourceID];!g||Di(g)||t.sourcePortID!==""&&ar(p)?t.sourcePortWrapper=c?this.getWrapper(c,r.sourcePortID):void 0:t.sourcePortID===""&&!Di(g)&&(t.sourcePortWrapper=void 0)}if(r.targetPortID!==void 0&&r.targetPortID!==i.targetPortID){var m=this.nameTable[t.targetID];t.targetID&&this.nameTable[t.targetID]&&(u=this.nameTable[t.targetID].wrapper),!m||ii(m)||t.targetPortID!==""&&Li(f)?t.targetPortWrapper=u?this.getWrapper(u,r.targetPortID):void 0:t.targetPortID===""&&!ii(m)&&(t.targetPortWrapper=void 0)}if(r.flip!==void 0){t.flip=r.flip;var S=(t.flip&G.Horizontal^t.wrapper.flip&G.Horizontal)===G.Horizontal,x=(t.flip&G.Vertical^t.wrapper.flip&G.Vertical)===G.Vertical;S&&(t.wrapper.flip^=G.Horizontal),x&&(t.wrapper.flip^=G.Vertical),rh(t,S,x,this)}t.type==="Orthogonal"&&this.lineRoutingModule&&this.diagramActions&&this.constraints&lt.LineRouting&&!(this.diagramActions&k.ToolAction)&&this.layout.type!=="ComplexHierarchicalTree"&&(this.lineRoutingModule.renderVirtualRegion(this,!0),t.sourceID!==t.targetID&&t.segments.length>1&&this.lineRoutingModule.refreshConnectorSegments(this,t,!1)),d=this.getPoints(t)}r.style!==void 0&&ua(r.style,t.wrapper.children[0]),(d.length>0||r.sourceDecorator!==void 0||r.targetDecorator!==void 0&&Y0(Object.keys(r.targetDecorator))||r.cornerRadius!==void 0)&&(Dn(t,d.length>0?d:t.intermediatePoints,this.diagramActions),r.type!==void 0&&(l=!0),d.length>0&&(t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),this.updateConnectorAnnotation(t),this.updateConnectorPort(t),this.updateConnectorfixedUserHandles(t),this.updateObject(t,i,r))),(r.sourcePoint||r.targetPoint||r.segments)&&this.diagramActions===k.Render&&(l=!0),t.shape.type==="Bpmn"&&t.shape.sequence==="Default"&&t.shape.flow==="Sequence"&&this.commandHandler.updatePathElementOffset(t),a||this.updateBridging(),this.updateAnnotations(r,t),this.updateConnectorPorts(r,t),this.updatefixedUserHandle(r,t),t.wrapper.measure(new U(t.wrapper.width,t.wrapper.height)),t.wrapper.arrange(t.wrapper.desiredSize),h.equals(h,t.wrapper.bounds)===!1&&!this.connectorFlipInProgress&&(this.updateQuad(t),this.eventHandler.currentAction!=="Drag"&&this.updateGroupSize(t)),l===!0&&this.checkSelectedItem(t)&&(!(this.diagramActions&k.ToolAction)||this.diagramActions&k.UndoRedo)&&this.updateSelector(),this.preventConnectorsUpdate||(!Le(this)||Le(this)&&this.scroller.oldCollectionObjects.indexOf(t.id)>-1)&&(this.diagramActions&k.PreventZIndexOnDragging?this.updateDiagramObject(t,!0):this.updateDiagramObject(t)),this.updateConnectorEdges(t),this.diagramActions&&t.status!=="New"&&(t.status="Update"),this.triggerPropertyChange(s,t,i,r)},e.prototype.removePortEdges=function(t,i,r,a){if(t)for(var s=0;s<t.ports.length;s++){var o=t.ports[parseInt(s.toString(),10)];if(o.id===i){var h=a?o.inEdges:o.outEdges;Zs(h,r)}}},e.prototype.updateConnectorPorts=function(t,i){if(t.ports!==void 0)for(var r=0,a=Object.keys(t.ports);r<a.length;r++){var s=a[r],o=Number(s),h=t.ports[""+s],l=i.ports[parseInt(o.toString(),10)];this.updatePort(h,l,i.wrapper,i)}},e.prototype.triggerPropertyChange=function(t,i,r,a){if(!t){var s=i,o={element:s,cause:this.diagramActions,diagramAction:this.getDiagramAction(this.diagramActions),oldValue:r,newValue:a};this.triggerEvent(Z.propertyChange,o)}},e.prototype.findInOutConnectPorts=function(t,i){var r={};return t&&(r=hn(t,i)),r},e.prototype.getPoints=function(t,i){var r=!!(this.lineDistributionModule&&this.layout.connectionPointOrigin==="DifferentPoint"),a=t.getConnectorPoints(t.type,i,this.layout.type==="ComplexHierarchicalTree"||this.layout.type==="HierarchicalTree"?this.layout.orientation:void 0,r);return a},e.prototype.updateNodeProperty=function(t,i,r){if(i===void 0)this.updateElementVisibility(t,this.nameTable[t.id],i);else{t.style.opacity=r;for(var a=0;a<t.children.length;a++)t.children[parseInt(a.toString(),10)]instanceof Je&&this.updateNodeProperty(t.children[parseInt(a.toString(),10)],void 0,r),t.children[parseInt(a.toString(),10)].style.opacity=r}},e.prototype.checkSelectedItem=function(t){var i=this.selectedItems,r=!1,a=[];return a=a.concat(i.nodes,i.connectors),a.length>0&&t.id===a[a.length-1].id&&(r=!0),r},e.prototype.updateDiagramContainerVisibility=function(t,i){if(t instanceof Je)for(var r=0;r<t.children.length;r++)this.updateDiagramContainerVisibility(t.children[parseInt(r.toString(),10)],i);t.visible=i},e.prototype.updateElementVisibility=function(t,i,r){if(r!==void 0){if(t.visible=r,i instanceof M){if(!i.children)t.children[0].visible=r,this.updateDiagramContainerVisibility(t.children[0],r),i.shape.type==="Bpmn"&&this.bpmnModule&&this.bpmnModule.updateElementVisibility(i,r,this);else for(var a=0,s=i.children;a<s.length;a++){var o=s[a];this.updateElementVisibility(this.nameTable[""+o].wrapper,this.nameTable[""+o],r)}if(i.shape.type==="Bpmn"&&i.shape.shape==="TextAnnotation"&&this.diagramActions){var h=this.nameTable[i.inEdges[0]],l=h.visible;h.visible=r,this.connectorPropertyChange(h,{visible:l},{visible:r})}if(i.ports)for(var d=0,f=i.ports;d<f.length;d++){var p=f[d];if(p.visibility&zt.Visible){var c=this.getWrapper(t,p.id);c.visible=r}}if(i.annotations)for(var u=0,g=i.annotations;u<g.length;u++){var v=g[u],c=this.getWrapper(t,v.id);r?c.visible=c.annotationVisibility==="Visible":c.visible=r}}else if(i.shape.type==="Bpmn")for(var m=0;m<4;m++)t.children[parseInt(m.toString(),10)].visible=r;else for(var m=0;m<3;m++)t.children[parseInt(m.toString(),10)].visible=r;if(i.annotations)for(var y=0,S=i.annotations;y<S.length;y++){var v=S[y],c=this.getWrapper(t,v.id);r?c.visible=c.annotationVisibility==="Visible":c.visible=r}if(i.expandIcon||i.collapseIcon){var c=this.getWrapper(t,"icon_content");if(c){for(var m=0;m<c.children.length;m++)c.children[parseInt(m.toString(),10)].visible=r;c.visible=r}i&&i.visible&&i.outEdges&&this.updateIconVisibility(i,i.outEdges.length!==0)}r===!1&&this.unSelect(this.nameTable[t.id]),(i instanceof M&&!this.preventNodesUpdate||i instanceof B&&!this.preventConnectorsUpdate)&&this.diagramActions&&this.updateDiagramObject(this.nameTable[t.id],void 0,!0)}},e.prototype.updateAnnotations=function(t,i){if(t.annotations!==void 0)for(var r=0,a=Object.keys(t.annotations);r<a.length;r++){var s=a[r],o=Number(s),h=t.annotations[""+s],l=i.annotations[parseInt(o.toString(),10)];this.updateAnnotation(h,l,i.wrapper,i)}},e.prototype.updatefixedUserHandle=function(t,i){if(t.fixedUserHandles!==void 0)for(var r=void 0,a=void 0,s=void 0,o=0,h=Object.keys(t.fixedUserHandles);o<h.length;o++){var l=h[o];r=Number(l),a=t.fixedUserHandles[""+l],s=i.fixedUserHandles[parseInt(r.toString(),10)],this.updateConnectorfixedUserHandle(a,s,i.wrapper,i)}},e.prototype.updateConnectorfixedUserHandle=function(t,i,r,a,s){var o=!1,h=this.getWrapper(r,i.id);h!==void 0&&(t.width!==void 0&&(h.width=t.width,o=!0),t.height!==void 0&&(h.height=t.height,o=!0),i instanceof Xn&&t.offset!==void 0&&a.updateAnnotation(i,a.intermediatePoints,a.wrapper.bounds,h),i instanceof Xn&&t.displacement&&(t.displacement.x!==void 0||t.displacement.y!==void 0)&&(o=!0),t.fill!==void 0&&(h.style.fill=t.fill),t.handleStrokeColor!==void 0&&(h.style.strokeColor=t.handleStrokeColor),t.handleStrokeWidth!==void 0&&(h.style.strokeWidth=t.handleStrokeWidth),t.visibility!==void 0&&(h.visible=t.visibility),t.cornerRadius!==void 0&&(h.cornerRadius=t.cornerRadius),this.updatefixedUserHandleContent(t,o,h,a,i,r),o===!0&&(h.measure(new U(h.width,h.height)),h.arrange(h.desiredSize)))},e.prototype.updateAnnotation=function(t,i,r,a,s){var o=!1,h=this.getWrapper(r,i.id);if(h!==void 0){if(t.width!==void 0&&t.height!==void 0&&(h.width=t.width,h.height=t.height,o=!0),t.rotateAngle!==void 0&&(h.rotateAngle=t.rotateAngle),s&&!(h instanceof we)&&h.refreshTextElement(),i instanceof Qt&&t.segmentAngle!==void 0&&(h.rotateAngle=i.rotateAngle),t.rotationReference!==void 0&&(h.rotationReference=t.rotationReference),i instanceof ae&&t.offset!==void 0){var l=t.offset;o=!0;var d=l.x!==void 0?l.x:i.offset.x,f=l.y!==void 0?l.y:i.offset.y;h.setOffsetWithRespectToBounds(d,f,"Fraction"),h.relativeMode="Point"}else i instanceof Qt&&(t.offset!==void 0||t.segmentAngle!==void 0||t.alignment!==void 0)&&a.updateAnnotation(i,a.intermediatePoints,a.wrapper.bounds,h);if(i instanceof Qt&&t.displacement&&(t.displacement.x!==void 0||t.displacement.y!==void 0)&&(o=!0,a.updateAnnotation(i,a.intermediatePoints,a.wrapper.bounds,h)),t.margin!==void 0&&(o=!0,t.margin.bottom!==void 0&&(h.margin.bottom=t.margin.bottom),t.margin.top!==void 0&&(h.margin.top=t.margin.top),t.margin.left!==void 0&&(h.margin.left=t.margin.left),t.margin.right!==void 0&&(h.margin.right=t.margin.right)),(o||s)&&(h.width=i.width||a.width,i.template&&(h.width=h.width||h.actualSize.width,h.height=i.height||a.height||h.actualSize.height)),t.horizontalAlignment!==void 0&&(h.horizontalAlignment=t.horizontalAlignment,o=!0),t.verticalAlignment!==void 0&&(h.verticalAlignment=t.verticalAlignment,o=!0),t.visibility!==void 0){h.visible=!!(r.visible&&t.visibility),h.annotationVisibility=h.visible?"Visible":"Collapsed";var p=this.selectedItems;!h.visible&&p.annotation&&this.clearSelection()}if(t.constraints!==void 0){var c=!1;h.constraints&He.Select&&!(t.constraints&He.Select)&&Ut(this,a,!1,h),h.constraints=t.constraints,c&&this.clearSelection()}t.style!==void 0&&ua(t.style,h),t.hyperlink!==void 0&&E0(t.hyperlink,h,i),this.updateAnnotationContent(t,o,h,a,i,r),o===!0&&(h.measure(new U(h.width,h.height)),h.arrange(h.desiredSize)),h instanceof we||h.refreshTextElement()}},e.prototype.updatefixedUserHandleContent=function(t,i,r,a,s,o){t!==void 0&&this.updateConnectorfixedUserHandleWrapper(r,a,s,o)},e.prototype.updateConnectorfixedUserHandleWrapper=function(t,i,r,a){for(var s=0,o=this.views;s<o.length;s++){var h=o[s];be(t.id+"_groupElement",h),be(t.id+"_html_element",h)}if(i instanceof B){var l=i.wrapper,d=l.children[0],f=new it(d.offsetX-d.width/2,d.offsetY-d.height/2,d.width,d.height);t=i.getFixedUserHandle(i.fixedUserHandles[i.fixedUserHandles.length-1],i.intermediatePoints,f,void 0,void 0)}for(var p=0;p<a.children.length;p++)t.id===a.children[parseInt(p.toString(),10)].id&&a.children.splice(p,1,t)},e.prototype.updateAnnotationContent=function(t,i,r,a,s,o){t.content!==void 0&&(r&&(a.shape.type==="UmlActivity"&&a.shape.shape==="StructuredNode"?r.content="<<"+t.content+">>":r.content=t.content),r instanceof we&&this.updateAnnotationWrapper(r,a,s,o)),t.template!==void 0&&(r.content=t.template,this.updateAnnotationWrapper(r,a,s,o))},e.prototype.updateAnnotationWrapper=function(t,i,r,a){for(var s=0,o=this.views;s<o.length;s++){var h=o[s];be(t.id+"_groupElement",h),be(t.id+"_html_element",h)}if(i instanceof M)t=i.initAnnotationWrapper(r,this.element.id);else if(i instanceof B){var l=i.wrapper,d=l.children[0],f=new it(d.offsetX-d.width/2,d.offsetY-d.height/2,d.width,d.height);t=i.getAnnotationElement(i.annotations[i.annotations.length-1],i.intermediatePoints,f,this.getDescription,this.element.id)}for(var p=0;p<a.children.length;p++)t.id===a.children[parseInt(p.toString(),10)].id&&a.children.splice(p,1,t)},e.prototype.updateNodefixedUserHandle=function(t,i,r,a){var s=!1,o=this.getWrapper(r,i.id);if(o!==void 0){if(t.width!==void 0&&(o.actualSize.width=t.width,s=!0),t.height!==void 0&&(o.height=t.height,s=!0),i instanceof Go&&t.offset!==void 0){var h=t.offset;s=!0;var l=h.x!==void 0?h.x:i.offset.x,d=h.y!==void 0?h.y:i.offset.y;o.setOffsetWithRespectToBounds(l,d,"Fraction"),o.relativeMode="Point"}t.margin!==void 0&&(s=!0,t.margin.bottom!==void 0&&(o.margin.bottom=t.margin.bottom),t.margin.top!==void 0&&(o.margin.top=t.margin.top),t.margin.left!==void 0&&(o.margin.left=t.margin.left),t.margin.right!==void 0&&(o.margin.right=t.margin.right)),t.visibility!==void 0&&(o.visible=t.visibility),t.fill!==void 0&&(o.style.fill=t.fill),t.handleStrokeColor!==void 0&&(o.style.strokeColor=t.handleStrokeColor),t.handleStrokeWidth!==void 0&&(o.style.strokeWidth=t.handleStrokeWidth),t.cornerRadius!==void 0&&(o.cornerRadius=t.cornerRadius),this.updatefixedUserHandleWrapper(o,a,i,r),s===!0&&(o.measure(new U(o.width,o.height)),o.arrange(o.desiredSize))}},e.prototype.updatefixedUserHandleWrapper=function(t,i,r,a){for(var s=0,o=this.views;s<o.length;s++){var h=o[s];be(t.id+"_groupElement",h),be(t.id+"_html_element",h)}i instanceof M&&(t=i.initFixedUserHandles(r,void 0,void 0));for(var l=0;l<a.children.length;l++)t.id===a.children[parseInt(l.toString(),10)].id&&a.children.splice(l,1,t)},e.prototype.updatePort=function(t,i,r,a){var s=!1,o=this.getWrapper(r,i.id);if(o!==void 0){if(t.offset!==void 0)if(s=!0,a)t.offset!==void 0&&a.updateAnnotation(i,a.intermediatePoints,a.wrapper.bounds,o);else{var h=t.offset.x!==void 0?t.offset.x:i.offset.x,l=t.offset.y!==void 0?t.offset.y:i.offset.y;o.setOffsetWithRespectToBounds(h,l,"Fraction"),o.relativeMode="Point"}if(t.width!==void 0&&(s=!0,o.width=t.width),t.height!==void 0&&(s=!0,o.height=t.height),t.connectionDirection!==void 0&&(o.connectionDirection=t.connectionDirection),t.visibility!==void 0&&(o.visible=!!(r.visible&&ci(i,zt.Visible))),t.margin!==void 0&&(s=!0,t.margin.bottom!==void 0&&(o.margin.bottom=t.margin.bottom),t.margin.top!==void 0&&(o.margin.top=t.margin.top),t.margin.right!==void 0&&(o.margin.right=t.margin.right),t.margin.left!==void 0&&(o.margin.left=t.margin.left)),t.horizontalAlignment!==void 0&&(s=!0,o.horizontalAlignment=t.horizontalAlignment),t.verticalAlignment!==void 0&&(s=!0,o.verticalAlignment=t.verticalAlignment),t.style!==void 0&&(t.style.fill!==void 0&&(o.style.fill=t.style.fill),t.style.opacity!==void 0&&(o.style.opacity=t.style.opacity),t.style.strokeColor!==void 0&&(o.style.strokeColor=t.style.strokeColor),t.style.strokeWidth!==void 0&&(o.style.strokeWidth=t.style.strokeWidth),t.style.strokeDashArray!==void 0&&(o.style.strokeDashArray=t.style.strokeDashArray)),t.shape!==void 0&&o){var d=Xo(t.shape);o.data=d,o.canMeasurePath=!0}t.pathData!==void 0&&(o.data=String(t.pathData),s=!0),s===!0&&(o.measure(new U(o.width,o.height)),o.arrange(o.desiredSize))}},e.prototype.updateIcon=function(t){var i=this.getWrapper(t.wrapper,"icon_content"),r=this.diagramActions&k.Render?this.element.id:void 0;if(i){if(this.mode==="SVG"){var a=St(t.wrapper.id+"_icon_content",r);if(a){var s=St(a.id+"_rect",r),o=St(a.id+"_shape",r),h=St(o.id+"_native_element",r);h&&h.parentNode.removeChild(h),o.parentNode.removeChild(o),s.parentNode.removeChild(s),a.parentNode.removeChild(a)}}var l=t.wrapper.children.indexOf(i);t.wrapper.children.splice(l,1)}var d=this.getPortContainer(t);t.initIcons(this.getDescription,this.layout,d,this.element.id)},e.prototype.getPortContainer=function(t){if(t.children){for(var i=0;i<t.wrapper.children.length;i++)if(t.wrapper.children[parseInt(i.toString(),10)].id===t.id+"group_container")return t.wrapper.children[parseInt(i.toString(),10)]}return t.wrapper},e.prototype.updateTooltip=function(t,i){i.tooltip.content!==void 0&&(t.tooltip.content=i.tooltip.content),i.tooltip.position!==void 0&&(t.tooltip.position=i.tooltip.position),i.tooltip.height!==void 0&&(t.tooltip.height=i.tooltip.height),i.tooltip.width!==void 0&&(t.tooltip.width=i.tooltip.width),i.tooltip.showTipPointer!==void 0&&(t.tooltip.showTipPointer=i.tooltip.showTipPointer),i.tooltip.relativeMode!==void 0&&(t.tooltip.relativeMode=i.tooltip.relativeMode)},e.prototype.updateQuad=function(t){var i=this.spatialSearch.updateQuad(t.wrapper);i&&!this.preventDiagramUpdate&&this.updatePage()},e.prototype.removeFromAQuad=function(t){if(t.children)for(var i=void 0,r=t.children,a=0;a<r.length;a++)i=this.nameTable[r[parseInt(a.toString(),10)]],i&&this.removeFromAQuad(i);this.spatialSearch.removeFromAQuad(t.wrapper);var s=t.shape.type==="SwimLane",o=this.spatialSearch.updateBounds(t.wrapper,s);o&&!this.preventDiagramUpdate&&this.updatePage()},e.prototype.updateGroupSize=function(t){var i;t.parentId&&(i=this.nameTable[t.parentId],i&&(i.parentId?this.updateGroupSize(i):(i.wrapper.measure(new U),i.wrapper.arrange(i.wrapper.desiredSize),this.updateGroupOffset(i),this.updateDiagramObject(i))))},e.prototype.updatePage=function(){if(this.diagramActions&k.Render&&!(this.diagramActions&k.DragUsingMouse)){this.scroller.updateScrollOffsets(),this.scroller.setSize();for(var t=0,i=this.views;t<i.length;t++){var r=i[t],a=this.views[""+r];a instanceof e||a.updateView(a)}}this.diagramActions&k.DragUsingMouse&&(this.renderPageBreaks(),(!(this.pageSettings.width&&this.pageSettings.height)||this.pageSettings.multiplePage)&&(this.scroller.updateScrollOffsets(),this.scroller.setSize()))},e.prototype.protectPropertyChange=function(t){this.isProtectedOnChange=t},e.prototype.getProtectPropertyChangeValue=function(){return this.isProtectedOnChange},e.prototype.enableServerDataBinding=function(t){},e.prototype.updateShadow=function(t,i){i.angle!==void 0&&(t.angle=i.angle),i.color!==void 0&&(t.color=i.color),i.distance!==void 0&&(t.distance=i.distance),i.opacity!==void 0&&(t.opacity=i.opacity)},e.prototype.updateMargin=function(t,i){i.margin.top!==void 0&&(t.margin.top=i.margin.top),i.margin.bottom!==void 0&&(t.margin.bottom=i.margin.bottom),i.margin.left!==void 0&&(t.margin.left=i.margin.left),i.margin.right!==void 0&&(t.margin.right=i.margin.right)},e.prototype.removePreviewChildren=function(t){if(t.children&&t.children.length&&t.shape&&t.shape.type==="SwimLane"){for(var i=0;i<t.children.length;i++){var r=t.children[parseInt(i.toString(),10)],a=this.nodes.indexOf(this.nameTable[""+r]);a>=0&&this.nodes.splice(a,1),delete this.nameTable[""+r]}var s=this.nodes.indexOf(this.nameTable[this.currentSymbol.id]);s>=0&&this.nodes.splice(s,1)}else if(t.shape.type==="Container"){if(t.shape.hasHeader){var o=this.nodes.indexOf(this.nameTable[t.id+t.shape.header.id]);o>=0&&this.nodes.splice(o,1)}var s=this.nodes.indexOf(this.nameTable[this.currentSymbol.id]);s>=0&&this.nodes.splice(s,1)}},e.prototype.selectDragedNode=function(t,i,r){this.currentSymbol=t,this.mode!=="SVG"&&this.refreshDiagramLayer(),this.commandHandler.oldSelectedObjects=es(this),this.commandHandler.select(t),this.eventHandler.mouseDown(i.event),this.eventHandler.mouseMove(i.event,i),this.preventDiagramUpdate=!1,this.updatePage(),r.style.opacity="0"},e.prototype.initDroppables=function(){var t=this,i={},r={},a,s,o="selectedSymbols";this.droppable=new eg(this.element);var h=5;this.droppable.over=function(l){if(t.rulerSettings.showRulers){var d=document.getElementById(t.element.id+"_vRuler"),f=parseFloat(d.style.width);h=f+1}if(t.previousSelectedObjects.length===0&&!t.currentSymbol&&(t.previousSelectedObjects=t.commandHandler.getSelectedObject()),t.commandHandler.PreventConnectorSplit=!0,t.currentSymbol)l.event.touches&&l.event.touches.length&&t.eventHandler.mouseMove(l.event,l.event.touches);else{var p=null;if(!l.dragData&&l.name==="drag"){var c=document.getElementsByClassName("e-dragclone")[0];c&&(p=c)}if(l.dragData||p){var u=void 0,g=void 0;document.getElementById(t.element.id+"content").focus();var v=t.eventHandler.getMousePosition(l.event),m=void 0,y=p||l.dragData.helper,S=y.getAttribute("paletteId"),x=void 0,I=void 0,C=void 0,P=void 0;if(!S&&l.dragData){var A={source:null,element:u,cancel:!1,diagram:t,dragData:l.dragData.draggedElement.ej2_instances[0].dragData,dragItem:u};t.triggerEvent(Z.dragEnter,A);var T=void 0,z=void 0;if(A.dragItem){if(A.dragItem.sourcePoint&&A.dragItem.targetPoint?z=new B(t,"connectors",A.dragItem,!0):T=new M(t,"nodes",A.dragItem,!0),u=T||z,t.initObject(u,void 0,void 0,!0),t.enterObject=u,t.enterTable=r,u instanceof M)T.offsetX=v.x+5+T.width*T.pivot.x,T.offsetY=v.y+T.height*T.pivot.y;else if(u instanceof B){var L=it.toBounds([u.sourcePoint,u.targetPoint]),R=v.x-L.left,O=v.y-L.top;u.sourcePoint.x+=R,u.sourcePoint.y+=O,u.targetPoint.x+=R,u.targetPoint.y+=O}t.preventDiagramUpdate=!0,t.currentSymbol=u,t.mode!=="SVG"&&t.refreshDiagramLayer(),t.selectDragedNode(u,l,y),delete t.enterObject,delete t.enterTable,t.droppable[""+o]=y,t.allowServerDataBinding=!0}}if(S){var N=document.getElementById(S).ej2_instances[0],H="sourceElement";t.droppable[""+H]=N;var F="childTable";if(N){var Y=N[""+o],et=Y.wrapper.children[0].children[0];if((Y.shape.type==="Native"||Y.shape.type==="HTML")&&Y.shape.content&&typeof Y.shape.content=="function"&&(Y.shape.content=et.template.innerHTML),t.allowServerDataBinding=!1,m=E(N[""+o]),i=N[""+F],P=U0(N,m,et),N[""+o]instanceof M){Y.shape.shape==="TextAnnotation"?(m.offsetX=v.x+11+P.width*m.pivot.x,m.offsetY=v.y+11+P.height*m.pivot.y):(m.offsetX=v.x+5+P.width*m.pivot.x,m.offsetY=v.y+P.height*m.pivot.y);var T=new M(t,"nodes",m,!0);T.shape.type==="Bpmn"&&T.shape.activity.subProcess.processes&&T.shape.activity.subProcess.processes.length&&(T.shape.activity.subProcess.processes=[]),x=T.dragSize,I=T.previewSize,C=N.symbolDragSize;var at=N.symbolPreview;if(T.width=x.width||C.width||I.width||at.width||T.width,T.height=x.height||C.height||I.height||at.height||T.height,T.shape.type==="SwimLane"){if(t.diagramActions|=k.PreventHistory,T.shape.isLane){T.children=[],a={id:"header"+K()},T.shape.orientation==="Horizontal"?(a.width=T.shape.lanes[0].header.width,a.height=T.shape.lanes[0].height):(a.width=T.shape.lanes[0].width,a.height=T.shape.lanes[0].header.height),a.style=T.shape.lanes[0].header.style,a.offsetX=v.x+h+a.width/2,a.offsetY=v.y+a.height/2,t.diagramActions|=k.PreventCollectionChangeOnDragOver,a=t.add(a),s={id:"body"+K()},T.shape.orientation==="Horizontal"?(s.width=T.shape.lanes[0].width-a.width,s.height=T.shape.lanes[0].height,s.offsetX=v.x+h+(T.shape.lanes[0].header.width+s.width/2),s.offsetY=v.y+s.height/2):(s.width=T.shape.lanes[0].width,s.height=T.shape.lanes[0].height-a.height,s.offsetX=v.x+h+s.width/2,s.offsetY=v.y+(T.shape.lanes[0].header.height+s.height/2)),s.style=T.shape.lanes[0].style,s=t.add(s);var tt={id:"group"+K(),children:[a.id,s.id]};tt.shape=T.shape,tt.width=T.shape.lanes[0].width,tt.height=T.shape.lanes[0].height,tt.previewSize=T.previewSize,tt.dragSize=T.dragSize,tt.addInfo=T.addInfo,T=t.add(tt),t.diagramActions&=~k.PreventCollectionChangeOnDragOver}t.diagramActions&=~k.PreventHistory}if(T.shape.type==="Container"){t.diagramActions|=k.PreventHistory,t.diagramActions|=k.PreventCollectionChangeOnDragOver,T.shape.hasHeader&&(a={id:"header"+K()},a.width=T.width,a.height=T.shape.header.height,a.style=T.shape.header.style);var tt={id:"group"+K()};tt.shape=T.shape,tt.shape.header=a,tt.width=T.width,tt.height=T.height,tt.previewSize=T.previewSize,tt.dragSize=T.dragSize,tt.addInfo=T.addInfo,tt.offsetX=T.offsetX,tt.offsetY=T.offsetY,tt.ports=T.ports,tt.style=T.style,T=t.add(tt),t.diagramActions&=~k.PreventCollectionChangeOnDragOver,t.diagramActions&=~k.PreventHistory}if(T.shape.isPhase&&(g=T.shape.orientation==="Horizontal",g?(T.offsetX=v.x+h+(T.width||et.actualSize.width)/2,T.offsetY=v.y,T.shape.data="M20,"+T.height/2+" L"+(T.width-20)+","+T.height/2+"z",T.height=1):(T.offsetX=v.x+5,T.offsetY=v.y+(T.height||et.actualSize.height)/2,T.shape.data="M"+T.width/2+",20 L"+T.width/2+","+(T.height-20)+"z",T.width=1)),T.shape.type==="UmlClassifier"&&(T.children=T.width=T.height=void 0,m.children=void 0,T.shape.classifier==="Class"&&T.shape.classShape.methods.length<=0&&T.shape.classShape.attributes.length<=0&&(T.shape.classShape.attributes=[{name:"Name",type:"Type",style:{}}]),T.shape.classifier==="Enumeration"&&T.shape.enumerationShape.members.length<=0&&(T.shape.enumerationShape.members=[{name:"Name"}]),T.shape.classifier==="Interface"&&T.shape.interfaceShape.methods.length<=0&&T.shape.interfaceShape.attributes.length<=0&&(T.shape.interfaceShape.attributes=[{name:"Name",type:"Type",style:{}}])),u=T,m.children){var nt=m,wt={};r=t.getChildren(nt,wt,i),ih(nt,-nt.offsetX,-nt.offsetY,r,!0,t)}}else if(N[""+o]instanceof B){u=new B(t,"connectors",m,!0);var $=it.toBounds([u.sourcePoint,u.targetPoint]),pt=v.x-$.left,rt=v.y-$.top;u.sourcePoint.x+=pt,u.sourcePoint.y+=rt,u.targetPoint.x+=pt,u.targetPoint.y+=rt}!u.shape.isLane&&u.shape.type!=="Container"&&(u.id+=K());var A={source:N,element:u,cancel:!1,diagram:t,dragData:null,dragItem:u};if(t.enterObject=u,t.enterTable=r,t.triggerEvent(Z.dragEnter,A),u instanceof M&&u.shape.type==="SwimLane"&&u.shape.isLane){var mt=A.element,ct=mt.shape.lanes[0];g=mt.shape.orientation==="Horizontal";var Dt=t.nameTable[u.children[0]],Ge=t.nameTable[u.children[1]];x=u.dragSize,I=u.previewSize,C=N.symbolDragSize,ct.width=x.width||C.width||I.width||ct.width,ct.height=x.height||C.height||I.height||ct.height,g?(a.width=ct.header.width,a.height=ct.height,s.width=ct.width-a.width,s.height=ct.height,s.offsetX=v.x+h+(ct.header.width+Ge.width/2),s.offsetY=v.y+Ge.height/2):(a.width=ct.width,a.height=ct.header.height,s.width=ct.width,s.height=ct.height-a.height,s.offsetX=v.x+h+Ge.width/2,s.offsetY=v.y+(ct.header.height+Ge.height/2)),a.offsetX=v.x+h+Dt.width/2,a.offsetY=v.y+Dt.height/2,u.width=ct.width,u.height=ct.height}u instanceof M&&u.shape.isPhase&&(g?u.height=1:u.width=1);var Ce=!1;if(t.element.ej2_instances[0].constraints&lt.RestrictNegativeAxisDragDrop){if(u instanceof M){var ie=u.offsetX-u.width*u.pivot.x,Oe=u.offsetY-u.height*u.pivot.y;Ce=ie<0||Oe<0}else if(u instanceof B){var ie=Math.min(u.sourcePoint.x,u.targetPoint.x),Oe=Math.min(u.sourcePoint.y,u.targetPoint.y);Ce=ie<0||Oe<0}Ce&&t.element.ej2_instances[0].setCursor("not-allowed")}if(!t.activeLayer.lock&&!A.cancel&&!Ce){if(t.preventDiagramUpdate=!0,u.children&&t.findChild(u,r),t.preventDiagramUpdate=!0,u.zIndex!==Number.MIN_VALUE&&(u.zIndex=Number.MIN_VALUE),u.shape.type!=="Container"&&t.initObject(u,void 0,void 0,!0),t.bpmnModule)for(var ni=0;ni<t.bpmnModule.bpmnTextAnnotationConnector.length;ni++)t.bpmnModule.bpmnTextAnnotationConnector[parseInt(ni.toString(),10)].wrapper===null&&t.initConnectors(t.bpmnModule.bpmnTextAnnotationConnector[parseInt(ni.toString(),10)],void 0,!0);t.selectDragedNode(u,l,y)}delete t.enterObject,delete t.enterTable}t.droppable[""+o]=y,t.allowServerDataBinding=!0}}}},this.droppable.drop=function(l){return In(t,void 0,void 0,function(){var d,f,p,c,u,m,S,y,g,v,m,y,S,x,I,C;return xn(this,function(P){if(this.allowServerDataBinding=!1,d="sourceElement",this.currentSymbol?(p=!1,u=this.currentSymbol instanceof B,l.event.touches&&this.eventHandler.mouseUp(l.event),m={source:this.droppable[""+d],element:this.currentSymbol,target:this.eventHandler.hoverNode||this.findObjectsUnderMouse(this.eventHandler.getMousePosition(l.event))[0]||this,cancel:!1,position:{x:this.currentSymbol.wrapper.offsetX,y:this.currentSymbol.wrapper.offsetY}},this.commandHandler.PreventConnectorSplit=!1,this.triggerEvent(Z.drop,m),S="id",y=E(this.currentSymbol),y.hasTarget=this.currentSymbol.hasTarget,this.removeFromAQuad(this.currentSymbol),this.removeObjectsFromLayer(this.nameTable[this.currentSymbol.id]),this.removeElements(this.currentSymbol),(this.currentSymbol.shape.isLane||this.currentSymbol.shape.isPhase||this.currentSymbol.shape.type==="UmlClassifier"||this.currentSymbol.shape.type==="Container")&&this.removeChildInNodes(this.currentSymbol),m.cancel&&jo(this.currentSymbol,this),this.currentSymbol.shape.isPhase&&(p=!0,c=this.currentSymbol.shape.orientation,y.shape.phases=this.currentSymbol.shape.phases),this.removePreviewChildren(this.currentSymbol),delete this.nameTable[this.currentSymbol.id],this.currentSymbol=null,this.protectPropertyChange(!0),this.itemType="SymbolPalette",m.cancel?this.clearSelectorLayer():(this.startGroupAction(),y&&(y.shape.isLane||p)&&(p&&(y.shape.isPhase=p,y.shape.orientation=c),this.eventHandler.addSwimLaneObject(y)),y&&y.shape.type==="UmlClassifier"&&!y.shape.relationship&&(y.children=void 0,this.clearSelectorLayer(),this.add(y)),y.shape.type==="Bpmn"&&y.shape.annotation&&y.hasTarget&&(g=y.shape.annotation.nodeId,y.shape.annotation.id=y.id,this.addTextAnnotation(y.shape.annotation,this.nameTable[""+g]),y.nodeId=""),!y.shape.isLane&&!p&&(y.type!==void 0||y.shape.type!=="UmlClassifier")&&(y.children&&this.addChildNodes(y),m.target&&m.target instanceof M&&!u&&ne(this,m.target)&&Ga(m.target)&&!this.commandHandler.isTargetSubProcess(m.target)?zn(this,m.target,y):(y.type==="Bezier"&&y.segments.length>0&&(y.segments=[]),f=this.add(y,!0)),(y||f)&&(Yn(this)||Un(this))&&this.select([this.nameTable[y[""+S]]],!1,this.previousSelectedObjects),this.lineRoutingModule&&this.constraints&lt.LineRouting&&this.commandHandler.updateSelectedNodeProperties(this.selectedItems),m.target&&m.target instanceof B&&this.enableConnectorSplit===!0&&this.nameTable[y[""+S]]instanceof M&&(this.commandHandler.connectorSplit(this.nameTable[y[""+S]],m.target),this.commandHandler.PreventConnectorSplit=!1))),this.protectPropertyChange(!1),v=this.nameTable[y[""+S]],y.hasTarget&&(y.nodeId=y.hasTarget,this.remove(y)),this.bpmnModule&&v instanceof M&&y.processId&&(v.processId=y.processId,this.bpmnModule.dropBPMNchild(this.nameTable[v.processId],v,this)),v instanceof M&&y.parentId&&this.nameTable[y.parentId]&&this.nameTable[y.parentId].shape.type==="Container"&&(v.parentId=y.parentId,mf(this.nameTable[v.parentId],v,this)),m.cancel||this.endGroupAction(),this.mode!=="SVG"&&this.refreshDiagramLayer(),delete this.droppable[""+d]):(m={source:l.droppedElement,element:void 0,target:this.eventHandler.hoverNode||this.eventHandler.lastObjectUnderMouse||this,cancel:!1,position:void 0},this.triggerEvent(Z.drop,m),y=void 0,S="id"),x="selectedSymbols",this.droppable[""+x]&&this.droppable[""+x].parentNode)sn(this.droppable[""+x]);else for(I=document.getElementsByClassName("e-dragclone"),C=0;C<I.length;C++)I[parseInt(C.toString(),10)].remove();return this.allowServerDataBinding=!0,this.previousSelectedObjects=[],[2]})})},this.droppable.out=function(l){if(l.evt.type==="touchmove"&&t.eventHandler.mouseLeave(l.evt),t.currentSymbol&&!t.eventHandler.focus){if(t.unSelect(t.currentSymbol),t.removeFromAQuad(t.currentSymbol),t.mode!=="SVG"&&t.currentSymbol.shape.type==="Native"&&t.removeElements(t.currentSymbol),t.removeObjectsFromLayer(t.nameTable[t.currentSymbol.id]),t.currentSymbol.shape&&t.currentSymbol.shape.shape==="TextAnnotation"){var d=t.nameTable[t.currentSymbol.inEdges[0]];t.removeObjectsFromLayer(t.nameTable[d.id]),t.removeFromAQuad(d),t.removePreviewChildren(d),delete t.nameTable[d.id];var f=t.connectors.indexOf(d);t.connectors.splice(f,1),t.removeElements(d)}t.removePreviewChildren(t.currentSymbol),delete t.nameTable[t.currentSymbol.id];var p={element:t.currentSymbol,diagram:t};if(t.triggerEvent(Z.dragLeave,p),t.mode!=="SVG")t.refreshDiagramLayer();else{if(t.removeElements(t.currentSymbol),t.currentSymbol.shape.type!=="SwimLane"&&t.currentSymbol.children&&t.currentSymbol.children.length>0)for(var c=0;c<t.currentSymbol.children.length;c++){var u=t.nameTable[t.currentSymbol.children[parseInt(c.toString(),10)]];t.removeElements(u),delete t.nameTable[t.currentSymbol.children[parseInt(c.toString(),10)]]}if(t.currentSymbol.shape.type==="Container"&&t.currentSymbol.shape.hasHeader){var u=t.nameTable[t.currentSymbol.id+t.currentSymbol.shape.header.id];t.removeFromAQuad(u),delete t.nameTable[u.id],t.removeElements(u)}}t.currentSymbol=null;var g="selectedSymbols";t.droppable[""+g].style.opacity="1";var v="sourceElement";delete t.droppable[""+v],t.diagramRenderer.rendererActions=t.removeConstraints(t.diagramRenderer.rendererActions,fi.DrawSelectorBorder),t.previousSelectedObject&&t.select(t.previousSelectedObject,t.previousSelectedObject.length>1),t.previousSelectedObject=null}}},e.prototype.getDropEventArgs=function(t){if(this.eventHandler.lastObjectUnderMouse||this.eventHandler.hoverNode){var i=this.eventHandler.lastObjectUnderMouse||this.eventHandler.hoverNode;t.target=Fe(i)===B?{connector:i}:{node:i}}else t.target.diagramId=this.element.id},e.prototype.removeChildInNodes=function(t){if(t&&t.shape.type!=="Container"){if(t.children)for(var i=0;i<t.children.length;i++)this.removeChildInNodes(this.nameTable[t.children[parseInt(i.toString(),10)]]);var r=this.nodes.indexOf(t);r!==-1&&this.nodes.splice(r,1)}else if(t&&t.shape.type==="Container"){t.shape.hasHeader&&this.removeChildInNodes(this.nameTable[t.id+t.shape.header.id]);var r=this.nodes.indexOf(t);r!==-1&&this.nodes.splice(r,1)}},e.prototype.getBlazorDragEventArgs=function(t){return t={source:t.source,element:Fe(t.element)===B?{connector:t.element}:{node:t.element},cancel:t.cancel,diagramId:this.element.id},t},e.prototype.findChild=function(t,i){for(var r,a,s=0;s<t.children.length;s++)r=i[t.children[parseInt(s.toString(),10)]],r&&(r.children&&this.findChild(r,i),r.id=r.id+K(),i[r.id]=r,t.children[parseInt(s.toString(),10)]=r.id,a=new M(this,"nodes",r,!0),this.initObject(a,void 0,void 0,!0))},e.prototype.getChildren=function(t,i,r){for(var a,s=0;s<t.children.length;s++)a=r[t.children[parseInt(s.toString(),10)]],a&&(a.children&&(i=this.getChildren(a,i,r)),i[a.id]=E(a));return i},e.prototype.addChildNodes=function(t){for(var i,r=0;r<t.children.length;r++)i=this.nameTable[t.children[parseInt(r.toString(),10)]],i&&(i.children&&this.addChildNodes(i),this.add(i,!0))},e.prototype.moveNode=function(t){for(var i=this.commandHandler.getObjectLayer(t.id),r=i.zIndex,a=i.objects.length,s,o=0;o<this.layers.length;o++)r===this.layers[parseInt(o.toString(),10)].zIndex&&(s=this.layers[o+1]);if(a>1){var h=2;if(t.children&&t.children.length>0)for(;t.children.indexOf(i.objects[a-h])>-1;)h++;if(a-h>-1){var l=this.nameTable[i.objects[a-h]];if(t.zIndex>l.zIndex){var d=l.parentId!==t.parentId&&l.parentId?this.getRootParentId(l):l.id;this.commandHandler.moveSvgNode(t.id,d),this.commandHandler.moveSvgNode(d,t.id)}}else this.moveNodeWithTargetLayer(t,i,s)}else this.moveNodeWithTargetLayer(t,i,s)},e.prototype.moveNodeWithTargetLayer=function(t,i,r){if(r){var a=this.commandHandler.getLayer(this.layerZIndexTable[r.zIndex]).objects[0];a?(this.commandHandler.moveSvgNode(t.id,a),this.commandHandler.updateNativeNodeIndex(t.id,a)):this.moveObjectsUp(t,i)}else this.moveObjectsUp(t,i)},e.prototype.getRootParentId=function(t){for(var i=t;i&&i.parentId;){var r=i.parentId,a=this.nameTable[""+r];if(!a)break;i=a}return i.id},e.prototype.moveObjectsUp=function(t,i){for(var r,a=this.layers.length-1;a>=0;a--)if(r=this.layers[parseInt(a.toString(),10)],i.id!==r.id){var s=this.commandHandler.getLayer(this.layerZIndexTable[r.zIndex]).objects[r.objects.length-1];if(s){this.commandHandler.moveSvgNode(t.id,s),this.commandHandler.moveSvgNode(s,t.id);break}}},e.prototype.insertData=function(t){return this.crudOperation(t,"create",this.getNewUpdateNodes("New"))},e.prototype.updateData=function(t){return this.crudOperation(t,"update",this.getNewUpdateNodes("Update"))},e.prototype.removeData=function(t){return this.crudOperation(t,"destroy",this.getDeletedNodes())},e.prototype.distributePorts=function(t){for(var i=this,r=[],a=function(h){var l=s.nameTable[t[parseInt(h.toString(),10)]];if(!l||!l.ports||!l.width||!l.height)return"continue";for(var d=function(g){var v=l.ports[parseInt(g.toString(),10)],m=0;if(v.inEdges&&v.inEdges.length&&(m+=v.inEdges.length),v.outEdges&&v.outEdges.length&&(m+=v.outEdges.length),m>1)return"continue";var y=v.offset.x*l.width,S=v.offset.y*l.height,x=y,I=l.width-y,C=S,P=l.height-S,A=[{edge:"Left",value:x},{edge:"Right",value:I},{edge:"Top",value:C},{edge:"Bottom",value:P}],T=Math.min(x,I,C,P),z=A.filter(function(nt){return nt.value===T}),L=z[0].edge;if(z.length>1){var R=null;if(v.outEdges&&v.outEdges.length>0?R=s.nameTable[v.outEdges[0]]:v.inEdges&&v.inEdges.length>0&&(R=s.nameTable[v.inEdges[0]]),R){var O=R.targetPoint;if(O){var N=l.offsetX-l.width*l.pivot.x,H=l.offsetY-l.height*l.pivot.y,F={x:N+v.offset.x*l.width,y:H+v.offset.y*l.height},Y=O.x-F.x,et=O.y-F.y,at=Math.abs(Y),tt=Math.abs(et);at>tt?Y<0&&z.some(function(nt){return nt.edge==="Left"})?L="Left":Y>0&&z.some(function(nt){return nt.edge==="Right"})&&(L="Right"):et<0&&z.some(function(nt){return nt.edge==="Top"})?L="Top":et>0&&z.some(function(nt){return nt.edge==="Bottom"})&&(L="Bottom")}}}switch(L){case"Left":{v.offset.x=0;break}case"Right":{v.offset.x=1;break}case"Top":{v.offset.y=0;break}case"Bottom":{v.offset.y=1;break}}},f=0;f<l.ports.length;f++)d(f);for(var p={Left:[],Right:[],Top:[],Bottom:[]},c=0;c<l.ports.length;c++){var u=l.ports[parseInt(c.toString(),10)];u.offset.x===0?p.Left.push(u):u.offset.x===1?p.Right.push(u):u.offset.y===0?p.Top.push(u):u.offset.y===1&&p.Bottom.push(u)}["Left","Right","Top","Bottom"].forEach(function(g){var v=p[""+g];if(v.length!==0){v.sort(i.callSort(l,g,i,r)),r.indexOf(l.id)===-1&&r.push(l.id);for(var m=v.length,y=0;y<m;y++){var S=v[parseInt(y.toString(),10)],x=0;if(S.inEdges&&S.inEdges.length&&(x+=S.inEdges.length),S.outEdges&&S.outEdges.length&&(x+=S.outEdges.length),!(x>1)){var I=(y+1)/(m+1);g==="Left"||g==="Right"?S.offset.y=I:S.offset.x=I}}}})},s=this,o=0;o<t.length;o++)a(o)},e.prototype.getProjectedOffset=function(t,i,r){var a=i.offsetX-i.width*i.pivot.x,s=i.offsetY-i.height*i.pivot.y;return{x:a+t.offset.x*i.width,y:s+t.offset.y*i.height}},e.prototype.callSort=function(t,i,r,a){return function(s,o){var h=s.outEdges&&s.outEdges.length||s.inEdges&&s.inEdges.length,l=o.outEdges&&o.outEdges.length||o.inEdges&&o.inEdges.length,d=h?r.getConnectorTargetOffset(s,t,i,r):r.getProjectedOffset(s,t,i),f=l?r.getConnectorTargetOffset(o,t,i,r):r.getProjectedOffset(o,t,i),p=s.outEdges&&s.outEdges.length?r.nameTable[s.outEdges[0]]:s.inEdges&&s.inEdges.length?r.nameTable[s.inEdges[0]]:null,c=o.outEdges&&o.outEdges.length?r.nameTable[o.outEdges[0]]:o.inEdges&&o.inEdges.length?r.nameTable[o.inEdges[0]]:null,u=!1,g,v,m,y,S,x,I,C;if(p&&(g=r.nameTable[p.sourceID],m=r.getConnectedPort(g,p,!0),S=r.nameTable[p.targetID],I=r.getConnectedPort(S,p),p.targetID===t.id&&(u=!0),S&&a.indexOf(S.id)!==-1&&(p=null)),c&&(v=r.nameTable[c.sourceID],y=r.getConnectedPort(v,c,!0),x=r.nameTable[c.targetID],C=r.getConnectedPort(x,c),c.targetID===t.id&&(u=!0),x&&a.indexOf(x.id)!==-1&&(c=null)),p&&c){var P=void 0,A=void 0;return(I&&I.offset.x===0||!I&&m&&m.offset.x===0)&&(P="Left"),(I&&I.offset.x===1||!I&&m&&m.offset.x===1)&&(P="Right"),(I&&I.offset.y===0||!I&&m&&m.offset.y===0)&&(P="Top"),(I&&I.offset.y===1||!I&&m&&m.offset.y===1)&&(P="Bottom"),(C&&C.offset.x===0||!C&&y&&y.offset.x===0)&&(A="Left"),(C&&C.offset.x===1||!C&&y&&y.offset.x===1)&&(A="Right"),(C&&C.offset.y===0||!C&&y&&y.offset.y===0)&&(A="Top"),(C&&C.offset.y===1||!C&&y&&y.offset.y===1)&&(A="Bottom"),i==="Top"||i==="Bottom"?c.targetID!==t.id&&(i==="Top"&&P==="Bottom"||i==="Top"&&P==="Right"||i==="Bottom"&&P==="Top"||i==="Bottom"&&P==="Left")?d.x-f.x===0?f.y-d.y:d.x-f.x:i==="Top"&&P==="Top"||i==="Top"&&P==="Left"||i==="Bottom"&&P==="Bottom"||i==="Bottom"&&P==="Right"?S&&x&&S.id===x.id&&!u&&(i==="Bottom"&&P==="Right"&&A==="Right"||i==="Bottom"&&P==="Bottom"&&A==="Bottom"||i==="Top"&&P==="Top"&&A==="Top"||i==="Top"&&P==="Left"&&A==="Left")?d.x-f.x===0?d.y-f.y:f.x-d.x:d.x-f.x===0?f.y-d.y:d.x-f.x:d.x-f.x===0?d.y-f.y:f.x-d.x:i==="Left"&&P==="Right"||i==="Left"&&P==="Bottom"||i==="Right"&&P==="Left"||i==="Right"&&P==="Top"?d.y-f.y===0?f.x-d.x:d.y-f.y:i==="Left"&&P==="Left"||i==="Left"&&P==="Top"||i==="Right"&&P==="Right"||i==="Right"&&P==="Bottom"?S&&x&&S.id===x.id&&!u&&(i==="Right"&&P==="Bottom"&&A==="Bottom"||i==="Right"&&P==="Right"&&A==="Right"||i==="Left"&&P==="Left"&&A==="Left"||i==="Left"&&P==="Top"&&A==="Top")?d.y-f.y===0?d.x-f.x:f.y-d.y:d.y-f.y===0?f.x-d.x:d.y-f.y:d.y-f.y===0?d.x-f.x:f.y-d.y}return 0}},e.prototype.getConnectorTargetOffset=function(t,i,r,a){var s=null;return t.outEdges&&t.outEdges.length>0?s=a.nameTable[t.outEdges[0]]:t.inEdges&&t.inEdges.length>0&&(s=a.nameTable[t.inEdges[0]]),s?s.targetPoint:this.getProjectedOffset(t,i,r)},e.prototype.crudOperation=function(t,i,r){if(t){var a=this.parameterMap(t,!(t instanceof B));if(a){var s=t instanceof B?this.dataSourceSettings.connectionDataSource.crudAction[""+i]:this.dataSourceSettings.crudAction[""+i];this.raiseAjaxPost(JSON.stringify(a),s)}return a}else{var o=r;return this.processCrudCollection(o,this.dataSourceSettings.crudAction[""+i],this.dataSourceSettings.connectionDataSource.crudAction[""+i]),o}},e.prototype.processCrudCollection=function(t,i,r){if(t.nodes){var a=[],s=void 0;for(s=0;s<t.nodes.length;s++)a.push(this.parameterMap(t.nodes[parseInt(s.toString(),10)],!0));a&&a.length>0&&this.raiseAjaxPost(JSON.stringify(a),i)}if(t.connectors){var a=[],s=void 0;for(s=0;s<t.connectors.length;s++)a.push(this.parameterMap(t.connectors[parseInt(s.toString(),10)],!1));a&&a.length>0&&this.raiseAjaxPost(JSON.stringify(a),r)}},e.prototype.parameterMap=function(t,i){var r={},a,s=i?this.dataSourceSettings:this.dataSourceSettings.connectionDataSource;if(s.id&&(r[s.id]=t.id),s.sourcePointX&&s.sourcePointY&&(r[s.sourcePointX]=t.sourcePoint.x,r[s.sourcePointY]=t.sourcePoint.y),s.targetPointX&&s.targetPointY&&(r[s.targetPointX]=t.targetPoint.x,r[s.targetPointY]=t.targetPoint.y),s.sourceID&&(r[s.sourceID]=t.sourceID),s.targetID&&(r[s.targetID]=t.targetID),s.crudAction&&s.crudAction.customFields&&s.crudAction.customFields.length>0)for(a=0;a<s.crudAction.customFields.length;a++)r[s.crudAction.customFields[parseInt(a.toString(),10)]]=t[s.crudAction.customFields[parseInt(a.toString(),10)]];return r},e.prototype.getNewUpdateNodes=function(t){var i=[],r=[];for(var a in this.nameTable){var s=this.nameTable[""+a];s.status===t&&(s&&s instanceof B?(s.status="None",r.push(s)):(s.status="None",i.push(s)))}return{nodes:i,connectors:r}},e.prototype.getDeletedNodes=function(){var t=[],i=[],r;for(r=0;r<this.crudDeleteNodes.length;r++){var a=this.crudDeleteNodes[parseInt(r.toString(),10)];a&&a.segments?i.push(a):a&&t.push(a)}return this.crudDeleteNodes=[],{nodes:t,connectors:i}},e.prototype.raiseAjaxPost=function(t,i){var r=new Ts(i,"POST","application/json"),a=JSON.stringify(JSON.parse(t));r.send(a).then(),r.onSuccess=function(s){}},e.prototype.getHiddenItems=function(t){var i=[];if(this.contextMenuModule){this.contextMenuModule.hiddenItems=[];for(var r=0,a=t.items;r<a.length;r++){var s=a[r];if(this.contextMenuModule.ensureItems(s,t.event),s.items&&s.items.length)for(var o=0,h=s.items;o<h.length;o++){var l=h[o];this.contextMenuModule.ensureItems(l,t.event)}}return this.contextMenuModule.hiddenItems}return i},e.prototype.importFromVisio=function(t,i){return In(this,void 0,void 0,function(){var r;return xn(this,function(a){switch(a.label){case 0:return this.importAndExportVisioModule?[4,this.importAndExportVisioModule.importVSDX(t,this,i)]:[3,2];case 1:return r=a.sent(),[2,r.warnings];case 2:console.warn('[WARNING] :: Module "ImportAndExportVisio" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),a.label=3;case 3:return[2,null]}})})},e.prototype.exportToVisio=function(t){return In(this,void 0,void 0,function(){return xn(this,function(i){return this.importAndExportVisioModule?[2,this.importAndExportVisioModule.exportVSDX(this,t)]:(console.warn('[WARNING] :: Module "ImportAndExportVisio" is not available in Diagram component! You either misspelled the module name or forgot to load it.'),[2,null])})})},Q([w("100%")],e.prototype,"width",void 0),Q([w(!1)],e.prototype,"enableConnectorSplit",void 0),Q([w("SVG")],e.prototype,"mode",void 0),Q([w("100%")],e.prototype,"height",void 0),Q([w("Circle")],e.prototype,"segmentThumbShape",void 0),Q([w(10)],e.prototype,"segmentThumbSize",void 0),Q([X({},i0)],e.prototype,"contextMenuSettings",void 0),Q([w(lt.Default)],e.prototype,"constraints",void 0),Q([w(Gt.Default)],e.prototype,"tool",void 0),Q([w("Top")],e.prototype,"bridgeDirection",void 0),Q([w("transparent")],e.prototype,"backgroundColor",void 0),Q([X({},Uy)],e.prototype,"snapSettings",void 0),Q([X({},Fy)],e.prototype,"rulerSettings",void 0),Q([X({},Ny)],e.prototype,"pageSettings",void 0),Q([X({},sS)],e.prototype,"serializationSettings",void 0),Q([Lt([],M)],e.prototype,"nodes",void 0),Q([w()],e.prototype,"drawingObject",void 0),Q([Lt([],B)],e.prototype,"connectors",void 0),Q([w([])],e.prototype,"basicElements",void 0),Q([X({},Gr)],e.prototype,"tooltip",void 0),Q([X({},$y)],e.prototype,"dataSourceSettings",void 0),Q([w()],e.prototype,"addInfo",void 0),Q([w()],e.prototype,"historyManager",void 0),Q([w()],e.prototype,"nodeTemplate",void 0),Q([w()],e.prototype,"annotationTemplate",void 0),Q([w()],e.prototype,"userHandleTemplate",void 0),Q([w()],e.prototype,"fixedUserHandleTemplate",void 0),Q([w()],e.prototype,"getNodeDefaults",void 0),Q([w()],e.prototype,"nodeDefaults",void 0),Q([w()],e.prototype,"getConnectorDefaults",void 0),Q([w()],e.prototype,"connectorDefaults",void 0),Q([w()],e.prototype,"setNodeTemplate",void 0),Q([w()],e.prototype,"getDescription",void 0),Q([w()],e.prototype,"getCustomProperty",void 0),Q([w()],e.prototype,"getCustomTool",void 0),Q([w()],e.prototype,"getCustomCursor",void 0),Q([Lt([],hS)],e.prototype,"customCursor",void 0),Q([w()],e.prototype,"updateSelection",void 0),Q([X({},pS)],e.prototype,"diagramSettings",void 0),Q([X({},It)],e.prototype,"selectedItems",void 0),Q([X({},Xy)],e.prototype,"scrollSettings",void 0),Q([X({},Qy)],e.prototype,"layout",void 0),Q([X(void 0,yS)],e.prototype,"model",void 0),Q([X({},e0)],e.prototype,"commandManager",void 0),Q([ot()],e.prototype,"dataLoaded",void 0),Q([ot()],e.prototype,"dragEnter",void 0),Q([ot()],e.prototype,"dragLeave",void 0),Q([ot()],e.prototype,"dragOver",void 0),Q([ot()],e.prototype,"click",void 0),Q([ot()],e.prototype,"historyChange",void 0),Q([ot()],e.prototype,"historyStateChange",void 0),Q([ot()],e.prototype,"doubleClick",void 0),Q([ot()],e.prototype,"textEdit",void 0),Q([ot()],e.prototype,"scrollChange",void 0),Q([ot()],e.prototype,"mouseWheel",void 0),Q([ot()],e.prototype,"selectionChange",void 0),Q([ot()],e.prototype,"sizeChange",void 0),Q([ot()],e.prototype,"connectionChange",void 0),Q([ot()],e.prototype,"sourcePointChange",void 0),Q([ot()],e.prototype,"targetPointChange",void 0),Q([ot()],e.prototype,"propertyChange",void 0),Q([ot()],e.prototype,"positionChange",void 0),Q([ot()],e.prototype,"keyUp",void 0),Q([ot()],e.prototype,"keyDown",void 0),Q([ot()],e.prototype,"animationComplete",void 0),Q([ot()],e.prototype,"rotateChange",void 0),Q([ot()],e.prototype,"collectionChange",void 0),Q([ot()],e.prototype,"fixedUserHandleClick",void 0),Q([ot()],e.prototype,"onUserHandleMouseDown",void 0),Q([ot()],e.prototype,"onUserHandleMouseUp",void 0),Q([ot()],e.prototype,"onUserHandleMouseEnter",void 0),Q([ot()],e.prototype,"onUserHandleMouseLeave",void 0),Q([ot()],e.prototype,"onFixedUserHandleMouseDown",void 0),Q([ot()],e.prototype,"onFixedUserHandleMouseUp",void 0),Q([ot()],e.prototype,"onFixedUserHandleMouseEnter",void 0),Q([ot()],e.prototype,"onFixedUserHandleMouseLeave",void 0),Q([ot()],e.prototype,"segmentCollectionChange",void 0),Q([ot()],e.prototype,"onImageLoad",void 0),Q([ot()],e.prototype,"expandStateChange",void 0),Q([ot()],e.prototype,"load",void 0),Q([ot()],e.prototype,"created",void 0),Q([ot()],e.prototype,"mouseEnter",void 0),Q([ot()],e.prototype,"mouseLeave",void 0),Q([ot()],e.prototype,"mouseOver",void 0),Q([ot()],e.prototype,"elementDraw",void 0),Q([ot()],e.prototype,"contextMenuOpen",void 0),Q([ot()],e.prototype,"contextMenuBeforeItemRender",void 0),Q([ot()],e.prototype,"contextMenuClick",void 0),Q([ot()],e.prototype,"commandExecute",void 0),Q([Lt([],Wf)],e.prototype,"layers",void 0),Q([ot()],e.prototype,"drop",void 0),Q([ot()],e.prototype,"segmentChange",void 0),Q([ot()],e.prototype,"loaded",void 0),Q([ot()],e.prototype,"layoutUpdated",void 0),Q([ot()],e.prototype,"diagramImporting",void 0),Q([ot()],e.prototype,"diagramExporting",void 0),e})(Vr),ws=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Yt=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},ga="e-acrdn-root",Er="e-accordion",$e="e-acrdn-item",kl="e-item-focus",Cn="e-hide",me="e-acrdn-header",DS="e-acrdn-header-icon",Dr="e-acrdn-header-content",ai="e-acrdn-panel",Oi="e-acrdn-content",Pn="e-toggle-icon",LS="e-tgl-collapse-icon e-icons",Rl="e-expand-icon",Js="e-rtl",_s="e-content-hide",Ks="e-select",Tn="e-selected",An="e-active",MS="e-animate",_r="e-overlay",va="e-toggle-animation",zS="e-nested",yi="e-expand-state",Hl="e-accordion-container",Bl=(function(n){ws(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Yt([w("SlideDown")],e.prototype,"effect",void 0),Yt([w(400)],e.prototype,"duration",void 0),Yt([w("linear")],e.prototype,"easing",void 0),e})(j),kS=(function(n){ws(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Yt([X({effect:"SlideUp",duration:400,easing:"linear"},Bl)],e.prototype,"collapse",void 0),Yt([X({effect:"SlideDown",duration:400,easing:"linear"},Bl)],e.prototype,"expand",void 0),e})(j),RS=(function(n){ws(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Yt([w(null)],e.prototype,"content",void 0),Yt([w(null)],e.prototype,"header",void 0),Yt([w(null)],e.prototype,"cssClass",void 0),Yt([w(null)],e.prototype,"iconCss",void 0),Yt([w(!1)],e.prototype,"expanded",void 0),Yt([w(!0)],e.prototype,"visible",void 0),Yt([w(!1)],e.prototype,"disabled",void 0),Yt([w()],e.prototype,"id",void 0),e})(j),HS=(function(n){ws(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.keyConfigs={moveUp:"uparrow",moveDown:"downarrow",enter:"enter",space:"space",home:"home",end:"end"},r}return e.prototype.destroy=function(){(this.isReact||this.isAngular||this.isVue)&&this.clearTemplate();var t=this.element;if(n.prototype.destroy.call(this),this.unWireEvents(),this.isDestroy=!0,this.restoreContent(null),[].slice.call(t.children).forEach(function(i){t.removeChild(i)}),this.trgtEle){for(this.trgtEle=null;this.ctrlTem.firstElementChild;)t.appendChild(this.ctrlTem.firstElementChild);this.ctrlTem=null}t.classList.remove(ga),t.removeAttribute("style"),this.element.removeAttribute("data-ripple"),!this.isNested&&ig},e.prototype.preRender=function(){var t=re(this.element,"."+ai);this.isNested=!1,this.templateEle=[],this.isDestroy||(this.isDestroy=!1),t&&t.firstElementChild&&t.firstElementChild.firstElementChild?t.firstElementChild.firstElementChild.classList.contains(Er)&&(t.classList.add(zS),this.isNested=!0):this.element.classList.add(ga),this.enableRtl&&this.add(this.element,Js)},e.prototype.add=function(t,i){t.classList.add(i)},e.prototype.remove=function(t,i){t.classList.remove(i)},e.prototype.render=function(){this.initializeHeaderTemplate(),this.initializeItemTemplate(),this.initialize(),this.renderControl(),this.wireEvents(),this.renderComplete()},e.prototype.initialize=function(){var t=Ve(this.width),i=Ve(this.height);Yi(this.element,{width:t,height:i}),V(this.initExpand)&&(this.initExpand=[]),!V(this.expandedIndices)&&this.expandedIndices.length>0&&(this.initExpand=this.expandedIndices)},e.prototype.renderControl=function(){this.trgtEle=this.element.children.length>0?Bt("div",this.element):null,this.renderItems(),this.initItemExpand()},e.prototype.wireFocusEvents=function(){for(var t=[].slice.call(this.element.querySelectorAll("."+$e)),i=0,r=t;i<r.length;i++){var a=r[i],s=a.querySelector("."+me);a.childElementCount>0&&s&&(J.clearEvents(s),J.add(s,"focus",this.focusIn,this),J.add(s,"blur",this.focusOut,this))}},e.prototype.unWireEvents=function(){J.remove(this.element,"click",this.clickHandler),V(this.keyModule)||this.keyModule.destroy()},e.prototype.wireEvents=function(){J.add(this.element,"click",this.clickHandler,this),!this.isNested&&!this.isDestroy&&(this.removeRippleEffect=rg(this.element,{selector:"."+me})),this.isNested||(this.keyModule=new ng(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}))},e.prototype.templateParser=function(t){if(t)try{return typeof t!="function"&&document.querySelectorAll(t).length?Re(document.querySelector(t).innerHTML.trim()):Re(t)}catch{return Re(t)}},e.prototype.initializeHeaderTemplate=function(){this.headerTemplate&&(this.headerTemplateFn=this.templateParser(this.headerTemplate))},e.prototype.initializeItemTemplate=function(){this.itemTemplate&&(this.itemTemplateFn=this.templateParser(this.itemTemplate))},e.prototype.getHeaderTemplate=function(){return this.headerTemplateFn},e.prototype.getItemTemplate=function(){return this.itemTemplateFn},e.prototype.focusIn=function(t){t.target.parentElement.classList.add(kl)},e.prototype.focusOut=function(t){t.target.parentElement.classList.remove(kl)},e.prototype.ctrlTemplate=function(){this.ctrlTem=this.element.cloneNode(!0);var t,i=Bt("."+Hl,this.element);i?t=i.children:t=this.element.children;var r=[];[].slice.call(t).forEach(function(a){r.push({header:a.childElementCount>0&&a.children[0]?a.children[0]:"",content:a.childElementCount>1&&a.children[1]?a.children[1]:""}),a.parentNode.removeChild(a)}),i&&this.element.removeChild(i),this.setProperties({items:r},!0)},e.prototype.toggleIconGenerate=function(){var t=this.createElement("div",{className:Pn}),i=this.createElement("span",{className:LS});return t.appendChild(i),t},e.prototype.initItemExpand=function(){var t=this.initExpand.length;if(t!==0){if(this.expandMode==="Single")this.expandItem(!0,this.initExpand[t-1]);else for(var i=0;i<t;i++)this.expandItem(!0,this.initExpand[parseInt(i.toString(),10)]);this.isReact&&this.renderReactTemplates()}},e.prototype.renderItems=function(){var t=this,i=this.element,r,a;if(V(this.trgtEle)||this.ctrlTemplate(),!V(this.dataSource)&&this.dataSource.length>0)this.dataSource.forEach(function(o,h){a=t.renderInnerItem(o,h),i.appendChild(a),a.childElementCount>0&&(J.add(a.querySelector("."+me),"focus",t.focusIn,t),J.add(a.querySelector("."+me),"blur",t.focusOut,t))});else{var s=this.items;i&&s.length>0&&s.forEach(function(o,h){r=t.renderInnerItem(o,h),i.appendChild(r),r.childElementCount>0&&(J.add(r.querySelector("."+me),"focus",t.focusIn,t),J.add(r.querySelector("."+me),"blur",t.focusOut,t))})}this.isReact&&this.renderReactTemplates()},e.prototype.clickHandler=function(t){var i=t.target,r=this.getItems(),a={},s,o=re(i,"."+Er);if(o===this.element){i.classList.add("e-target");var h=re(i,"."+$e),l=re(i,"."+me),d=re(i,"."+ai);h&&(V(l)||V(d))&&(l=h.children[0],d=h.children[1]),l&&(s=Bt("."+Pn,l));var f;l?f=re(l,"."+$e):d&&(f=re(d,"."+$e));var p=this.getIndexByItem(h);f&&(a.item=r[this.getIndexByItem(f)]),a.originalEvent=t;var c=!V(s)&&h.childElementCount<=1;c&&(V(d)||!V(Bt("."+me+" ."+Pn,f)))?(h.appendChild(this.contentRendering(p)),this.ariaAttrUpdate(h),this.afterContentRender(i,a,h,l,d,f)):this.afterContentRender(i,a,h,l,d,f),this.isReact&&this.renderReactTemplates()}},e.prototype.afterContentRender=function(t,i,r,a,s,o){var h=this,l=[];this.trigger("clicked",i,function(d){if(!d.cancel){var f=s&&!V(Bt(".e-target",s)),p="."+ai+" ."+Er,c=s&&!V(Bt("."+Er,s))&&V(re(t,p)),u=s&&V(Bt("."+Er,s))||re(t,"."+Er)!==h.element;if(f=f&&(c||u),t.classList.remove("e-target"),!(t.classList.contains(ai)||t.classList.contains(Oi)||f)){var g=h.element.querySelector("."+Hl),v=g?g.children:h.element.children;[].slice.call(v).forEach(function(z){z.classList.contains(An)&&l.push(z)});var m=[].slice.call(h.element.querySelectorAll("."+$e+" ["+MS+"]"));if(m.length>0)for(var y=0,S=m;y<S.length;y++){var x=S[y];l.push(x.parentElement)}var I=l.indexOf(o)!==-1&&s.getAttribute("e-animate")==="true",C=!1;if(!V(r)&&!V(a)){var P=Bt("."+ai,r),A=re(r,"."+ga),T=A.querySelector("."+yi);if(V(P))return;C=T===r,As(P)&&(!I||o.classList.contains(Tn))?h.collapse(P):(l.length>0&&h.expandMode==="Single"&&!I&&l.forEach(function(z){h.collapse(Bt("."+ai,z)),z.classList.remove(yi)}),h.expand(P)),!V(T)&&!C&&T.classList.remove(yi)}}}})},e.prototype.eleMoveFocus=function(t,i,r){var a,s=re(r,"."+$e);r===i?a=(t==="moveUp"?r.lastElementChild:r).querySelector("."+me):r.classList.contains(me)&&(s=t==="moveUp"?s.previousElementSibling:s.nextElementSibling,s&&(a=Bt("."+me,s))),a&&a.focus()},e.prototype.keyActionHandler=function(t){var i=t.target,r=re(t.target,me);if(!(V(r)&&!i.classList.contains(Er)&&!i.classList.contains(me))){var a,s=this.element,o;switch(t.action){case"moveUp":this.eleMoveFocus(t.action,s,i);break;case"moveDown":this.eleMoveFocus(t.action,s,i);break;case"space":case"enter":o=i.nextElementSibling,!V(o)&&o.classList.contains(ai)?o.getAttribute("e-animate")!=="true"&&i.click():i.click(),t.preventDefault();break;case"home":case"end":a=t.action==="home"?s.firstElementChild.children[0]:s.lastElementChild.children[0],a.focus(),t.preventDefault();break}}},e.prototype.headerEleGenerate=function(){var t=this.createElement("div",{className:me,id:Rr("acrdn_header")}),i={tabindex:"0",role:"button","aria-disabled":"false","aria-expanded":"false"};return Kr(t,i),t},e.prototype.renderInnerItem=function(t,i){var r=this.createElement("div",{className:$e,id:t.id||Rr("acrdn_item")});if(this.headerTemplate){var a=this.headerEleGenerate(),s=this.createElement("div",{className:Dr});return a.appendChild(s),ba(this.getHeaderTemplate()(t,this,"headerTemplate",this.element.id+"_headerTemplate",!1),s),r.appendChild(a),a.appendChild(this.toggleIconGenerate()),this.add(r,Ks),r}if(t.header&&this.angularnativeCondiCheck(t,"header")){var o=t.header;this.enableHtmlSanitizer&&typeof t.header=="string"&&(o=jr.sanitize(t.header));var a=this.headerEleGenerate(),s=this.createElement("div",{className:Dr});a.appendChild(s),a.appendChild(this.fetchElement(s,o,i)),r.appendChild(a)}var h=Bt("."+me,r);if(t.expanded&&!V(i)&&!this.enablePersistence&&this.initExpand.indexOf(i)===-1&&this.initExpand.push(i),t.cssClass&&he([r],t.cssClass.split(" ")),t.disabled&&he([r],_r),t.visible===!1&&he([r],Cn),t.iconCss){var l=this.createElement("div",{className:DS}),d=this.createElement("span",{className:t.iconCss+" e-icons"});l.appendChild(d),V(h)?(h=this.headerEleGenerate(),h.appendChild(l),r.appendChild(h)):h.insertBefore(l,h.childNodes[0])}if(t.content&&this.angularnativeCondiCheck(t,"content")){var f=this.toggleIconGenerate();V(h)&&(h=this.headerEleGenerate(),r.appendChild(h)),h.appendChild(f),this.add(r,Ks)}return r},e.prototype.angularnativeCondiCheck=function(t,i){var r=i==="content"?t.content:t.header,a=r;if(this.isAngular&&!V(a.elementRef)){var s=a.elementRef.nativeElement.data;if(V(s)||s===""||s.indexOf("bindings=")===-1)return!0;var o=JSON.parse(a.elementRef.nativeElement.data.replace("bindings=",""));return!(!V(o)&&o["ng-reflect-ng-if"]==="false")}else return!0},e.prototype.fetchElement=function(t,i,r){var a,s;try{if(document.querySelectorAll(i).length&&i!=="Button"){var o=document.querySelector(i);s=o.outerHTML.trim(),t.appendChild(o),o.style.display=""}else a=Re(i)}catch{typeof i=="string"?t.innerHTML=this.enableHtmlSanitizer?jr.sanitize(i):i:i instanceof HTMLElement?(t.appendChild(i),this.trgtEle&&(t.firstElementChild.style.display="")):a=Re(i)}var h;if(!V(a)){this.isReact&&this.renderReactTemplates();var l=void 0,d=void 0;t.classList.contains(Dr)?(l=this.element.id+r+"_header",d="header"):t.classList.contains(Oi)&&(l=this.element.id+r+"_content",d="content"),h=a({},this,d,l,this.isStringTemplate)}return!V(h)&&h.length>0&&!(V(h[0].tagName)&&h.length===1)?[].slice.call(h).forEach(function(f){V(f.tagName)||(f.style.display=""),t.appendChild(f)}):t.childElementCount===0&&(t.innerHTML=this.enableHtmlSanitizer?jr.sanitize(i):i),V(s)||this.templateEle.indexOf(i)===-1&&this.templateEle.push(i),t},e.prototype.ariaAttrUpdate=function(t){var i=Bt("."+me,t),r=Bt("."+ai,t);i.setAttribute("aria-controls",r.id),r.setAttribute("aria-labelledby",i.id),r.setAttribute("role","region")},e.prototype.contentRendering=function(t){var i=this.createElement("div",{className:ai+" "+_s,id:Rr("acrdn_panel")});Kr(i,{"aria-hidden":"true"});var r=this.createElement("div",{className:Oi});if(!V(this.dataSource)&&this.dataSource.length>0)this.isReact&&this.renderReactTemplates(),ba(this.getItemTemplate()(this.dataSource[parseInt(t.toString(),10)],this,"itemTemplate",this.element.id+"_itemTemplate",!1),r),i.appendChild(r);else{var a=this.items[parseInt(t.toString(),10)].content;this.enableHtmlSanitizer&&typeof a=="string"&&(a=jr.sanitize(a)),i.appendChild(this.fetchElement(r,a,t))}return i},e.prototype.expand=function(t){var i=this,r=this.getItems(),a=re(t,"."+$e);if(!(V(t)||As(t)&&t.getAttribute("e-animate")!=="true"||a.classList.contains(_r))){var s=re(a,"."+ga),o=s.querySelector("."+yi),h={name:this.animation.expand.effect,duration:this.animation.expand.duration,timingFunction:this.animation.expand.easing},l=Bt("."+Pn,a).firstElementChild,d={element:a,item:r[this.getIndexByItem(a)],index:this.getIndexByItem(a),content:a.querySelector("."+ai),isExpanded:!0};this.trigger("expanding",d,function(f){f.cancel||(l.classList.add(va),i.expandedItemsPush(a),V(o)||o.classList.remove(yi),a.classList.add(yi),h.name==="None"&&tn!=="Enable"||tn==="Disable"?(i.expandProgress("begin",l,t,a,f),i.expandProgress("end",l,t,a,f)):i.expandAnimation(h.name,l,t,a,h,f))})}},e.prototype.expandAnimation=function(t,i,r,a,s,o){var h=this,l;this.lastActiveItemId=a.id,t==="SlideDown"?(s.begin=function(){h.expandProgress("begin",i,r,a,o),r.style.position="absolute",l=a.offsetHeight,r.style.maxHeight=r.offsetHeight+"px",a.style.maxHeight=""},s.progress=function(){a.style.minHeight=l+r.offsetHeight+"px"},s.end=function(){Yi(r,{position:"",maxHeight:""}),a.style.minHeight="",h.expandProgress("end",i,r,a,o)}):(s.begin=function(){h.expandProgress("begin",i,r,a,o)},s.end=function(){h.expandProgress("end",i,r,a,o)}),new ur(s).animate(r)},e.prototype.expandProgress=function(t,i,r,a,s){this.remove(r,_s),this.add(a,Tn),this.add(i,Rl),t==="end"&&(this.add(a,An),r.setAttribute("aria-hidden","false"),Kr(r.previousElementSibling,{"aria-expanded":"true"}),i.classList.remove(va),this.trigger("expanded",s))},e.prototype.expandedItemsPush=function(t){var i=this.getIndexByItem(t);if(this.expandedIndices.indexOf(i)===-1){var r=[].slice.call(this.expandedIndices);r.push(i),this.setProperties({expandedIndices:r},!0)}},e.prototype.getIndexByItem=function(t){var i=this.getItemElements();return[].slice.call(i).indexOf(t)},e.prototype.getItemElements=function(){var t=[],i=this.element.children;return[].slice.call(i).forEach(function(r){r.classList.contains($e)&&t.push(r)}),t},e.prototype.expandedItemsPop=function(t){var i=this.getIndexByItem(t),r=[].slice.call(this.expandedIndices);r.splice(r.indexOf(i),1),this.setProperties({expandedIndices:r},!0)},e.prototype.collapse=function(t){var i=this;if(!V(t)){var r=this.getItems(),a=re(t,"."+$e);if(!(!As(t)||a.classList.contains(_r))){var s={name:this.animation.collapse.effect,duration:this.animation.collapse.duration,timingFunction:this.animation.collapse.easing},o=Bt("."+Pn,a).firstElementChild,h={element:a,item:r[this.getIndexByItem(a)],index:this.getIndexByItem(a),content:a.querySelector("."+ai),isExpanded:!1};this.trigger("expanding",h,function(l){l.cancel||(i.expandedItemsPop(a),a.classList.remove(yi),o.classList.add(va),s.name==="None"&&tn!=="Enable"||tn==="Disable"?(i.collapseProgress("begin",o,t,a,l),i.collapseProgress("end",o,t,a,l)):i.collapseAnimation(s.name,t,a,o,s,l))})}}},e.prototype.collapseAnimation=function(t,i,r,a,s,o){var h=this,l,d,f,p;this.lastActiveItemId=r.id,t==="SlideUp"?(s.begin=function(){f=r.offsetHeight,r.style.minHeight=f+"px",i.style.position="absolute",l=r.offsetHeight,d=i.offsetHeight,i.style.maxHeight=d+"px",h.collapseProgress("begin",a,i,r,o)},s.progress=function(){p=l-(d-i.offsetHeight),p<f&&(r.style.minHeight=p+"px")},s.end=function(){i.style.display="none",h.collapseProgress("end",a,i,r,o),r.style.minHeight="",Yi(i,{position:"",maxHeight:"",display:""})}):(s.begin=function(){h.collapseProgress("begin",a,i,r,o)},s.end=function(){h.collapseProgress("end",a,i,r,o)}),new ur(s).animate(i)},e.prototype.collapseProgress=function(t,i,r,a,s){this.remove(i,Rl),this.remove(a,Tn),t==="end"&&(this.add(r,_s),i.classList.remove(va),this.remove(a,An),r.setAttribute("aria-hidden","true"),Kr(r.previousElementSibling,{"aria-expanded":"false"}),this.trigger("expanded",s))},e.prototype.getModuleName=function(){return"accordion"},e.prototype.getItems=function(){var t;return this.itemTemplate&&this.headerTemplate?t=this.dataSource:t=this.items,t},e.prototype.addItem=function(t,i){var r=this,a=this.element,s=this.getItemElements(),o=this.getItems();if(V(i)&&(i=o.length),a.childElementCount>=i){var h=t instanceof Array?t:[t];h.forEach(function(l,d){var f=i+d;o.splice(f,0,l);var p=r.renderInnerItem(l,f);a.childElementCount===f?a.appendChild(p):a.insertBefore(p,s[parseInt(f.toString(),10)]),J.add(p.querySelector("."+me),"focus",r.focusIn,r),J.add(p.querySelector("."+me),"blur",r.focusOut,r),r.expandedIndices=[],r.expandedItemRefresh(),l&&l.expanded&&r.expandItem(!0,f)})}this.isReact&&this.renderReactTemplates()},e.prototype.expandedItemRefresh=function(){var t=this,i=this.getItemElements();[].slice.call(i).forEach(function(r){r.classList.contains(Tn)&&t.expandedItemsPush(r)})},e.prototype.removeItem=function(t){if(this.isReact||this.isAngular){var i=fr("."+$e,this.element)[parseInt(t.toString(),10)],r=Bt("."+Dr,i),a=Bt("."+Oi,i);this.clearAccordionTemplate(r,this.dataSource.length>0?"headerTemplate":"header",Dr),this.clearAccordionTemplate(a,this.dataSource.length>0?"itemTemplate":"content",Oi)}var s=this.getItemElements(),o=s[parseInt(t.toString(),10)],h=this.getItems();V(o)||(this.restoreContent(t),Ni(o),h.splice(t,1),this.expandedIndices=[],this.expandedItemRefresh())},e.prototype.select=function(t){var i=this.getItemElements(),r=i[parseInt(t.toString(),10)];V(r)||V(Bt("."+me,r))||r.children[0].focus()},e.prototype.hideItem=function(t,i){var r=this.getItemElements(),a=r[parseInt(t.toString(),10)];V(a)||(V(i)&&(i=!0),i?this.add(a,Cn):this.remove(a,Cn))},e.prototype.enableItem=function(t,i){var r=this.getItemElements(),a=r[parseInt(t.toString(),10)];if(!V(a)){var s=a.firstElementChild;i?(this.remove(a,_r),Kr(s,{tabindex:"0","aria-disabled":"false"}),s.focus()):(a.classList.contains(An)&&(this.expandItem(!1,t),this.eleMoveFocus("movedown",this.element,s)),this.add(a,_r),s.setAttribute("aria-disabled","true"),s.removeAttribute("tabindex"))}},e.prototype.expandItem=function(t,i){var r=this,a=this.getItemElements();if(V(i))if(this.expandMode==="Single"&&t){var s=a[a.length-1];this.itemExpand(t,s,this.getIndexByItem(s))}else{var o=Bt("#"+this.lastActiveItemId,this.element);[].slice.call(a).forEach(function(l){r.itemExpand(t,l,r.getIndexByItem(l)),l.classList.remove(yi)});var h=Bt("."+yi,this.element);h&&h.classList.remove(yi),o&&o.classList.add(yi)}else{var s=a[parseInt(i.toString(),10)];if(V(s)||!s.classList.contains(Ks)||s.classList.contains(An)&&t)return;this.expandMode==="Single"&&this.expandItem(!1),this.itemExpand(t,s,i)}},e.prototype.itemExpand=function(t,i,r){var a=i.children[1];i.classList.contains(_r)||(V(a)&&t?(a=this.contentRendering(r),i.appendChild(a),this.ariaAttrUpdate(i),this.expand(a)):V(a)||(t?this.expand(a):this.collapse(a)),this.isReact&&this.renderReactTemplates())},e.prototype.destroyItems=function(){this.restoreContent(null),(this.isReact||this.isAngular||this.isVue)&&this.clearTemplate(),[].slice.call(this.element.querySelectorAll("."+$e)).forEach(function(t){Ni(t)})},e.prototype.restoreContent=function(t){var i;V(t)?i=this.element:i=this.element.querySelectorAll("."+$e)[parseInt(t.toString(),10)],this.templateEle.forEach(function(r){V(i.querySelector(r))||(document.body.appendChild(i.querySelector(r)).style.display="none")})},e.prototype.updateItem=function(t,i){if(!V(t)){var r=this.getItems(),a=r[parseInt(i.toString(),10)];r.splice(i,1),this.restoreContent(i);var s=Bt("."+Dr,t),o=Bt("."+Oi,t);(this.isReact||this.isAngular)&&(this.clearAccordionTemplate(s,"header",Dr),this.clearAccordionTemplate(o,"content",Oi)),Ni(t),this.addItem(a,i)}},e.prototype.setTemplate=function(t,i,r){this.fetchElement(i,t,r),this.isReact&&this.renderReactTemplates()},e.prototype.clearAccordionTemplate=function(t,i,r){if(this.registeredTemplate&&this.registeredTemplate[""+i])for(var a=this.registeredTemplate,s=0;s<a[""+i].length;s++){var o=a[""+i][parseInt(s.toString(),10)].rootNodes[0],h=re(o,"."+r);if(!V(h)&&h===t||V(o.parentNode)){this.clearTemplate([i],[a[""+i][parseInt(s.toString(),10)]]);break}}else if(this.portals&&this.portals.length>0)for(var l=this.portals,s=0;s<l.length;s++){var d=l[parseInt(s.toString(),10)],h=re(d.containerInfo,"."+r);if(!V(h)&&h===t){this.clearTemplate([i],s);break}}},e.prototype.getPersistData=function(){var t=["expandedIndices"];return this.addOnPersist(t)},e.prototype.onPropertyChanged=function(t,i){for(var r=this.element,a=!1,s=0,o=Object.keys(t);s<o.length;s++){var h=o[s];switch(h){case"items":if(t.items instanceof Array&&i.items instanceof Array)a=!0;else for(var l=Object.keys(t.items),d=0;d<l.length;d++)for(var f=parseInt(Object.keys(t.items)[parseInt(d.toString(),10)],10),p=Object.keys(t.items[parseInt(f.toString(),10)]),c=0;c<p.length;c++){var u=fr("."+$e,this.element)[parseInt(f.toString(),10)],g=Object(i.items[parseInt(f.toString(),10)])[""+p[parseInt(c.toString(),10)]],v=Object(t.items[parseInt(f.toString(),10)])[""+p[parseInt(c.toString(),10)]],m=p[parseInt(c.toString(),10)],y=Bt("."+Oi,u);if((m==="header"||m==="iconCss"||m==="expanded"||m==="content"&&g==="")&&this.updateItem(u,f),p[parseInt(c.toString(),10)]==="cssClass"&&!V(u)&&(g&&We([u],g.split(" ")),v&&he([u],v.split(" "))),p[parseInt(c.toString(),10)]==="visible"&&!V(u)&&(Object(t.items[parseInt(f.toString(),10)])[""+p[parseInt(c.toString(),10)]]===!1?u.classList.add(Cn):u.classList.remove(Cn)),p[parseInt(c.toString(),10)]==="disabled"&&!V(u)&&this.enableItem(f,!v),p.indexOf("header")<0&&p[parseInt(c.toString(),10)]==="content"&&!V(u)&&u.children.length===2)if(typeof v=="function"){(this.isAngular||this.isReact)&&this.clearAccordionTemplate(y,p[parseInt(c.toString(),10)],Oi);var S=u.querySelector("."+Oi);S.innerHTML="",this.setTemplate(v,S,f)}else u.classList.contains(Tn)&&this.expandItem(!1,f),Ni(u.querySelector("."+ai))}break;case"dataSource":case"expandedIndices":this.expandedIndices===null&&(this.expandedIndices=[]),a=!0;break;case"headerTemplate":this.initializeHeaderTemplate(),a=!0;break;case"itemTemplate":this.initializeItemTemplate(),a=!0;break;case"enableRtl":t.enableRtl?this.add(r,Js):this.remove(r,Js);break;case"height":Yi(this.element,{height:Ve(t.height)});break;case"width":Yi(this.element,{width:Ve(t.width)});break;case"expandMode":t.expandMode==="Single"&&!V(this.expandedIndices)&&this.expandedIndices.length>1&&this.expandItem(!1);break}}a&&(this.initExpand=[],!V(this.expandedIndices)&&this.expandedIndices.length>0&&(this.initExpand=this.expandedIndices),this.destroyItems(),this.renderItems(),this.initItemExpand())},Yt([Lt([],RS)],e.prototype,"items",void 0),Yt([w([])],e.prototype,"dataSource",void 0),Yt([w()],e.prototype,"itemTemplate",void 0),Yt([w()],e.prototype,"headerTemplate",void 0),Yt([w("100%")],e.prototype,"width",void 0),Yt([w("auto")],e.prototype,"height",void 0),Yt([w([])],e.prototype,"expandedIndices",void 0),Yt([w("Multiple")],e.prototype,"expandMode",void 0),Yt([w(!0)],e.prototype,"enableHtmlSanitizer",void 0),Yt([X({},kS)],e.prototype,"animation",void 0),Yt([ot()],e.prototype,"clicked",void 0),Yt([ot()],e.prototype,"expanding",void 0),Yt([ot()],e.prototype,"expanded",void 0),Yt([ot()],e.prototype,"created",void 0),Yt([ot()],e.prototype,"destroyed",void 0),e=Yt([Po],e),e})(Vr),Ol;(function(n){n[n.BOLD=1]="BOLD",n[n.ITALIC=2]="ITALIC",n[n.UNDERLINE=4]="UNDERLINE"})(Ol||(Ol={}));function BS(n){return n?Array.isArray(n)?n:[n]:[]}function OS(n){for(var e=new Map,t=0,i=n;t<i.length;t++){var r=i[t];r&&r.$&&r.$.N&&((r.$.N==="LocPinX"||r.$.N==="LocPinY")&&r.$.F?e.set(r.$.N,r.$.F):e.set(r.$.N,r.$.V))}return e}function WS(n){var e=BS(n);return OS(e)}function NS(n){return!n||typeof n!="string"?"":n.split(/[-_]/).map(function(e,t){return e.length===0?"":t===0?e.charAt(0).toLowerCase()+e.slice(1):e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}).join("")}function XS(n,e){if(typeof n!="string")return!1;var t=n.trim();if(t===""||t==="undefined"||t==="null")return!1;if(t.charAt(0)==="#"){var i=t.length;return i!==4&&i!==7&&i!==9?!1:/^#(?:[0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$/.test(t)}var r=t.toLowerCase(),a=["black","white","red","green","blue","yellow","cyan","magenta","gray","grey","transparent"];return a.indexOf(r)!==-1}var Wl;(function(n){n.Solid="",n.Dash="2",n.Dot="3",n.DashDot="4",n.LargeDash="7",n.LargeDashDot="18",n.LargeDashDotDot="19"})(Wl||(Wl={}));var Uf=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})();function xo(n,e){if(!n||!n.Section)return null;var t=Array.isArray(n.Section)?n.Section:[n.Section];return t.find(function(i){return i&&i.$&&i.$.N===e})||null}function Aa(n){return Array.isArray(n)?n:n!=null?[n]:[]}function YS(n){var e=xo(n,"Character");if(!e||!e.Row)return!1;for(var t=Aa(e.Row),i=new Set,r=0,a=t;r<a.length;r++){for(var s=a[r],o=Aa(s.Cell),h=new Map,l=0,d=o;l<d.length;l++){var f=d[l];f&&f.$&&f.$.N&&h.set(f.$.N,f.$.V)}var p=[h.get("Font")||"",h.get("Size")||"",h.get("Style")||"",h.get("Color")||""].join("|");i.add(p)}var c=n&&n.Text&&n.Text.value?String(n.Text.value):"",u=c.replace(/<cp[^>]*\/>/gi," ").replace(/<pp[^>]*\/>/gi," ").replace(/\s+/g," ").trim(),g=/\S\s+\S/.test(u),v=xo(n,"Paragraph"),m=v&&v.Row?Aa(v.Row).length:0;return i.size>1&&(g||m>1)}function US(n,e){if(!e)return e;var t=e.replace(/<cp[^>]*\/>/gi,"").replace(/<pp[^>]*\/>/gi,`
`);if(!/\n/.test(t)){var i=xo(n,"Paragraph"),r=i&&i.Row?Aa(i.Row):[];r.length>1&&(t=t.replace(/\s+(?=\d+\.)/g,`
`),t=t.replace(/\s+(?=[-]\s)/g,`
`))}return t}function FS(n){return n&&(n.bold=!1,n.italic=!1,n.fontFamily="Segoe UI",n.fontSize=16,n.textDecoration&&(n.textDecoration.underline=!1,n.textDecoration.strikethrough=!1),n)}var Ff=(function(){function n(){this.left=0,this.right=0,this.top=0,this.bottom=0}return n.fromJs=function(e){var t=new n;if(!e||!e.$)return t;var i=function(r){var a=e.Cell.find(function(s){return s.$.N===r});return a?a.$.V:void 0};return t.left=Number(i("LeftMargin"))||0,t.right=Number(i("RightMargin"))||0,t.top=Number(i("TopMargin"))||0,t.bottom=Number(i("BottomMargin"))||0,t},n})(),VS=(function(){function n(){this.underline=!1,this.strikethrough=!1}return n.fromJs=function(e){var t=new n,i=[];if(!e||!e.$)return t;for(var r=Array.isArray(e.Section)?e.Section:[e.Section],a=0,s=r;a<s.length;a++)for(var o=s[a],h=Array.isArray(o.Row)?o.Row:[o.Row],l=0,d=h;l<d.length;l++){var f=d[l];if(!(!f||typeof f!="object")){var p=Array.isArray(f.Cell)?f.Cell:[f.Cell];i.push.apply(i,p)}}var c=function(v){var m=i.find(function(y){return y&&y.$&&y.$.N===v});return m&&m.$&&m.$.V},u=parseInt(c("Style"),10),g=Number(c("Strikethru"));return g===1&&(t.strikethrough=!0),u&&(t.underline=(u&4)!==0),t},n})(),GS=(function(){function n(){this.left=!1,this.right=!1,this.center=!0,this.justify=!1}return n.fromJs=function(e){var t=new n,i=[];if(!e||!e.$)return t;for(var r=Array.isArray(e.Section)?e.Section:[e.Section],a=0,s=r;a<s.length;a++)for(var o=s[a],h=Array.isArray(o.Row)?o.Row:[o.Row],l=0,d=h;l<d.length;l++){var f=d[l];if(!(!f||typeof f!="object")){var p=Array.isArray(f.Cell)?f.Cell:[f.Cell];i.push.apply(i,p)}}var c=function(g){var v=i.find(function(m){return m&&m.$&&m.$.N===g});return v&&v.$&&v.$.V},u=c("HorzAlign");switch(u){case"0":t.left=!0;break;case"2":t.right=!0;break;case"3":t.justify=!0;break;default:t.center=!0}return t},n})(),Vf=(function(){function n(){this.fontFamily="Calibri",this.italic=!1,this.bold=!1,this.TEXT_STYLE_NONE=!0,this.opacity=1}return n.fromJs=function(e,t){var i=new n,r=[];if(!e||!e.Section)return i;for(var a=Array.isArray(e.Section)?e.Section:[e.Section],s=0,o=a;s<o.length;s++)for(var h=o[s],l=Array.isArray(h.Row)?h.Row:[h.Row],d=0,f=l;d<f.length;d++){var p=f[d];if(!(!p||typeof p!="object")){var c=Array.isArray(p.Cell)?p.Cell:[p.Cell];r.push.apply(r,c)}}var u=function(x){var I=r.find(function(C){return C&&C.$&&C.$.N===x});return I&&I.$&&I.$.V},g=function(x){var I=e.Cell.find(function(C){return C.$.N===x});return I?I.$.V:void 0};i.color=u("Color")!=null?u("Color"):void 0,i.fontFamily=u("Font")?u("Font"):"Calibri";var v=Number(u("Size"));v&&(i.fontSize=v*72*1.33);var m=parseInt(u("Style"),10);m>-1&&(i.bold=(m&1)!==0,i.italic=(m&2)!==0,i.TEXT_STYLE_NONE=!1),i.opacity=Number(u("ColorTrans"))||1,i.textAlign=GS.fromJs(e);var y=g("TextBkgnd"),S=y!=null&&y!==""?y==="0"?"transparent":y:t?"white":"transparent";return i.fill=XS(S)?S:"transparent",i.textDecoration=VS.fromJs(e),i},n})(),Gf=(function(){function n(){this.link="",this.content="",this.newWindow=!1}return n.fromJs=function(e){if(!e||!e.Section)return new n;var t=null;if(Array.isArray(e.Section)?t=e.Section.find(function(h){return h.$.N==="Hyperlink"}):e.Section&&e.Section.$.N==="Hyperlink"&&(t=e.Section),!t||!t.Row)return new n;var i=Array.isArray(t.Row)?t.Row:[t.Row],r=i[0],a=function(h){var l=(r.Cell||[]).find(function(d){return d.$.N===h});return l?l.$.V:void 0},s=new n;s.content=a("Description"),s.link=a("Address");var o=Number(a("NewWindow"));return o===1&&(s.newWindow=!0),s},n})(),Zf=(function(){function n(){this.content="",this.rotateAngle=0,this.visible=!0,this.verticalAlignment="Center",this.horizontalAlignment="Center",this.segmentAngle=!1}return n})();function ZS(n,e,t){var i=n&&n.trim().length?n:"shape";switch(i.toLowerCase()){case"rectangle":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"ellipse":return{txtWidth:e*.875,txtHeight:t*.875,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"righttriangle":return{txtWidth:e*.5,txtHeight:t*.5,txtPinX:e*.25,txtPinY:t*.25,txtLocPinX:e*.5,txtLocPinY:t*.5};case"triangle":return{txtWidth:e*1,txtHeight:t*.6667,txtPinX:e*.5,txtPinY:t*.3333,txtLocPinX:e*.5,txtLocPinY:t*.5};case"pentagon":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.4472,txtLocPinX:e*.5,txtLocPinY:t*.4472};case"heptagon":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.474,txtLocPinX:e*.5,txtLocPinY:t*.474};case"octagon":case"polygon":case"hexagon":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"trapezoid":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"decagon":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"parallelogram":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"cylinder":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};case"diamond":return{txtWidth:e*1,txtHeight:t*1,txtPinX:e*.5,txtPinY:t*.5,txtLocPinX:e*.5,txtLocPinY:t*.5};default:return{txtWidth:e,txtHeight:t,txtPinX:e/2,txtPinY:t/2,txtLocPinX:e/2,txtLocPinY:t/2}}}(function(n){Uf(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.fromJs=function(t,i){var r=new e;if(!t||!t.$||!t.Cell)return r;var a=function(o){var h=t.Cell.find(function(l){return l.$.N===o});return h?h.$.V:void 0};r.content=t.Text&&t.Text.value?t.Text.value:"";var s=parseFloat(a("TxtAngle"));return r.rotateAngle=isNaN(s)?0:s*(180/Math.PI),r.QuickStyleFontColor=a("QuickStyleFontColor")!==void 0?Number(a("QuickStyleFontColor")):void 0,r.QuickStyleFontMatrix=a("QuickStyleFontMatrix")!==void 0?Number(a("QuickStyleFontMatrix")):void 0,r.margin=Ff.fromJs(t),r.style=Vf.fromJs(t,!0),r.visible=a("HideText")!=="1",r.hyperlink=Gf.fromJs(t),qf(r,t.Cell),r.segmentAngle=a("TextDirection")?a("TextDirection")==="1":!1,r.segmentAngle?r.horizontalAlignment=$f(t):r.verticalAlignment=Qf(t),r.txtPinX=a("TxtPinX")!==void 0?parseFloat(a("TxtPinX")):i.txtPinX,r.txtPinY=a("TxtPinY")!==void 0?parseFloat(a("TxtPinY")):i.txtPinY,r.txtLocPinX=a("TxtLocPinX")!==void 0?parseFloat(a("TxtLocPinX")):i.txtLocalPinX,r.txtLocPinY=a("TxtLocPinY")!==void 0?parseFloat(a("TxtLocPinY")):i.txtLocalPinY,r.txtWidth=a("TxtWidth")!==void 0?parseFloat(a("TxtWidth")):i.txtWidth,r.txtHeight=a("TxtHeight")!==void 0?parseFloat(a("TxtHeight")):i.txtHeight,r},e})(Zf);(function(n){Uf(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.fromJs=function(t,i){var r=new e;if(!t||!t.$||!t.Cell)return r;var a=function(S){var x=t.Cell.find(function(I){return I.$.N===S});return x?x.$.V:void 0},s=i,o=t.Text&&t.Text.value?t.Text.value:"";r.content=US(t,o);var h=parseFloat(a("TxtAngle")),l=Number(a("TextDirection"));r.rotateAngle=isNaN(h)?0:h*(180/Math.PI),l===1&&(r.rotateAngle-=90),r.margin=Ff.fromJs(t),r.style=Vf.fromJs(t),YS(t)&&r.style&&(r.style=FS(r.style)),r.visible=a("HideText")!=="1",r.hyperlink=Gf.fromJs(t),qf(r,t.Cell),r.segmentAngle=l?l===1:!1,r.segmentAngle?r.horizontalAlignment=$f(t):r.verticalAlignment=Qf(t);var d=isNaN(parseFloat(a("Width")))?s&&s.Width||1:parseFloat(a("Width")),f=isNaN(parseFloat(a("Height")))?s&&s.Height||1:parseFloat(a("Height")),p=ZS(s.Name,d,f),c=parseFloat(a("TxtWidth"));r.txtWidth=isNaN(c)?p.txtWidth:c;var u=parseFloat(a("TxtHeight"));r.txtHeight=isNaN(u)?p.txtHeight:u;var g=parseFloat(a("TxtPinX"));r.txtPinX=isNaN(g)?p.txtPinX:g;var v=parseFloat(a("TxtPinY"));r.txtPinY=isNaN(v)?p.txtPinY:v;var m=parseFloat(a("TxtLocPinX"));r.txtLocPinX=isNaN(m)?p.txtLocPinX:m;var y=parseFloat(a("TxtLocPinY"));return r.txtLocPinY=isNaN(y)?p.txtLocPinY:y,r},e})(Zf);function $f(n){var e=n.Cell.find(function(t){return t.$.N==="VerticalAlign"});if(e)switch(e.$.V){case"0":return"Left";case"2":return"Right";default:return"Center"}return"Center"}function qf(n,e){for(var t=WS(e),i=["LockTextEdit","LockSelect","LockRotate"],r=0,a=i;r<a.length;r++){var s=a[r],o=t.get(s);n[NS(s)]=o!=null&&o!=="0"}}function Qf(n){var e=n.Cell.find(function(t){return t.$.N==="VerticalAlign"});if(e)switch(e.$.V){case"0":return"Bottom";case"2":return"Top";default:return"Center"}return"Center"}var $S=(function(){function n(){this.windows=[],this.pages=[],this.masters=[],this.shapes=[],this.connectors=[],this.connections=[],this.themes=[],this.expandedSubprocessCollection=[],this.relations=[],this.medias={}}return n.prototype.clear=function(){this.windows=[],this.pages=[],this.masters=[],this.shapes=[],this.connectors=[],this.documentSettings=void 0,this.connections=[],this.themes=[],this.currentPage=void 0,this.currentTheme=void 0,this.expandedSubprocessCollection=[],this.relations=[]},n})();(function(){function n(){this.contentPos=0,this.bufferText="",this.bufferBlob=new Blob([""],{type:"text/plain"}),this.currentState="Initial",this.namespaceStack=[],this.namespaceStack.push(new ma),this.namespaceStack[0].set("xmlns","http://www.w3.org/2000/xmlns/","Special"),this.namespaceStack.push(new ma),this.namespaceStack[1].set("xml","http://www.w3.org/XML/1998/namespace","Special"),this.namespaceStack.push(new ma),this.namespaceStack[2].set("","","Implied"),this.elementStack=[],this.elementStack.push(new Nl),this.elementStack[0].set("","","",this.namespaceStack.length-1),this.attributeStack=[]}return Object.defineProperty(n.prototype,"text",{get:function(){return this.bufferText},enumerable:!0,configurable:!0}),n.prototype.writeStartDocument=function(e){this.currentState="StartDocument",this.rawText('<?xml version="1.0" encoding="utf-8'),e!=null&&(this.rawText('" standalone="'),this.rawText(e?"yes":"no")),this.rawText('"?>')},n.prototype.writeStartElement=function(e,t,i){this.checkName(t),this.currentState==="StartElement"&&this.startElementContent(),this.currentState="StartElement",e==null?(i!=null&&(e=this.lookupPrefix(i)),e==null&&(e="")):e.length>0&&i==null&&(i=this.lookupNamespace(e)),i==null&&(i=this.lookupNamespace(e)),this.writeStartElementInternal(e,t,i)},n.prototype.writeEndElement=function(){this.currentState==="StartElement"?(this.startElementContent(),this.currentState="ElementContent"):this.currentState==="ElementContent"&&(this.currentState="ElementContent"),this.currentState="EndElement";var e=this.elementStack.length-1;this.writeEndElementInternal(this.elementStack[e].prefix,this.elementStack[e].localName),this.namespaceStack.splice(this.elementStack[e].previousTop+1),this.elementStack.splice(e)},n.prototype.writeElementString=function(e,t,i,r){this.writeStartElement(e,t,i),r!=null&&r.length!==0&&this.writeString(r),this.writeEndElement()},n.prototype.writeAttributeString=function(e,t,i,r){this.writeStartAttribute(e,t,i,r),this.writeStringInternal(r,!0),this.writeEndAttribute()},n.prototype.writeString=function(e){this.writeInternal(e,!1)},n.prototype.writeRaw=function(e){this.writeInternal(e,!0)},n.prototype.writeInternal=function(e,t){e!=null&&(this.currentState==="StartElement"&&this.startElementContent(),this.currentState="ElementContent",t?this.rawText(e):this.writeStringInternal(e,!1))},n.prototype.writeStartAttribute=function(e,t,i,r){(t==null||t.length===0)&&e==="xmlns"&&(t="xmlns",e=""),this.checkName(t),this.writeStartAttributePrefixAndNameSpace(e,t,i,r)},n.prototype.writeStartAttributePrefixAndNameSpace=function(e,t,i,r){e==null&&(i!=null&&(t==="xmlns"&&i==="http://www.w3.org/2000/xmlns/"||(e=this.lookupPrefix(i))),e==null&&(e="")),i==null&&(e!=null&&e.length>0&&(i=this.lookupNamespace(e)),i==null&&(i="")),this.writeStartAttributeSpecialAttribute(e,t,i,r)},n.prototype.writeStartAttributeSpecialAttribute=function(e,t,i,r){if(e.length===0)if(t[0]==="x"&&t==="xmlns"){this.skipPushAndWrite(e,t,i),this.pushNamespaceExplicit("",r);return}else i.length>0&&(e=this.lookupPrefix(i));else{if(e[0]==="x"){if(e==="xmlns"){this.skipPushAndWrite(e,t,i),this.pushNamespaceExplicit(t,r);return}else if(e==="xml"&&(t==="space"||t==="lang")){this.skipPushAndWrite(e,t,i);return}}i.length===0&&(e="")}e!=null&&e.length!==0&&this.pushNamespaceImplicit(e,i),this.skipPushAndWrite(e,t,i)},n.prototype.writeEndAttribute=function(){this.currentState="StartElement",this.bufferText+='"'},n.prototype.writeStartElementInternal=function(e,t,i){this.bufferText+="<",e.length>0&&(this.rawText(e),this.bufferText+=":"),this.rawText(t);var r=this.elementStack.length;this.elementStack.push(new Nl),this.elementStack[r].set(e,t,i,this.namespaceStack.length-1),this.pushNamespaceImplicit(e,i);for(var a=0,s=this.attributeStack;a<s.length;a++){var o=s[a];o.destroy()}this.attributeStack=[]},n.prototype.writeEndElementInternal=function(e,t){this.contentPos!==this.bufferText.length+1?(this.bufferText+="</",e!=null&&e.length!==0&&(this.rawText(e),this.bufferText+=":"),this.rawText(t),this.bufferText+=">"):(this.bufferText=this.bufferText.substring(0,this.bufferText.length-1),this.bufferText+=" />")},n.prototype.writeStartAttributeInternal=function(e,t,i){this.bufferText+=" ",e!=null&&e.length>0&&(this.rawText(e),this.bufferText+=":"),this.rawText(t),this.bufferText+="=",this.bufferText+='"'},n.prototype.writeNamespaceDeclaration=function(e,t){this.writeStartNamespaceDeclaration(e),this.writeStringInternal(t,!0),this.bufferText+='"'},n.prototype.writeStartNamespaceDeclaration=function(e){(e==null||e.length===0)&&this.rawText(' xmlns="')},n.prototype.writeStringInternal=function(e,t){e==null&&(e=""),e=e.replace(/\&/g,"&amp;"),e=e.replace(/\</g,"&lt;"),e=e.replace(/\>/g,"&gt;"),t&&(e=e.replace(/\"/g,"&quot;")),this.bufferText+=e,t||(this.contentPos=0)},n.prototype.startElementContent=function(){for(var e=this.elementStack[this.elementStack.length-1].previousTop,t=this.namespaceStack.length-1;t>e;t--)this.namespaceStack[t].kind==="NeedToWrite"&&this.writeNamespaceDeclaration(this.namespaceStack[t].prefix,this.namespaceStack[t].namespaceUri);this.bufferText+=">",this.contentPos=this.bufferText.length+1},n.prototype.rawText=function(e){this.bufferText+=e},n.prototype.addNamespace=function(e,t,i){var r=this.namespaceStack.length;this.namespaceStack.push(new ma),this.namespaceStack[r].set(e,t,i)},n.prototype.lookupPrefix=function(e){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].namespaceUri===e)return this.namespaceStack[t].prefix},n.prototype.lookupNamespace=function(e){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].prefix===e)return this.namespaceStack[t].namespaceUri},n.prototype.lookupNamespaceIndex=function(e){for(var t=this.namespaceStack.length-1;t>=0;t--)if(this.namespaceStack[t].prefix===e)return t;return-1},n.prototype.pushNamespaceImplicit=function(e,t){var i,r=this.lookupNamespaceIndex(e);if(r!==-1){if(r>this.elementStack[this.elementStack.length-1].previousTop)return;this.namespaceStack[r].kind!=="Special"&&(i=this.namespaceStack[r].namespaceUri===t?"Implied":"NeedToWrite")}else i="NeedToWrite";this.addNamespace(e,t,i)},n.prototype.pushNamespaceExplicit=function(e,t){var i=this.lookupNamespaceIndex(e);if(i!==-1&&i>this.elementStack[this.elementStack.length-1].previousTop){this.namespaceStack[i].kind="Written";return}this.addNamespace(e,t,"Written")},n.prototype.addAttribute=function(e,t,i){var r=this.attributeStack.length;this.attributeStack.push(new qS),this.attributeStack[r].set(e,t,i)},n.prototype.skipPushAndWrite=function(e,t,i){this.addAttribute(e,t,i),this.writeStartAttributeInternal(e,t,i)},n.prototype.checkName=function(e){},n})();var ma=(function(){function n(){}return n.prototype.set=function(e,t,i){this.prefix=e,this.namespaceUri=t,this.kind=i},n})(),Nl=(function(){function n(){}return n.prototype.set=function(e,t,i,r){this.previousTop=r,this.prefix=e,this.namespaceUri=i,this.localName=t},n})(),qS=(function(){function n(){}return n.prototype.set=function(e,t,i){this.prefix=e,this.namespaceUri=i,this.localName=t},n.prototype.destroy=function(){this.prefix=void 0,this.namespaceUri=void 0,this.localName=void 0},n})();var ir={FIXED_LIT_LEN_TABLE_SIZE:288,FIXED_DIST_TABLE_SIZE:32,FIXED_LIT_LEN_144_END:144,FIXED_LIT_LEN_256_END:256,FIXED_LIT_LEN_280_END:280};(function(){for(var n=new Array(ir.FIXED_LIT_LEN_TABLE_SIZE),e=0;e<ir.FIXED_LIT_LEN_144_END;e++)n[parseInt(e.toString(),10)]=8;for(var e=ir.FIXED_LIT_LEN_144_END;e<ir.FIXED_LIT_LEN_256_END;e++)n[parseInt(e.toString(),10)]=9;for(var e=ir.FIXED_LIT_LEN_256_END;e<ir.FIXED_LIT_LEN_280_END;e++)n[parseInt(e.toString(),10)]=7;for(var e=ir.FIXED_LIT_LEN_280_END;e<ir.FIXED_LIT_LEN_TABLE_SIZE;e++)n[parseInt(e.toString(),10)]=8;return n})();new Array(ir.FIXED_DIST_TABLE_SIZE).fill(5);(function(){function n(e){this.data=new $S,this.shapeIndex={value:0},this.warnings=[],this.diagram=e}return n.prototype.addWarning=function(e){this.warnings.indexOf(e)===-1&&this.warnings.push(e)},n.prototype.getWarnings=function(){return this.warnings},n.prototype.triggerEvent=function(e,t){t.logs||(t.logs=this.getWarnings()),e==="Import"?this.diagram.triggerEvent(Z.diagramImporting,t):this.diagram.triggerEvent(Z.diagramExporting,t)},Object.defineProperty(n.prototype,"currentPage",{get:function(){return this.data.currentPage},enumerable:!0,configurable:!0}),n})();var Is=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var a in r)r.hasOwnProperty(a)&&(i[a]=r[a])},n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}})(),Mt=function(n,e,t,i){var r=arguments.length,a=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,i);else for(var o=n.length-1;o>=0;o--)(s=n[o])&&(a=(r<3?s(a):r>3?s(e,t,a):s(e,t))||a);return r>3&&a&&Object.defineProperty(e,t,a),a},Jf=function(n){var e=n;return e.sourcePoint||e.targetPoint||e.sourceID||e.targetID||e.sourcePortID||e.targetPortID||e.sourceDecorator||e.targetDecorator?B:(n.shape&&(n.shape instanceof ri||n.shape.type),M)},js=(function(n){Is(e,n);function e(t,i,r,a){return n.call(this,t,i,r,a)||this}return Mt([w("")],e.prototype,"id",void 0),Mt([w()],e.prototype,"height",void 0),Mt([w(!0)],e.prototype,"expanded",void 0),Mt([w("")],e.prototype,"iconCss",void 0),Mt([w("")],e.prototype,"title",void 0),Mt([jl(Jf)],e.prototype,"symbols",void 0),e})(j),QS=(function(n){Is(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Mt([w()],e.prototype,"width",void 0),Mt([w()],e.prototype,"height",void 0),e})(j),JS=(function(n){Is(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return Mt([w()],e.prototype,"width",void 0),Mt([w()],e.prototype,"height",void 0),Mt([X({},b)],e.prototype,"offset",void 0),e})(j);(function(n){Is(e,n);function e(t,i){var r=n.call(this,t,i)||this;r.symbolTable={},r.childTable={},r.info="info",r.oldObject=null,r.laneTable={},r.isExpand=!1,r.isExpandMode=!1,r.isMethod=!1,r.paletteid=88123,r.checkOnRender=!1,r.symbolTooltipObject=null,r.helper=function(l){var d,f=r.selectedSymbol&&r.selectedSymbol.id||l.sender.target.id.split("_container")[0],p=r.symbolTable[""+f];return p&&r.selectedSymbol&&(r.selectedSymbols=r.selectedSymbol.id===p.id?p:r.selectedSymbol,d=r.getSymbolPreview(r.selectedSymbols,l.sender,r.element),d.setAttribute("paletteId",r.element.id)),d};for(var a,s,o=0;r&&r.palettes&&o<r.palettes.length;o++)for(var h=0;h<r.palettes[parseInt(o.toString(),10)].symbols.length;h++)a=r.palettes[parseInt(o.toString(),10)].symbols[parseInt(h.toString(),10)],s=t.palettes[parseInt(o.toString(),10)].symbols[parseInt(h.toString(),10)],a&&a.shape.type==="UmlActivity"&&us(s,a),(r.nodeDefaults||r.connectorDefaults)&&Ti(a,s,a instanceof M?r.nodeDefaults:r.connectorDefaults);return r}return e.prototype.onPropertyChanged=function(t,i){for(var r=!1,a=0,s=Object.keys(t);a<s.length;a++){var o=s[a];switch(o){case"width":this.element.style.width=this.width.toString();break;case"height":this.element.style.height=this.height.toString();break;case"symbolPreview":break;case"symbolWidth":case"symbolHeight":case"getSymbolInfo":this.isReact?r=!1:r=!0;break;case"enableSearch":if(t.enableSearch)this.createTextbox();else{var h=document.getElementById(this.element.id+"_search");h&&h.parentNode.removeChild(h)}break;case"palettes":for(var l=0,d=Object.keys(t.palettes);l<d.length;l++){var f=d[l],p=Number(f);if(this.accordionElement.items[parseInt(p.toString(),10)]||(this.accordionElement.items[parseInt(p.toString(),10)]={header:t.palettes[parseInt(p.toString(),10)].title||"",expanded:t.palettes[parseInt(p.toString(),10)].expanded,iconCss:t.palettes[parseInt(p.toString(),10)].iconCss||""}),t.palettes[parseInt(p.toString(),10)].height){var c=document.getElementById(this.palettes[parseInt(p.toString(),10)].id+"_content");c.style.height=t.palettes[parseInt(p.toString(),10)].height+"px"}t.palettes[parseInt(p.toString(),10)].iconCss!==void 0&&(this.accordionElement.items[parseInt(p.toString(),10)].iconCss=t.palettes[parseInt(p.toString(),10)].iconCss||"",r=!0),t.palettes[parseInt(p.toString(),10)].expanded!==void 0&&(this.palettes[parseInt(p.toString(),10)].isInteraction?this.palettes[parseInt(p.toString(),10)].isInteraction=!1:(this.accordionElement.items[parseInt(p.toString(),10)].expanded=t.palettes[parseInt(p.toString(),10)].expanded,this.isExpand=!0),!this.isExpandMode&&!this.isMethod&&!this.isExpand&&(this.isExpand=!0))}break;case"enableAnimation":this.enableAnimation?this.accordionElement.animation={expand:{duration:400},collapse:{duration:400}}:this.accordionElement.animation={expand:{duration:0},collapse:{duration:0}};break;case"expandMode":this.accordionElement.expandMode=this.expandMode,r=!0,this.isExpandMode=!0;break;case"allowDrag":this.allowDrag=t.allowDrag,this.draggable&&(this.draggable.destroy(),this.draggable=null),this.allowDrag&&this.initDraggable();break}}if(r&&this.refreshPalettes(),this.isExpand&&!r){this.isExpand=!1;for(var u=0;u<this.palettes.length;u++){var g=this.palettes[parseInt(u.toString(),10)].id;window[""+g]&&window[""+g].length>1&&(window[""+g][1].parentNode.removeChild(window[""+g][1]),window[""+g][1]=null)}}this.isMethod=!1},e.prototype.getPersistData=function(){var t=["loaded"];return this.addOnPersist(t)},e.prototype.preRender=function(){var t=this;if(this.l10n=new no(this.getModuleName(),this.defaultLocale(),this.locale),this.element.id===""){var i=document.getElementsByClassName("e-symbolpalette").length;this.element.id="symbolpalette_"+this.paletteid+"_"+i}this.element.style.overflow="auto",this.element.style.height=this.height.toString(),this.element.style.width=this.width.toString(),this.enableSearch&&this.createTextbox();{var r=bt("div",{id:this.element.id+"_container"});this.accordionElement=new HS({expandMode:this.expandMode}),this.enableAnimation||(this.accordionElement.animation={expand:{duration:0},collapse:{duration:0}}),this.accordionElement.created=function(){t.checkOnRender=!0},this.accordionElement.expanded=function(s){var o=t.accordionElement.items.indexOf(s.item),h=t.allowServerDataBinding;t.allowServerDataBinding=!1,t.palettes[parseInt(o.toString(),10)].expanded=s.isExpanded,t.palettes[parseInt(o.toString(),10)].isInteraction=!0,t.allowServerDataBinding=h},this.accordionElement.expanding=function(s){if(t.checkOnRender){var o={element:s.element,content:s.content,index:s.index,cancel:!1,isExpanded:s.isExpanded,palette:t.palettes[s.index]},h="paletteExpanding";t.trigger(h,o),s.cancel=o.cancel}},this.element.appendChild(r)}var a="measureElement";window[""+a]&&(window[""+a]=null),Mf(),this.unWireEvents(),this.wireEvents()},e.prototype.defaultLocale=function(){return{SearchShapes:"Search Shapes",SearchResults:"Search Results",NoItemsToDisplay:"No Items To Display"}},e.prototype.render=function(){this.diagramRenderer=new on(this.element.id,new ln,!1),this.svgRenderer=new on(this.element.id,new ln,!0),this.updatePalettes(),this.accordionElement.appendTo("#"+this.element.id+"_container"),this.renderComplete()},e.prototype.getModuleName=function(){return"SymbolPalette"},e.prototype.requiredModules=function(){var t=[];return t.push({member:"Bpmn",args:[]}),t},e.prototype.destroy=function(){if(this.allowDrag){this.draggable.destroy(),this.unWireEvents(),this.notify("destroy",{}),n.prototype.destroy.call(this);var t=document.getElementById(this.element.id+"_container");if(t){this.element.removeChild(t);var i="measureElement";if(window[""+i]){window[""+i].usageCount-=1;var r="measureElementCount";window[""+r]--,window[""+r]===0&&(window[""+i].parentNode.removeChild(window[""+i]),window[""+i]=null)}}t=document.getElementById(this.element.id+"_search"),t&&t.parentNode.removeChild(t)}},e.prototype.addPalettes=function(t){for(var i,r=0;r<t.length;r++){var a=this.allowServerDataBinding;this.isProtectedOnChange=!0,this.allowServerDataBinding=!1,i=new js(this,"palettes",t[parseInt(r.toString(),10)],!0),this.palettes.push(i),this.initSymbols(i),this.allowServerDataBinding=a,this.isProtectedOnChange=!1,this.renderPalette(i)}this.bulkChanges={},this.accordionElement.refresh()},e.prototype.removePalette=function(t){for(var i=0;i<this.palettes.length;i++)if(this.palettes[parseInt(i.toString(),10)].id===t){this.palettes.splice(i,1),this.accordionElement.items.splice(i,1);break}},e.prototype.removePalettes=function(t){var i=this.allowServerDataBinding;this.allowServerDataBinding=!1;for(var r=0;r<t.length;r++)this.removePalette(t[parseInt(r.toString(),10)]);this.accordionElement.refresh(),this.allowServerDataBinding=i},e.prototype.initSymbols=function(t){for(var i=[],r=0,a=0,s=0,o=t.symbols;s<o.length;s++){var h=o[s];if(h.shape.type==="SwimLane"){var l=h,d=h.shape,f=d.orientation==="Horizontal";if(d.isLane){r=f?this.symbolHeight-this.symbolHeight/2:this.symbolHeight-this.symbolHeight/4,a=f?this.symbolWidth-this.symbolWidth/4:this.symbolWidth-this.symbolWidth/2,this.laneTable[h.id]={height:r,width:a};var p=d.lanes[0].header,c=d.lanes[0].style,u=p.style,g={id:"header"+K(),shape:{type:"Basic",shape:"Rectangle"},width:f?p.width:l.width,height:f?l.height:p.height,style:u,annotations:[{content:p.annotation.content}]};g.offsetX=g.width/2,g.offsetY=g.height/2,this.addPaletteItem(t.id,g);var v={id:"lane"+K(),shape:{type:"Basic",shape:"Rectangle"},width:f?l.width-p.width:l.width,height:f?l.height:l.height-p.height,style:c};v.offsetX=f?g.width+v.width/2:v.width/2,v.offsetY=f?v.height/2:g.height+v.height/2,this.addPaletteItem(t.id,v),l.children=[g.id,v.id]}else d.isPhase&&(r=l.height?l.height:this.symbolHeight,a=l.width?l.width:this.symbolWidth,h.shape.type="Path",f?h.shape.data="M0,0 L"+a+",0":h.shape.data="M0,0 L0,"+a)}if(h.shape.type==="Container"){var m=h,y=h.shape;if(y.hasHeader){var p=y.header,S=m.style,u=p.style,g={id:"header"+K(),shape:{type:"Basic",shape:"Rectangle"},width:m.width,height:m.height/2,style:u,annotations:[{content:p.annotation.content}]};g.offsetX=g.width/2,g.offsetY=g.height/2,this.addPaletteItem(t.id,g);var x={id:"container"+K(),shape:{type:"Basic",shape:"Rectangle"},width:m.width,height:m.height,style:S};x.offsetX=m.width/2,x.offsetY=m.height/2,this.addPaletteItem(t.id,x),m.children=[x.id,g.id]}}if(h.shape.type==="UmlClassifier"&&!h.shape.relationship){var I=h,C=void 0,P=void 0;h.style.fill==="white"?P={fill:"#26A0DA"}:P={fill:h.style.fill},h.shape.classifier==="Class"?(C={id:"node"+K(),shape:{type:"HTML",content:'<div id="parentDiv" style="width:100%; height:50%; border:1px solid #000; background:#6BA5D7; display: flex; align-items: center; justify-content: center;"><div id="textDiv" style="font-size:0.7vw;">class</div></div>'},width:I.width?I.width:100,height:I.height?I.height:100,style:P,offsetX:I.width?I.width/2:50,offsetY:I.height?I.height/2:50},this.addPaletteItem(t.id,C)):h.shape.classifier==="Enumeration"?(C={id:"node"+K(),shape:{type:"HTML",content:'<div id="parentDiv2" style="width:100%; height:50%; border:1px solid #000; background:#6BA5D7; display: flex; align-items: center; justify-content: center;"><div id="textDiv2" style="font-size:0.5vw;">Enumeration</div></div>'},width:I.width?I.width:100,height:I.height?I.height:100,style:P,offsetX:I.width?I.width/2:50,offsetY:I.height?I.height/2:50},this.addPaletteItem(t.id,C)):h.shape.classifier==="Interface"&&(C={id:"node"+K(),shape:{type:"HTML",content:'<div id="parentDiv3" style="width:100%; height:50%; border:1px solid #000; background:#6BA5D7; display: flex; align-items: center; justify-content: center;"><div id="textDiv3" style="font-size:0.7vw;">Interface</div></div>'},width:I.width?I.width:100,height:I.height?I.height:100,style:P,offsetX:I.width?I.width/2:50,offsetY:I.height?I.height/2:50},this.addPaletteItem(t.id,C));var A={id:"member"+K(),shape:{type:"HTML",content:'<div style="width:100%;height:100%;border:1px solid #000;background:white"></div>'},width:I.width?I.width:100,height:I.height?I.height:100,offsetX:I.width?I.width/2:50,offsetY:I.height?I.height/2+C.height/2:50+C.height/2};this.addPaletteItem(t.id,A),I.children=[C.id,A.id]}if(h.shape.type==="UmlClassifier"&&h.shape.relationship&&(h.shape.relationship==="Inheritance"&&(h.targetDecorator.style.fill=h.targetDecorator.style.fill==="black"?"white":h.targetDecorator.style.fill),h.shape.relationship==="Realization"&&(h.style.strokeDashArray=h.style.strokeDashArray?h.style.strokeDashArray:"4 4",h.targetDecorator.style.fill=h.targetDecorator.style.fill==="black"?"white":h.targetDecorator.style.fill),h.shape.relationship==="Dependency"&&(h.style.strokeDashArray=h.style.strokeDashArray?h.style.strokeDashArray:"4 4"),h.shape.relationship==="Aggregation"&&(h.sourceDecorator.style.fill=h.sourceDecorator.style.fill==="black"?"white":h.sourceDecorator.style.fill)),h instanceof M){var T=_t(this.getNodeDefaults);T&&T(h,this)}else if(h instanceof B){var z=_t(this.getConnectorDefaults);z&&z(h,this)}this.symbolTable[h.id]=h,h instanceof M&&h.children&&i.push(h)}for(var L=0;L<i.length;L++)for(var R=void 0,O=0;O<i[parseInt(L.toString(),10)].children.length;O++)R=this.symbolTable[i[parseInt(L.toString(),10)].children[parseInt(O.toString(),10)]],R&&(this.childTable[R.id]=R,R.parentId=i[parseInt(L.toString(),10)].id);for(var N=0,H=t.symbols;N<H.length;N++){var h=H[N];h instanceof M&&h.children||this.prepareSymbol(h)}for(var F=0,Y=i;F<Y.length;F++){var h=Y[F];this.prepareSymbol(h)}},e.prototype.renderPalette=function(t){var i="display:none;overflow:auto;";t.height&&(i+="height:"+t.height+"px"),document.getElementById(t.id);var r=bt("div",{id:t.id,style:i,class:"e-remove-palette"});this.element.appendChild(r);{var a={header:t.title,expanded:t.expanded,content:"#"+t.id,iconCss:t.iconCss};this.accordionElement.items.push(a)}this.renderSymbols(t,r)},e.prototype.addPaletteItem=function(t,i,r){i=E(i);for(var a=0;a<this.palettes.length;a++){var s=this.palettes[parseInt(a.toString(),10)];if(s.id.indexOf(t)!==-1){for(var o=[void 0,s,"symbols",{},!0],h=new(Function.prototype.bind.apply(Jf(i),o)),l=0;l<Object.keys(i).length;l++){var d=this.allowServerDataBinding;this.allowServerDataBinding=!1,h[Object.keys(i)[parseInt(l.toString(),10)]]=i[Object.keys(i)[parseInt(l.toString(),10)]],this.allowServerDataBinding=d}Ti(h,i,h instanceof M?this.nodeDefaults:this.connectorDefaults),s.symbols.push(h);var f=this.allowServerDataBinding;if(this.allowServerDataBinding=!1,this.prepareSymbol(h),this.allowServerDataBinding=f,this.symbolTable[h.id]=h,r)this.childTable[h.id]=h;else{var p=document.getElementById(s.id);p&&p.appendChild(this.getSymbolContainer(h,p))}break}}},e.prototype.removePaletteItem=function(t,i){for(var r,a=0;a<this.palettes.length;a++){var s=this.palettes[parseInt(a.toString(),10)];if(s.id.indexOf(t)!==-1)for(var o=0,h=s.symbols;o<h.length;o++){var l=h[o];if(l.id.indexOf(i)!==-1){var d=s.symbols.indexOf(l);if(s.symbols.splice(d,1),l.children)for(var f=l.children,p=0;p<f.length;p++)delete this.symbolTable[f[parseInt(p.toString(),10)]];delete this.symbolTable[l.id];var c=document.getElementById(l.id+"_container");c.parentNode.removeChild(c),r=!0;break}}if(r)break}},e.prototype.prepareSymbol=function(t){var i,r,a,s,o=new ah,h=t,l,d=new Ht,f=t instanceof M?t.initContainer():null;f&&!f.children&&(f.children=[]);var p=_t(this.getSymbolTemplate);if(p&&(l=p(t)),!l)if(h.children)l=this.getContainer(h,f);else{if(t instanceof B&&t.shape.type==="UmlClassifier"&&t.shape.relationship){l=t.init(this);for(var c=l.children.length-1;c>=0;c--)l.children[parseInt(c.toString(),10)]instanceof Tt&&l.children.splice(c,1)}else l=t.init(this);t instanceof M&&t.parentId&&(l.measure(new U),l.arrange(l.desiredSize),l.width=l.width||l.actualSize.width||this.symbolWidth||l.style.strokeWidth,l.height=l.height||l.actualSize.height||this.symbolHeight||l.style.strokeWidth,t.width=t.width||l.actualSize.width||this.symbolWidth||l.style.strokeWidth,t.height=t.height||l.actualSize.height||this.symbolHeight||l.style.strokeWidth,f.children.push(l))}if(!t.parentId){var u={width:this.symbolWidth,height:this.symbolHeight},g=_t(this.getSymbolInfo);if(g&&(u=g(t)),h.showDefaultTooltipForPalette=u&&u.showTooltip!==!1,u=u||this.symbolInfo||{},t.shape&&t.shape.isPhase&&(u.width=u.width||this.symbolWidth,u.height=u.height||this.symbolHeight),l.relativeMode="Object",l.horizontalAlignment=l.verticalAlignment="Center",d.style.strokeColor=d.style.fill="none",d.children=[l],l.measure(new U),l.arrange(l.desiredSize),i=u.width=u.width||(h.width!==void 0?l.actualSize.width:void 0)||this.symbolWidth,a=u.height=u.height||(h.height!==void 0?l.actualSize.height:void 0)||this.symbolHeight,i!==void 0&&a!==void 0){var v=i,m=a,y=!!t.shape.isPhase;this.symbolWidth!==void 0?v=this.symbolWidth-this.symbolMargin.left-this.symbolMargin.right:i+=h.style.strokeWidth,this.symbolHeight!==void 0?m=this.symbolHeight-this.symbolMargin.top-this.symbolMargin.bottom:a+=h.style.strokeWidth,t.shape&&t.shape.type!=="Bpmn"&&u.description&&u.description.text!==""&&(m-=20),r=v/(!y&&l.width||i),s=m/(!y&&l.height||a),u.fit&&(r=v/u.width,s=m/u.height),i=v,a=m,r=s=Math.min(r,s),d.width=i,d.height=a,l.width=u.width,l.height=u.height,this.scaleSymbol(t,d,r,s,i,a)}else{var S=void 0;t instanceof B&&(S=Od(t)),l.width=t.width||S?S.width:l.actualSize.width,l.height=t.height||S?S.height:l.actualSize.height}t.wrapper=o,o.children=[d],l.pivot=o.pivot={x:0,y:0},o.id=l.id+"_symbol",o.style.fill=o.style.strokeColor="transparent",t instanceof M?(o.offsetX=t.style.strokeWidth/2,o.offsetY=t.style.strokeWidth/2):(o.offsetX=.5,o.offsetY=.5),this.getSymbolDescription(u,i,o,t),o.padding={left:1,right:1,bottom:1,top:1},o.measure(new U),o.arrange(o.desiredSize),u.width=u.width||l.actualSize.width,u.height=u.height||l.actualSize.height,t[this.info]=u}t.parentId&&(f.measure(new U(h.width,h.height)),f.arrange(f.desiredSize))},e.prototype.getContainer=function(t,i){i.measureChildren=!1;var r,a=t.children;i.children=[];for(var s=0;s<a.length;s++)this.symbolTable[a[parseInt(s.toString(),10)]]&&i.children.push(this.symbolTable[a[parseInt(s.toString(),10)]].wrapper);return i.measure(new U(t.width,t.height)),i.arrange(i.desiredSize),(i.bounds.x!==0||i.bounds.y!==0)&&(r=i.bounds,ih(t,r.x,r.y,this.symbolTable,!1,this),i=this.getContainer(t,i)),i},e.prototype.getSymbolDescription=function(t,i,r,a){if(t&&t.description&&t.description.text){var s=new Tt;t.description.overflow=t.description.overflow||"Ellipsis",t.description.wrap=t.description.wrap||"WrapWithOverflow",s.id=r.id+"_text",s.content=t.description.text,s.width=i,s.height=20,s.style.strokeColor="transparent",s.style.color=t.description.color||"black",s.style.fill=t.description.fill||"transparent",s.style.fontFamily=t.description.fontFamily||"Arial",s.style.fontSize=t.description.fontSize||12,s.style.bold=t.description.bold||!1,s.style.italic=t.description.italic||!1,s.style.textDecoration=t.description.textDecoration||"None",s.style.strokeWidth=0,s.style.textWrapping=t.description.wrap,s.style.textOverflow=t.description.overflow,a.shape&&a.shape.type==="Bpmn"?s.margin={left:0,right:0,top:t.description.margin?t.description.margin.top:0,bottom:t.description.margin?t.description.margin.bottom:this.symbolMargin.bottom}:s.margin={left:0,right:0,top:t.description.margin?t.description.margin.top:0,bottom:t.description.margin?t.description.margin.bottom:5},r.children.push(s)}},e.prototype.renderSymbols=function(t,i){for(var r=0,a=t.symbols;r<a.length;r++){var s=a[r];s.parentId||this.getSymbolContainer(s,i)}},e.prototype.getSymbolPreview=function(t,i,r){this.allowServerDataBinding=!1;var a,s,o,h=t.wrapper.children[0].desiredSize.width+t.style.strokeWidth,l=t.wrapper.children[0].desiredSize.height+t.style.strokeWidth,d=t.wrapper.children[0].children[0],f=t.previewSize;if(t&&(f.width||f.height)||this.symbolPreview.width!==void 0||this.symbolPreview.height!==void 0){h=(f.width||this.symbolPreview.width||h)-t.style.strokeWidth,l=(f.height||this.symbolPreview.height||l)-t.style.strokeWidth,t instanceof B&&(d.actualSize.width<=t.style.strokeWidth&&(d.actualSize.width=this.symbolWidth),d.actualSize.height<=t.style.strokeWidth&&(d.actualSize.height=this.symbolHeight)),s=h/d.actualSize.width,o=l/d.actualSize.height,s=o=Math.min(s,o);var p=d.actualSize.width*s,c=d.actualSize.height*o;t.wrapper.children[0].width=h,t.wrapper.children[0].height=l,this.measureAndArrangeSymbol(d,t instanceof M),this.scaleSymbol(t,t.wrapper.children[0],s,o,p,c,!0),h=p,l=c}var u={x:d.offsetX,y:d.offsetY};d.offsetX=d.offsetY=t.style.strokeWidth/2,d.pivot={x:0,y:0},this.measureAndArrangeSymbol(d,t instanceof M);var g=bt("div",{draggable:"true",class:"e-dragclone",style:"pointer-events:none"}),v;document.body.appendChild(g);var m="margin:5px;";if(t.shape.type==="Native"){a=Nt("svg",{id:t.id+"_preview",width:Math.ceil(h)+1,height:Math.ceil(l)+1});var y=Nt("g",{id:t.id+"_g"});a.appendChild(y),g.appendChild(a),this.svgRenderer.renderElement(d,y,void 0,void 0,a),this.prepareSymbol(t)}else if(t.shape.type==="HTML")v=this.getHtmlSymbol(t,a,g,l,h,!0),this.prepareSymbol(t);else if(t.shape.type==="UmlClassifier"&&!t.shape.relationship)t.children&&t.children.length>0&&en(t,"HTML",this.childTable)&&(v=this.getHtmlSymbol(t,a,g,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!0),this.prepareSymbol(t));else if(t.children&&t.children.length>0&&en(t,"HTML",this.childTable))v=this.getGroupParent(t,a,g,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!0),this.prepareSymbol(t);else{a=nr.createCanvas(t.id+"_preview",(Math.ceil(h)+t.style.strokeWidth+1)*2,(Math.ceil(l)+t.style.strokeWidth+1)*2),g.appendChild(a),t.shape.type==="Basic"||t.shape.type==="Flow"?m+="transform: scale(0.5) translate(-"+a.width/2+"px, -"+a.height/2+"px);":m+="transform:scale(0.5);",a.setAttribute("transform-origin","0 0");var S=2;t instanceof B&&(S=1.9),a.getContext("2d").setTransform(S,0,0,S,0,0),this.diagramRenderer.renderElement(d,a,void 0),this.prepareSymbol(t)}return Ui(v&&(t.shape.type==="HTML"||t.children&&t.children.length>0)?v:a,m),d.offsetX=u.x,d.offsetY=u.y,this.allowServerDataBinding=!0,g},e.prototype.measureAndArrangeSymbol=function(t,i){t.children&&!i&&(t.children[0].transform=Zi.Self),t.measure(new U),t.arrange(t.desiredSize),t.children&&t.children.length>0&&(t.children[0].transform=Zi.Parent)},e.prototype.updateSymbolSize=function(t,i,r){var a=t.wrapper.children[0].children[0],s=t.style.strokeWidth;a.width=(i||a.width)-(s+1),a.height=(r||a.height)-(s+1),t.wrapper.measure(new U),t.wrapper.arrange(t.wrapper.desiredSize)},e.prototype.getSymbolContainer=function(t,i,r){var a=this.symbolTable[t.id][this.info],s=this.getSymbolSize(t,a),o=s.width+1,h=s.height+1,l=i.id==="SearchPalette"?t.id+"SearchSymbol":t.id,d=bt("div",{id:l+"_container",style:"width:"+o+"px;height:"+h+"px;float:left;overflow:hidden"});i.appendChild(d);var f,p,c;if(t.shape.type==="Native")f=Nt("svg",{id:l,width:Math.ceil(t.wrapper.actualSize.width)+1,height:Math.ceil(t.wrapper.actualSize.height)+1}),p=Nt("g",{id:l+"_g"}),f.appendChild(p),d.appendChild(f),this.updateSymbolSize(t),this.svgRenderer.renderElement(t.wrapper,p,void 0,void 0,f);else if(t.shape.type==="HTML")c=this.getHtmlSymbol(t,f,d,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!1,i.id==="SearchPalette");else if(t.shape.type==="UmlClassifier"&&!t.shape.relationship)t.children&&t.children.length>0&&en(t,"HTML",this.childTable)&&(c=this.getHtmlSymbol(t,f,d,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!1));else if(t.children&&t.children.length>0&&en(t,"HTML",this.childTable))c=this.getGroupParent(t,f,d,t.wrapper.actualSize.height,t.wrapper.actualSize.width,!1);else{f=nr.createCanvas(l,Math.ceil((t.wrapper.actualSize.width+t.style.strokeWidth)*2)+1,Math.ceil((t.wrapper.actualSize.height+t.style.strokeWidth)*2)+1),d.appendChild(f);var u=2;t instanceof B&&(u=1.9),f.getContext("2d").setTransform(u,0,0,u,0,0),this.diagramRenderer.renderElement(t.wrapper,p||f,void 0,void 0,void 0,void 0,!0,void 0,!0)}if(!r){var g=t.wrapper.actualSize.width+t.style.strokeWidth,v=t.wrapper.actualSize.height+t.style.strokeWidth,m="pointer-events:none;transform-origin:0 0;overflow:hidden;";return t.shape.isPhase?t.shape.orientation==="Horizontal"?m+="margin-left:"+Math.max(this.symbolMargin.left,(o-g)/2)+"px;margin-top:"+s.height/2+"px;":m+="margin-left:"+s.width/2+"px;margin-top:"+Math.max(this.symbolMargin.top,(h-v)/2)+"px;":m+="margin-left:"+Math.max(this.symbolMargin.left,(o-g)/2)+"px;margin-top:"+Math.max(this.symbolMargin.top,(h-v)/2)+"px;",f instanceof HTMLCanvasElement&&(m+="transform:scale(.5,.5);"),Ui(c&&(t.shape.type==="HTML"||t.children&&t.children.length>0)?c:f,m),d.classList.add("e-symbol-draggable"),d}return f},e.prototype.getGroupParent=function(t,i,r,a,s,o){var h=bt("div",{id:t.id+(o?"_html_div_preview":"_html_div")}),l=bt("div",{id:t.id+(o?"_htmlLayer_preview":"_htmlLayer"),style:"width:"+Math.ceil(s+1)+"px;height:"+Math.ceil(a+1)+"px;position:absolute",class:"e-html-layer"}),d=bt("div",{id:t.id+(o?"_htmlLayer_div_preview":"_htmlLayer_div"),style:"width:"+Math.ceil(s+1)+"px;height:"+Math.ceil(a+1)+"px;position:absolute"});return l.appendChild(d),h.appendChild(l),i=nr.createCanvas(o?t.id+"_preview":t.id,Math.ceil(s)+1,Math.ceil(a)+1),h.appendChild(i),r.appendChild(h),this.diagramRenderer.renderElement(t.wrapper.children[0].children[0],i,l),h},e.prototype.getHtmlSymbol=function(t,i,r,a,s,o,h){var l=h?t.id+"SearchSymbol":t.id,d=bt("div",{id:l+(o?"_html_div_preview":"_html_div")}),f=bt("div",{id:l+(o?"_htmlLayer_preview":"_htmlLayer"),style:"width:"+Math.ceil(s+1)+"px;height:"+Math.ceil(a+1)+"px;position:absolute",class:"e-html-layer"}),p=bt("div",{id:l+(o?"_htmlLayer_div_preview":"_htmlLayer_div"),style:"width:"+Math.ceil(s+1)+"px;height:"+Math.ceil(a+1)+"px;position:absolute"});f.appendChild(p),d.appendChild(f);var c=t.wrapper.actualSize.width+t.style.strokeWidth,u=t.wrapper.actualSize.height+t.style.strokeWidth,g="pointer-events:none;transform-origin:0 0;overflow:hidden;";return g+="margin-left:"+Math.max(this.symbolMargin.left,(s-c)/2)+"px;margin-top:"+Math.max(this.symbolMargin.top,(a-u)/2)+"px;",g+="transform:scale(.5,.5);position:absolute",i=nr.createCanvas(l,Math.ceil((t.wrapper.actualSize.width+t.style.strokeWidth)*2)+1,Math.ceil((t.wrapper.actualSize.height+t.style.strokeWidth)*2)+1),r.appendChild(i),i.getContext("2d").setTransform(2,0,0,2,0,0),Ui(i,g),r.appendChild(d),o?(t.shape.type==="UmlClassifier"&&(t.shape.classifier==="Class"?t.wrapper.children[0].children[0].children[0].content='<div id="parentDiv" style="width:100%; height:50%; border:1px solid #000; background:#6BA5D7; display: flex; align-items: center; justify-content: center;"><div id="textDiv" style="font-size:1vw;">class</div></div>':t.shape.classifier==="Enumeration"?t.wrapper.children[0].children[0].children[0].content='<div id="parentDiv2" style="width:100%; height:50%; border:1px solid #000; background:#6BA5D7; display: flex; align-items: center; justify-content: center;"><div id="textDiv2" style="font-size:0.8vw;">Enumeration</div></div>':t.shape.classifier==="Interface"&&(t.wrapper.children[0].children[0].children[0].content='<div id="parentDiv3" style="width:100%; height:50%; border:1px solid #000; background:#6BA5D7; display: flex; align-items: center; justify-content: center;"><div id="textDiv3" style="font-size:0.9vw;">Interface</div></div>')),this.diagramRenderer.renderElement(t.wrapper.children[0].children[0],i,f)):this.diagramRenderer.renderElement(t.wrapper,i,f),d},e.prototype.getSymbolSize=function(t,i){var r=t.wrapper.actualSize.width,a=t.wrapper.actualSize.height;return!this.symbolWidth&&!this.symbolHeight?(r+=this.symbolMargin.left+this.symbolMargin.right+t.style.strokeWidth,a+=this.symbolMargin.top+this.symbolMargin.bottom+t.style.strokeWidth):(r=this.symbolWidth,a=Math.max(this.symbolHeight,a)),new U(r,a)},e.prototype.getMousePosition=function(t){var i,r,a;if(t.type.indexOf("touch")!==-1){a=t;var s=a.changedTouches[0].clientY,o=a.changedTouches[0].clientX;i=s-this.element.offsetTop,r=o-this.element.offsetLeft}else i=t.clientY-this.element.offsetTop,r=t.clientX-this.element.offsetLeft;return{x:r,y:i}},e.prototype.getContent=function(t){var i=this.hoverElement instanceof M&&this.hoverElement.constraints&W.Tooltip||this.hoverElement instanceof B&&this.hoverElement.constraints&yt.Tooltip,r=i?this.hoverElement.tooltip.content:t.id;return r},e.prototype.initTooltip=function(t){var i;{var r=new Ba;r=this.updateTooltipContent(this.hoverElement.tooltip,r),i=new Ba(r),i.cssClass="e-symbolPalette-tooltip",i.opensOn="custom",i.appendTo("#"+t.id),i.close()}return i},e.prototype.updateTooltipContent=function(t,i){return i.content=t.content,i.position="BottomRight",i.showTipPointer=t.showTipPointer,i.width=t.width,i.height=t.height,t.animation?i.animation=t.animation:i.animation={close:{effect:"None"}},i},e.prototype.elementEnter=function(t,i,r){if(!i){this.symbolTooltipObject.windowCollision=!0;var a=this.hoverElement.showDefaultTooltipForPalette;this.hoverElement.tooltip.isSticky&&(this.symbolTooltipObject.isSticky=!0),this.hoverElement instanceof M?a&&!(this.hoverElement.constraints&(W.Default&&W.Tooltip))&&(this.symbolTooltipObject.content=xr(function(){return this.hoverElement.id},this)):this.hoverElement instanceof B&&a&&!(this.hoverElement.constraints&(yt.Default&&yt.Tooltip))&&(this.symbolTooltipObject.content=xr(function(){return this.hoverElement.id},this)),this.symbolTooltipObject.content&&(this.hoverElement.tooltip.relativeMode==="Mouse"?(this.hoverElement.tooltip.relativeMode="Object",this.symbolTooltipObject.offsetX=0,this.symbolTooltipObject.offsetY=0):(this.symbolTooltipObject.offsetX=0,this.symbolTooltipObject.offsetY=0));var s=r?this.hoverElement.id+"SearchSymbol":this.hoverElement.id,o=document.getElementById(s);this.hoverElement.tooltip.openOn==="Auto"&&this.symbolTooltipObject.content!==""&&(this.symbolTooltipObject.close(),this.symbolTooltipObject.opensOn=this.hoverElement.tooltip.openOn,this.symbolTooltipObject.dataBind()),this.hoverElement.tooltip.openOn==="Auto"&&this.symbolTooltipObject.content!==""&&(this.symbolTooltipObject.target=this.hoverElement.id,this.symbolTooltipObject.open(o))}},e.prototype.mouseMove=function(t,i){this.highlightedSymbol&&(!this.selectedSymbol||this.selectedSymbol.id+"_container"!==this.highlightedSymbol.id)&&(this.highlightedSymbol.classList.remove("e-symbol-hover"),this.highlightedSymbol.style.backgroundColor="",this.highlightedSymbol=null);var r=t.target.id.split("_container")[0];if(this.symbolTable[""+r]||r!=="SearchPalette"&&t.target&&t.target.id.includes("SearchSymbol")){var a=document.getElementById(r+"_container");a.classList.add("e-symbol-hover"),this.highlightedSymbol=a}t.preventDefault();var s=!1;t.target&&t.target.id.includes("SearchSymbol")&&(s=!0,r=r.split("SearchSymbol")[0]);var o=this.symbolTable[""+r];if(this.symbolTable[""+r]&&o!==this.hoverElement){this.currentPosition=this.getMousePosition(t);var h=this.getContent(o);this.hoverElement&&this.hoverElement.tooltip.openOn==="Auto"&&h!==""&&this.elementLeave(),this.hoverElement=o,this.symbolTooltipObject=this.initTooltip(this.hoverElement),h===""&&(h=this.hoverElement.id),this.hoverElement.tooltip&&h!==""&&this.elementEnter(this.currentPosition,!1,s)}o===void 0&&this.hoverElement&&!this.hoverElement.tooltip.isSticky&&this.hoverElement.tooltip.openOn==="Auto"&&(this.hoverElement=null,this.elementLeave())},e.prototype.elementLeave=function(){this.symbolTooltipObject&&this.symbolTooltipObject.opensOn!=="Custom"&&this.symbolTooltipObject.close()},e.prototype.mouseLeave=function(t){this.elementLeave(),t.preventDefault()},e.prototype.mouseUp=function(t){if(this.isMethod=!0,t&&t.target)if(t.srcElement.id==="iconSearch"){var i=document.getElementById("iconSearch");i.classList.contains("e-clear-searchtext")&&(i.className="e-input-group-icon e-search e-icons",document.getElementById("textEnter").value="",this.searchPalette(""))}else{var r=t.target.id.split("_container")[0];if(r&&this.selectedSymbol){var a={oldValue:this.oldObject,newValue:r},s="paletteSelectionChange";this.trigger(s,a),this.oldObject=r,t.preventDefault()}else this.oldObject!==""&&(this.oldObject="")}},e.prototype.keyUp=function(t){var i=this;if(this.enableSearch){var r=this,a=document.getElementById("iconSearch");a.className="e-input-group-icon e-clear-searchtext e-icons",t&&(t.key==="Enter"||t.keyCode===13)?t.target instanceof HTMLInputElement&&this.searchPalette(t.target.value):(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.target instanceof HTMLInputElement&&(r.searchPalette(t.target.value),i.timer=null)},500))}},e.prototype.mouseDown=function(t){var i=t.target.id.split("_container")[0],r=!1;if(i.includes("SearchSymbol")&&(i=i.split("SearchSymbol")[0],r=!0),this.selectedSymbol){var a=document.getElementById(this.selectedSymbol.id+"_container"),s=document.getElementById(this.selectedSymbol.id+"SearchSymbol_container");(a||s)&&(a.classList.remove("e-symbol-selected"),s&&s.classList.remove("e-symbol-selected"));var o=document.getElementById(this.selectedSymbol.id+"_container");o&&(o.style.backgroundColor=""),this.selectedSymbol=null}if(this.symbolTable[""+i]){var h=i;r&&(h=i+"SearchSymbol");var o=document.getElementById(h+"_container");o.classList.add("e-symbol-selected"),this.selectedSymbol=this.symbolTable[""+i],t.preventDefault()}},e.prototype.keyDown=function(t){var i=this,r="helperElement",a="intDestroy";if(t&&t.key==="Escape"&&this.allowDrag){var s=i.draggable[""+r];s&&s.parentNode&&(s.parentNode.removeChild(s),i.draggable[""+a]())}},e.prototype.initDraggable=function(){this.allowDrag&&(this.draggable=new ag(this.element,{dragTarget:".e-symbol-draggable",helper:this.helper,dragStart:this.dragStart,preventDefault:!1,dragStop:this.dragStop,drag:function(t){var i="target",r=Pl(t[""+i],"e-droppable");if(r&&r.classList.contains("e-diagram")){var a="ej2_instances";r[""+a][0].droppable.over(t)}},cursorAt:{left:this.symbolPreview.offset.x,top:this.symbolPreview.offset.y}}))},e.prototype.dragStart=function(t){var i=this.helper[0];i&&i.setAttribute("paletteId",this.element.id)},e.prototype.dragStop=function(t){Pl(t.target,"e-diagram")||sn(t.helper)},e.prototype.scaleSymbol=function(t,i,r,a,s,o,h){if(t instanceof B){var l=t.wrapper;t.wrapper=i.children[0];for(var d=t.scale(r,a,s,o,i.children[0]),f=s/2-i.children[0].children[0].offsetX+d.x/2,p=o/2-i.children[0].children[0].offsetY+d.y/2,c=0,u=i.children[0].children;c<u.length;c++){var g=u[c];g.offsetX+=f,g.offsetY+=p,g.staticSize=!1}t.wrapper=l}else if(t.shape.type==="Bpmn"&&this.bpmnModule){var l=t.wrapper;t.wrapper=i,i.children[0].width=s,i.children[0].height=o,this.bpmnModule.updateBPMN({width:s,height:o},t,t,null),t.wrapper=l}else if(t.children){var v=t.children,m=0,y=0;if(!h)for(var S=void 0,x=void 0,I=0;I<v.length;I++)x=i.children[0].children[parseInt(I.toString(),10)],x&&(x.children[0].children&&this.measureChild(x),S=this.symbolTable[x.id],x.width=S.width,x.height=S.height,x.measure(new U),x.arrange(x.children[0].desiredSize));if(m=s/i.children[0].desiredSize.width,y=o/i.children[0].desiredSize.height,i.children[0].measure(new U),i.children[0].arrange(i.children[0].desiredSize),!h)for(var C=void 0,I=0;I<v.length;I++)C=i.children[0].children[parseInt(I.toString(),10)],C&&(C.children[0].children&&this.scaleChildren(C,m,y,t),this.scaleGroup(C,m,y,t));if(h){for(var P=void 0,A=void 0,C=void 0,I=0;I<v.length;I++)P=s/t.wrapper.children[0].desiredSize.width,A=o/t.wrapper.children[0].desiredSize.height,C=i.children[0].children[parseInt(I.toString(),10)],C&&(C.children[0].children&&this.scaleChildren(C,P,A,t,!0),this.scaleGroup(C,P,A,t,!0));t.wrapper.children[0].measure(new U),t.wrapper.children[0].arrange(t.wrapper.children[0].desiredSize)}}else pf(i.children[0],r,a,i)},e.prototype.scaleChildren=function(t,i,r,a,s){for(var o,h=0;h<t.children.length;h++)o=t.children[parseInt(h.toString(),10)],o.children[0].children?this.scaleChildren(o,i,r,a,s):this.scaleGroup(o,i,r,a,s)},e.prototype.measureChild=function(t){for(var i,r,a=0;a<t.children.length;a++)i=t.children[parseInt(a.toString(),10)],i.children[0].children?this.measureChild(i):(r=this.symbolTable[i.id],i.width=r.width,i.height=r.height,i.measure(new U),i.arrange(i.children[0].desiredSize))},e.prototype.scaleGroup=function(t,i,r,a,s){t.width=(t.width||t.children[0].width)*i,t.height=(t.height||t.children[0].height)*r,t.offsetX=s?t.offsetX*i-a.style.strokeWidth:t.offsetX*i+a.style.strokeWidth/2,t.offsetY=s?t.offsetY*r-a.style.strokeWidth:t.offsetY*r+a.style.strokeWidth/2,t.measure(new U),t.arrange(t.children[0].desiredSize)},e.prototype.refreshPalettes=function(){this.accordionElement.items=[],yy("e-remove-palette",this.element.id),this.updatePalettes(),this.accordionElement.dataBind()},e.prototype.updatePalettes=function(){for(var t=0;t<this.palettes.length;t++){var i=this.palettes[parseInt(t.toString(),10)];i.id==="search_palette"?(this.palettes.splice(t,1),t--):(this.initSymbols(i),this.renderPalette(i))}},e.prototype.createTextbox=function(){var t=bt("div",{id:this.element.id+"_search"});Ui(t,"height:30px"),t.className="e-input-group",this.element.insertBefore(t,this.element.firstChild);var i=bt("input",{});i.placeholder=this.l10n.getConstant("SearchShapes"),i.id="textEnter",Ui(i,"width:100%;height:auto"),i.className="e-input",t.appendChild(i);var r=bt("span",{id:"iconSearch",className:"e-input-group-icon e-search e-icons"});t.appendChild(r)},e.prototype.getFilterSymbol=function(t){var i=this,r=[];return r=t.filter(function(a){return!i.ignoreSymbolsOnSearch.includes(a.id)}),r},e.prototype.searchPalette=function(t){var i=[],r=document.getElementById("SearchPalette"),a;if(r){for(var s=r.children.length-1;s>=0;s--)r.removeChild(r.children[parseInt(s.toString(),10)]);this.palettes.splice(0,1)}for(var s=0;s<this.palettes.length;s++)for(var o=this.palettes[parseInt(s.toString(),10)],h=0;h<o.symbols.length;h++){var l=o.symbols[parseInt(h.toString(),10)];t!==""&&(l.id.toLowerCase().indexOf(t.toLowerCase())!==-1||l.info&&l.info.description&&l.info.description.text&&l.info.description.text.toLowerCase().startsWith(t.toLowerCase()))&&i.push(l)}var d=_t(this.filterSymbols);if(d&&(i=d(i)||[]),this.ignoreSymbolsOnSearch&&this.ignoreSymbolsOnSearch.length>0&&(i=this.getFilterSymbol(i)),t!==""){var f={id:"search_palette",expanded:!0,symbols:i,title:"Search Shapes"},p=new js(this,"palettes",f,!0);this.palettes.splice(0,0,p)}if(r||(a=this.createSearchPalette(a),r=a),i.length>0)for(var c=0,u=i;c<u.length;c++){var g=u[c];g.parentId===""&&this.getSymbolContainer(g,r)}else if(t!==""){var v=bt("div",{id:"EmptyDiv",style:"text-align:center;font-style:italic"});v.innerHTML=this.l10n.getConstant("NoItemsToDisplay"),r.appendChild(v)}else{var m=document.getElementById("iconSearch");m.className="e-input-group-icon e-search e-icons";{this.accordionElement.removeItem(0);var f=document.getElementById("SearchPalette");f&&f.remove()}}},e.prototype.createSearchPalette=function(t){t=bt("div",{id:"SearchPalette",style:"display:none;overflow:auto;"}),this.element.appendChild(t);var i={header:this.l10n.getConstant("SearchResults"),expanded:!0,content:"#SearchPalette"};return this.accordionElement.addItem(i,0),t},e.prototype.wireEvents=function(){var t=vt.touchStartEvent,i=vt.touchEndEvent,r=vt.touchMoveEvent,a="mouseleave",s="keyup",o="keydown";J.add(this.element,t,this.mouseDown,this),J.add(this.element,r,this.mouseMove,this),J.add(this.element,i,this.mouseUp,this),J.add(this.element,a,this.mouseLeave,this),J.add(this.element,s,this.keyUp,this),J.add(document,o,this.keyDown,this),this.initDraggable()},e.prototype.unWireEvents=function(){var t=vt.touchStartEvent,i=vt.touchEndEvent,r=vt.touchMoveEvent,a=vt.isPointer?"pointerleave":"mouseleave",s="keyup",o="keydown";J.remove(this.element,t,this.mouseDown),J.remove(this.element,r,this.mouseMove),J.remove(this.element,i,this.mouseUp),J.remove(this.element,a,this.mouseLeave),J.remove(this.element,s,this.keyUp),J.remove(document,o,this.keyDown)},Mt([w("S")],e.prototype,"accessKey",void 0),Mt([w("100%")],e.prototype,"width",void 0),Mt([w("100%")],e.prototype,"height",void 0),Mt([Lt([],js)],e.prototype,"palettes",void 0),Mt([w()],e.prototype,"getSymbolInfo",void 0),Mt([w({fit:!0})],e.prototype,"symbolInfo",void 0),Mt([w()],e.prototype,"filterSymbols",void 0),Mt([w()],e.prototype,"ignoreSymbolsOnSearch",void 0),Mt([w()],e.prototype,"getSymbolTemplate",void 0),Mt([w()],e.prototype,"symbolWidth",void 0),Mt([w()],e.prototype,"symbolHeight",void 0),Mt([X({left:10,right:10,top:10,bottom:10},Ie)],e.prototype,"symbolMargin",void 0),Mt([w(!0)],e.prototype,"allowDrag",void 0),Mt([X({},JS)],e.prototype,"symbolPreview",void 0),Mt([X({},QS)],e.prototype,"symbolDragSize",void 0),Mt([w(!1)],e.prototype,"enableSearch",void 0),Mt([w(!0)],e.prototype,"enableAnimation",void 0),Mt([w("Multiple")],e.prototype,"expandMode",void 0),Mt([ot()],e.prototype,"paletteSelectionChange",void 0),Mt([ot()],e.prototype,"paletteExpanding",void 0),Mt([w()],e.prototype,"getNodeDefaults",void 0),Mt([w()],e.prototype,"nodeDefaults",void 0),Mt([w()],e.prototype,"getConnectorDefaults",void 0),Mt([w()],e.prototype,"connectorDefaults",void 0),Mt([w()],e.prototype,"nodeTemplate",void 0),e})(Vr);function _S(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[""+t]=n[""+t]);return e.default=n,e}var an=_S(fg),zi=!(parseInt(an.version,10)>2),Ci=zi?an.default.default?an.default.default:an.default:an,KS=an.h,_f=function(n){return zi?Ci.extend(n):Ci.defineComponent(n)},jS=_f({name:"ComponentBase",data:function(){return{tagMapper:{},tagNameMapper:{},hasInjectedModules:!1,hasChildDirective:!1,childDirObjects:"",propKeys:{},isDecorator:!1}},created:function(){var n=this;if(this.ej2Instance&&(this.ej2Instances=this.isVue3?Ci.toRaw(this.ej2Instance):this.ej2Instance),!!this.propKeys){for(var e=function(c){t.ej2Instances.addEventListener(c,function(u){n.$emit(c,u)})},t=this,i=0,r=this.propKeys;i<r.length;i++){var a=r[i];e(a)}var s=Ii("$root.$options.provide",this),o=Ii("$parent.$options.provide",this);if(o=V(o)?Ii("$.parent.provides",this):o,this.hasInjectedModules&&!zi){var h=[];s&&s.managed?(this.isDecorator=!0,h=this.getInjectedServices()||[]):s?h=s[this.ej2Instances.getModuleName()]||[]:o&&(h=this.getInjectedServices()||[]);for(var l=this.ej2Instances.getInjectedModules()||[],d=0,f=l;d<f.length;d++){var p=f[d];h.indexOf(p)===-1&&h.push(p)}this.ej2Instances.injectedModules=h}}},mounted:function(){var n=this.$el?this.$el.querySelectorAll("div.e-directive"):null;if(!zi&&n)for(var e=0;e<n.length;e++){var t=n[parseInt(e.toString(),10)];t.parentElement&&t.parentElement.removeChild(t)}this.ej2Instances.isVue=!0,this.ej2Instances.isVue3=this.isVue3,this.ej2Instances.vueInstance=this,this.isVue3&&(this.ej2Instances.ej2Instances=this.ej2Instances,this.ej2Instances.referModels=this.models,this.setModelValue()),this.ej2Instances.appendTo(this.$el)},updated:function(){this.updated()},beforeDestroy:function(){this.destroyComponent()},beforeUnmount:function(){this.destroyComponent()},methods:{setModelValue:function(){if(!V(this.modelValue)||!V(this.$attrs.modelValue)){var n=this.models.toString().match(/checked|value/)||[],e=n[0];V(e)||(this.ej2Instances[""+e]=V(this.modelValue)?this.$attrs.modelValue:this.modelValue)}},updated:function(){if(this.isVue3&&this.setModelValue(),this.hasChildDirective){var n={};this.fetchChildPropValues(n);var e=JSON.stringify(n);this.childDirObjects!==e&&(this.childDirObjects=e,this.assignValueToWrapper(n,!1))}},getInjectedServices:function(){var n=[],e;if(this.$root&&this.isDecorator?e=Ii("$root.$options.provide",this):this.$vnode?e=Ii("$vnode.context.$options.provide",this):this.$parent&&(e=Ii("$parent.$options.provide",this)),V(e)&&!V(this.$)&&(e=Ii("$.parent.provides",this)),e){var t=e;if(typeof e=="function")if(e.managed){var i=e.managed,r=Object.keys(i),a=void 0;this.$root&&this.isDecorator?a=Object.keys(this.$root):this.$vnode?a=Object.keys(this.$vnode.context):this.$parent&&(a=Object.keys(this.$parent));for(var s=0;s<r.length;s++)for(var o=0;o<a.length;o++)a[parseInt(o.toString(),10)].indexOf(r[parseInt(s.toString(),10)])!==-1&&(this.$root&&this.isDecorator?i[r[parseInt(o.toString(),10)]]=this.$root[a[parseInt(s.toString(),10)]]:this.$vnode?i[r[parseInt(s.toString(),10)]]=this.$vnode.context[a[parseInt(o.toString(),10)]]:this.$parent&&(i[r[parseInt(s.toString(),10)]]=this.$parent[a[parseInt(o.toString(),10)]]),t=i)}else this.$vnode?t=this.$vnode.context.$options.provide():this.$parent&&(t=this.$parent.$options.provide());n=t[this.ej2Instances.getModuleName()]||[]}return this.isDecorator=!1,n},destroyComponent:function(){this.ej2Instances.destroy(),this.$el.style.visibility="hidden",this.clearTemplate()},destroyPortals:function(n){if(n){var e=Ii("__vue__.$destroy",n);if(e)n.__vue__.$destroy();else if(!zi&&n._vnode)try{Ci.render(null,n)}catch{}n.innerHTML&&(n.innerHTML="")}},bindProperties:function(){for(var n={},e=0,t=this.propKeys;e<t.length;e++){var i=t[e];V(this[""+i])?this[0]&&!V(this[0][0])&&!V(this[0][0][""+i])&&(n[""+i]=this[0][0][""+i]):n[""+i]=this[""+i]}if(this.hasChildDirective&&this.fetchChildPropValues(n),this.hasInjectedModules){for(var r=this.getInjectedServices()||[],a=this.ej2Instances.getInjectedModules()||[],s=0,o=a;s<o.length;s++){var h=o[s];r.indexOf(h)===-1&&r.push(h)}this.ej2Instances.injectedModules=r}this.assignValueToWrapper(n)},assignValueToWrapper:function(n,e){this.ej2Instances.setProperties(Ea({},{},n,!0),V(e)?!0:e)},fetchChildPropValues:function(n){var e={};if(!this.isVue3)e=this.getDirectiveValues(this.$slots.default,this.tagMapper||{},this.tagNameMapper||{});else{var t=void 0;if(this[0]&&this[0][1].slots.default?t=this[0][1].slots.default():this&&this.$&&this.$.slots&&this.$.slots.default&&(t=this.$.slots.default()),t){for(var i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)].type.methods||t[parseInt(i.toString(),10)].type==="e-seriescollection"){var r=t[parseInt(i.toString(),10)].type==="e-seriescollection"?"series-collection":t[parseInt(i.toString(),10)].type.methods.getTag().replace("e-",""),a=this.resolveArrayDirectives(t[parseInt(i.toString(),10)].children,r),s=r.split("-"),o=this.ej2Instances.getModuleName().toLowerCase(),h=s.length>1&&o.indexOf(s[0])>-1?s[1]:s[0];h=h.replace(o,""),h=this.tagNameMapper["e-"+r]?this.tagNameMapper["e-"+r].replace("e-",""):h,o==="splitter"&&h==="panes"?h="paneSettings":o==="bulletchart"&&h==="range"?h="ranges":o==="schedule"&&h==="header"&&(h="headerRows"),e[""+h]=a[""+r]}}else return}this.childDirObjects||(this.childDirObjects=JSON.stringify(e));for(var l=0,d=Object.keys(e);l<d.length;l++){var f=d[l];n[""+f]=e[""+f]}},resolveArrayDirectives:function(n,e){var t=[],i;t=n.default?n.default():n,t=t.flatMap(function(d){return Array.isArray(d.children)?d.children:d});var r={};r[""+e]=[];for(var a=function(d){var f={},p=d.type.methods?d.type.methods.getTag():e;if(d.children){var c=void 0;if(i=s.resolveComplexDirs(d.children,s.tagMapper["e-"+e],p),i.length)f=i;else for(var u=0;u<Object.keys(i).length;u++)c=Object.keys(i)[parseInt(u.toString(),10)],f[""+c]=i[""+c]}d.props&&Object.keys(d.props).forEach(function(g){var v=g.replace(/-[a-z]/g,function(m){return m[1].toUpperCase()});v&&(f[""+v]=d.props[""+g])}),/[s]\b/.test(p)&&i&&(!/[s]\b/.test(e)||i.length)?Array.isArray(f)?f.forEach(function(g){r[""+e].push(g)}):r[""+e].push(f):f&&Object.keys(f).length!==0&&r[""+e].push(f)},s=this,o=0,h=t;o<h.length;o++){var l=h[o];a(l)}return r},resolveComplexDirs:function(n,e,t){var i=[],r;i=n.default?n.default():n;for(var a={},s=function(f){var p=void 0,c=void 0;e[""+t]&&(p=Object.keys(e[""+t]),c=p.find(function(u){return e[""+t][""+u]===f.type.methods.getTag().replace(/[s]\b/,"")}),c=c||f.type.methods.getTag(),c=(o.tagNameMapper[""+c]?o.tagNameMapper[""+c]:c).replace("e-",""),o.ej2Instances.getModuleName().toLowerCase()==="diagram"&&c.indexOf("annotations")!==-1&&(c="annotations")),f.children&&(r=o.resolveComplexInnerDirs(f.children,e[""+t],f.type.methods.getTag()),a[""+c]||(a[""+c]=[]),r.length>1?a[""+c]=r:a[""+c].push(r)),f.props&&(f.props=o.getCamelCaseProps(f.props)),i.length>1?(a=Object.keys(a).length===0&&!a.length?[]:a,f.props&&a.push(f.props)):a=f.props?Object.assign(a,f.props):a},o=this,h=0,l=i;h<l.length;h++){var d=l[h];s(d)}return a},resolveComplexInnerDirs:function(n,e,t){var i=[];i=n.default?n.default():n;for(var r=i.length>1?[]:{},a=0,s=i;a<s.length;a++){var o=s[a],h=null,l=o.type.methods.getTag();l=(this.tagNameMapper[""+l]?this.tagNameMapper[""+l]:l).replace("e-",""),o.children&&(h=this.resolveMultilevelComplexInnerDirs(o.children,e[""+t],o.type.methods.getTag()),/[s]\b/.test(l)||i.length>1?/[s]\b/.test(l)?(r[""+l]=r[""+l]?r[""+l]:[],h.length?r[""+l]=h:r[""+l].push(h)):h&&!o.props&&r.push(h):r=h||r),o.props&&(o.props=this.getCamelCaseProps(o.props)),i.length>1&&o.props?h?(h=o.props?Object.assign(h,o.props):h,r.push(h)):r.length>=0?r.push(o.props):r=o.props?Object.assign(r,o.props):r:r=o.props?Object.assign(r,o.props):r}return r},resolveMultilevelComplexInnerDirs:function(n,e,t){var i=[];i=n.default?n.default():n;for(var r=i.length>1?[]:{},a=0,s=i;a<s.length;a++){var o=s[a],h=null,l=o.type.methods.getTag();l=(this.tagNameMapper[""+l]?this.tagNameMapper[""+l]:l).replace("e-",""),o.children&&(h=this.resolveComplexInnerDirs(o.children,e[""+t],o.type.methods.getTag())),o.props&&(o.props=this.getCamelCaseProps(o.props)),/[s]\b/.test(l)?(r[""+l]=r[""+l]?r[""+l]:[],h.length?r[""+l]=h:r[""+l].push(h),o.props&&r[""+l].push(o.props)):(r=h,r=o.props?Object.assign(r,o.props):r)}return r},getDirectiveValues:function(n,e,t){var i=Object.keys(e),r={};if(n)for(var a=0,s=n;a<s.length;a++){var o=s[a],h=o.componentOptions;if(h&&h.children&&this.getTagName(h)||o.tag==="e-seriescollection"&&o.children){var l=h?this.getTagName(h):o.tag;if(l=l==="e-seriescollection"?"e-seriesCollection":l,i.indexOf(l)!==-1){var d=t[""+l]?t[""+l]:l;r[d.replace("e-","")]=[];for(var f=h?h.children:o.children,p=0,c=f;p<c.length;p++){var u=c[p],g=this.getVNodeValue(u,e[""+l],t);Object.keys(g).length!==0&&r[d.replace("e-","")].push(g)}}}}return r},getMultiLevelDirValue:function(n,e,t){for(var i={},r=0,a=n;r<a.length;r++){var s=a[r],o=void 0,h=void 0;if(s.componentOptions?(o=this.getTagName(s.componentOptions),s.componentOptions.children&&(h=s.componentOptions.children)):(s.tag==="e-markersettings"||s.tag==="e-markersetting")&&s.children&&(o=s.tag==="e-markersettings"?"e-markerSettings":"e-markerSetting",h=s.children),o){var l=t[""+o]?t[""+o]:o;if(i[l.replace("e-","")]=[],h)for(var d=0,f=h;d<f.length;d++){var p=f[d],c=this.getVNodeValue(p,e[""+o],t);Object.keys(c).length!==0&&i[l.replace("e-","")].push(c)}}}return i},getVNodeValue:function(n,e,t){var i={};if(n.componentOptions||(n.tag==="e-markersettings"||n.tag==="e-markersetting")&&n.context){var r=void 0;n.componentOptions?r=this.getTagName(n.componentOptions):r=n.tag==="e-markersettings"?"e-markerSettings":"e-markerSetting";var a=n.data;typeof e=="string"&&r===e&&a?i=a.attrs?this.getCamelCaseProps(a.attrs):this.getCamelCaseProps(a):typeof e=="object"&&(n.componentOptions.children&&Object.keys(e).indexOf(r)!==-1?i=this.getMultiLevelDirValue(n.componentOptions.children,e[""+r],t):n.children&&Object.keys(e).indexOf(r)!==-1&&(r==="e-markersettings"||r==="e-markersetting")&&(i=this.getMultiLevelDirValue(n.children,e[""+r],t)),a&&a.attrs&&(i=Ea(i,this.getCamelCaseProps(a.attrs))))}return i},getCamelCaseProps:function(n){for(var e={},t=0,i=Object.keys(n);t<i.length;t++){var r=i[t];e[r.replace(/-[a-z]/g,function(a){return a[1].toUpperCase()})]=n[""+r]}return e},dataBind:function(){this.ej2Instances.dataBind()},setProperties:function(n,e){return this.ej2Instances.setProperties(n,e)},getTagName:function(n){var e=n.tag,t=n.Ctor;return!e&&t&&t.extendOptions&&t.extendOptions.methods&&t.extendOptions.methods.getTag&&(e=n.Ctor.extendOptions.methods.getTag()),e}}});function tw(n){if(n===void 0&&(n={}),n.props)for(var e=function(a){(n.newprops||(n.newprops={}))[""+a]={},(n.watch||(n.watch={}))[""+a]=function(s){this.ej2Instances[""+a]=s,this.dataBind&&n.name!=="DateRangePickerComponent"&&this.dataBind()}},t=0,i=n.props;t<i.length;t++){var r=i[t];e(r)}return[n.newprops,n.watch]}zi||sg(Ci.toRaw);var pn=function(){return pn=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},pn.apply(this,arguments)},Xl=og();function ew(n,e){var t=this;return function(i,r,a,s,o){var h;if(r){var l=r.vueInstance&&r.vueInstance.plugins?{plugins:r.vueInstance.plugins}:{},d=r.vueInstance?r.vueInstance:o&&o.vueInstance?o.vueInstance:null,f=Rr("templateParentDiv"),p=Rr("templateDiv"),c=td("div",{id:f,innerHTML:'<div id="'+p+'"></div>'});if(document.body.appendChild(c),!zi&&(typeof n=="string"||n.prototype&&n.prototype.CSPTemplate&&typeof n=="function")){var u=rw(r.vueInstance,n,o);if(u){var g=Ci.createVNode({render:function(){return u[""+n]({data:i})}},l);if(c.innerHTML="",Yl(g,r.vueInstance,o),Ci.render(g,c),h=c.childNodes,d){var v=d.templateCollection;v||(d.templateCollection={},v=d.templateCollection),a&&(v[""+a]||(v[""+a]=[]),v[""+a].push(c))}Ni(c)}else return Ni(c),Xl(n,e)(i)}else if(zi)if(typeof n=="string"||n.prototype&&n.prototype.CSPTemplate&&typeof n=="function"){var O=iw(r.vueInstance,n,o);if(O){var N={},H=function(nt){nt.$parent&&H(nt.$parent),nt._provided&&Object.keys(nt._provided).length>0&&(N=pn({},N,nt._provided))},F=r.vueInstance?r.vueInstance:o&&o.vueInstance?o.vueInstance:null;F&&H(F);var Y=new Ci({provide:pn({},N),render:function(){return O[""+n]({data:i})}});if(Y.$mount("#"+p),h=c.childNodes,F){var v=F.templateCollection;v||(F.templateCollection={},v=F.templateCollection),a&&(v[""+a]||(v[""+a]=[]),v[""+a].push(h[0]))}Ni(c)}else return Ni(c),Xl(n,e)(i)}else{var m=n.call(t,{}),et=m.template,S=Ii("template.propsData",m),at={data:{data:Ea(m.data||{},i)},parent:r.vueInstance};S&&(et=m.template.extends,at.propsData=S),typeof et!="function"&&(et=Ci.extend(et)),et.options.setup&&(at.propsData=Object.assign(at.propsData||{},i));var tt=new et(at);if(tt.$mount("#"+p),h=c.childNodes,at.parent=null,d){var v=d.templateCollection;v||(d.templateCollection={},v=d.templateCollection),a&&(v[""+a]||(v[""+a]=[]),v[""+a].push(h[0]))}Ni(c)}else{var m=n.call(t,{}),y=m,S=Ii("template.propsData",m),x={data:{data:Ea(m.data||{},i)},parent:r.vueInstance};y.template||(y.template=y[Object.keys(y)[0]]);var I=void 0;if(y.template.extends)I=y.template.extends._context.components.template;else if(I=y.template._context.components[n.name],!I){var C=Object.keys(y.template._context.components)[0];I=y.template._context.components[""+C]}var P;if(S)I.setup?P=Object.assign({},S):P=Object.assign(I.data(),S);else if(I.setup?P=Object.assign({},x.data):P=Object.assign(I.data(),x.data),I.components)for(var A=Object.keys(I.components)||[],T=function(wt){var $=I.components[""+wt];$&&$.data&&($.__data||($.__data=$.data),$.data=function(pt){return Object.assign($.__data.call(pt),x.data)})},z=0,L=A;z<L.length;z++){var R=L[z];T(R)}I.setup&&(l=Object.assign(l,i)),I.data=function(){return P};var g=Ci.createVNode(I,l);if(c.innerHTML="",Yl(g,r.vueInstance,o),Ci.render(g,c),h=c.childNodes,x.parent=null,d){var v=d.templateCollection;v||(d.templateCollection={},v=d.templateCollection),a&&(v[""+a]||(v[""+a]=[]),v[""+a].push(c))}Ni(c)}}return h||[]}}hg({compile:ew});function Yl(n,e,t){var i=e||(t&&t.vueInstance?t.vueInstance:null);if(i){n.appContext=i.$.appContext;var r={},a=function(s){s.$&&s.$.parent&&a(s.$.parent),s.provides&&Object.keys(s.provides).length>0&&(r=pn({},r,s.provides))};a(i),n.appContext.provides&&(n.appContext.provides=pn({},n.appContext.provides,r))}}function iw(n,e,t){if(!(!n&&!(t&&t.vueInstance))){var i=t&&t.vueInstance?t.vueInstance:n;return Co(i,e)}}function Co(n,e){if(n){var t=n.$slots,i=n.$scopedSlots,r=n.scopedSlots,a=n.children;if(i&&i[""+e])return i;if(t&&t.default)for(var s=t.default,o=0;o<s.length;o++){var h=Co(Ul(s[parseInt(o.toString(),10)]),e);if(h)return h}else{if(r&&r[""+e])return r;if(a)for(var o=0;o<a.length;o++){var h=Co(Ul(a[parseInt(o.toString(),10)]),e);if(h)return h}}}}function Ul(n){var e=n.componentOptions&&n.componentOptions.children?n.componentOptions:!n.data&&(n.tag==="e-markersettings"||n.tag==="e-markersetting")?n:n.data;return n.componentInstance?n.componentInstance:e}function rw(n,e,t){if(!(!n&&!(t&&t.vueInstance))){var i=t&&t.vueInstance?t.vueInstance.$slots:n.$slots;return Kf(i,e)}}function Kf(n,e){if(n&&n[""+e])return n;if(n&&n.default){var t=n.default();t=t.flatMap(function(a){return Array.isArray(a.children)?a.children:a});for(var i=0;i<t.length;i++){var r=Kf(t[parseInt(i.toString(),10)].children,e);if(r)return r}}}var jf=["isLazyUpdate","plugins","addInfo","annotationTemplate","backgroundColor","bridgeDirection","commandManager","connectorDefaults","connectors","constraints","contextMenuSettings","customCursor","dataSourceSettings","diagramSettings","drawingObject","enableConnectorSplit","enablePersistence","enableRtl","fixedUserHandleTemplate","getConnectorDefaults","getCustomCursor","getCustomProperty","getCustomTool","getDescription","getNodeDefaults","height","historyManager","layers","layout","locale","mode","model","nodeDefaults","nodeTemplate","nodes","pageSettings","rulerSettings","scrollSettings","segmentThumbShape","segmentThumbSize","selectedItems","serializationSettings","setNodeTemplate","snapSettings","tool","tooltip","updateSelection","userHandleTemplate","width","animationComplete","click","collectionChange","commandExecute","connectionChange","contextMenuBeforeItemRender","contextMenuClick","contextMenuOpen","created","dataLoaded","diagramExporting","diagramImporting","doubleClick","dragEnter","dragLeave","dragOver","drop","elementDraw","expandStateChange","fixedUserHandleClick","historyChange","historyStateChange","keyDown","keyUp","layoutUpdated","load","loaded","mouseEnter","mouseLeave","mouseOver","mouseWheel","onFixedUserHandleMouseDown","onFixedUserHandleMouseEnter","onFixedUserHandleMouseLeave","onFixedUserHandleMouseUp","onImageLoad","onUserHandleMouseDown","onUserHandleMouseEnter","onUserHandleMouseLeave","onUserHandleMouseUp","positionChange","propertyChange","rotateChange","scrollChange","segmentChange","segmentCollectionChange","selectionChange","sizeChange","sourcePointChange","targetPointChange","textEdit"],tp=[],ep=tw({props:jf}),nw=ep[0],ip=ep[1],yh=Object.keys(ip);yh.push("modelchanged","update:modelValue");for(var to=0,Fl=tp;to<Fl.length;to++){var aw=Fl[to];yh.push("update:"+aw)}var sw=_f({name:"DiagramComponent",mixins:[jS],props:nw,watch:ip,emits:yh,provide:function(){return{custom:this.custom}},data:function(){return{ej2Instance:new Xe({}),propKeys:jf,models:tp,hasChildDirective:!0,hasInjectedModules:!0,tagMapper:{"e-layers":"e-layer","e-cursormaps":"e-cursormap","e-connectors":{"e-connector":{"e-connector-fixeduserhandles":"e-connector-fixeduserhandle","e-connector-annotations":"e-connector-annotation"}},"e-nodes":{"e-node":{"e-node-fixeduserhandles":"e-node-fixeduserhandle","e-node-annotations":"e-node-annotation","e-node-ports":"e-node-port"}}},tagNameMapper:{"e-cursormaps":"e-customCursor","e-connector-fixeduserhandles":"e-fixedUserHandles","e-connector-annotations":"e-annotations","e-node-fixeduserhandles":"e-fixedUserHandles","e-node-annotations":"e-annotations","e-node-ports":"e-ports"},isVue3:!zi,templateCollection:{}}},created:function(){this.bindProperties(),this.ej2Instances._setProperties=this.ej2Instances.setProperties,this.ej2Instances.setProperties=this.setProperties,this.ej2Instances.clearTemplate=this.clearTemplate,this.updated=this.updated},render:function(n){var e=zi?n:KS,t=null;return V(this.$slots.default)||(t=zi?this.$slots.default:this.$slots.default()),e("div",t)},methods:{clearTemplate:function(n){if(n||(n=Object.keys(this.templateCollection||{})),n.length&&this.templateCollection)for(var e=0,t=n;e<t.length;e++){var i=t[e],r=this.templateCollection[i];if(r&&r.length){for(var a=0,s=r;a<s.length;a++){var o=s[a];this.destroyPortals(o)}delete this.templateCollection[i]}}},setProperties:function(n,e){var t=this;this.isVue3&&(this.models=this.models?this.models:this.ej2Instances.referModels),this.ej2Instances&&this.ej2Instances._setProperties&&this.ej2Instances._setProperties(n,e),n&&this.models&&this.models.length&&Object.keys(n).map(function(i){t.models.map(function(r){i===r&&!/datasource/i.test(i)&&(t.isVue3?t.ej2Instances.vueInstance.$emit("update:"+i,n[i]):(t.$emit("update:"+i,n[i]),t.$emit("modelchanged",n[i])))})})},custom:function(){this.updated()},add:function(n,e){return this.ej2Instances.add(n,e)},addChildToGroup:function(n,e){return this.ej2Instances.addChildToGroup(n,e)},addChildToUmlNode:function(n,e,t){return this.ej2Instances.addChildToUmlNode(n,e,t)},addConnector:function(n){return this.ej2Instances.addConnector(n)},addConnectorLabels:function(n,e){return this.ej2Instances.addConnectorLabels(n,e)},addConstraints:function(n,e){return this.ej2Instances.addConstraints(n,e)},addCustomHistoryEntry:function(n){return this.ej2Instances.addCustomHistoryEntry(n)},addElements:function(n){return this.ej2Instances.addElements(n)},addHistoryEntry:function(n,e){return this.ej2Instances.addHistoryEntry(n,e)},addLabels:function(n,e){return this.ej2Instances.addLabels(n,e)},addLanes:function(n,e,t){return this.ej2Instances.addLanes(n,e,t)},addLayer:function(n,e){return this.ej2Instances.addLayer(n,e)},addNode:function(n,e){return this.ej2Instances.addNode(n,e)},addNodeLabels:function(n,e){return this.ej2Instances.addNodeLabels(n,e)},addNodeToLane:function(n,e,t){return this.ej2Instances.addNodeToLane(n,e,t)},addPhases:function(n,e){return this.ej2Instances.addPhases(n,e)},addPorts:function(n,e){return this.ej2Instances.addPorts(n,e)},addProcess:function(n,e){return this.ej2Instances.addProcess(n,e)},addTextAnnotation:function(n,e){return this.ej2Instances.addTextAnnotation(n,e)},align:function(n,e,t){return this.ej2Instances.align(n,e,t)},bringIntoView:function(n){return this.ej2Instances.bringIntoView(n)},bringLayerForward:function(n){return this.ej2Instances.bringLayerForward(n)},bringToCenter:function(n){return this.ej2Instances.bringToCenter(n)},bringToFront:function(){return this.ej2Instances.bringToFront()},clear:function(){return this.ej2Instances.clear()},clearHistory:function(){return this.ej2Instances.clearHistory()},clearSelection:function(){return this.ej2Instances.clearSelection()},cloneLayer:function(n){return this.ej2Instances.cloneLayer(n)},copy:function(){return this.ej2Instances.copy()},cut:function(){return this.ej2Instances.cut()},destroy:function(){return this.ej2Instances.destroy()},distribute:function(n,e){return this.ej2Instances.distribute(n,e)},distributePorts:function(n){return this.ej2Instances.distributePorts(n)},doLayout:function(){return this.ej2Instances.doLayout()},drag:function(n,e,t){return this.ej2Instances.drag(n,e,t)},dragSourceEnd:function(n,e,t){return this.ej2Instances.dragSourceEnd(n,e,t)},dragTargetEnd:function(n,e,t){return this.ej2Instances.dragTargetEnd(n,e,t)},editSegment:function(n){return this.ej2Instances.editSegment(n)},endGroupAction:function(){return this.ej2Instances.endGroupAction()},exportDiagram:function(n){return this.ej2Instances.exportDiagram(n)},exportImage:function(n,e){return this.ej2Instances.exportImage(n,e)},exportToVisio:function(n){return this.ej2Instances.exportToVisio(n)},findElementUnderMouse:function(n,e,t,i){return this.ej2Instances.findElementUnderMouse(n,e,t,i)},findObjectsUnderMouse:function(n,e){return this.ej2Instances.findObjectsUnderMouse(n,e)},fitToPage:function(n){return this.ej2Instances.fitToPage(n)},getActiveLayer:function(){return this.ej2Instances.getActiveLayer()},getConnectorObject:function(n){return this.ej2Instances.getConnectorObject(n)},getCursor:function(n,e){return this.ej2Instances.getCursor(n,e)},getDiagramAction:function(n){return this.ej2Instances.getDiagramAction(n)},getDiagramBounds:function(){return this.ej2Instances.getDiagramBounds()},getDiagramContent:function(n){return this.ej2Instances.getDiagramContent(n)},getEdges:function(n){return this.ej2Instances.getEdges(n)},getHistoryStack:function(n){return this.ej2Instances.getHistoryStack(n)},getNodeObject:function(n){return this.ej2Instances.getNodeObject(n)},getObject:function(n){return this.ej2Instances.getObject(n)},getParentId:function(n){return this.ej2Instances.getParentId(n)},getTool:function(n){return this.ej2Instances.getTool(n)},group:function(){return this.ej2Instances.group()},hideTooltip:function(n){return this.ej2Instances.hideTooltip(n)},importFromVisio:function(n,e){return this.ej2Instances.importFromVisio(n,e)},insertData:function(n){return this.ej2Instances.insertData(n)},loadDiagram:function(n,e){return this.ej2Instances.loadDiagram(n,e)},loadDiagramFromMermaid:function(n){return this.ej2Instances.loadDiagramFromMermaid(n)},moveForward:function(){return this.ej2Instances.moveForward()},moveObjects:function(n,e){return this.ej2Instances.moveObjects(n,e)},moveObjectsUp:function(n,e){return this.ej2Instances.moveObjectsUp(n,e)},nudge:function(n,e,t,i){return this.ej2Instances.nudge(n,e,t,i)},pan:function(n,e,t,i){return this.ej2Instances.pan(n,e,t,i)},paste:function(n){return this.ej2Instances.paste(n)},print:function(n){return this.ej2Instances.print(n)},printImage:function(n,e){return this.ej2Instances.printImage(n,e)},redo:function(){return this.ej2Instances.redo()},remove:function(n){return this.ej2Instances.remove(n)},removeChildFromGroup:function(n,e){return this.ej2Instances.removeChildFromGroup(n,e)},removeConstraints:function(n,e){return this.ej2Instances.removeConstraints(n,e)},removeData:function(n){return this.ej2Instances.removeData(n)},removeLabels:function(n,e){return this.ej2Instances.removeLabels(n,e)},removeLane:function(n,e){return this.ej2Instances.removeLane(n,e)},removeLayer:function(n){return this.ej2Instances.removeLayer(n)},removePhase:function(n,e){return this.ej2Instances.removePhase(n,e)},removePorts:function(n,e){return this.ej2Instances.removePorts(n,e)},removeProcess:function(n){return this.ej2Instances.removeProcess(n)},reset:function(){return this.ej2Instances.reset()},resetSegments:function(){return this.ej2Instances.resetSegments()},rotate:function(n,e,t,i){return this.ej2Instances.rotate(n,e,t,i)},sameSize:function(n,e){return this.ej2Instances.sameSize(n,e)},saveDiagram:function(){return this.ej2Instances.saveDiagram()},saveDiagramAsMermaid:function(){return this.ej2Instances.saveDiagramAsMermaid()},scale:function(n,e,t,i){return this.ej2Instances.scale(n,e,t,i)},select:function(n,e,t){return this.ej2Instances.select(n,e,t)},selectAll:function(){return this.ej2Instances.selectAll()},sendBackward:function(){return this.ej2Instances.sendBackward()},sendLayerBackward:function(n){return this.ej2Instances.sendLayerBackward(n)},sendToBack:function(){return this.ej2Instances.sendToBack()},setActiveLayer:function(n){return this.ej2Instances.setActiveLayer(n)},setStackLimit:function(n){return this.ej2Instances.setStackLimit(n)},showTooltip:function(n){return this.ej2Instances.showTooltip(n)},startGroupAction:function(){return this.ej2Instances.startGroupAction()},startTextEdit:function(n,e){return this.ej2Instances.startTextEdit(n,e)},unGroup:function(){return this.ej2Instances.unGroup()},unSelect:function(n){return this.ej2Instances.unSelect(n)},undo:function(){return this.ej2Instances.undo()},updateData:function(n){return this.ej2Instances.updateData(n)},updateFromModel:function(){return this.ej2Instances.updateFromModel()},updateViewPort:function(){return this.ej2Instances.updateViewPort()},zoom:function(n,e){return this.ej2Instances.zoom(n,e)},zoomTo:function(n){return this.ej2Instances.zoomTo(n)}}});const ow={class:"flow-demo"},hw={class:"toolbar"},lw=["value"],dw={class:"flow-container"},fw={class:"flow-wrapper"},pw={class:"code"},cw=$l({__name:"SyncfusionDiagramDemo",setup(n){const e=bn(null),t=[{id:"node0",offsetX:250,offsetY:250,width:180,height:60,annotations:[{content:"Task: Deployment"}],shape:{type:"Flow",shape:"Process"},style:{fill:"#f3e8ff",strokeColor:"#a855f7",strokeWidth:2}},{id:"node1",offsetX:550,offsetY:350,width:180,height:60,annotations:[{content:"Task: Enrichment"}],shape:{type:"Flow",shape:"Process"},style:{fill:"#f3e8ff",strokeColor:"#a855f7",strokeWidth:2}}],i=[{id:"connector0-1",sourceID:"node0",targetID:"node1",type:"Orthogonal",style:{strokeColor:"#7c3aed",strokeWidth:3},targetDecorator:{shape:"Arrow",style:{fill:"#7c3aed",strokeColor:"#7c3aed"},width:12,height:12}}],r=bn(JSON.parse(JSON.stringify(t))),a=bn(JSON.parse(JSON.stringify(i))),s={constraints:pi.ShowLines|pi.SnapToLines,horizontalGridlines:{lineIntervals:[1,14,.5,14.5]},verticalGridlines:{lineIntervals:[1,14,.5,14.5]}},o={scrollLimit:"Infinity"};let h=t.length;function l(C){return C.constraints=W.Default|W.AllowDrop,C}function d(C){return C.constraints=yt.Default|yt.DragSegmentThumb,C}const f=["Enrichment","Cleaning","Transformation","Modeling","Validation","Deployment"],p=bn(f[0]);function c(){return e.value?.ej2Instances}function u(){const C=c();C&&C.fitToPage({mode:"Page",margin:{left:20,right:20,top:20,bottom:20}})}function g(){const C=c();C&&C.zoom(1.2)}function v(){const C=c();C&&C.zoom(.8)}function m(){const C=c();C&&(C.reset(),C.pan(0,0))}function y(){const C=c();if(!C)return;const A={id:`node${h++}`,offsetX:Math.random()*400+100,offsetY:Math.random()*300+100,width:180,height:60,annotations:[{content:`Task: ${p.value}`}],shape:{type:"Flow",shape:"Process"},style:{fill:"#f3e8ff",strokeColor:"#a855f7",strokeWidth:2}};C.add(A)}function S(){const C=c();if(!C)return;C.clear(),h=t.length;const P=JSON.parse(JSON.stringify(t)),A=JSON.parse(JSON.stringify(i));for(const T of P)C.add(T);for(const T of A)C.add(T);C.fitToPage({mode:"Page",margin:{left:20,right:20,top:20,bottom:20}})}const x=eo(()=>{const C=c();return C?C.nodes.map(P=>({id:P.id,offsetX:Math.round(P.offsetX),offsetY:Math.round(P.offsetY),annotation:P.annotations?.[0]?.content})):r.value.map(P=>({id:P.id,offsetX:P.offsetX,offsetY:P.offsetY,annotation:P.annotations?.[0]?.content}))}),I=eo(()=>{const C=c();return C?C.connectors.map(P=>({id:P.id,sourceID:P.sourceID,targetID:P.targetID})):a.value.map(P=>({id:P.id,sourceID:P.sourceID,targetID:P.targetID}))});return ql(()=>{setTimeout(()=>{u()},300)}),(C,P)=>(ro(),io("div",ow,[P[2]||(P[2]=pe("div",{class:"demo-header"},[pe("h1",null,"Syncfusion Diagram Demo"),pe("p",{class:"subtitle"},[Gl(" Interactive node-based diagram editor powered by "),pe("code",null,"@syncfusion/ej2-vue-diagrams")])],-1)),pe("div",hw,[pe("button",{class:"btn btn-primary",onClick:u},"Fit View"),pe("button",{class:"btn btn-secondary",onClick:g},"Zoom In (+)"),pe("button",{class:"btn btn-secondary",onClick:v},"Zoom Out (-)"),pe("button",{class:"btn btn-secondary",onClick:m},"Reset View"),P[1]||(P[1]=pe("div",{class:"toolbar-divider"},null,-1)),pe("button",{class:"btn btn-danger",onClick:S},"Reset Diagram"),Kl(pe("select",{"onUpdate:modelValue":P[0]||(P[0]=A=>p.value=A),class:"form-select"},[(ro(),io(Vl,null,Ql(f,A=>pe("option",{key:A,value:A},ya(A),9,lw)),64))],512),[[_l,p.value]]),pe("button",{class:"btn btn-accent",onClick:y},"+ Add Task")]),pe("div",dw,[pe("div",fw,[Zl(Jl(sw),{ref_key:"diagramRef",ref:e,id:"syncfusion-diagram",width:"100%",height:"100%",nodes:r.value,connectors:a.value,getNodeDefaults:l,getConnectorDefaults:d,snapSettings:s,scrollSettings:o},null,8,["nodes","connectors"])]),pe("div",pw,[pe("pre",null,"nodes = "+ya(x.value),1),pe("pre",null,"connectors = "+ya(I.value),1)])])]))}}),gw=lg(cw,[["__scopeId","data-v-27169740"]]);export{gw as default};
